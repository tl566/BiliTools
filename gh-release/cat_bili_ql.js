"use strict";var u=require("path"),t=require("fs");require("crypto");var e=require("zlib"),n=require("got");function r(u){return u&&"object"==typeof u&&"default"in u?u:{default:u}}function i(u){if(u&&u.__esModule)return u;var t=Object.create(null);return u&&Object.keys(u).forEach((function(e){if("default"!==e){var n=Object.getOwnPropertyDescriptor(u,e);Object.defineProperty(t,e,n.get?n:{enumerable:!0,get:function(){return u[e]}})}})),t.default=u,Object.freeze(t)}var o,a=i(u),s=i(t),c=r(n);!function(u){u[u.SUCCESS=0]="SUCCESS",u[u["应用程序不存在或已被封禁"]=-1]="应用程序不存在或已被封禁",u[u["Access Key错误"]=-2]="Access Key错误",u[u["API校验密匙错误"]=-3]="API校验密匙错误",u[u["调用方对该Method没有权限"]=-4]="调用方对该Method没有权限",u[u["账号未登录"]=-101]="账号未登录",u[u["账号被封停"]=-102]="账号被封停",u[u["积分不足"]=-103]="积分不足",u[u["硬币不足"]=-104]="硬币不足",u[u["验证码错误"]=-105]="验证码错误",u[u["账号非正式会员或在适应期"]=-106]="账号非正式会员或在适应期",u[u["应用不存在或者被封禁"]=-107]="应用不存在或者被封禁",u[u["未绑定手机?"]=-108]="未绑定手机?",u[u["未绑定手机"]=-110]="未绑定手机",u[u["csrf 校验失败"]=-111]="csrf 校验失败",u[u["系统升级中"]=-112]="系统升级中",u[u["账号尚未实名认证"]=-113]="账号尚未实名认证",u[u["请先绑定手机"]=-114]="请先绑定手机",u[u["请先完成实名认证"]=-115]="请先完成实名认证"}(o||(o={}));const D="https://account.bilibili.com",f="https://live.bilibili.com",l="https://space.bilibili.com",d="https://message.bilibili.com",C="https://www.bilibili.com",p="https://www.bilibili.com/",F="https://account.bilibili.com",A="https://api.live.bilibili.com",E="https://api.bilibili.com",g="https://manga.bilibili.com",m="https://api.vc.bilibili.com",h={"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.41 Safari/537.36 Edg/101.0.1210.32","content-type":"application/x-www-form-urlencoded; charset=UTF-8","accept-language":"zh-CN,zh;q=0.9","accept-encoding":"gzip, deflate, br"},y=["棒","棒唉","棒耶","加油~","UP加油!","支持~","支持支持！","催更啦","顶顶","留下脚印~","干杯","bilibili干杯","o(*￣▽￣*)o","(｡･∀･)ﾉﾞ嗨","(●ˇ∀ˇ●)","( •̀ ω •́ )y","(ง •_•)ง",">.<","^_~"],B=Object.prototype.toString;function w(u,t){return B.call(u)===`[object ${t}]`}function v(u){return null!==u&&w(u,"Object")}function _(u){return w(u,"String")}function b(u){return u&&Array.isArray(u)}function $(){const u=new Date,t=u.getTime(),e=u.getTimezoneOffset()/60;return new Date(t+36e5*(e+8))}function S(u,t){return Math.ceil(t/u)}function T(u,t,e){if(e&&"boolean"!=typeof e&&(t=e=void 0),void 0===e&&("boolean"==typeof t?(e=t,t=void 0):"boolean"==typeof u&&(e=u,u=void 0)),void 0===u&&void 0===t?(u=0,t=1):void 0===t&&(t=u,u=0),u>t){const e=u;u=t,t=e}if(e||u%1||t%1){const e=Math.random();return Math.min(u+e*(t-u+parseFloat("1e-"+((e+"").length-1))),t)}return u+Math.floor(Math.random()*(t-u+1))}function I(){return`${T(1,9)}${function(u,t){let e="";for(let t=0;t<u;t++)e+=k("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");return t?e.toLowerCase():e}(10,!0)}0`}function O(u,t){u.includes(t)||u.push(t)}function P(u,t=!1){return v(u)?Array.isArray(u)?u.map((u=>P(u,t))):t?Object.keys(u).reduce(((e,n)=>(e[n]=P(u[n],t),e)),{}):Object.assign({},u):u}function x(u,t){return void 0===u||void 0===t?u||t:v(u)&&v(t)?Array.isArray(u)&&Array.isArray(t)?u.concat(t):Object.keys(t).reduce(((e,n)=>(e[n]=x(u[n],t[n]),e)),u):t}function L(u){if(!v(u)&&!b(u))return u;const t=new URLSearchParams;return Array.isArray(u)||(u=Object.entries(u)),u.forEach((([u,e])=>{v(e)?t.append(u,JSON.stringify(e)):t.append(u,String(e))})),t.toString()}function k(u){return u[T(u.length-1)]}function N(u){return u&&u.map((u=>Number(u))).filter((u=>u>0&&u%1==0))}var R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},U=function(u){return u&&u.Math==Math&&u},j=U("object"==typeof globalThis&&globalThis)||U("object"==typeof window&&window)||U("object"==typeof self&&self)||U("object"==typeof R&&R)||function(){return this}()||Function("return this")(),G={},M=function(u){try{return!!u()}catch(u){return!0}},q=!M((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),J=!M((function(){var u=function(){}.bind();return"function"!=typeof u||u.hasOwnProperty("prototype")})),H=J,K=Function.prototype.call,z=H?K.bind(K):function(){return K.apply(K,arguments)},Y={},Q={}.propertyIsEnumerable,W=Object.getOwnPropertyDescriptor,V=W&&!Q.call({1:2},1);Y.f=V?function(u){var t=W(this,u);return!!t&&t.enumerable}:Q;var X,Z,uu=function(u,t){return{enumerable:!(1&u),configurable:!(2&u),writable:!(4&u),value:t}},tu=J,eu=Function.prototype,nu=eu.bind,ru=eu.call,iu=tu&&nu.bind(ru,ru),ou=tu?function(u){return u&&iu(u)}:function(u){return u&&function(){return ru.apply(u,arguments)}},au=ou,su=au({}.toString),cu=au("".slice),Du=function(u){return cu(su(u),8,-1)},fu=M,lu=Du,du=Object,Cu=ou("".split),pu=fu((function(){return!du("z").propertyIsEnumerable(0)}))?function(u){return"String"==lu(u)?Cu(u,""):du(u)}:du,Fu=TypeError,Au=function(u){if(null==u)throw Fu("Can't call method on "+u);return u},Eu=pu,gu=Au,mu=function(u){return Eu(gu(u))},hu=function(u){return"function"==typeof u},yu=hu,Bu=function(u){return"object"==typeof u?null!==u:yu(u)},wu=j,vu=hu,_u=function(u){return vu(u)?u:void 0},bu=function(u,t){return arguments.length<2?_u(wu[u]):wu[u]&&wu[u][t]},$u=ou({}.isPrototypeOf),Su=j,Tu=bu("navigator","userAgent")||"",Iu=Su.process,Ou=Su.Deno,Pu=Iu&&Iu.versions||Ou&&Ou.version,xu=Pu&&Pu.v8;xu&&(Z=(X=xu.split("."))[0]>0&&X[0]<4?1:+(X[0]+X[1])),!Z&&Tu&&(!(X=Tu.match(/Edge\/(\d+)/))||X[1]>=74)&&(X=Tu.match(/Chrome\/(\d+)/))&&(Z=+X[1]);var Lu=Z,ku=M,Nu=!!Object.getOwnPropertySymbols&&!ku((function(){var u=Symbol();return!String(u)||!(Object(u)instanceof Symbol)||!Symbol.sham&&Lu&&Lu<41})),Ru=Nu&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Uu=bu,ju=hu,Gu=$u,Mu=Object,qu=Ru?function(u){return"symbol"==typeof u}:function(u){var t=Uu("Symbol");return ju(t)&&Gu(t.prototype,Mu(u))},Ju=String,Hu=hu,Ku=function(u){try{return Ju(u)}catch(u){return"Object"}},zu=TypeError,Yu=function(u){if(Hu(u))return u;throw zu(Ku(u)+" is not a function")},Qu=z,Wu=hu,Vu=Bu,Xu=TypeError,Zu={exports:{}},ut=j,tt=Object.defineProperty,et=function(u,t){try{tt(ut,u,{value:t,configurable:!0,writable:!0})}catch(e){ut[u]=t}return t},nt=et,rt=j["__core-js_shared__"]||nt("__core-js_shared__",{}),it=rt;(Zu.exports=function(u,t){return it[u]||(it[u]=void 0!==t?t:{})})("versions",[]).push({version:"3.22.8",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.8/LICENSE",source:"https://github.com/zloirock/core-js"});var ot=Au,at=Object,st=function(u){return at(ot(u))},ct=ou({}.hasOwnProperty),Dt=Object.hasOwn||function(u,t){return ct(st(u),t)},ft=ou,lt=0,dt=Math.random(),Ct=ft(1..toString),pt=function(u){return"Symbol("+(void 0===u?"":u)+")_"+Ct(++lt+dt,36)},Ft=j,At=Zu.exports,Et=Dt,gt=pt,mt=Nu,ht=Ru,yt=At("wks"),Bt=Ft.Symbol,wt=Bt&&Bt.for,vt=ht?Bt:Bt&&Bt.withoutSetter||gt,_t=function(u){if(!Et(yt,u)||!mt&&"string"!=typeof yt[u]){var t="Symbol."+u;mt&&Et(Bt,u)?yt[u]=Bt[u]:yt[u]=ht&&wt?wt(t):vt(t)}return yt[u]},bt=z,$t=Bu,St=qu,Tt=function(u,t){var e=u[t];return null==e?void 0:Yu(e)},It=function(u,t){var e,n;if("string"===t&&Wu(e=u.toString)&&!Vu(n=Qu(e,u)))return n;if(Wu(e=u.valueOf)&&!Vu(n=Qu(e,u)))return n;if("string"!==t&&Wu(e=u.toString)&&!Vu(n=Qu(e,u)))return n;throw Xu("Can't convert object to primitive value")},Ot=TypeError,Pt=_t("toPrimitive"),xt=function(u,t){if(!$t(u)||St(u))return u;var e,n=Tt(u,Pt);if(n){if(void 0===t&&(t="default"),e=bt(n,u,t),!$t(e)||St(e))return e;throw Ot("Can't convert object to primitive value")}return void 0===t&&(t="number"),It(u,t)},Lt=qu,kt=function(u){var t=xt(u,"string");return Lt(t)?t:t+""},Nt=Bu,Rt=j.document,Ut=Nt(Rt)&&Nt(Rt.createElement),jt=function(u){return Ut?Rt.createElement(u):{}},Gt=!q&&!M((function(){return 7!=Object.defineProperty(jt("div"),"a",{get:function(){return 7}}).a})),Mt=q,qt=z,Jt=Y,Ht=uu,Kt=mu,zt=kt,Yt=Dt,Qt=Gt,Wt=Object.getOwnPropertyDescriptor;G.f=Mt?Wt:function(u,t){if(u=Kt(u),t=zt(t),Qt)try{return Wt(u,t)}catch(u){}if(Yt(u,t))return Ht(!qt(Jt.f,u,t),u[t])};var Vt={},Xt=q&&M((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Zt=Bu,ue=String,te=TypeError,ee=function(u){if(Zt(u))return u;throw te(ue(u)+" is not an object")},ne=q,re=Gt,ie=Xt,oe=ee,ae=kt,se=TypeError,ce=Object.defineProperty,De=Object.getOwnPropertyDescriptor;Vt.f=ne?ie?function(u,t,e){if(oe(u),t=ae(t),oe(e),"function"==typeof u&&"prototype"===t&&"value"in e&&"writable"in e&&!e.writable){var n=De(u,t);n&&n.writable&&(u[t]=e.value,e={configurable:"configurable"in e?e.configurable:n.configurable,enumerable:"enumerable"in e?e.enumerable:n.enumerable,writable:!1})}return ce(u,t,e)}:ce:function(u,t,e){if(oe(u),t=ae(t),oe(e),re)try{return ce(u,t,e)}catch(u){}if("get"in e||"set"in e)throw se("Accessors not supported");return"value"in e&&(u[t]=e.value),u};var fe=Vt,le=uu,de=q?function(u,t,e){return fe.f(u,t,le(1,e))}:function(u,t,e){return u[t]=e,u},Ce={exports:{}},pe=q,Fe=Dt,Ae=Function.prototype,Ee=pe&&Object.getOwnPropertyDescriptor,ge=Fe(Ae,"name"),me={EXISTS:ge,PROPER:ge&&"something"===function(){}.name,CONFIGURABLE:ge&&(!pe||pe&&Ee(Ae,"name").configurable)},he=hu,ye=rt,Be=ou(Function.toString);he(ye.inspectSource)||(ye.inspectSource=function(u){return Be(u)});var we,ve,_e,be=ye.inspectSource,$e=hu,Se=be,Te=j.WeakMap,Ie=$e(Te)&&/native code/.test(Se(Te)),Oe=Zu.exports,Pe=pt,xe=Oe("keys"),Le={},ke=Ie,Ne=j,Re=ou,Ue=Bu,je=de,Ge=Dt,Me=rt,qe=function(u){return xe[u]||(xe[u]=Pe(u))},Je=Le,He=Ne.TypeError,Ke=Ne.WeakMap;if(ke||Me.state){var ze=Me.state||(Me.state=new Ke),Ye=Re(ze.get),Qe=Re(ze.has),We=Re(ze.set);we=function(u,t){if(Qe(ze,u))throw new He("Object already initialized");return t.facade=u,We(ze,u,t),t},ve=function(u){return Ye(ze,u)||{}},_e=function(u){return Qe(ze,u)}}else{var Ve=qe("state");Je[Ve]=!0,we=function(u,t){if(Ge(u,Ve))throw new He("Object already initialized");return t.facade=u,je(u,Ve,t),t},ve=function(u){return Ge(u,Ve)?u[Ve]:{}},_e=function(u){return Ge(u,Ve)}}var Xe={set:we,get:ve,has:_e,enforce:function(u){return _e(u)?ve(u):we(u,{})},getterFor:function(u){return function(t){var e;if(!Ue(t)||(e=ve(t)).type!==u)throw He("Incompatible receiver, "+u+" required");return e}}},Ze=M,un=hu,tn=Dt,en=q,nn=me.CONFIGURABLE,rn=be,on=Xe.enforce,an=Xe.get,sn=Object.defineProperty,cn=en&&!Ze((function(){return 8!==sn((function(){}),"length",{value:8}).length})),Dn=String(String).split("String"),fn=Ce.exports=function(u,t,e){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),e&&e.getter&&(t="get "+t),e&&e.setter&&(t="set "+t),(!tn(u,"name")||nn&&u.name!==t)&&sn(u,"name",{value:t,configurable:!0}),cn&&e&&tn(e,"arity")&&u.length!==e.arity&&sn(u,"length",{value:e.arity});try{e&&tn(e,"constructor")&&e.constructor?en&&sn(u,"prototype",{writable:!1}):u.prototype&&(u.prototype=void 0)}catch(u){}var n=on(u);return tn(n,"source")||(n.source=Dn.join("string"==typeof t?t:"")),u};Function.prototype.toString=fn((function(){return un(this)&&an(this).source||rn(this)}),"toString");var ln=hu,dn=de,Cn=Ce.exports,pn=et,Fn={},An=Math.ceil,En=Math.floor,gn=Math.trunc||function(u){var t=+u;return(t>0?En:An)(t)},mn=function(u){var t=+u;return t!=t||0===t?0:gn(t)},hn=mn,yn=Math.max,Bn=Math.min,wn=mn,vn=Math.min,_n=function(u){return u>0?vn(wn(u),9007199254740991):0},bn=mu,$n=function(u,t){var e=hn(u);return e<0?yn(e+t,0):Bn(e,t)},Sn=function(u){return _n(u.length)},Tn=function(u){return function(t,e,n){var r,i=bn(t),o=Sn(i),a=$n(n,o);if(u&&e!=e){for(;o>a;)if((r=i[a++])!=r)return!0}else for(;o>a;a++)if((u||a in i)&&i[a]===e)return u||a||0;return!u&&-1}},In={includes:Tn(!0),indexOf:Tn(!1)},On=Dt,Pn=mu,xn=In.indexOf,Ln=Le,kn=ou([].push),Nn=function(u,t){var e,n=Pn(u),r=0,i=[];for(e in n)!On(Ln,e)&&On(n,e)&&kn(i,e);for(;t.length>r;)On(n,e=t[r++])&&(~xn(i,e)||kn(i,e));return i},Rn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype");Fn.f=Object.getOwnPropertyNames||function(u){return Nn(u,Rn)};var Un={};Un.f=Object.getOwnPropertySymbols;var jn=bu,Gn=Fn,Mn=Un,qn=ee,Jn=ou([].concat),Hn=jn("Reflect","ownKeys")||function(u){var t=Gn.f(qn(u)),e=Mn.f;return e?Jn(t,e(u)):t},Kn=Dt,zn=Hn,Yn=G,Qn=Vt,Wn=function(u,t,e){for(var n=zn(t),r=Qn.f,i=Yn.f,o=0;o<n.length;o++){var a=n[o];Kn(u,a)||e&&Kn(e,a)||r(u,a,i(t,a))}},Vn=M,Xn=hu,Zn=/#|\.prototype\./,ur=function(u,t){var e=er[tr(u)];return e==rr||e!=nr&&(Xn(t)?Vn(t):!!t)},tr=ur.normalize=function(u){return String(u).replace(Zn,".").toLowerCase()},er=ur.data={},nr=ur.NATIVE="N",rr=ur.POLYFILL="P",ir=ur,or=j,ar=G.f,sr=de,cr=function(u,t,e,n){n||(n={});var r=n.enumerable,i=void 0!==n.name?n.name:t;return ln(e)&&Cn(e,i,n),n.global?r?u[t]=e:pn(t,e):(n.unsafe?u[t]&&(r=!0):delete u[t],r?u[t]=e:dn(u,t,e)),u},Dr=et,fr=Wn,lr=ir,dr=J,Cr=Function.prototype,pr=Cr.apply,Fr=Cr.call,Ar="object"==typeof Reflect&&Reflect.apply||(dr?Fr.bind(pr):function(){return Fr.apply(pr,arguments)}),Er=hu,gr=String,mr=TypeError,hr=ou,yr=ee,Br=function(u){if("object"==typeof u||Er(u))return u;throw mr("Can't set "+gr(u)+" as a prototype")},wr=Object.setPrototypeOf||("__proto__"in{}?function(){var u,t=!1,e={};try{(u=hr(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(e,[]),t=e instanceof Array}catch(u){}return function(e,n){return yr(e),Br(n),t?u(e,n):e.__proto__=n,e}}():void 0),vr=Vt.f,_r=hu,br=Bu,$r=wr,Sr={};Sr[_t("toStringTag")]="z";var Tr="[object z]"===String(Sr),Ir=hu,Or=Du,Pr=_t("toStringTag"),xr=Object,Lr="Arguments"==Or(function(){return arguments}()),kr=Tr?Or:function(u){var t,e,n;return void 0===u?"Undefined":null===u?"Null":"string"==typeof(e=function(u,t){try{return u[t]}catch(u){}}(t=xr(u),Pr))?e:Lr?Or(t):"Object"==(n=Or(t))&&Ir(t.callee)?"Arguments":n},Nr=kr,Rr=String,Ur=function(u){if("Symbol"===Nr(u))throw TypeError("Cannot convert a Symbol value to a string");return Rr(u)},jr=Bu,Gr=de,Mr=Error,qr=ou("".replace),Jr=String(Mr("zxcasd").stack),Hr=/\n\s*at [^:]*:[^\n]*/,Kr=Hr.test(Jr),zr=uu,Yr=!M((function(){var u=Error("a");return!("stack"in u)||(Object.defineProperty(u,"stack",zr(1,7)),7!==u.stack)})),Qr=bu,Wr=Dt,Vr=de,Xr=$u,Zr=wr,ui=Wn,ti=function(u,t,e){e in u||vr(u,e,{configurable:!0,get:function(){return t[e]},set:function(u){t[e]=u}})},ei=function(u,t,e){var n,r;return $r&&_r(n=t.constructor)&&n!==e&&br(r=n.prototype)&&r!==e.prototype&&$r(u,r),u},ni=function(u,t){return void 0===u?arguments.length<2?"":t:Ur(u)},ri=function(u,t){jr(t)&&"cause"in t&&Gr(u,"cause",t.cause)},ii=function(u,t){if(Kr&&"string"==typeof u&&!Mr.prepareStackTrace)for(;t--;)u=qr(u,Hr,"");return u},oi=Yr,ai=q,si=function(u,t){var e,n,r,i,o,a=u.target,s=u.global,c=u.stat;if(e=s?or:c?or[a]||Dr(a,{}):(or[a]||{}).prototype)for(n in t){if(i=t[n],r=u.dontCallGetSet?(o=ar(e,n))&&o.value:e[n],!lr(s?n:a+(c?".":"#")+n,u.forced)&&void 0!==r){if(typeof i==typeof r)continue;fr(i,r)}(u.sham||r&&r.sham)&&sr(i,"sham",!0),cr(e,n,i,u)}},ci=Ar,Di=function(u,t,e,n){var r="stackTraceLimit",i=n?2:1,o=u.split("."),a=o[o.length-1],s=Qr.apply(null,o);if(s){var c=s.prototype;if(Wr(c,"cause")&&delete c.cause,!e)return s;var D=Qr("Error"),f=t((function(u,t){var e=ni(n?t:u,void 0),r=n?new s(u):new s;return void 0!==e&&Vr(r,"message",e),oi&&Vr(r,"stack",ii(r.stack,2)),this&&Xr(c,this)&&ei(r,this,f),arguments.length>i&&ri(r,arguments[i]),r}));f.prototype=c,"Error"!==a?Zr?Zr(f,D):ui(f,D,{name:!0}):ai&&r in s&&(ti(f,s,r),ti(f,s,"prepareStackTrace")),ui(f,s);try{c.name!==a&&Vr(c,"name",a),c.constructor=f}catch(u){}return f}},fi=j.WebAssembly,li=7!==Error("e",{cause:7}).cause,di=function(u,t){var e={};e[u]=Di(u,t,li),si({global:!0,constructor:!0,arity:1,forced:li},e)},Ci=function(u,t){if(fi&&fi[u]){var e={};e[u]=Di("WebAssembly."+u,t,li),si({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:li},e)}};di("Error",(function(u){return function(t){return ci(u,this,arguments)}})),di("EvalError",(function(u){return function(t){return ci(u,this,arguments)}})),di("RangeError",(function(u){return function(t){return ci(u,this,arguments)}})),di("ReferenceError",(function(u){return function(t){return ci(u,this,arguments)}})),di("SyntaxError",(function(u){return function(t){return ci(u,this,arguments)}})),di("TypeError",(function(u){return function(t){return ci(u,this,arguments)}})),di("URIError",(function(u){return function(t){return ci(u,this,arguments)}})),Ci("CompileError",(function(u){return function(t){return ci(u,this,arguments)}})),Ci("LinkError",(function(u){return function(t){return ci(u,this,arguments)}})),Ci("RuntimeError",(function(u){return function(t){return ci(u,this,arguments)}}));function pi(u,t=!0){return t?u.toLocaleString("zh-CN",{hour12:!1}):u.toLocaleString("zh-CN",{hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"})}function Fi(u="info"){const t=["error","warn","info","verbose","debug"],e=t.indexOf(u);return e>0?t.slice(0,e+1):t}function Ai(u){return a.resolve(process.cwd(),u)}class Ei{static pushValue="";month=$().getMonth()+1;errorFile=Ai(`./logs/bt_error-${this.month}.log`);logFile=Ai(`./logs/bt_combined-${this.month}.log`);noFile=!1;constructor(u={console:"info",file:"info",push:"info"},t="default"){this.options=u,this.name=t,this.consoleLeval=Fi(this.options.console),this.fileLeval=Fi(this.options.file),this.pushLeval=Fi(this.options.push),this.noFile=!0,this.noFile||this.createLogFile()}log({level:u},t){const e=$(),n=`[${u} ${pi(e,!1)}] ${t}\n`,r=["error","warn"].includes(u);this.consoleLeval.includes(u)&&this.Conslole(n,r),!this.noFile&&this.fileLeval.includes(u)&&this.File(`[${u} ${pi(e,!0)}] ${t}\n`,r),this.pushLeval.includes(u)&&this.Push(n)}error(u){this.log({level:"error"},u)}warn(u){this.log({level:"warn"},u)}info(u){this.log({level:"info"},u)}verbose(u){this.log({level:"verbose"},u)}debug(u){this.log({level:"debug"},u)}Conslole(u,t){t?process.stderr.write(u):process.stdout.write(u)}File(u,t){t&&s.appendFileSync(this.errorFile,u,"utf-8"),s.appendFileSync(this.logFile,u,"utf-8")}Push(u){Ei.pushValue+=u}createLogFile(){const u=Ai("./logs");s.existsSync(u)||s.mkdirSync(u)}}const gi=new Ei({console:"debug",file:"debug",push:"debug"});function mi(u){try{const t=e.unzipSync(Buffer.from(u,"base64")).toString();try{return decodeURIComponent(function(u){return u.replace(/\\u([\d\w]{4})/gi,((u,t)=>String.fromCodePoint(parseInt(t,16))))}(t))}catch(u){return unescape(t)}}catch(u){throw new Error("Error: 当前字符串不能被Gzip解压")}}class hi{static configFileName=function(){const u=".json",{BILITOOLS_FILE_NAME:t}=process.env;return t?t.endsWith(u)?t:`${t}.json`:"cat_bili_config"+u}();static isQingLongPanel=!0}var yi={Space_Separator:/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,ID_Start:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,ID_Continue:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},Bi={isSpaceSeparator:u=>"string"==typeof u&&yi.Space_Separator.test(u),isIdStartChar:u=>"string"==typeof u&&(u>="a"&&u<="z"||u>="A"&&u<="Z"||"$"===u||"_"===u||yi.ID_Start.test(u)),isIdContinueChar:u=>"string"==typeof u&&(u>="a"&&u<="z"||u>="A"&&u<="Z"||u>="0"&&u<="9"||"$"===u||"_"===u||"‌"===u||"‍"===u||yi.ID_Continue.test(u)),isDigit:u=>"string"==typeof u&&/[0-9]/.test(u),isHexDigit:u=>"string"==typeof u&&/[0-9A-Fa-f]/.test(u)};let wi,vi,_i,bi,$i,Si,Ti,Ii,Oi;function Pi(u,t,e){const n=u[t];if(null!=n&&"object"==typeof n)for(const u in n){const t=Pi(n,u,e);void 0===t?delete n[u]:n[u]=t}return e.call(u,t,n)}let xi,Li,ki,Ni,Ri;function Ui(){for(xi="default",Li="",ki=!1,Ni=1;;){Ri=ji();const u=Mi[xi]();if(u)return u}}function ji(){if(wi[bi])return String.fromCodePoint(wi.codePointAt(bi))}function Gi(){const u=ji();return"\n"===u?($i++,Si=0):u?Si+=u.length:Si++,u&&(bi+=u.length),u}const Mi={default(){switch(Ri){case"\t":case"\v":case"\f":case" ":case" ":case"\ufeff":case"\n":case"\r":case"\u2028":case"\u2029":return void Gi();case"/":return Gi(),void(xi="comment");case void 0:return Gi(),qi("eof")}if(!Bi.isSpaceSeparator(Ri))return Mi[vi]();Gi()},comment(){switch(Ri){case"*":return Gi(),void(xi="multiLineComment");case"/":return Gi(),void(xi="singleLineComment")}throw Qi(Gi())},multiLineComment(){switch(Ri){case"*":return Gi(),void(xi="multiLineCommentAsterisk");case void 0:throw Qi(Gi())}Gi()},multiLineCommentAsterisk(){switch(Ri){case"*":return void Gi();case"/":return Gi(),void(xi="default");case void 0:throw Qi(Gi())}Gi(),xi="multiLineComment"},singleLineComment(){switch(Ri){case"\n":case"\r":case"\u2028":case"\u2029":return Gi(),void(xi="default");case void 0:return Gi(),qi("eof")}Gi()},value(){switch(Ri){case"{":case"[":return qi("punctuator",Gi());case"n":return Gi(),Ji("ull"),qi("null",null);case"t":return Gi(),Ji("rue"),qi("boolean",!0);case"f":return Gi(),Ji("alse"),qi("boolean",!1);case"-":case"+":return"-"===Gi()&&(Ni=-1),void(xi="sign");case".":return Li=Gi(),void(xi="decimalPointLeading");case"0":return Li=Gi(),void(xi="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return Li=Gi(),void(xi="decimalInteger");case"I":return Gi(),Ji("nfinity"),qi("numeric",1/0);case"N":return Gi(),Ji("aN"),qi("numeric",NaN);case'"':case"'":return ki='"'===Gi(),Li="",void(xi="string")}throw Qi(Gi())},identifierNameStartEscape(){if("u"!==Ri)throw Qi(Gi());Gi();const u=Hi();switch(u){case"$":case"_":break;default:if(!Bi.isIdStartChar(u))throw Vi()}Li+=u,xi="identifierName"},identifierName(){switch(Ri){case"$":case"_":case"‌":case"‍":return void(Li+=Gi());case"\\":return Gi(),void(xi="identifierNameEscape")}if(!Bi.isIdContinueChar(Ri))return qi("identifier",Li);Li+=Gi()},identifierNameEscape(){if("u"!==Ri)throw Qi(Gi());Gi();const u=Hi();switch(u){case"$":case"_":case"‌":case"‍":break;default:if(!Bi.isIdContinueChar(u))throw Vi()}Li+=u,xi="identifierName"},sign(){switch(Ri){case".":return Li=Gi(),void(xi="decimalPointLeading");case"0":return Li=Gi(),void(xi="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return Li=Gi(),void(xi="decimalInteger");case"I":return Gi(),Ji("nfinity"),qi("numeric",Ni*(1/0));case"N":return Gi(),Ji("aN"),qi("numeric",NaN)}throw Qi(Gi())},zero(){switch(Ri){case".":return Li+=Gi(),void(xi="decimalPoint");case"e":case"E":return Li+=Gi(),void(xi="decimalExponent");case"x":case"X":return Li+=Gi(),void(xi="hexadecimal")}return qi("numeric",0*Ni)},decimalInteger(){switch(Ri){case".":return Li+=Gi(),void(xi="decimalPoint");case"e":case"E":return Li+=Gi(),void(xi="decimalExponent")}if(!Bi.isDigit(Ri))return qi("numeric",Ni*Number(Li));Li+=Gi()},decimalPointLeading(){if(Bi.isDigit(Ri))return Li+=Gi(),void(xi="decimalFraction");throw Qi(Gi())},decimalPoint(){switch(Ri){case"e":case"E":return Li+=Gi(),void(xi="decimalExponent")}return Bi.isDigit(Ri)?(Li+=Gi(),void(xi="decimalFraction")):qi("numeric",Ni*Number(Li))},decimalFraction(){switch(Ri){case"e":case"E":return Li+=Gi(),void(xi="decimalExponent")}if(!Bi.isDigit(Ri))return qi("numeric",Ni*Number(Li));Li+=Gi()},decimalExponent(){switch(Ri){case"+":case"-":return Li+=Gi(),void(xi="decimalExponentSign")}if(Bi.isDigit(Ri))return Li+=Gi(),void(xi="decimalExponentInteger");throw Qi(Gi())},decimalExponentSign(){if(Bi.isDigit(Ri))return Li+=Gi(),void(xi="decimalExponentInteger");throw Qi(Gi())},decimalExponentInteger(){if(!Bi.isDigit(Ri))return qi("numeric",Ni*Number(Li));Li+=Gi()},hexadecimal(){if(Bi.isHexDigit(Ri))return Li+=Gi(),void(xi="hexadecimalInteger");throw Qi(Gi())},hexadecimalInteger(){if(!Bi.isHexDigit(Ri))return qi("numeric",Ni*Number(Li));Li+=Gi()},string(){switch(Ri){case"\\":return Gi(),void(Li+=function(){switch(ji()){case"b":return Gi(),"\b";case"f":return Gi(),"\f";case"n":return Gi(),"\n";case"r":return Gi(),"\r";case"t":return Gi(),"\t";case"v":return Gi(),"\v";case"0":if(Gi(),Bi.isDigit(ji()))throw Qi(Gi());return"\0";case"x":return Gi(),function(){let u="",t=ji();if(!Bi.isHexDigit(t))throw Qi(Gi());if(u+=Gi(),t=ji(),!Bi.isHexDigit(t))throw Qi(Gi());return u+=Gi(),String.fromCodePoint(parseInt(u,16))}();case"u":return Gi(),Hi();case"\n":case"\u2028":case"\u2029":return Gi(),"";case"\r":return Gi(),"\n"===ji()&&Gi(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case void 0:throw Qi(Gi())}return Gi()}());case'"':return ki?(Gi(),qi("string",Li)):void(Li+=Gi());case"'":return ki?void(Li+=Gi()):(Gi(),qi("string",Li));case"\n":case"\r":throw Qi(Gi());case"\u2028":case"\u2029":!function(u){console.warn(`JSON5: '${Xi(u)}' in strings is not valid ECMAScript; consider escaping`)}(Ri);break;case void 0:throw Qi(Gi())}Li+=Gi()},start(){switch(Ri){case"{":case"[":return qi("punctuator",Gi())}xi="value"},beforePropertyName(){switch(Ri){case"$":case"_":return Li=Gi(),void(xi="identifierName");case"\\":return Gi(),void(xi="identifierNameStartEscape");case"}":return qi("punctuator",Gi());case'"':case"'":return ki='"'===Gi(),void(xi="string")}if(Bi.isIdStartChar(Ri))return Li+=Gi(),void(xi="identifierName");throw Qi(Gi())},afterPropertyName(){if(":"===Ri)return qi("punctuator",Gi());throw Qi(Gi())},beforePropertyValue(){xi="value"},afterPropertyValue(){switch(Ri){case",":case"}":return qi("punctuator",Gi())}throw Qi(Gi())},beforeArrayValue(){if("]"===Ri)return qi("punctuator",Gi());xi="value"},afterArrayValue(){switch(Ri){case",":case"]":return qi("punctuator",Gi())}throw Qi(Gi())},end(){throw Qi(Gi())}};function qi(u,t){return{type:u,value:t,line:$i,column:Si}}function Ji(u){for(const t of u){if(ji()!==t)throw Qi(Gi());Gi()}}function Hi(){let u="",t=4;for(;t-- >0;){const t=ji();if(!Bi.isHexDigit(t))throw Qi(Gi());u+=Gi()}return String.fromCodePoint(parseInt(u,16))}const Ki={start(){if("eof"===Ti.type)throw Wi();zi()},beforePropertyName(){switch(Ti.type){case"identifier":case"string":return Ii=Ti.value,void(vi="afterPropertyName");case"punctuator":return void Yi();case"eof":throw Wi()}},afterPropertyName(){if("eof"===Ti.type)throw Wi();vi="beforePropertyValue"},beforePropertyValue(){if("eof"===Ti.type)throw Wi();zi()},beforeArrayValue(){if("eof"===Ti.type)throw Wi();"punctuator"!==Ti.type||"]"!==Ti.value?zi():Yi()},afterPropertyValue(){if("eof"===Ti.type)throw Wi();switch(Ti.value){case",":return void(vi="beforePropertyName");case"}":Yi()}},afterArrayValue(){if("eof"===Ti.type)throw Wi();switch(Ti.value){case",":return void(vi="beforeArrayValue");case"]":Yi()}},end(){}};function zi(){let u;switch(Ti.type){case"punctuator":switch(Ti.value){case"{":u={};break;case"[":u=[]}break;case"null":case"boolean":case"numeric":case"string":u=Ti.value}if(void 0===Oi)Oi=u;else{const t=_i[_i.length-1];Array.isArray(t)?t.push(u):t[Ii]=u}if(null!==u&&"object"==typeof u)_i.push(u),vi=Array.isArray(u)?"beforeArrayValue":"beforePropertyName";else{const u=_i[_i.length-1];vi=null==u?"end":Array.isArray(u)?"afterArrayValue":"afterPropertyValue"}}function Yi(){_i.pop();const u=_i[_i.length-1];vi=null==u?"end":Array.isArray(u)?"afterArrayValue":"afterPropertyValue"}function Qi(u){return Zi(void 0===u?`JSON5: invalid end of input at ${$i}:${Si}`:`JSON5: invalid character '${Xi(u)}' at ${$i}:${Si}`)}function Wi(){return Zi(`JSON5: invalid end of input at ${$i}:${Si}`)}function Vi(){return Si-=5,Zi(`JSON5: invalid identifier character at ${$i}:${Si}`)}function Xi(u){const t={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(t[u])return t[u];if(u<" "){const t=u.charCodeAt(0).toString(16);return"\\x"+("00"+t).substring(t.length)}return u}function Zi(u){const t=new SyntaxError(u);return t.lineNumber=$i,t.columnNumber=Si,t}const uo={parse:function(u,t){wi=String(u),vi="start",_i=[],bi=0,$i=1,Si=0,Ti=void 0,Ii=void 0,Oi=void 0;do{Ti=Ui(),Ki[vi]()}while("eof"!==Ti.type);return"function"==typeof t?Pi({"":Oi},"",t):Oi},stringify:function(u,t,e){const n=[];let r,i,o,a="",s="";if(null==t||"object"!=typeof t||Array.isArray(t)||(e=t.space,o=t.quote,t=t.replacer),"function"==typeof t)i=t;else if(Array.isArray(t)){r=[];for(const u of t){let t;"string"==typeof u?t=u:("number"==typeof u||u instanceof String||u instanceof Number)&&(t=String(u)),void 0!==t&&r.indexOf(t)<0&&r.push(t)}}return e instanceof Number?e=Number(e):e instanceof String&&(e=String(e)),"number"==typeof e?e>0&&(e=Math.min(10,Math.floor(e)),s="          ".substr(0,e)):"string"==typeof e&&(s=e.substr(0,10)),c("",{"":u});function c(u,t){let e=t[u];switch(null!=e&&("function"==typeof e.toJSON5?e=e.toJSON5(u):"function"==typeof e.toJSON&&(e=e.toJSON(u))),i&&(e=i.call(t,u,e)),e instanceof Number?e=Number(e):e instanceof String?e=String(e):e instanceof Boolean&&(e=e.valueOf()),e){case null:return"null";case!0:return"true";case!1:return"false"}return"string"==typeof e?D(e):"number"==typeof e?String(e):"object"==typeof e?Array.isArray(e)?function(u){if(n.indexOf(u)>=0)throw TypeError("Converting circular structure to JSON5");n.push(u);let t=a;a+=s;let e,r=[];for(let t=0;t<u.length;t++){const e=c(String(t),u);r.push(void 0!==e?e:"null")}if(0===r.length)e="[]";else if(""===s){e="["+r.join(",")+"]"}else{let u=",\n"+a,n=r.join(u);e="[\n"+a+n+",\n"+t+"]"}return n.pop(),a=t,e}(e):function(u){if(n.indexOf(u)>=0)throw TypeError("Converting circular structure to JSON5");n.push(u);let t=a;a+=s;let e,i=r||Object.keys(u),o=[];for(const t of i){const e=c(t,u);if(void 0!==e){let u=f(t)+":";""!==s&&(u+=" "),u+=e,o.push(u)}}if(0===o.length)e="{}";else{let u;if(""===s)u=o.join(","),e="{"+u+"}";else{let n=",\n"+a;u=o.join(n),e="{\n"+a+u+",\n"+t+"}"}}return n.pop(),a=t,e}(e):void 0}function D(u){const t={"'":.1,'"':.2},e={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let n="";for(let r=0;r<u.length;r++){const i=u[r];switch(i){case"'":case'"':t[i]++,n+=i;continue;case"\0":if(Bi.isDigit(u[r+1])){n+="\\x00";continue}}if(e[i])n+=e[i];else if(i<" "){let u=i.charCodeAt(0).toString(16);n+="\\x"+("00"+u).substring(u.length)}else n+=i}const r=o||Object.keys(t).reduce(((u,e)=>t[u]<t[e]?u:e));return n=n.replace(new RegExp(r,"g"),e[r]),r+n+r}function f(u){if(0===u.length)return D(u);const t=String.fromCodePoint(u.codePointAt(0));if(!Bi.isIdStartChar(t))return D(u);for(let e=t.length;e<u.length;e++)if(!Bi.isIdContinueChar(String.fromCodePoint(u.codePointAt(e))))return D(u);return u}}};var to=uo;const eo=to||Object.freeze({__proto__:null,default:to});function no(u){try{let e;if((t.existsSync(u)||t.existsSync(u+="5"))&&(e=t.readFileSync(u,"utf-8")),!e)return;return gi.verbose(`读取配置文件 ${u}`),eo.parse(e)}catch(u){!function(u){if(!_(u))return;if(u.includes("SyntaxError: JSON5"))throw gi.error(u),new SyntaxError("配置文件存在，但是无法解析！可能 JSON5 格式不正确！");throw new Error(u)}(u.message)}}const ro=u=>a.resolve(process.cwd(),u),io=u=>a.resolve(__dirname,"../",u),oo=Array.from(new Set([ro("./config/config.dev.json"),ro(`./config/${hi.configFileName}`),ro(`./${hi.configFileName}`),io(`./config/${hi.configFileName}`),io(`./${hi.configFileName}`)])),ao=["./config.json",ro("./config/config.json")];function so(u){let t;if(t=Array.isArray(u)?u:u.account.filter((u=>u.cookie)),0!==t.length)return function(u){const t=process.argv.find((u=>u.includes("--item")||u.includes("-i")||u.includes("-I")));if(!t)return u[0];const e=Number(t.split("=")[1])-1;return!e||e>=u.length||e<0?(gi.warn("似乎想要指定一个不存在的用户，我们将指定第一个用户"),u[0]):u[e]}(t)}function co(){if(globalThis.BILITOOLS_CONFIG)return globalThis.BILITOOLS_CONFIG;oo.splice(0,1,...ao);for(let u=0;u<oo.length;u++){const t=no(oo[u]);if(t)return t}return(()=>{const{BILITOOLS_CONFIG:u,BILI_SCF_CONFIG:t,BILI_CONFIG:e}=process.env,n=u||t||e;if(n)try{return eo.parse(mi(n))}catch{throw new Error("环境中的配置不是有效的 JSON 字符串！")}})()}function Do(u){if(!u)throw new Error("获取配置失败！未找到配置文件！");if(function(u){if(Array.isArray(u))return!0;return Boolean(u.account&&u.account.length)}(u)){const t=so(u);if(t)return t}if(!u.cookie)throw new Error("配置文件中没有 cookie！");return u}function fo(u){return u?u.split("; ").map((u=>u.split("="))):[]}function lo(u,t){return u?t&&0!==t.length?function(u){const t=Object.keys(u).reduce(((t,e)=>t+`${e}=${u[e]}; `),"");return t.substring(0,t.length-2||0)}(function(u,t){const e=fo(null==t?void 0:t[0]).filter((u=>2===u.length)),n=fo(u).concat(e).filter((u=>2===u.length)),r={};for(const u of n)r[u[0]]?r[u[0]]=u[1]:Object.defineProperty(r,u[0],{value:u[1],enumerable:!0,writable:!0});return r}(u,t)):u:""}function Co(u,t){if(!u)return null;const e=`(?:^|)${t}=([^;]*)(?:;|$)`,n=u.match(e);return n?n[1]:null}const po={cookie:"",message:{email:{host:"smtp.163.com",port:465},pushplusToken:process.env.PUSHPLUS_TOKEN,api:void 0},function:{silver2Coin:!0,liveSignTask:!0,addCoins:!0,mangaSign:!1,shareAndWatch:!0,supGroupSign:!1,liveSendMessage:!1,taskReward:!0,charging:!1,getVipPrivilege:!1,giveGift:!1,matchGame:!1,liveLottery:!1,liveRedPack:!1,liveIntimacy:!1},apiDelay:[2,6],userAgent:"",dailyRunTime:"17:30:00-23:40:00",targetLevel:void 0,stayCoins:void 0,targetCoins:void 0,customizeUp:void 0,giftUp:void 0,coinRetryNum:void 0,chargeUpId:void 0,chargePresetTime:void 0,matchCoins:void 0,matchSelection:void 0,matchDiff:void 0,match:{coins:5,selection:1,diff:0},charge:{mid:0,presetTime:31},gift:{mids:[]},coin:{customizeUp:[],retryNum:4,targetLevel:6,stayCoins:0,targetCoins:5},sls:{name:"",description:"",region:"ap-chengdu",dailyRunTime:"17:30:00-23:40:00"},lottery:{excludeAward:["舰","船","航海","代金券","优惠券","自拍","照","写真","图","提督","车车一局","再来一局","游戏道具"],includeAward:["谢"],blackUid:[65566781,1277481241,1643654862,603676925],isMoveTag:!0,moveTag:"天选时刻",pageNum:2,actFollowMsg:"read",scanFollow:void 0,skipNeedFollow:!1},redPack:{},intimacy:{liveSendMessage:!0,liveShare:!0,liveLike:!0,whiteList:[],blackList:[]},BILIJCT:"",USERID:0};function Fo(){return P(po,!0)}function Ao(u){return function(u){!function(u){u.BILIJCT=function(u){return Co(u,"bili_jct")||""}(u.cookie),u.USERID=function(u){return Number(Co(u,"DedeUserID"))||0}(u.cookie)}(u);const{coin:t,gift:e,charge:n}=u;b(u.apiDelay)?u.apiDelay=N(u.apiDelay):u.apiDelay=[Number(u.apiDelay)];t.customizeUp=N(t.customizeUp),e.mids=N(e.mids),0===e.mids.length&&(e.mids=t.customizeUp);n.mid||(n.mid=u.USERID);return u}(function(u){return Object.keys(Eo).forEach((t=>{if(void 0!==u[t]){const[e,n]=Eo[t];u[e]=u[e]||{},u[e][n]=u[t]}delete u[t]})),u}(x(Fo(),u)))}const Eo={targetLevel:["coin","targetLevel"],stayCoins:["coin","stayCoins"],targetCoins:["coin","targetCoins"],customizeUp:["coin","customizeUp"],coinRetryNum:["coin","retryNum"],giftUp:["gift","mids"],chargeUpId:["charge","mid"],chargePresetTime:["charge","presetTime"],matchCoins:["match","coins"],matchSelection:["match","selection"],matchDiff:["match","diff"]};class go{constructor(u){this.COOKIE=u.cookie,this.BILIJCT=u.BILIJCT,this.USERID=u.USERID,this.USER_AGENT=u.userAgent,this.BILI_API_DELAY=u.apiDelay;const t=u.message;this.MESSAGE_API=t.api,this.PUSHPLUS_TOKEN=t.pushplusToken;const e=u.coin;this.BILI_CUSTOMIZE_UP=e.customizeUp,this.BILI_COIN_RETRY_NUM=e.retryNum,this.BILI_TARGET_LEVEL=e.targetLevel,this.BILI_STAY_COINS=e.stayCoins,this.BILI_TARGET_COINS=e.targetCoins;const n=u.gift;this.BILI_GIFT_UP=n.mids;const r=u.charge;this.CHARGE_ID=r.mid,this.CHARGE_PRESET_TIME=r.presetTime;const i=u.match;this.MATCH_COINS=i.coins,this.MATCH_SELECTION=i.selection,this.MATCH_DIFF=i.diff}}let mo;const ho=new Proxy({},{get:(u,t)=>(mo||Bo(),Reflect.get(mo,t)),set:(u,t,e)=>"config"===t&&e?(Bo(e),!0):Reflect.set(mo,t,e)});let yo=null;function Bo(u){u||(u=Do(co()));const t=Ao(u);mo={...new go(Do(t)),...t},yo=class extends class{static money=0;static coinsTask=5;static share=!1;static watch=!1;static currentStartFun=0;static bCoinCouponBalance=0;static vipType=0;static userLevel=0}{},yo.coinsTask=mo.BILI_TARGET_COINS}const wo=(u,t)=>{const{isTransformResponse:e,isReturnNativeResponse:n}=t;if(n)return u;if(!1===e)return u.body;const{body:r}=u;if(t.isJsonp&&_(r))return function(u){const t=u.replace(/^\w+\(/,"").replace(/\)$/,"");return JSON.parse(t)}(r);try{if(_(r)&&r.startsWith("{"))return JSON.parse(r)}catch{}return r};class vo{name="VGot";constructor(u){u.baseURL&&(u.prefixUrl=u.baseURL),this.options=u,this.gotInstance=c.default.extend(u,{hooks:{afterResponse:[u=>{const{requestOptions:t}=u.request.options;var e;null!=t&&t.withBiliCookie&&(ho.COOKIE=lo(ho.COOKIE,(null===(e=u.headers)||void 0===e?void 0:e["set-cookie"])||[]));return u}]}})}request(u){const{requestOptions:t={},headers:e={}}=this.options;return u.requestOptions=Object.assign({},t,u.requestOptions),u.headers=function(u={},t={}){function e(u){return Object.keys(u).reduce(((t,e)=>(t[e.toLowerCase()]=u[e],t)),{})}return Object.assign({},e(u),e(t))}(e,u.headers),t.withBiliCookie&&(u.headers.Cookie=ho.COOKIE),t.retry&&(u.retry=t.retry),u=function(u){_(u.url)||(u.url=u.url.toString()),v(u.params)&&!_(u.searchParams)&&(u.searchParams={...u.searchParams,...u.params});const t=u.headers["content-type"],e=null==t?void 0:t.startsWith("application/x-www-form-urlencoded");function n(t){u.agent||(u.agent={}),u.agent[t]=u[`${t}Agent`]}return v(u.data)&&(e?u.body=L(u.data):u.json=u.data),_(u.data)&&e&&(u.body=u.data),u.httpAgent&&n("http"),u.httpsAgent&&n("https"),u.url&&u.url.startsWith("/")&&(u.url=u.url.substring(1)),u}(u),new Promise(((t,e)=>{this.gotInstance(u).then((n=>{{"function"!=typeof wo;try{const e=wo(n,u.requestOptions);t(e)}catch(u){e(u||new Error("请求错误!"))}}})).catch((u=>{u.response&&(u.response.status=u.response.statusCode),e(u)}))}))}get(u,t){return _(u)?this.request({...t,method:"GET",url:u}):this.request({...u,method:"GET"})}post(u,t,e){return _(u)?this.request({...e,method:"POST",url:u,data:t}):this.request({...u,method:"POST"})}put(u,t,e){return this.request({...e,method:"PUT",url:u,data:t})}delete(u,t,e){return this.request({...e,method:"DELETE",url:u,data:t})}patch(u,t,e){return this.request({...e,method:"PATCH",url:u,data:t})}}function _o(u){return new vo(x({timeout:1e4,headers:{"content-type":h["content-type"],"user-agent":h["user-agent"],"accept-language":h["accept-language"],"accept-encoding":h["accept-encoding"]},requestOptions:{isTransformResponse:!0,ignoreCancelToken:!0,withBiliCookie:!0}},u||{}))}const bo=_o({requestOptions:{withBiliCookie:!1}}),$o=_o();async function So(){let u="v0.5.3";u.includes(".")?gi.info("当前版本【v0.5.3】"):u=void 0;try{if(u||(u="v"+(function(){try{return require("../../package.json").version}catch{}}()||function(){try{return s.readFileSync(a.resolve(__dirname,"../version.txt"),"utf8").trim()}catch{}}()),gi.info(`当前版本【${u}】`)),!u)return;const t=await async function(){const u={timeout:6e3};try{return(await Promise.any([bo.get("https://api.github.com/repos/catlair/BiliTools/releases/latest",u),bo.get("https://gitee.com/api/v5/repos/catlair/BiliTools/releases/latest",u)])).tag_name}catch(u){return}}();t&&t!==u&&gi.info(`可更新：最新版本【${t}】`)}catch{}}function To(u){const t=function(){const u=ho.function;return u.addCoins||u.shareAndWatch||(u.taskReward=!1),u.liveIntimacy&&(u.liveSendMessage=!1),u}();return u.map((u=>t[u.name]?u:null)).filter((u=>u))}function Io(u,t){const e=function(u,t){if(u&&t)return T(u,t);if(u)return u;const e=ho.BILI_API_DELAY;if(1===e.length)return 1e3*e[0];return 1e3*T(e[0]||2,e[1]||6)}(u,t);return new Promise((u=>{setTimeout((()=>{u(e)}),e)}))}process.env.IS_LOCAL="true",async function(){const{dailyTasks:u}=await Promise.resolve().then((function(){return gs}));await So(),await u()}();let Oo={};function Po(){const u=ho.message||{};Oo=function(u={}){return Oo.SCKEY="",Oo.BARK_PUSH="",Oo.BARK_SOUND="",Oo.BARK_GROUP="QingLong",Oo.TG_BOT_TOKEN="",Oo.TG_USER_ID="",Oo.TG_PROXY_HOST="",Oo.TG_PROXY_PORT="",Oo.TG_PROXY_AUTH="",Oo.TG_API_HOST="api.telegram.org",Oo.DD_BOT_TOKEN="",Oo.DD_BOT_SECRET="",Oo.QYWX_KEY="",Oo.QYWX_AM="",Oo.IGOT_PUSH_KEY="",Oo.PUSH_PLUS_TOKEN="",Oo.PUSH_PLUS_USER="",Oo.QQ_SKEY="",Oo.QQ_MODE="",u}(Oo),["GOBOT_URL","GOBOT_TOKEN","GOBOT_QQ","SCKEY","QQ_SKEY","QQ_MODE","BARK_PUSH","BARK_SOUND","BARK_GROUP","TG_BOT_TOKEN","TG_USER_ID","TG_PROXY_AUTH","TG_PROXY_HOST","TG_PROXY_PORT","TG_API_HOST","DD_BOT_TOKEN","DD_BOT_SECRET","QYWX_KEY","QYWX_AM","IGOT_PUSH_KEY","PUSH_PLUS_TOKEN","PUSH_PLUS_USER"].forEach((t=>{const e=u[(n=t,n.toLowerCase().replace(/_(\w)/g,((u,t)=>t.toUpperCase())))]||u[t]||process.env[t];var n;e&&(Oo[t]=e)})),ho.PUSHPLUS_TOKEN&&(Oo.PUSH_PLUS_TOKEN=ho.PUSHPLUS_TOKEN)}async function xo(u,t){var e;const n=null===(e=ho.message)||void 0===e?void 0:e.email;if(!(n&&n.pass&&n.from&&n.host))return;const{createTransport:r}=await Promise.resolve().then((function(){return i(require("nodemailer"))})),o=Number(n.port)||465,a=r({host:n.host,port:o,secure:465===o,auth:{user:n.from,pass:n.pass}}),s=await a.sendMail({from:`${u} <${n.from}>`,to:n.to,subject:u,headers:{"Content-Type":"text/plain; charset=utf-8"},text:t.replace(/\n/g,"\r\n")});gi.info(`邮件消息已发送: ${s.messageId}`)}async function Lo(u,t){try{const e=ho.MESSAGE_API;if(!e)return;const n=e.replace("{title}",u).replace("{text}",t);await bo.get(n)}catch(u){gi.info(`自定义接口消息发送失败: ${u}`),gi.error(u)}}function ko(u,t,e=2100){return new Promise((n=>{const r=Oo.SCKEY;if(r){t=t.replace(/[\n\r]/g,"\n\n");const i={url:r.includes("SCT")?`https://sctapi.ftqq.com/${r}.send`:`https://sc.ftqq.com/${r}.send`,params:`text=${u}&desp=${t}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};setTimeout((()=>{bo.post(i).then((u=>{0===u.errno||0===u.data.errno?gi.info("server酱发送通知消息成功🎉"):1024===u.errno?gi.info(`server酱发送通知消息异常: ${u.errmsg}`):gi.info(`server酱发送通知消息异常\n${JSON.stringify(u)}`)})).catch((u=>{gi.info("发送通知调用API失败！！"),gi.info(u)})).finally((()=>{n("")}))}),e)}else n("")}))}function No(u,t){return new Promise((e=>{const{QQ_SKEY:n,QQ_MODE:r}=Oo;if(n){const i={url:`https://push.xuthus.cc/${r}/${n}`,headers:{"Content-Type":"application/json"},data:{},params:{}};u=u.replace(/京豆/g,"豆豆"),t=(t=(t=t.replace(/京豆/g,"")).replace(/🐶/g,"")).replace(/红包/g,"H包"),"email"===r?i.data={t:u,c:t}:i.params=`${u}\n\n${t}`;const o=function(u){switch(u){case"send":return"个人";case"group":return"QQ群";case"wx":return"微信";case"ww":return"企业微信";case"email":return"邮件";default:return"未知方式"}};bo.post(i).then((u=>{200===u.code?gi.info(`酷推发送${o(r)}通知消息成功🎉`):400===u.code?gi.info(`QQ酷推(Cool Push)发送${o(r)}推送失败：${u.msg}`):503===u.code?gi.info(`QQ酷推出错，${u.message}：${u.data}`):gi.info(`酷推推送异常: ${JSON.stringify(u)}`)})).catch((u=>{gi.info(`发送${o(r)}通知调用API失败！！`),gi.info(u)})).finally((()=>{e("")}))}else e("")}))}function Ro(u,t,e={}){return new Promise((n=>{const{BARK_PUSH:r,BARK_SOUND:i,BARK_GROUP:o}=Oo;if(r){const a={url:`${r}/${encodeURIComponent(u)}/${encodeURIComponent(t)}?sound=${i}&group=${o}&${L(e)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};bo.get(a).then((u=>{200===u.code?gi.info("Bark APP发送通知消息成功🎉"):gi.info(`Bark APP发送通失败：${u.message}`)})).catch((u=>{gi.info("Bark APP发送通知调用API失败！！"),gi.error(u)})).finally((()=>{n("")}))}n("")}))}function Uo(u,t){return new Promise((async e=>{const{TG_BOT_TOKEN:n,TG_USER_ID:r,TG_API_HOST:o,TG_PROXY_HOST:a,TG_PROXY_PORT:s,TG_PROXY_AUTH:c}=Oo;if(n&&r){const D={url:`https://${o}/bot${n}/sendMessage`,data:`chat_id=${r}&text=${u}\n\n${t}&disable_web_page_preview=true`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};if(a&&s){const u=(await Promise.resolve().then((function(){return i(require("tunnel"))}))).httpsOverHttp({proxy:{host:a,port:+s,proxyAuth:c},maxSockets:1});Object.assign(D,{httpsAgent:u})}bo.post(D).then((u=>{u.ok?gi.info("Telegram发送通知消息成功🎉。"):400===u.error_code?gi.info("请主动给bot发送一条消息并检查接收用户ID是否正确。"):401===u.error_code&&gi.info("Telegram bot token 填写错误。")})).catch((u=>{gi.info("telegram发送通知消息失败！！"),gi.info(u)})).finally((()=>{e("")}))}else e("")}))}function jo(u,t){return new Promise((e=>{const{DD_BOT_TOKEN:n,DD_BOT_SECRET:r}=Oo,i={url:`https://oapi.dingtalk.com/robot/send?access_token=${n}`,data:{msgtype:"text",text:{content:` ${u}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};if(n){if(r){const u=require("crypto"),t=Date.now(),e=u.createHmac("sha256",r);e.update(`${t}\n${r}`);const n=encodeURIComponent(e.digest("base64"));i.url=`${i.url}&timestamp=${t}&sign=${n}`}bo.post(i).then((u=>{0===u.errcode?gi.info("钉钉发送通知消息成功🎉。"):gi.info(`钉钉发送通知失败：${u.errmsg}`)})).catch((u=>{gi.info("钉钉发送通知消息失败！！"),gi.info(u)})),e("")}else e("")}))}function Go(u,t){return new Promise((e=>{const{QYWX_KEY:n}=Oo,r={url:`https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=${n}`,data:{msgtype:"text",text:{content:` ${u}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};n&&bo.post(r).then((u=>{0===u.errcode?gi.info("企业微信发送通知消息成功🎉。"):gi.info(`企业微信发送通知失败：${u.errmsg}`)})).catch((u=>{gi.info("企业微信发送通知消息失败！！"),gi.info(u)})).finally((()=>{e("")})),e("")}))}function Mo(u){const{QYWX_AM:t}=Oo,e=null==t?void 0:t.split(",");if(e[2]){const t=e[2].split("|");let n="";for(let e=0;e<t.length;e++){const r="签到号 "+(e+1);u.match(r)&&(n=t[e])}return n||(n=e[2]),n}return"@all"}function qo(u,t){return new Promise((e=>{const n=Oo.QYWX_AM;if(n){const r=n.split(","),i={url:"https://qyapi.weixin.qq.com/cgi-bin/gettoken",data:{corpid:`${r[0]}`,corpsecret:`${r[1]}`},headers:{"Content-Type":"application/json"},timeout:15e3};bo.post(i).then((n=>{const i=t.replace(/\n/g,"<br/>"),o=JSON.parse(n).access_token;let a;switch(r[4]){case"0":a={msgtype:"textcard",textcard:{title:`${u}`,description:`${t}`,url:"https://github.com/whyour/qinglong",btntxt:"更多"}};break;case"1":a={msgtype:"text",text:{content:`${u}\n\n${t}`}};break;default:a={msgtype:"mpnews",mpnews:{articles:[{title:`${u}`,thumb_media_id:`${r[4]}`,author:"智能助手",content_source_url:"",content:`${i}`,digest:`${t}`}]}}}r[4]||(a={msgtype:"text",text:{content:`${u}\n\n${t}`}}),a={url:`https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=${o}`,data:{touser:`${Mo(t)}`,agentid:`${r[3]}`,safe:"0",...a},headers:{"Content-Type":"application/json"}},bo.post(a).then((u=>{0===u.errcode?gi.info("成员ID:"+Mo(t)+"企业微信应用消息发送通知消息成功🎉。"):gi.info(`企业微信应用：${u.errmsg}`)})).catch((u=>{gi.info("成员ID:"+Mo(t)+"企业微信应用消息发送通知消息失败！！"),gi.info(u)})).finally((()=>{e("")}))})).catch((u=>{gi.error("企业微信应用消息发送通知消息失败！！")}))}else e("")}))}function Jo(u,t,e={}){return new Promise((n=>{const{IGOT_PUSH_KEY:r}=Oo;if(r){if(!new RegExp("^[a-zA-Z0-9]{24}$").test(r))return gi.info("您所提供的IGOT_PUSH_KEY无效"),void n("");const i={url:`https://push.hellyw.com/${r.toLowerCase()}`,params:`title=${u}&content=${t}&${L(e)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};bo.post(i).then((u=>{"string"==typeof u&&(u=JSON.parse(u)),0===u.ret?gi.info("iGot发送通知消息成功🎉"):gi.info(`iGot发送通知消息失败：${u.errMsg}`)})).catch((u=>{gi.info("发送通知调用API失败！！"),gi.info(u)})).finally((()=>{n("")}))}else n("")}))}function Ho(u,t){return new Promise((e=>{const{PUSH_PLUS_TOKEN:n,PUSH_PLUS_USER:r}=Oo;if(n){t=t.replace(/[\n\r]/g,"<br>");const i={url:"https://www.pushplus.plus/send",params:{token:`${n}`,title:`${u}`,content:`${t}`,topic:`${r}`},headers:{"Content-Type":" application/json"},timeout:15e3};bo.post(i).then((u=>{200===u.code?gi.info(`push+发送${r?"一对多":"一对一"}通知消息完成。`):gi.info(`push+发送${r?"一对多":"一对一"}通知消息失败：${u.msg}`)})).catch((u=>{gi.info(`push+发送${r?"一对多":"一对一"}通知消息失败！！`),gi.info(u)})).finally((()=>{e("")}))}else e("")}))}async function Ko(u,t){gi.info("----【消息推送】----"),u=`Bili-${yo.nickname}-${u}`,await async function(u,t,e={},n="\n\n本通知 By：https://github.com/catlair/BiliTools"){Po(),t+=n,await Promise.all([ko(u,t),Ho(u,t)]),await Promise.all([Ro(u,t,e),Uo(u,t),jo(u,t),Go(u,t),qo(u,t),Jo(u,t,e),xo(u,t),Lo(u,t),No(u,t)])}(u,t,void 0,"")}const zo=_o({baseURL:F,headers:{"user-agent":ho.USER_AGENT}}),Yo=_o({baseURL:A,headers:{Referer:p,"user-agent":ho.USER_AGENT}}),Qo=_o({baseURL:E,headers:{Referer:p,"user-agent":ho.USER_AGENT}}),Wo=_o({baseURL:g,headers:{"user-agent":ho.USER_AGENT}}),Vo=_o({baseURL:m,headers:{"user-agent":ho.USER_AGENT}});function Xo(u=1,t=50,e=1){return Yo.get(`/xlive/app-ucenter/v1/fansMedal/panel?page=${u}&page_size=${t}&target_id=${e}`)}function Zo({ruid:u,gift_num:t,bag_id:e,gift_id:n,roomid:r}){const i=ho.BILIJCT,o=i,a={gift_id:n,ruid:u,gift_num:t,bag_id:e,biz_id:r,rnd:(new Date).getTime(),send_ruid:0,storm_beat_id:0,metadata:"",price:0,visit_id:"",csrf:i,platform:"pc",biz_code:"Live",csrf_token:o,uid:ho.USERID};return Yo.post("/xlive/revenue/v2/gift/sendBag",a,{headers:{Origin:f}})}function ua(u){return Yo.get(`/xlive/lottery-interface/v1/Anchor/Check?roomid=${u}`)}function ta(){return Qo.get("/x/web-interface/nav",{headers:{Origin:D}})}function ea(){return Qo.get("/x/web-interface/coin/today/exp")}function na(u=1,t=50,e=-10){return Qo.get("/x/relation/tag",{params:{tagid:e,pn:u,ps:t}})}function ra(u,t){return Qo.post("/x/relation/tags/addUsers?cross_domain=true",{fids:u,tagids:t,csrf:ho.BILIJCT},{headers:{Origin:l}})}function ia(u){const t=u.level_info,e=t.current_level;if(e>=ho.BILI_TARGET_LEVEL&&(yo.coinsTask=0),gi.info(`当前等级: ${t.current_level}`),e>=6){const u=ho.function;u.shareAndWatch=!1,u.addCoins=!1,u.taskReward=!1,gi.info("已经满级，不需要再投币了，做个白嫖怪吧")}else{const u=t.next_exp-t.current_exp;gi.info(`距离升级还需要 ${u} 经验，预计 ${function(u){if(ho.BILI_TARGET_COINS<=0)return u/15;const t=10*ho.BILI_TARGET_COINS+15,e=u/t,n=yo.money/(ho.BILI_TARGET_COINS-1);return e<n?Math.floor(e):(u-n*t)/25+n}(u).toFixed(2)} 天`)}}async function oa(u){try{var t;const{data:e}=await zo.get("/site/getCoin");gi.info(`登录成功: ${u.uname}`),gi.info(`硬币余额: ${e.money||0}`),yo.nickname=function(u){const t=u.length;return t<=3?u:`${u[0]}**${u[t-1]}`}(u.uname),yo.money=e.money||0,yo.userLevel=u.level_info.current_level,yo.bCoinCouponBalance=(null===(t=u.wallet)||void 0===t?void 0:t.coupon_balance)||0,ia(u),function(u){let t="";switch(yo.vipType=u.vipType,u.vipType){case 0:t="无大会员";break;case 1:t="月度大会员";break;case 2:t="年度大会员"}0===u.vipStatus&&(t="无大会员"===t?t:t+"[已过期]"),gi.info(`大会员状态: ${t}`)}(u)}catch(u){gi.error(`获取硬币信息异常: ${u.message}`),gi.debug(u)}}function aa(u,t,e=1){return Qo.post("/x/web-interface/coin/add",{aid:u,multiply:t,selectLike:e,csrf:ho.BILIJCT})}function sa(u,t=1){return $o.post("https://www.bilibili.com/audio/music-service-c/web/coin/add",{sid:u,multiply:t,csrf:ho.BILIJCT})}const ca="video",Da="audio",fa="article";async function la(u=!0){try{const t=ho.USERID,{data:e,message:n,code:r}=await(u?function(u=1,t=50){return na(u,t,-10)}():function(u,t=1,e=50,n="desc",r="attention"){return Qo.get("/x/relation/followings",{params:{vmid:u,pn:t,ps:e,order:n,order_type:r}})}(t)),i=u?e:e.list;if(!i||0===i.length)return{msg:"-1",data:{}};if(0===r){await Io();const{mid:u}=k(i)||{};return await pa(u)}return{msg:u?`未获取到特别关注列表: ${r}-${n}`:`未获取到关注列表: ${r}-${n}`,data:{}}}catch(u){return{msg:u.message,data:{}}}}async function da(){const u=k([1,3,4,5,160,22,119]);try{const{data:t,message:e,code:n}=await function(u=1,t=3){return Qo.get("/x/web-interface/ranking/region",{params:{rid:u,day:t}})}(u,3);if(0==n){const{aid:u,title:e,author:n}=k(t);return{msg:"0",data:{id:Number(u),title:e,author:n}}}return{msg:`未获取到排行信息: ${n}-${e}`,data:{}}}catch(u){return{msg:u.message,data:{}}}}async function Ca(){const u=ho.BILI_CUSTOMIZE_UP;return 0===u.length?{msg:"-1",data:{}}:await pa(k(u))}async function pa(u){try{const{code:t,data:e,message:n}=await function(u){return Qo.get(`/x/space/navnum?mid=${u}`)}(u);if(t)return{msg:`通过uid获取视频失败: ${t}-${n}`,data:{}};await Io();const{video:r,audio:i,article:o}=e,{type:a,page:s,index:c}=function([u,t,e]){const n=u+t+e;if(!n)return;const r=T(0,n-1);let i=r;if(r<u)return{type:ca,page:S(30,i+1),index:i%30};const o=u+t;return i=r-u,r<o?{type:Da,page:S(30,i+1),index:i%30}:(i=r-o,{type:fa,page:S(12,i+1),index:i%12})}([r,i,o]),D={[ca]:Fa,[Da]:Aa,[fa]:Ea},f=await D[a](u,s,c);return f.message?{msg:f.message,data:{}}:{msg:"0",data:f}}catch(u){return gi.debug(u),{msg:u.message,data:{}}}}async function Fa(u,t,e){const{code:n,data:r,message:i}=await function(u,t=30,e=1,n=""){return Qo.get("/x/space/arc/search",{params:{jsonp:"jsonp",order:"pubdate",keyword:n,pn:e,tid:0,ps:t,mid:u}})}(u,30,t);if(n)return{message:i};const{aid:o,title:a,author:s}=r.list.vlist[e];return{type:ca,id:o,title:a,author:s}}async function Aa(u,t,e){const{code:n,data:r,msg:i}=await function(u,t=30,e=1){return Qo.get("/audio/music-service/web/song/upper",{params:{jsonp:"jsonp",order:1,pn:e,ps:t,uid:u}})}(u,30,t);if(n)return{message:i};const{data:o}=r,{id:a,uname:s,title:c}=o[e];return{type:Da,id:a,title:c,author:s}}async function Ea(u,t,e){const{code:n,data:r,message:i}=await function(u,t=12,e=1){return Qo.get("/x/space/article",{params:{callback:"__test",jsonp:"jsonp",sort:"publish_time",pn:e,ps:t,mid:u},requestOptions:{isJsonp:!0}})}(u,12,t);if(n)return{message:i};const{articles:o}=r,{id:a,title:s,author:{name:c}}=o[e];return{type:fa,id:a,title:s,author:c,mid:u}}const ga=function(){const u=[Ca,la,()=>la(!1),da];return ho.BILI_CUSTOMIZE_UP||u.shift(),u}();async function ma(u=0){ga.splice(0,yo.currentStartFun+u);for(let u=0;u<ga.length;u++){const t=ga[u];let e=Number(ho.BILI_COIN_RETRY_NUM??4);for(e=e<1?1:e>8?8:e;e--;){await Io();const u=await t();if("-1"===u.msg&&(e=0),"0"===u.msg)return u}e<=0&&(yo.currentStartFun=u)}return{msg:"-1",data:{id:0}}}async function ha({id:u,coin:t=1,type:e="video",mid:n}){const r={[ca]:aa,[Da]:sa,[fa]:(u,t=1)=>function(u,t,e=1){return Qo.post("/x/web-interface/coin/add",{aid:t,upid:u,avtype:2,multiply:e,csrf:ho.BILIJCT})}(n,u,t)},i=await r[e](Number(u),t);return{code:i.code,message:i.message||i.msg}}async function ya(u){if(await async function(){try{const{data:u,code:t}=await ea();if(0==t){const t=ho.BILI_TARGET_COINS-u/10;yo.coinsTask=t>0?t:0}}catch(u){}}(),yo.coinsTask<=0||yo.money<=0)return!0;const{data:t,msg:e}=await ma(u.priority);return null!=t&&t.id&&"0"==e?(await Io(),await async function(u,t){const{id:e,title:n,author:r,type:i,mid:o}=u;try{const u=await ha({id:e,type:i,mid:o});if(0===u.code)yo.money--,yo.coinsTask--,t.num++,gi.info(`给[${n}--up【${r}】]投币成功`);else if(34005===u.code)t.fillCount++,gi.verbose(`当前稿件[${e}]不能再投币了`),t.fillCount>=3&&(gi.warn("自定义用户组投币似乎没有币可投了"),t.priority++);else{if(-111===u.code||-104===u.code)return gi.warn(`${e} ${u.message} 无法继续进行投币`),!0;if(t.eCount++,gi.warn(`给${e}投币失败 ${u.code} ${u.message}`),t.prevCode===u.code)return!0;t.prevCode=u.code}}catch(u){t.eCount++,gi.error(`投币异常 ${u.message}`)}finally{await Io(1500)}return!1}(t,u)):(u.eCount++,!1)}async function Ba(){try{const{data:u,code:t,message:e}=await Vo.get("/link_group/v1/member/my_groups");return 0===t?(null==u?void 0:u.list)||[]:(gi.warn(`获取自己的应援团异常失败: ${e}`),[])}catch(u){gi.error(`获取自己的应援团异常: ${u}`)}}const wa=["(⌒▽⌒)","（￣▽￣）","(=・ω・=)","(｀・ω・´)","(〜￣△￣)〜","(･∀･)","(°∀°)ﾉ","(￣3￣)","╮(￣▽￣)╭","_(:3」∠)_","( ´_ゝ｀)","←_←","→_→","(<_<)","(>_>)","(;¬_¬)","(ﾟДﾟ≡ﾟдﾟ)!?","Σ(ﾟдﾟ;)","Σ( ￣□￣||)","(´；ω；`)","（/TДT)/","(^・ω・^ )","(｡･ω･｡)","(●￣(ｴ)￣●)","ε=ε=(ノ≧∇≦)ノ","(´･_･`)","(-_-#)","（￣へ￣）","(￣ε(#￣) Σ","ヽ(`Д´)ﾉ","（#-_-)┯━┯","(╯°口°)╯(┴—┴","←◡←","( ♥д♥)","Σ>―(〃°ω°〃)♡→","⁄(⁄ ⁄•⁄ω⁄•⁄ ⁄)⁄","(╬ﾟдﾟ)▄︻┻┳═一","･*･:≡(　ε:)","(汗)","(苦笑)"].concat("1","2","3","4","5","6","7","8","9","签到","哈哈"),va=new Ei({console:"debug",file:"debug"},"live");async function _a(){let u=99,t=0;const e=[];try{for(;t<u;){const{code:n,message:r,data:i}=await Xo(t+1,50,ho.USERID);if(0!==n)return gi.verbose(`获取勋章信息失败 ${n} ${r}`),null;if(!i)return e;u=i.page_info.total_page,t=i.page_info.current_page,e.push(...i.list,...i.special_list)}return e}catch(u){return gi.error(`获取勋章异常 ${u.message}`),null}}function ba({room_info:u,medal:t}){if(null==u||!u.room_id)return!1;if(t.level>=20)return!1;if(t.today_feed>=t.day_limit)return!1;const{whiteList:e,blackList:n}=ho.intimacy;return e&&e.length?!!e.includes(u.room_id):!n||!n.includes(u.room_id)}async function $a(u,t){const e=wa[T(wa.length-1)];try{const{code:n,message:r}=await function(u,t){const e=ho.BILIJCT,n=e;return t||(t=T(10).toString()),Yo.post("/msg/send",{color:5566168,fontsize:25,mode:1,msg:t,rnd:Date.now(),roomid:u,bubble:0,csrf:e,csrf_token:n})}(u,e);return 0===n||(11e3===n?(gi.warn(`【${t}】${u}-可能未开启评论`),!1):(gi.warn(`【${t}】${u}-发送失败 ${r}`),gi.verbose(`code: ${n}`),!1))}catch(u){gi.verbose(`发送弹幕异常 ${u.message}`)}}async function Sa(u){try{const{code:e,message:n,data:r}=await(t=u,Yo.post("xlive/web-room/v1/index/TrigerInteract",{roomid:t,interact_type:3,csrf:ho.BILIJCT,csrf_token:ho.BILIJCT,visit_id:""}));if(0===e)return r;gi.info(`【${u}】直播间分享失败 ${e} ${n}`)}catch(t){gi.warn(`分享直播间 [${u}] 异常 ${t.message}`)}var t}async function Ta(u){try{const{code:e,message:n,data:r}=await(t=u,Yo.post("xlive/web-ucenter/v1/interact/likeInteract",{roomid:t,csrf:ho.BILIJCT,csrf_token:ho.BILIJCT}));if(0===e)return r;gi.info(`【${u}】直播间点赞失败 ${e} ${n}`)}catch(u){gi.warn(`点赞直播间异常 ${u.message}`)}var t}async function Ia(){const u=(t=await _a())&&0!==t.length?t.filter(ba):[];var t;for(let t=0;t<u.length;t++){const e=u[t];await Oa(e)}}async function Oa(u){const{room_info:t,anchor_info:e}=u;if(!t||!e)return;const{liveLike:n,liveSendMessage:r,liveShare:i}=ho.intimacy,o=e.nick_name,a=t.room_id;r&&(va.verbose(`【${o}】开始发送直播弹幕`),await $a(a,o)),i&&async function(){await Io(100,300);for(let u=0;u<5;u++)va.verbose(`分享 [${o}] 直播间`),await Sa(a),await Io(4e3)}().catch((u=>gi.error(u))),n&&async function(){await Io(100,300);for(let u=0;u<3;u++)va.verbose(`给 [${o}] 直播间点赞`),await Ta(a),await Io(6500)}().catch((u=>gi.error(u))),await Io(22e3)}async function Pa(){try{const{data:u,message:t,code:e}=await ta();if(0!==e)return void gi.warn(`获取用户信息失败：${e} ${t}`);!function(u){var t;yo.bCoinCouponBalance=(null===(t=u.wallet)||void 0===t?void 0:t.coupon_balance)||0}(u)}catch(u){gi.error(`获取用户信息异常：${u.message}`)}}var xa;function La(){const u=$(),t=u.getDate(),e=function(u){const t=u||$(),e=t.getFullYear(),n=t.getMonth()+1;return 2===n?e%4==0&&e%100!=0||e%400==0?29:28:[4,6,9,11].includes(n)?30:31}(u),n=ho.CHARGE_PRESET_TIME;return yo.bCoinCouponBalance<2?(gi.info(`剩余券为${yo.bCoinCouponBalance}，不足2跳过充电`),!1):e===t?(gi.info("今天是最后一天了"),!0):!(n>t)||(gi.info(`预设时间为${n}，不符合条件`),!1)}async function ka(){try{const{data:u,code:t,message:e}=await Qo.get("/x/vip/privilege/my",{headers:{origin:D,referer:p}});if(0!==t)return void gi.info(`获取领取状态失败：${t} ${e}`);const{list:n}=u;return n.slice(0,2).filter((u=>{const t=parseInt(((new Date).getTime()/1e3).toString());return 0===u.state&&t>u.period_end_unix}))}catch(u){gi.error(`获取领取状态出现异常：${u.message}`)}}async function Na(u){try{const t=function(u){switch(u){case 1:return"B 币券";case 2:return"大会员优惠券";default:return""}}(u),{code:e,message:n}=await function(u=1){return Qo.post("/x/vip/privilege/receive",{csrf:ho.BILIJCT,type:u},{headers:{origin:C,referer:p}})}(u);let r="成功";return 0===e&&(r=`失败 ${n}`),gi.info(`领取${t} ${r}`),!0}catch(u){gi.error(`领取权益出现异常：${u.message}`)}return!1}async function Ra(u){let t=0,e=!1;for(;!(e||(e=await Na(u),t>2));)t++;return e}!function(u){u[u["成功"]=4]="成功",u[u["低于20电池"]=-2]="低于20电池",u[u["B币不足"]=-4]="B币不足"}(xa||(xa={}));let Ua=0;async function ja(){try{const{data:{list:u}}=await function(u=3394945){const t=(new Date).getTime();return Yo.get(`/xlive/web-room/v1/gift/bag_list?t=${t}&room_id=${u}`)}();return u.filter((u=>{if(u.expire_at<=0)return!1;const t=(1e3*u.expire_at-(new Date).getTime())/864e5<2,e=![1,30607].includes(u.gift_id);return e&&t&&gi.info(`${u.gift_name} 即将过期请尽快投喂`),!e&&t}))}catch(u){if(Ua)return null;await ja(),Ua++}}async function Ga(u){try{const{data:{live_room:t,name:e}}=await function(u){return Qo.get(`/x/space/acc/info?mid=${u}&jsonp=jsonp`)}(u);if(await Io(),t.roomStatus)return{roomid:t.roomid,name:e}}catch{}}function Ma(u,t,e,n){const r=ho.BILIJCT,i={is_fav:0,main_id:t,oid:u,detail_id:e,count:n,csrf:r,csrf_token:r};return Qo.post("/x/esports/guess/add",i)}function qa(){return yo.money-ho.MATCH_COINS<ho.BILI_TARGET_COINS&&(gi.info(`需要保留${ho.BILI_TARGET_COINS}个硬币，任务结束`),!0)}async function Ja(){const{data:u,code:t}=await na(1,1,0);if(0!==t)throw new Error(`获取最后一个关注失败: ${t}`);return u[0]}async function Ha(u){const{data:t,code:e}=await Qo.get("/x/relation/tags?jsonp=jsonp&callback=__jp3",{headers:{Referer:"https://space.bilibili.com/1/fans/follow?tagid=0"},requestOptions:{isJsonp:!0}});if(0===e)return t.find((t=>t.name===u));gi.warn(`获取分组列表失败: ${e}`)}async function Ka(u){const t=await Ha(u);if(t)return t.tagid;await Io(300);const{data:e,code:n,message:r}=await(i=u,Qo.post("/x/relation/tag/create",{tag:i,jsonp:"jsonp",csrf:ho.BILIJCT}));var i;if(22106===n){await Io(300);const t=await Ha(u);return t&&t.tagid}return 0!==n&&gi.warn(`创建分组失败: ${n}-${r}`),e.tagid}async function za(u,t="天选时刻"){if(0===u.length)return;const e=await Ka(t);if(e)for(const t of u){const{code:u,message:n}=await ra(t.mid,e);0!==u&&gi.warn(`移动【${t.uname}】失败: ${u}-${n}`),await Io()}}async function Ya(u,t,e,n=1){if(u.length>t.length)return;const{data:r,code:i,message:o}=await na(n,20,0);if(0===i){for(const{mid:n,uname:i}of r){if(u.length>=t.length)return;if(n===e)return;(t.includes(n)||t.includes(i))&&u.push({mid:n,uname:i})}if(!(r.length<20))return await Ya(u,t,e,n+1)}else gi.warn(`获取关注用户失败: ${i}-${o}`)}const Qa=0,Wa=1,Va=5,Xa=1,Za=504,us=1096;let ts;async function es(){try{const{data:u,code:t,message:e}=await Yo.get("/xlive/web-interface/v1/index/getWebAreaList?source_id=2");return 0!==t&&gi.info(`获取直播分区失败: ${t}-${e}`),u.data.map((u=>u.list)).map((u=>u.map((u=>({areaId:u.id,parentId:u.parent_id})))))}catch(u){throw gi.error(`获取直播分区异常: ${u.message}`),u}}async function ns(u,t,e=1,n="lottery"){try{await Io(100);const{data:r,code:i,message:o}=await function(u,t,e=1){return Yo.get(`/xlive/web-interface/v1/second/getList?platform=web&parent_area_id=${u}&area_id=${t}&page=${e}`)}(t,u,e);return 0!==i&&gi.info(`获取直播间列表失败: ${i}-${o}`),function(u){const t=[],e=[];return u.forEach((u=>{const n=u.pendant_info[2];n&&(n.pendent_id===Za?t.push(u):n.pendent_id===us&&e.push(u))})),{lotteryTime:t,lotteryPacket:e}}(r.list)["lottery"===n?"lotteryTime":"lotteryPacket"]}catch(u){throw gi.error(`获取直播间列表异常: ${u.message}`),u}}async function rs(u,t,e=1){const n=await ns(u,t,e),r=[];for(const u of n){const t=await is(u);t&&(r.push({...t,uid:u.uid,uname:u.uname}),await Io(100))}return r}async function is(u){const{blackUid:t}=ho.lottery;if(t.includes(u.uid))return void gi.info(`跳过黑名单用户: ${u.uname}`);let e,n,r;try{({data:n,code:e,message:r}=await ua(u.roomid))}catch(t){return void gi.info(`直播间${u.roomid}检测异常: ${t.message}`)}if(0!==e)return void gi.debug(`直播间${u.roomid}检测失败: ${e}-${r}`);if(null===n)return;const{excludeAward:i,includeAward:o}=ho.lottery,a=i.some((u=>n.award_name.match(u)));if(o.some((u=>n.award_name.match(u)))||!a){if(n.status===Xa&&!(n.gift_price>0))return 4===n.require_type&&(gi.info("您能反馈给作者输出了什么吗？"),gi.info(`${n.require_type}--${n.require_text}--${n.require_value}`),gi.info("也许这正是我们想要的。")),n.require_type===Va&&yo.userLevel>=n.require_value||n.require_type===Qa?n:n.require_type!==Wa||ho.lottery.skipNeedFollow?void 0:n}else gi.info(`跳过屏蔽奖品: ${n.award_name}`)}async function os(u,t=!0){try{const{id:n,gift_id:r,gift_num:i,award_name:o,uid:a,uname:s,require_type:c,require_text:D}=u;gi.info(`天选主播：【${s}】`),gi.info(`奖品：${o}`);const{code:f,message:l}=await(e={id:n,gift_id:r,gift_num:i},Yo.post("/xlive/lottery-interface/v1/Anchor/Join",{...e,csrf:ho.BILIJCT,csrf_token:ho.BILIJCT,visit_id:I(),platform:"pc"}));if(0!==f)return void gi.info(`天选失败: ${f}-${l}`);if(gi.info("天选成功 √"),c===Wa&&t){O(ts,a);(function(u){const t=(u=u.replace("关注主播","")).split(/\s*\+\s*/);return t.shift(),t})(D).forEach((u=>O(ts,u)))}}catch(u){gi.info(`天选异常: ${u.message}`)}var e}async function as(u,t,e=2){for(let n=1;n<=e;n++){const e=await rs(u,t,n);for(const u of e)await os(u),await Io(300)}}async function ss(u){try{const{data:t,code:e}=await function(u){return Yo.get(`/xlive/lottery-interface/v1/lottery/getLotteryInfoWeb?roomid=${u}`)}(u);if(0!==e)return;const{popularity_red_pocket:n}=t;if(!n)return;const{lot_id:r,lot_status:i}=n[0];if(2===i)return;return r}catch(u){}}async function cs(u,t,e=1){const n=await ns(u,t,e,"redPack"),r=[];for(const u of n){const t=await ss(u.roomid);t&&(r.push({uid:u.uid,uname:u.uname,lot_id:t,room_id:u.roomid}),await Io(100))}return r}async function Ds(u){try{const{lot_id:e,uid:n,uname:r,room_id:i}=u;gi.info(`红包主播：【${r}】`);const{code:o,message:a}=await(t={room_id:i,lot_id:e,ruid:n},Yo.post("/xlive/lottery-interface/v1/popularityRedPocket/RedPocketDraw",{...t,spm_id:"444.8.red_envelope.extract",jump_from:"",session_id:"",csrf_token:ho.BILIJCT,csrf:ho.BILIJCT,visit_id:""}));if(0!==o)return void gi.info(`红包失败: ${o}-${a}`);ts.push(n),gi.info("红包成功 √")}catch(u){gi.info(`红包异常: ${u.message}`)}var t}async function fs(u,t,e=2){for(let n=1;n<=e;n++){const e=await cs(u,t,n);for(const u of e)await Ds(u),await Io(200)}}async function ls(){const u=[];return await async function t(e=1){try{var n;const{data:r,code:i,message:o}=await function(u=1,t=9){return Yo.get(`/xlive/web-ucenter/user/following?page=${u}&page_size=${t}`)}(e,9);if(0!==i)return void gi.info(`获取关注直播间失败: ${i}-${o}`);const a=null===(n=r.list)||void 0===n?void 0:n.filter((u=>1===u.live_status));if(9===a.length&&e<r.totalPage)return u.push(...a),t(e+1);u.push(...a)}catch(u){gi.error(`获取关注直播间异常: ${u.message}`)}}(),u}async function ds(u){try{const{code:t,message:e,data:n}=await ua(u.roomid);if(0!==t)return void gi.debug(`直播间${u.roomid}检测失败: ${t}-${e}`);if(null===n)return;if(n.status!==Xa)return;if(n.gift_price>0)return;return n}catch(t){return void gi.info(`直播间${u.roomid}检测异常: ${t.message}`)}}async function Cs(){const{scanFollow:u}=ho.lottery;if(!u)return!0;try{gi.info("开始扫描关注的主播");const u=await async function(){const u=await ls(),t=[];for(const e of u){const u=await ds(e);u&&t.push({...u,uid:e.uid,uname:e.uname}),await Io(100)}return t}();for(const t of u)await os(t,!1),await Io(300);gi.info("关注的主播天选完成")}catch(u){gi.error(`关注的主播天选异常: ${u.message}`)}return"only"!==u}async function ps(u){try{const{code:t,message:e,data:n}=await function({session_type:u}={session_type:1}){return Vo.get(`/session_svr/v1/session_svr/get_sessions?session_type=${u}&group_fold=1&unfollow_fold=1&sort_rule=2&build=0&mobi_app=web`)}();if(0!==t)return void gi.warn(`获取会话失败：${t}-${e}`);const{session_list:r}=n;if(r.length<=0)return;return r.filter((({unread_count:t,talker_id:e,is_follow:n,last_msg:r})=>{return u.find((u=>u.mid===e))&&t>0&&e===r.sender_uid&&1===n&&(i=r.timestamp,Date.now()-1e3*i<36e5);var i}))}catch(u){gi.error(`获取会话异常：${u.message}`)}}async function Fs(u){const t=await ps(u);await Io(200);try{for(let u=0;u<t.length;u++){const e=t[u];await As(e)}}catch(u){gi.error(`更新会话异常：${u.message}`)}t.length>=19&&await Fs(u)}async function As(u){switch(ho.lottery.actFollowMsg){case"del":case"delete":await function({talker_id:u,session_type:t}){return Vo.post("/session_svr/v1/session_svr/remove_session",{talker_id:u,session_type:t,build:0,mobi_app:"web",csrf_token:ho.BILIJCT,csrf:ho.BILIJCT})}(u);break;case"read":await function({talker_id:u,session_type:t,ack_seqno:e}){return Vo.post("/session_svr/v1/session_svr/update_ack",{talker_id:u,session_type:t,ack_seqno:e,build:0,mobi_app:"web",csrf_token:ho.BILIJCT,csrf:ho.BILIJCT},{headers:{origin:d}})}(u)}await Io(50)}var Es={taskReward:async function(){gi.info("----【每日任务完成情况】----");try{const{data:u,message:t,code:e}=await Qo.get("/x/member/web/exp/reward");await Io();const{data:n}=await ea();if(0!=e)return void gi.warn(`状态获取失败: ${e} ${t}`);const r=yo.money-ho.BILI_STAY_COINS;let i=0;0===yo.coinsTask?gi.info(`今日投币获取经验: ${n}，还需投币0颗，经验够了，不想投了`):r<=0?gi.info(`今日投币获取经验: ${n}，还需投币0颗，硬币不够了，不投币了`):r<yo.coinsTask?(i=yo.coinsTask-r,gi.info(`投币获取经验: ${n}，还需投币数量: ${i}颗;(目标${yo.coinsTask}颗，忽略部分投币)`)):(i=yo.coinsTask-n/10,gi.info(`投币获取经验: ${n}，还需投币数量: ${i}颗;(目标${yo.coinsTask}颗)`)),yo.coinsTask=i,gi.info("每日分享: "+(u.share?"已完成":"[未完成]")),gi.info("每日播放: "+(u.watch?"已完成":"[未完成]")),yo.share=u.share,yo.watch=u.watch}catch(u){gi.error(`状态获取异常 ${u.message}`)}},liveSignTask:async function(){gi.info("----【直播签到】----");try{const{data:u}=await Yo.get("/xlive/web-ucenter/v1/sign/WebGetSignInfo");if(1===u.status)return gi.info("已签到，跳过签到"),void gi.info(`已经签到${u.hadSignDays}天，${u.specialText}`)}catch(u){}try{const{code:u,data:t,message:e}=await Yo.get("/xlive/web-ucenter/v1/sign/DoSign");0===u?gi.info(`直播签到成功: ${t.text}，特别信息: ${t.specialText}，本月签到天数: ${t.hadSignDays}天;`):gi.warn(`直播签到失败: ${u} ${e}`)}catch(u){gi.error(`直播签到异常: ${u.message}`)}},shareAndWatch:async function(){if(gi.info("----【分享/播放视频】----"),yo.share&&yo.watch)return void gi.info("已完成，跳过分享/播放");let u=0;try{let t=await ma();if("-1"===t.msg&&(t=await da()),"0"!==t.msg)return gi.warn(`获取视频失败 ${t.msg}`),!1;{const{id:e,author:n,title:r}=t.data;u=e,gi.info(`获取视频: ${r} --up【${n}】`)}}catch(u){return gi.error(`获取视频出现异常: ${u.message}`),!1}if(!yo.share){await Io();try{const{code:t,message:e}=await function(u){const t={csrf:ho.BILIJCT,aid:u};return Qo.post("/x/web-interface/share/add",t)}(u);0===t?gi.info("分享视频成功!"):gi.warn(`分享视频失败: ${t} ${e}`)}catch(u){gi.error(`分享视频异常: ${u.message}`)}}if(!yo.watch){await Io();try{const{code:n,message:r}=await(t=u,e=T(4,60),Qo.post("/x/click-interface/web/heartbeat",{aid:t,played_time:e}));0===n?gi.info("播放视频成功!"):gi.warn(`播放视频失败: ${n} ${r}`)}catch(u){gi.error(`播放视频异常: ${u.message}`)}}var t,e},silver2Coin:async function(){gi.info("----【银瓜子兑换硬币】----");try{const{data:u,code:t,message:e}=await Yo.get("/xlive/revenue/v1/wallet/getStatus");if(0!=t&&gi.info(`获取瓜子详情失败 ${e}`),0===u.silver_2_coin_left)gi.info("今日已兑换一次");else if(u.silver<700)gi.info("兑换失败，你瓜子不够了");else{const{message:u}=await Yo.post("/xlive/revenue/v1/wallet/silver2coin",{csrf_token:ho.BILIJCT,csrf:ho.BILIJCT});gi.info(`兑换硬币： ${u}`),await Yo.get("/xlive/revenue/v1/wallet/myWallet?need_bp=1&need_metal=1&platform=pc")}}catch(u){gi.error(`操作异常 ${u.message}`)}},addCoins:async function(){if(gi.info("----【视频投币】----"),!yo.coinsTask)return void gi.info("跳过投币，今日已完成");const u={eCount:0,num:0,prevCode:0,fillCount:0,priority:0};let t=!1;for(;yo.coinsTask&&!t&&u.eCount<5;)t=await ya(u);u.eCount>=5&&gi.info("出现异常/错误5次，自动退出投币"),gi.info(`一共成功投币${u.num}颗`),gi.info(`硬币还剩${yo.money}颗`)},mangaSign:async function(){gi.info("----【漫画签到】----");try{const{code:u}=await function(u="android"){return Wo.post("/twirp/activity.v1.Activity/ClockIn",{platform:u})}();0==u?gi.info("漫画签到成功"):gi.warn("漫画签到失败")}catch(u){const{status:t,statusCode:e}=u.response||{};400===t||400===e?gi.info("已经签到过了，跳过任务"):gi.error(`漫画签到异常 ${u.message}`)}},supGroupSign:async function(){gi.info("----【应援团签到】----");const u=await Ba();await Io();let t=0;for(let r=0;r<u.length;){const i=u[r];try{const{data:u,code:r,message:o}=await(e=i.group_id,n=i.owner_uid,Vo.get("/link_setting/v1/link_setting/sign_in",{params:{group_id:e,owner_id:n}}));0===r?0===u.status?t++:gi.info(o):gi.warn(`[${i.group_name}]签到失败 ${o}`)}catch(u){gi.error(`签到异常 ${u.message}`)}finally{await Io()}}var e,n;gi.info(`签到结束，成功${t}/${u.length}`)},liveSendMessage:async function(){gi.info("----【发送直播弹幕】----"),gi.info("该函数即将废弃，请使用 liveIntimacy 替代");try{const u=await _a(),t=u.length;let e=0,n=0;gi.info(`一共需要发送${t}个直播间`),gi.verbose("所需时间可能很长，请耐心等待");for(let r=0;r<t;r++){const{room_info:i,anchor_info:o,medal:a}=u[r];null!=i&&i.room_id?100===a.today_feed||a.level>=20?n++:(await $a(i.room_id,o.nick_name)&&e++,r<t-1&&await Io(T(1e4,25e3))):(gi.info(`【${o.nick_name}】没有直播间哦`),n++)}gi.info(`成功发送${e}个弹幕，跳过${n}个`)}catch(u){gi.error(`直播间发送弹幕异常: ${u.message}`)}},charging:async function(){if(gi.info("----【给目标充电】----"),await Pa(),await Io(),La())try{const u=yo.bCoinCouponBalance||0,t=ho.CHARGE_ID;let e=0;gi.info(`b 币券余额${u}`);const n=async()=>{const{code:e,message:n,data:r}=await function(u=50,t=!0,e=ho.USERID,n="up",r=e){return Qo.post("/x/ugcpay/web/v2/trade/elec/pay/quick",{csrf:ho.BILIJCT,bp_num:u,is_bp_remains_prior:t,up_mid:e,otype:n,oid:r})}(u,!0,t);0===e?(gi.info(`【充值结果】${xa[r.status]}`),r.status===xa["成功"]&&(yo.chargeOrderNo=r.order_no,await Io(),await async function(){try{if(!yo.chargeOrderNo)return!1;const u=y[T(0,y.length-1)],{code:t}=await function(u,t="支持大佬一波"){return Qo.post("/x/ugcpay/trade/elec/message",{csrf:ho.BILIJCT,message:t,order_id:u})}(yo.chargeOrderNo,u);0===t&&gi.info("留言成功！")}catch{}}())):gi.warn(`充电失败：${e} ${n}`)};for(yo.chargeOrderNo="";!(yo.chargeOrderNo||(await n(),await Io(),e++>2)););}catch(u){gi.error(`充电出现异常：${u.message}`)}},getVipPrivilege:async function(){try{if(gi.info("----【领取大会员权益】----"),2!==yo.vipType)return gi.info("账号非年度大会员，不需要领取权益"),!1;const u=await ka();if(0===u.length)return void gi.info("已经领取过权益，不需要再领取");for(let t=0;t<u.length;t++){const e=u[t];await Ra(e.type)}}catch(u){gi.error(`领取大会员权益出现异常：${u.message}`)}},giveGift:async function(){gi.info("----【投喂过期食物】----");try{const u=await ja();if(await Io(),null==u||!u.length)return void gi.info("没有2天内过期的简单礼物");const t=await async function(){const u=Object.assign([],ho.BILI_GIFT_UP),t=()=>u.splice(T(ho.BILI_GIFT_UP.length-1),1)[0];for(;u.length;){const u=t(),e=await Ga(u);if(e)return{mid:u,...e}}return await async function(){const{data:{count:u,items:t}}=await function(u=1,t=10){return u>10&&(u=10),Yo.get(`/xlive/app-ucenter/v1/user/GetMyMedals?page=${u}&page_size=${t}`)}();if(await Io(),!u)return;const e=t[T(t.length-1)];return{mid:e.target_id,roomid:e.roomid||0,name:e.uname}}()}();if(!t)return void gi.info("没有找到投喂目标");await async function({roomid:u,mid:t,name:e},n){for(const r of n){await Io();try{const{code:n,message:i,data:o}=await Zo({roomid:u,ruid:t,bag_id:r.bag_id,gift_id:r.gift_id,gift_num:r.gift_num});if(0!==n){gi.warn(`向[${e}]投喂[${r.gift_name}]，${i}`);continue}o.gift_list.forEach((u=>{gi.info(`成功给 [${e}] 投喂${u.gift_name}`)}))}catch{}}}(t,u)}catch(u){gi.info(`投喂过期食物异常 ${u}`)}},matchGame:async function(){if(gi.info("----【赛事硬币竞猜】----"),ho.MATCH_COINS<=0)return void gi.info("硬币数量不能小于 0");if(qa())return;const u=await async function(){try{const{code:u,message:t,data:{list:e,page:n}}=await function(u="",t=""){return Qo.get(`/x/esports/guess/collection/question?pn=1&ps=50&gid=&sids=&stime=${u}&etime=${t}`)}();return 0!==u?void gi.warn(`获取赛事错误 ${u} ${t}`):0===n.total?(gi.info("今日已经无法获取赛事"),null):e}catch(u){}}();if(await Io(),!u)return;const t=await async function(u){let t=0;try{for(const e of u){const{contest:u,questions:n}=e,r=u.id,[{id:i,title:o,details:a,is_guess:s}]=n,[c,D]=a;if(qa())return t;if(s)continue;gi.info(`${o} <=> ${c.odds}:${D.odds}`);const f=c.odds>D.odds;let l;l=ho.MATCH_SELECTION>0?f?D:c:f?c:D,gi.info(`预测[ ${l.option} ] ${ho.MATCH_COINS} 颗硬币`),await Io();const{code:d}=await Ma(r,i,l.detail_id,ho.MATCH_COINS);0!==d?gi.info("预测失败"):(t++,yo.money-=ho.MATCH_COINS)}}catch(u){console.warn(u.message)}return t}(function(u,t){return u.filter((u=>{const{questions:e}=u,[{details:n,is_guess:r}]=e;if(r)return!1;const[i,o]=n;return Math.abs(i.odds-o.odds)>=t}))}(u,ho.MATCH_DIFF));gi.info(`【竞猜结束】一共参与${t}次预测`)},liveLottery:async function(){gi.info("----【天选时刻】----");const u=await Cs();if(!u)return u;try{const u=await Ja();gi.info(`最后一个关注的UP: ${u.uname}`);const t=await async function(){ts=[];const{pageNum:u}=ho.lottery,t=await es();for(const e of t)for(const t of e)await as(t.areaId,t.parentId,u);return ts}();gi.info("扫描完成");const e=[];await Ya(e,t,null==u?void 0:u.mid),await za(e),gi.info("移动关注UP到分组成功")}catch(u){gi.warn(`天选时刻异常: ${u.message}`),gi.debug(u)}gi.info("结束天选时刻")},liveRedPack:async function(){gi.info("----【天选红包】----");try{const u=await Ja();gi.info(`最后一个关注的UP: ${u.uname}`);const t=await async function(){ts=[];const{pageNum:u}=ho.lottery,t=await es();for(const e of t)for(const t of e)await fs(t.areaId,t.parentId,u);return ts}();gi.info("扫描完成，获取新关注的UP");const e=[];await Ya(e,t,null==u?void 0:u.mid),gi.info("开始读取消息"),await Fs(e),gi.info("移动关注UP到分组"),await za(e),gi.info("移动关注UP到分组成功")}catch(u){gi.warn(`天选时刻异常: ${u.message}`),gi.debug(u)}gi.info("结束天选红包")},liveIntimacy:async function(){gi.info("----【直播亲密度】----");try{await Ia(),gi.info("直播亲密度完成")}catch(u){gi.error(`直播亲密度: ${u.message}`)}}};var gs=Object.freeze({__proto__:null,dailyTasks:async function(u,...t){Ei.pushValue="";try{await async function(){gi.info("----【登录】----");const{data:u,message:t,code:e}=await ta();if(0!==e)throw gi.error(`登录错误 ${e} ${t}`),new Error(t);if(!u.isLogin)throw new Error("接口返回为未登录");await Io(),await oa(u)}()}catch(u){return gi.error(`登录失败: ${u}`),await Ko("登录失败",Ei.pushValue),"未完成"}const e=To([...Object.values(Es)]);for(const u of e)try{await u()}catch(t){gi.error(`${u.name}失败: ${t}`)}finally{await Io()}return u&&await u(...t),await Ko("每日完成",Ei.pushValue),"完成"}});
