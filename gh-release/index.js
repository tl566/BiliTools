"use strict";var e=require("path"),t=require("fs"),i=require("crypto"),n=require("zlib"),s=require("events"),o=require("url"),a=require("util"),r=require("http"),c=require("https"),p=require("stream"),u=require("dns"),l=require("net"),d=require("os"),h=require("punycode"),m=require("tls"),f=require("child_process");require("assert");var g=require("buffer"),v=require("http2");function x(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function y(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}var b=y(e),w=x(e),_=y(t),D=x(t),E=x(i),C=x(n),A=x(s),k=x(o),S=x(a),F=x(r),T=x(c),B=x(p),O=x(u),I=x(l),P=x(d),j=x(h),R=x(m),L=x(f),N=x(g),H=x(v),$="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function U(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var q=function(e){return e&&e.Math==Math&&e},M=q("object"==typeof globalThis&&globalThis)||q("object"==typeof window&&window)||q("object"==typeof self&&self)||q("object"==typeof $&&$)||function(){return this}()||Function("return this")(),z={},G=function(e){try{return!!e()}catch(e){return!0}},V=!G((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),W=!G((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),K=W,J=Function.prototype.call,Q=K?J.bind(J):function(){return J.apply(J,arguments)},X={},Y={}.propertyIsEnumerable,Z=Object.getOwnPropertyDescriptor,ee=Z&&!Y.call({1:2},1);X.f=ee?function(e){var t=Z(this,e);return!!t&&t.enumerable}:Y;var te,ie,ne=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},se=W,oe=Function.prototype,ae=oe.bind,re=oe.call,ce=se&&ae.bind(re,re),pe=se?function(e){return e&&ce(e)}:function(e){return e&&function(){return re.apply(e,arguments)}},ue=pe,le=ue({}.toString),de=ue("".slice),he=function(e){return de(le(e),8,-1)},me=G,fe=he,ge=Object,ve=pe("".split),xe=me((function(){return!ge("z").propertyIsEnumerable(0)}))?function(e){return"String"==fe(e)?ve(e,""):ge(e)}:ge,ye=TypeError,be=function(e){if(null==e)throw ye("Can't call method on "+e);return e},we=xe,_e=be,De=function(e){return we(_e(e))},Ee=function(e){return"function"==typeof e},Ce=Ee,Ae=function(e){return"object"==typeof e?null!==e:Ce(e)},ke=M,Se=Ee,Fe=function(e){return Se(e)?e:void 0},Te=function(e,t){return arguments.length<2?Fe(ke[e]):ke[e]&&ke[e][t]},Be=pe({}.isPrototypeOf),Oe=M,Ie=Te("navigator","userAgent")||"",Pe=Oe.process,je=Oe.Deno,Re=Pe&&Pe.versions||je&&je.version,Le=Re&&Re.v8;Le&&(ie=(te=Le.split("."))[0]>0&&te[0]<4?1:+(te[0]+te[1])),!ie&&Ie&&(!(te=Ie.match(/Edge\/(\d+)/))||te[1]>=74)&&(te=Ie.match(/Chrome\/(\d+)/))&&(ie=+te[1]);var Ne=ie,He=G,$e=!!Object.getOwnPropertySymbols&&!He((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Ne&&Ne<41})),Ue=$e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,qe=Te,Me=Ee,ze=Be,Ge=Object,Ve=Ue?function(e){return"symbol"==typeof e}:function(e){var t=qe("Symbol");return Me(t)&&ze(t.prototype,Ge(e))},We=String,Ke=function(e){try{return We(e)}catch(e){return"Object"}},Je=Ee,Qe=Ke,Xe=TypeError,Ye=function(e){if(Je(e))return e;throw Xe(Qe(e)+" is not a function")},Ze=Ye,et=function(e,t){var i=e[t];return null==i?void 0:Ze(i)},tt=Q,it=Ee,nt=Ae,st=TypeError,ot={exports:{}},at=M,rt=Object.defineProperty,ct=function(e,t){try{rt(at,e,{value:t,configurable:!0,writable:!0})}catch(i){at[e]=t}return t},pt=ct,ut=M["__core-js_shared__"]||pt("__core-js_shared__",{}),lt=ut;(ot.exports=function(e,t){return lt[e]||(lt[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.22.8",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.8/LICENSE",source:"https://github.com/zloirock/core-js"});var dt=be,ht=Object,mt=function(e){return ht(dt(e))},ft=mt,gt=pe({}.hasOwnProperty),vt=Object.hasOwn||function(e,t){return gt(ft(e),t)},xt=pe,yt=0,bt=Math.random(),wt=xt(1..toString),_t=function(e){return"Symbol("+(void 0===e?"":e)+")_"+wt(++yt+bt,36)},Dt=M,Et=ot.exports,Ct=vt,At=_t,kt=$e,St=Ue,Ft=Et("wks"),Tt=Dt.Symbol,Bt=Tt&&Tt.for,Ot=St?Tt:Tt&&Tt.withoutSetter||At,It=function(e){if(!Ct(Ft,e)||!kt&&"string"!=typeof Ft[e]){var t="Symbol."+e;kt&&Ct(Tt,e)?Ft[e]=Tt[e]:Ft[e]=St&&Bt?Bt(t):Ot(t)}return Ft[e]},Pt=Q,jt=Ae,Rt=Ve,Lt=et,Nt=function(e,t){var i,n;if("string"===t&&it(i=e.toString)&&!nt(n=tt(i,e)))return n;if(it(i=e.valueOf)&&!nt(n=tt(i,e)))return n;if("string"!==t&&it(i=e.toString)&&!nt(n=tt(i,e)))return n;throw st("Can't convert object to primitive value")},Ht=TypeError,$t=It("toPrimitive"),Ut=function(e,t){if(!jt(e)||Rt(e))return e;var i,n=Lt(e,$t);if(n){if(void 0===t&&(t="default"),i=Pt(n,e,t),!jt(i)||Rt(i))return i;throw Ht("Can't convert object to primitive value")}return void 0===t&&(t="number"),Nt(e,t)},qt=Ve,Mt=function(e){var t=Ut(e,"string");return qt(t)?t:t+""},zt=Ae,Gt=M.document,Vt=zt(Gt)&&zt(Gt.createElement),Wt=function(e){return Vt?Gt.createElement(e):{}},Kt=Wt,Jt=!V&&!G((function(){return 7!=Object.defineProperty(Kt("div"),"a",{get:function(){return 7}}).a})),Qt=V,Xt=Q,Yt=X,Zt=ne,ei=De,ti=Mt,ii=vt,ni=Jt,si=Object.getOwnPropertyDescriptor;z.f=Qt?si:function(e,t){if(e=ei(e),t=ti(t),ni)try{return si(e,t)}catch(e){}if(ii(e,t))return Zt(!Xt(Yt.f,e,t),e[t])};var oi={},ai=V&&G((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),ri=Ae,ci=String,pi=TypeError,ui=function(e){if(ri(e))return e;throw pi(ci(e)+" is not an object")},li=V,di=Jt,hi=ai,mi=ui,fi=Mt,gi=TypeError,vi=Object.defineProperty,xi=Object.getOwnPropertyDescriptor;oi.f=li?hi?function(e,t,i){if(mi(e),t=fi(t),mi(i),"function"==typeof e&&"prototype"===t&&"value"in i&&"writable"in i&&!i.writable){var n=xi(e,t);n&&n.writable&&(e[t]=i.value,i={configurable:"configurable"in i?i.configurable:n.configurable,enumerable:"enumerable"in i?i.enumerable:n.enumerable,writable:!1})}return vi(e,t,i)}:vi:function(e,t,i){if(mi(e),t=fi(t),mi(i),di)try{return vi(e,t,i)}catch(e){}if("get"in i||"set"in i)throw gi("Accessors not supported");return"value"in i&&(e[t]=i.value),e};var yi=oi,bi=ne,wi=V?function(e,t,i){return yi.f(e,t,bi(1,i))}:function(e,t,i){return e[t]=i,e},_i={exports:{}},Di=V,Ei=vt,Ci=Function.prototype,Ai=Di&&Object.getOwnPropertyDescriptor,ki=Ei(Ci,"name"),Si={EXISTS:ki,PROPER:ki&&"something"===function(){}.name,CONFIGURABLE:ki&&(!Di||Di&&Ai(Ci,"name").configurable)},Fi=Ee,Ti=ut,Bi=pe(Function.toString);Fi(Ti.inspectSource)||(Ti.inspectSource=function(e){return Bi(e)});var Oi,Ii,Pi,ji=Ti.inspectSource,Ri=Ee,Li=ji,Ni=M.WeakMap,Hi=Ri(Ni)&&/native code/.test(Li(Ni)),$i=ot.exports,Ui=_t,qi=$i("keys"),Mi=function(e){return qi[e]||(qi[e]=Ui(e))},zi={},Gi=Hi,Vi=M,Wi=pe,Ki=Ae,Ji=wi,Qi=vt,Xi=ut,Yi=Mi,Zi=zi,en=Vi.TypeError,tn=Vi.WeakMap;if(Gi||Xi.state){var nn=Xi.state||(Xi.state=new tn),sn=Wi(nn.get),on=Wi(nn.has),an=Wi(nn.set);Oi=function(e,t){if(on(nn,e))throw new en("Object already initialized");return t.facade=e,an(nn,e,t),t},Ii=function(e){return sn(nn,e)||{}},Pi=function(e){return on(nn,e)}}else{var rn=Yi("state");Zi[rn]=!0,Oi=function(e,t){if(Qi(e,rn))throw new en("Object already initialized");return t.facade=e,Ji(e,rn,t),t},Ii=function(e){return Qi(e,rn)?e[rn]:{}},Pi=function(e){return Qi(e,rn)}}var cn={set:Oi,get:Ii,has:Pi,enforce:function(e){return Pi(e)?Ii(e):Oi(e,{})},getterFor:function(e){return function(t){var i;if(!Ki(t)||(i=Ii(t)).type!==e)throw en("Incompatible receiver, "+e+" required");return i}}},pn=G,un=Ee,ln=vt,dn=V,hn=Si.CONFIGURABLE,mn=ji,fn=cn.enforce,gn=cn.get,vn=Object.defineProperty,xn=dn&&!pn((function(){return 8!==vn((function(){}),"length",{value:8}).length})),yn=String(String).split("String"),bn=_i.exports=function(e,t,i){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),i&&i.getter&&(t="get "+t),i&&i.setter&&(t="set "+t),(!ln(e,"name")||hn&&e.name!==t)&&vn(e,"name",{value:t,configurable:!0}),xn&&i&&ln(i,"arity")&&e.length!==i.arity&&vn(e,"length",{value:i.arity});try{i&&ln(i,"constructor")&&i.constructor?dn&&vn(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var n=fn(e);return ln(n,"source")||(n.source=yn.join("string"==typeof t?t:"")),e};Function.prototype.toString=bn((function(){return un(this)&&gn(this).source||mn(this)}),"toString");var wn=Ee,_n=wi,Dn=_i.exports,En=ct,Cn={},An=Math.ceil,kn=Math.floor,Sn=Math.trunc||function(e){var t=+e;return(t>0?kn:An)(t)},Fn=function(e){var t=+e;return t!=t||0===t?0:Sn(t)},Tn=Fn,Bn=Math.max,On=Math.min,In=Fn,Pn=Math.min,jn=function(e){return e>0?Pn(In(e),9007199254740991):0},Rn=function(e){return jn(e.length)},Ln=De,Nn=function(e,t){var i=Tn(e);return i<0?Bn(i+t,0):On(i,t)},Hn=Rn,$n=function(e){return function(t,i,n){var s,o=Ln(t),a=Hn(o),r=Nn(n,a);if(e&&i!=i){for(;a>r;)if((s=o[r++])!=s)return!0}else for(;a>r;r++)if((e||r in o)&&o[r]===i)return e||r||0;return!e&&-1}},Un={includes:$n(!0),indexOf:$n(!1)},qn=vt,Mn=De,zn=Un.indexOf,Gn=zi,Vn=pe([].push),Wn=function(e,t){var i,n=Mn(e),s=0,o=[];for(i in n)!qn(Gn,i)&&qn(n,i)&&Vn(o,i);for(;t.length>s;)qn(n,i=t[s++])&&(~zn(o,i)||Vn(o,i));return o},Kn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Jn=Wn,Qn=Kn.concat("length","prototype");Cn.f=Object.getOwnPropertyNames||function(e){return Jn(e,Qn)};var Xn={};Xn.f=Object.getOwnPropertySymbols;var Yn=Te,Zn=Cn,es=Xn,ts=ui,is=pe([].concat),ns=Yn("Reflect","ownKeys")||function(e){var t=Zn.f(ts(e)),i=es.f;return i?is(t,i(e)):t},ss=vt,os=ns,as=z,rs=oi,cs=function(e,t,i){for(var n=os(t),s=rs.f,o=as.f,a=0;a<n.length;a++){var r=n[a];ss(e,r)||i&&ss(i,r)||s(e,r,o(t,r))}},ps=G,us=Ee,ls=/#|\.prototype\./,ds=function(e,t){var i=ms[hs(e)];return i==gs||i!=fs&&(us(t)?ps(t):!!t)},hs=ds.normalize=function(e){return String(e).replace(ls,".").toLowerCase()},ms=ds.data={},fs=ds.NATIVE="N",gs=ds.POLYFILL="P",vs=ds,xs=M,ys=z.f,bs=wi,ws=function(e,t,i,n){n||(n={});var s=n.enumerable,o=void 0!==n.name?n.name:t;return wn(i)&&Dn(i,o,n),n.global?s?e[t]=i:En(t,i):(n.unsafe?e[t]&&(s=!0):delete e[t],s?e[t]=i:_n(e,t,i)),e},_s=ct,Ds=cs,Es=vs,Cs=function(e,t){var i,n,s,o,a,r=e.target,c=e.global,p=e.stat;if(i=c?xs:p?xs[r]||_s(r,{}):(xs[r]||{}).prototype)for(n in t){if(o=t[n],s=e.dontCallGetSet?(a=ys(i,n))&&a.value:i[n],!Es(c?n:r+(p?".":"#")+n,e.forced)&&void 0!==s){if(typeof o==typeof s)continue;Ds(o,s)}(e.sham||s&&s.sham)&&bs(o,"sham",!0),ws(i,n,o,e)}},As=!G((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),ks=vt,Ss=Ee,Fs=mt,Ts=As,Bs=Mi("IE_PROTO"),Os=Object,Is=Os.prototype,Ps=Ts?Os.getPrototypeOf:function(e){var t=Fs(e);if(ks(t,Bs))return t[Bs];var i=t.constructor;return Ss(i)&&t instanceof i?i.prototype:t instanceof Os?Is:null},js=Ee,Rs=String,Ls=TypeError,Ns=pe,Hs=ui,$s=function(e){if("object"==typeof e||js(e))return e;throw Ls("Can't set "+Rs(e)+" as a prototype")},Us=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,i={};try{(e=Ns(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(i,[]),t=i instanceof Array}catch(e){}return function(i,n){return Hs(i),$s(n),t?e(i,n):i.__proto__=n,i}}():void 0),qs={},Ms=Wn,zs=Kn,Gs=Object.keys||function(e){return Ms(e,zs)},Vs=V,Ws=ai,Ks=oi,Js=ui,Qs=De,Xs=Gs;qs.f=Vs&&!Ws?Object.defineProperties:function(e,t){Js(e);for(var i,n=Qs(t),s=Xs(t),o=s.length,a=0;o>a;)Ks.f(e,i=s[a++],n[i]);return e};var Ys,Zs=Te("document","documentElement"),eo=ui,to=qs,io=Kn,no=zi,so=Zs,oo=Wt,ao=Mi("IE_PROTO"),ro=function(){},co=function(e){return"<script>"+e+"<\/script>"},po=function(e){e.write(co("")),e.close();var t=e.parentWindow.Object;return e=null,t},uo=function(){try{Ys=new ActiveXObject("htmlfile")}catch(e){}var e,t;uo="undefined"!=typeof document?document.domain&&Ys?po(Ys):((t=oo("iframe")).style.display="none",so.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(co("document.F=Object")),e.close(),e.F):po(Ys);for(var i=io.length;i--;)delete uo.prototype[io[i]];return uo()};no[ao]=!0;var lo=Object.create||function(e,t){var i;return null!==e?(ro.prototype=eo(e),i=new ro,ro.prototype=null,i[ao]=e):i=uo(),void 0===t?i:to.f(i,t)},ho=Error,mo=pe("".replace),fo=String(ho("zxcasd").stack),go=/\n\s*at [^:]*:[^\n]*/,vo=go.test(fo),xo=function(e,t){if(vo&&"string"==typeof e&&!ho.prepareStackTrace)for(;t--;)e=mo(e,go,"");return e},yo=Ae,bo=wi,wo=function(e,t){yo(t)&&"cause"in t&&bo(e,"cause",t.cause)},_o=Ye,Do=W,Eo=pe(pe.bind),Co={},Ao=Co,ko=It("iterator"),So=Array.prototype,Fo={};Fo[It("toStringTag")]="z";var To="[object z]"===String(Fo),Bo=Ee,Oo=he,Io=It("toStringTag"),Po=Object,jo="Arguments"==Oo(function(){return arguments}()),Ro=To?Oo:function(e){var t,i,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Po(e),Io))?i:jo?Oo(t):"Object"==(n=Oo(t))&&Bo(t.callee)?"Arguments":n},Lo=Ro,No=et,Ho=Co,$o=It("iterator"),Uo=function(e){if(null!=e)return No(e,$o)||No(e,"@@iterator")||Ho[Lo(e)]},qo=Q,Mo=Ye,zo=ui,Go=Ke,Vo=Uo,Wo=TypeError,Ko=Q,Jo=ui,Qo=et,Xo=function(e,t){return _o(e),void 0===t?e:Do?Eo(e,t):function(){return e.apply(t,arguments)}},Yo=Q,Zo=ui,ea=Ke,ta=function(e){return void 0!==e&&(Ao.Array===e||So[ko]===e)},ia=Rn,na=Be,sa=function(e,t){var i=arguments.length<2?Vo(e):t;if(Mo(i))return zo(qo(i,e));throw Wo(Go(e)+" is not iterable")},oa=Uo,aa=function(e,t,i){var n,s;Jo(e);try{if(!(n=Qo(e,"return"))){if("throw"===t)throw i;return i}n=Ko(n,e)}catch(e){s=!0,n=e}if("throw"===t)throw i;if(s)throw n;return Jo(n),i},ra=TypeError,ca=function(e,t){this.stopped=e,this.result=t},pa=ca.prototype,ua=function(e,t,i){var n,s,o,a,r,c,p,u=i&&i.that,l=!(!i||!i.AS_ENTRIES),d=!(!i||!i.IS_ITERATOR),h=!(!i||!i.INTERRUPTED),m=Xo(t,u),f=function(e){return n&&aa(n,"normal",e),new ca(!0,e)},g=function(e){return l?(Zo(e),h?m(e[0],e[1],f):m(e[0],e[1])):h?m(e,f):m(e)};if(d)n=e;else{if(!(s=oa(e)))throw ra(ea(e)+" is not iterable");if(ta(s)){for(o=0,a=ia(e);a>o;o++)if((r=g(e[o]))&&na(pa,r))return r;return new ca(!1)}n=sa(e,s)}for(c=n.next;!(p=Yo(c,n)).done;){try{r=g(p.value)}catch(e){aa(n,"throw",e)}if("object"==typeof r&&r&&na(pa,r))return r}return new ca(!1)},la=Ro,da=String,ha=function(e){if("Symbol"===la(e))throw TypeError("Cannot convert a Symbol value to a string");return da(e)},ma=function(e,t){return void 0===e?arguments.length<2?"":t:ha(e)},fa=ne,ga=!G((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",fa(1,7)),7!==e.stack)})),va=Cs,xa=Be,ya=Ps,ba=Us,wa=cs,_a=lo,Da=wi,Ea=ne,Ca=xo,Aa=wo,ka=ua,Sa=ma,Fa=ga,Ta=It("toStringTag"),Ba=Error,Oa=[].push,Ia=function(e,t){var i,n=arguments.length>2?arguments[2]:void 0,s=xa(Pa,this);ba?i=ba(new Ba,s?ya(this):Pa):(i=s?this:_a(Pa),Da(i,Ta,"Error")),void 0!==t&&Da(i,"message",Sa(t)),Fa&&Da(i,"stack",Ca(i.stack,1)),Aa(i,n);var o=[];return ka(e,Oa,{that:o}),Da(i,"errors",o),i};ba?ba(Ia,Ba):wa(Ia,Ba,{name:!0});var Pa=Ia.prototype=_a(Ba.prototype,{constructor:Ea(1,Ia),message:Ea(1,""),name:Ea(1,"AggregateError")});va({global:!0,constructor:!0,arity:2},{AggregateError:Ia});var ja={},Ra=Ye,La=function(e){var t,i;this.promise=new e((function(e,n){if(void 0!==t||void 0!==i)throw TypeError("Bad Promise constructor");t=e,i=n})),this.resolve=Ra(t),this.reject=Ra(i)};ja.f=function(e){return new La(e)};var Na,Ha=Q,$a=Ye,Ua=Te,qa=ja,Ma=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},za=ua;Cs({target:"Promise",stat:!0},{any:function(e){var t=this,i=Ua("AggregateError"),n=qa.f(t),s=n.resolve,o=n.reject,a=Ma((function(){var n=$a(t.resolve),a=[],r=0,c=1,p=!1;za(e,(function(e){var u=r++,l=!1;c++,Ha(n,t,e).then((function(e){l||p||(p=!0,s(e))}),(function(e){l||p||(l=!0,a[u]=e,--c||o(new i(a,"No one promise resolved")))}))})),--c||o(new i(a,"No one promise resolved"))}));return a.error&&o(a.value),n.promise}}),function(e){e[e.SUCCESS=0]="SUCCESS",e[e["应用程序不存在或已被封禁"]=-1]="应用程序不存在或已被封禁",e[e["Access Key错误"]=-2]="Access Key错误",e[e["API校验密匙错误"]=-3]="API校验密匙错误",e[e["调用方对该Method没有权限"]=-4]="调用方对该Method没有权限",e[e["账号未登录"]=-101]="账号未登录",e[e["账号被封停"]=-102]="账号被封停",e[e["积分不足"]=-103]="积分不足",e[e["硬币不足"]=-104]="硬币不足",e[e["验证码错误"]=-105]="验证码错误",e[e["账号非正式会员或在适应期"]=-106]="账号非正式会员或在适应期",e[e["应用不存在或者被封禁"]=-107]="应用不存在或者被封禁",e[e["未绑定手机?"]=-108]="未绑定手机?",e[e["未绑定手机"]=-110]="未绑定手机",e[e["csrf 校验失败"]=-111]="csrf 校验失败",e[e["系统升级中"]=-112]="系统升级中",e[e["账号尚未实名认证"]=-113]="账号尚未实名认证",e[e["请先绑定手机"]=-114]="请先绑定手机",e[e["请先完成实名认证"]=-115]="请先完成实名认证"}(Na||(Na={}));const Ga="https://account.bilibili.com",Va="https://live.bilibili.com",Wa="https://space.bilibili.com",Ka="https://message.bilibili.com",Ja="https://www.bilibili.com",Qa="https://www.bilibili.com/",Xa="https://account.bilibili.com",Ya="https://api.live.bilibili.com",Za="https://api.bilibili.com",er="https://manga.bilibili.com",tr="https://api.vc.bilibili.com",ir={"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.41 Safari/537.36 Edg/101.0.1210.32","content-type":"application/x-www-form-urlencoded; charset=UTF-8","accept-language":"zh-CN,zh;q=0.9","accept-encoding":"gzip, deflate, br"},nr=["棒","棒唉","棒耶","加油~","UP加油!","支持~","支持支持！","催更啦","顶顶","留下脚印~","干杯","bilibili干杯","o(*￣▽￣*)o","(｡･∀･)ﾉﾞ嗨","(●ˇ∀ˇ●)","( •̀ ω •́ )y","(ง •_•)ง",">.<","^_~"],sr=Object.prototype.toString;function or(e,t){return sr.call(e)===`[object ${t}]`}function ar(e){return null!==e&&or(e,"Object")}function rr(e){return or(e,"String")}function cr(e){return e&&Array.isArray(e)}function pr(){const e=new Date,t=e.getTime(),i=e.getTimezoneOffset()/60;return new Date(t+36e5*(i+8))}function ur(e,t){return Math.ceil(t/e)}function lr(e,t,i){if(i&&"boolean"!=typeof i&&(t=i=void 0),void 0===i&&("boolean"==typeof t?(i=t,t=void 0):"boolean"==typeof e&&(i=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):void 0===t&&(t=e,e=0),e>t){const i=e;e=t,t=i}if(i||e%1||t%1){const i=Math.random();return Math.min(e+i*(t-e+parseFloat("1e-"+((i+"").length-1))),t)}return e+Math.floor(Math.random()*(t-e+1))}function dr(){return`${lr(1,9)}${function(e,t){let i="";for(let t=0;t<e;t++)i+=vr("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");return t?i.toLowerCase():i}(10,!0)}0`}function hr(e,t){e.includes(t)||e.push(t)}function mr(e,t=!1){return ar(e)?Array.isArray(e)?e.map((e=>mr(e,t))):t?Object.keys(e).reduce(((i,n)=>(i[n]=mr(e[n],t),i)),{}):Object.assign({},e):e}function fr(e,t){return void 0===e||void 0===t?e||t:ar(e)&&ar(t)?Array.isArray(e)&&Array.isArray(t)?e.concat(t):Object.keys(t).reduce(((i,n)=>(i[n]=fr(e[n],t[n]),i)),e):t}function gr(e){if(!ar(e)&&!cr(e))return e;const t=new URLSearchParams;return Array.isArray(e)||(e=Object.entries(e)),e.forEach((([e,i])=>{ar(i)?t.append(e,JSON.stringify(i)):t.append(e,String(i))})),t.toString()}function vr(e){return e[lr(e.length-1)]}function xr(e){return e&&e.map((e=>Number(e))).filter((e=>e>0&&e%1==0))}var yr=W,br=Function.prototype,wr=br.apply,_r=br.call,Dr="object"==typeof Reflect&&Reflect.apply||(yr?_r.bind(wr):function(){return _r.apply(wr,arguments)}),Er=oi.f,Cr=Ee,Ar=Ae,kr=Us,Sr=Te,Fr=vt,Tr=wi,Br=Be,Or=Us,Ir=cs,Pr=function(e,t,i){i in e||Er(e,i,{configurable:!0,get:function(){return t[i]},set:function(e){t[i]=e}})},jr=function(e,t,i){var n,s;return kr&&Cr(n=t.constructor)&&n!==i&&Ar(s=n.prototype)&&s!==i.prototype&&kr(e,s),e},Rr=ma,Lr=wo,Nr=xo,Hr=ga,$r=V,Ur=Cs,qr=Dr,Mr=function(e,t,i,n){var s="stackTraceLimit",o=n?2:1,a=e.split("."),r=a[a.length-1],c=Sr.apply(null,a);if(c){var p=c.prototype;if(Fr(p,"cause")&&delete p.cause,!i)return c;var u=Sr("Error"),l=t((function(e,t){var i=Rr(n?t:e,void 0),s=n?new c(e):new c;return void 0!==i&&Tr(s,"message",i),Hr&&Tr(s,"stack",Nr(s.stack,2)),this&&Br(p,this)&&jr(s,this,l),arguments.length>o&&Lr(s,arguments[o]),s}));l.prototype=p,"Error"!==r?Or?Or(l,u):Ir(l,u,{name:!0}):$r&&s in c&&(Pr(l,c,s),Pr(l,c,"prepareStackTrace")),Ir(l,c);try{p.name!==r&&Tr(p,"name",r),p.constructor=l}catch(e){}return l}},zr=M.WebAssembly,Gr=7!==Error("e",{cause:7}).cause,Vr=function(e,t){var i={};i[e]=Mr(e,t,Gr),Ur({global:!0,constructor:!0,arity:1,forced:Gr},i)},Wr=function(e,t){if(zr&&zr[e]){var i={};i[e]=Mr("WebAssembly."+e,t,Gr),Ur({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:Gr},i)}};Vr("Error",(function(e){return function(t){return qr(e,this,arguments)}})),Vr("EvalError",(function(e){return function(t){return qr(e,this,arguments)}})),Vr("RangeError",(function(e){return function(t){return qr(e,this,arguments)}})),Vr("ReferenceError",(function(e){return function(t){return qr(e,this,arguments)}})),Vr("SyntaxError",(function(e){return function(t){return qr(e,this,arguments)}})),Vr("TypeError",(function(e){return function(t){return qr(e,this,arguments)}})),Vr("URIError",(function(e){return function(t){return qr(e,this,arguments)}})),Wr("CompileError",(function(e){return function(t){return qr(e,this,arguments)}})),Wr("LinkError",(function(e){return function(t){return qr(e,this,arguments)}})),Wr("RuntimeError",(function(e){return function(t){return qr(e,this,arguments)}}));var Kr=oi.f,Jr=vt,Qr=It("toStringTag"),Xr=M,Yr=function(e,t,i){e&&!i&&(e=e.prototype),e&&!Jr(e,Qr)&&Kr(e,Qr,{configurable:!0,value:t})};Cs({global:!0},{Reflect:{}}),Yr(Xr.Reflect,"Reflect",!0);const Zr=()=>process.env.QL_BRANCH;function ec(){return function(){const e=Object.keys(process.env),t=e.filter((e=>e.startsWith("SCF_"))).length>=10,i=e.filter((e=>e.startsWith("TENCENTCLOUD_"))).length>=3;return t&&i||!1}()||function(){const e=Object.keys(process.env),t=["securityToken","accessKeyID","accessKeySecret","FC_FUNCTION_MEMORY_SIZE","FC_FUNC_CODE_PATH","FC_RUNTIME_VERSION"];return e.filter((e=>t.includes(e))).length>=3||!1}()||global.IS_CFC||!1||global.IS_CFC||!1}function tc(e,t=!0){return t?e.toLocaleString("zh-CN",{hour12:!1}):e.toLocaleString("zh-CN",{hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"})}function ic(e="info"){const t=["error","warn","info","verbose","debug"],i=t.indexOf(e);return i>0?t.slice(0,i+1):t}function nc(e){return b.resolve(process.cwd(),e)}class sc{static pushValue="";month=pr().getMonth()+1;errorFile=nc(`./logs/bt_error-${this.month}.log`);logFile=nc(`./logs/bt_combined-${this.month}.log`);noFile=!1;constructor(e={console:"info",file:"info",push:"info"},t="default"){this.options=e,this.name=t,this.consoleLeval=ic(this.options.console),this.fileLeval=ic(this.options.file),this.pushLeval=ic(this.options.push),this.noFile=Zr()||ec(),this.noFile||this.createLogFile()}log({level:e},t){const i=pr(),n=`[${e} ${tc(i,!1)}] ${t}\n`,s=["error","warn"].includes(e);this.consoleLeval.includes(e)&&this.Conslole(n,s),!this.noFile&&this.fileLeval.includes(e)&&this.File(`[${e} ${tc(i,!1)}] ${t}\n`,s),this.pushLeval.includes(e)&&this.Push(n)}error(e){this.log({level:"error"},e)}warn(e){this.log({level:"warn"},e)}info(e){this.log({level:"info"},e)}verbose(e){this.log({level:"verbose"},e)}debug(e){this.log({level:"debug"},e)}Conslole(e,t){t?process.stderr.write(e):process.stdout.write(e)}File(e,t){t&&_.appendFileSync(this.errorFile,e,"utf-8"),_.appendFileSync(this.logFile,e,"utf-8")}Push(e){sc.pushValue+=e}createLogFile(){const e=nc("./logs");_.existsSync(e)||_.mkdirSync(e)}}const oc=new sc({console:"debug",file:"debug",push:"debug"});function ac(e){try{const t=n.unzipSync(Buffer.from(e,"base64")).toString();try{return decodeURIComponent(function(e){return e.replace(/\\u([\d\w]{4})/gi,((e,t)=>String.fromCodePoint(parseInt(t,16))))}(t))}catch(e){return unescape(t)}}catch(e){throw new Error("Error: 当前字符串不能被Gzip解压")}}class rc{static configFileName=function(){const e=Zr()?"cat_bili_config":"config",t=".json",{BILITOOLS_FILE_NAME:i}=process.env;return i?i.endsWith(t)?i:`${i}.json`:e+t}();static isQingLongPanel=Zr()}var cc={Space_Separator:/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,ID_Start:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,ID_Continue:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},pc={isSpaceSeparator:e=>"string"==typeof e&&cc.Space_Separator.test(e),isIdStartChar:e=>"string"==typeof e&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||"$"===e||"_"===e||cc.ID_Start.test(e)),isIdContinueChar:e=>"string"==typeof e&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"$"===e||"_"===e||"‌"===e||"‍"===e||cc.ID_Continue.test(e)),isDigit:e=>"string"==typeof e&&/[0-9]/.test(e),isHexDigit:e=>"string"==typeof e&&/[0-9A-Fa-f]/.test(e)};let uc,lc,dc,hc,mc,fc,gc,vc,xc;function yc(e,t,i){const n=e[t];if(null!=n&&"object"==typeof n)for(const e in n){const t=yc(n,e,i);void 0===t?delete n[e]:n[e]=t}return i.call(e,t,n)}let bc,wc,_c,Dc,Ec;function Cc(){for(bc="default",wc="",_c=!1,Dc=1;;){Ec=Ac();const e=Sc[bc]();if(e)return e}}function Ac(){if(uc[hc])return String.fromCodePoint(uc.codePointAt(hc))}function kc(){const e=Ac();return"\n"===e?(mc++,fc=0):e?fc+=e.length:fc++,e&&(hc+=e.length),e}const Sc={default(){switch(Ec){case"\t":case"\v":case"\f":case" ":case" ":case"\ufeff":case"\n":case"\r":case"\u2028":case"\u2029":return void kc();case"/":return kc(),void(bc="comment");case void 0:return kc(),Fc("eof")}if(!pc.isSpaceSeparator(Ec))return Sc[lc]();kc()},comment(){switch(Ec){case"*":return kc(),void(bc="multiLineComment");case"/":return kc(),void(bc="singleLineComment")}throw jc(kc())},multiLineComment(){switch(Ec){case"*":return kc(),void(bc="multiLineCommentAsterisk");case void 0:throw jc(kc())}kc()},multiLineCommentAsterisk(){switch(Ec){case"*":return void kc();case"/":return kc(),void(bc="default");case void 0:throw jc(kc())}kc(),bc="multiLineComment"},singleLineComment(){switch(Ec){case"\n":case"\r":case"\u2028":case"\u2029":return kc(),void(bc="default");case void 0:return kc(),Fc("eof")}kc()},value(){switch(Ec){case"{":case"[":return Fc("punctuator",kc());case"n":return kc(),Tc("ull"),Fc("null",null);case"t":return kc(),Tc("rue"),Fc("boolean",!0);case"f":return kc(),Tc("alse"),Fc("boolean",!1);case"-":case"+":return"-"===kc()&&(Dc=-1),void(bc="sign");case".":return wc=kc(),void(bc="decimalPointLeading");case"0":return wc=kc(),void(bc="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return wc=kc(),void(bc="decimalInteger");case"I":return kc(),Tc("nfinity"),Fc("numeric",1/0);case"N":return kc(),Tc("aN"),Fc("numeric",NaN);case'"':case"'":return _c='"'===kc(),wc="",void(bc="string")}throw jc(kc())},identifierNameStartEscape(){if("u"!==Ec)throw jc(kc());kc();const e=Bc();switch(e){case"$":case"_":break;default:if(!pc.isIdStartChar(e))throw Lc()}wc+=e,bc="identifierName"},identifierName(){switch(Ec){case"$":case"_":case"‌":case"‍":return void(wc+=kc());case"\\":return kc(),void(bc="identifierNameEscape")}if(!pc.isIdContinueChar(Ec))return Fc("identifier",wc);wc+=kc()},identifierNameEscape(){if("u"!==Ec)throw jc(kc());kc();const e=Bc();switch(e){case"$":case"_":case"‌":case"‍":break;default:if(!pc.isIdContinueChar(e))throw Lc()}wc+=e,bc="identifierName"},sign(){switch(Ec){case".":return wc=kc(),void(bc="decimalPointLeading");case"0":return wc=kc(),void(bc="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return wc=kc(),void(bc="decimalInteger");case"I":return kc(),Tc("nfinity"),Fc("numeric",Dc*(1/0));case"N":return kc(),Tc("aN"),Fc("numeric",NaN)}throw jc(kc())},zero(){switch(Ec){case".":return wc+=kc(),void(bc="decimalPoint");case"e":case"E":return wc+=kc(),void(bc="decimalExponent");case"x":case"X":return wc+=kc(),void(bc="hexadecimal")}return Fc("numeric",0*Dc)},decimalInteger(){switch(Ec){case".":return wc+=kc(),void(bc="decimalPoint");case"e":case"E":return wc+=kc(),void(bc="decimalExponent")}if(!pc.isDigit(Ec))return Fc("numeric",Dc*Number(wc));wc+=kc()},decimalPointLeading(){if(pc.isDigit(Ec))return wc+=kc(),void(bc="decimalFraction");throw jc(kc())},decimalPoint(){switch(Ec){case"e":case"E":return wc+=kc(),void(bc="decimalExponent")}return pc.isDigit(Ec)?(wc+=kc(),void(bc="decimalFraction")):Fc("numeric",Dc*Number(wc))},decimalFraction(){switch(Ec){case"e":case"E":return wc+=kc(),void(bc="decimalExponent")}if(!pc.isDigit(Ec))return Fc("numeric",Dc*Number(wc));wc+=kc()},decimalExponent(){switch(Ec){case"+":case"-":return wc+=kc(),void(bc="decimalExponentSign")}if(pc.isDigit(Ec))return wc+=kc(),void(bc="decimalExponentInteger");throw jc(kc())},decimalExponentSign(){if(pc.isDigit(Ec))return wc+=kc(),void(bc="decimalExponentInteger");throw jc(kc())},decimalExponentInteger(){if(!pc.isDigit(Ec))return Fc("numeric",Dc*Number(wc));wc+=kc()},hexadecimal(){if(pc.isHexDigit(Ec))return wc+=kc(),void(bc="hexadecimalInteger");throw jc(kc())},hexadecimalInteger(){if(!pc.isHexDigit(Ec))return Fc("numeric",Dc*Number(wc));wc+=kc()},string(){switch(Ec){case"\\":return kc(),void(wc+=function(){switch(Ac()){case"b":return kc(),"\b";case"f":return kc(),"\f";case"n":return kc(),"\n";case"r":return kc(),"\r";case"t":return kc(),"\t";case"v":return kc(),"\v";case"0":if(kc(),pc.isDigit(Ac()))throw jc(kc());return"\0";case"x":return kc(),function(){let e="",t=Ac();if(!pc.isHexDigit(t))throw jc(kc());if(e+=kc(),t=Ac(),!pc.isHexDigit(t))throw jc(kc());return e+=kc(),String.fromCodePoint(parseInt(e,16))}();case"u":return kc(),Bc();case"\n":case"\u2028":case"\u2029":return kc(),"";case"\r":return kc(),"\n"===Ac()&&kc(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case void 0:throw jc(kc())}return kc()}());case'"':return _c?(kc(),Fc("string",wc)):void(wc+=kc());case"'":return _c?void(wc+=kc()):(kc(),Fc("string",wc));case"\n":case"\r":throw jc(kc());case"\u2028":case"\u2029":!function(e){console.warn(`JSON5: '${Nc(e)}' in strings is not valid ECMAScript; consider escaping`)}(Ec);break;case void 0:throw jc(kc())}wc+=kc()},start(){switch(Ec){case"{":case"[":return Fc("punctuator",kc())}bc="value"},beforePropertyName(){switch(Ec){case"$":case"_":return wc=kc(),void(bc="identifierName");case"\\":return kc(),void(bc="identifierNameStartEscape");case"}":return Fc("punctuator",kc());case'"':case"'":return _c='"'===kc(),void(bc="string")}if(pc.isIdStartChar(Ec))return wc+=kc(),void(bc="identifierName");throw jc(kc())},afterPropertyName(){if(":"===Ec)return Fc("punctuator",kc());throw jc(kc())},beforePropertyValue(){bc="value"},afterPropertyValue(){switch(Ec){case",":case"}":return Fc("punctuator",kc())}throw jc(kc())},beforeArrayValue(){if("]"===Ec)return Fc("punctuator",kc());bc="value"},afterArrayValue(){switch(Ec){case",":case"]":return Fc("punctuator",kc())}throw jc(kc())},end(){throw jc(kc())}};function Fc(e,t){return{type:e,value:t,line:mc,column:fc}}function Tc(e){for(const t of e){if(Ac()!==t)throw jc(kc());kc()}}function Bc(){let e="",t=4;for(;t-- >0;){const t=Ac();if(!pc.isHexDigit(t))throw jc(kc());e+=kc()}return String.fromCodePoint(parseInt(e,16))}const Oc={start(){if("eof"===gc.type)throw Rc();Ic()},beforePropertyName(){switch(gc.type){case"identifier":case"string":return vc=gc.value,void(lc="afterPropertyName");case"punctuator":return void Pc();case"eof":throw Rc()}},afterPropertyName(){if("eof"===gc.type)throw Rc();lc="beforePropertyValue"},beforePropertyValue(){if("eof"===gc.type)throw Rc();Ic()},beforeArrayValue(){if("eof"===gc.type)throw Rc();"punctuator"!==gc.type||"]"!==gc.value?Ic():Pc()},afterPropertyValue(){if("eof"===gc.type)throw Rc();switch(gc.value){case",":return void(lc="beforePropertyName");case"}":Pc()}},afterArrayValue(){if("eof"===gc.type)throw Rc();switch(gc.value){case",":return void(lc="beforeArrayValue");case"]":Pc()}},end(){}};function Ic(){let e;switch(gc.type){case"punctuator":switch(gc.value){case"{":e={};break;case"[":e=[]}break;case"null":case"boolean":case"numeric":case"string":e=gc.value}if(void 0===xc)xc=e;else{const t=dc[dc.length-1];Array.isArray(t)?t.push(e):t[vc]=e}if(null!==e&&"object"==typeof e)dc.push(e),lc=Array.isArray(e)?"beforeArrayValue":"beforePropertyName";else{const e=dc[dc.length-1];lc=null==e?"end":Array.isArray(e)?"afterArrayValue":"afterPropertyValue"}}function Pc(){dc.pop();const e=dc[dc.length-1];lc=null==e?"end":Array.isArray(e)?"afterArrayValue":"afterPropertyValue"}function jc(e){return Hc(void 0===e?`JSON5: invalid end of input at ${mc}:${fc}`:`JSON5: invalid character '${Nc(e)}' at ${mc}:${fc}`)}function Rc(){return Hc(`JSON5: invalid end of input at ${mc}:${fc}`)}function Lc(){return fc-=5,Hc(`JSON5: invalid identifier character at ${mc}:${fc}`)}function Nc(e){const t={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(t[e])return t[e];if(e<" "){const t=e.charCodeAt(0).toString(16);return"\\x"+("00"+t).substring(t.length)}return e}function Hc(e){const t=new SyntaxError(e);return t.lineNumber=mc,t.columnNumber=fc,t}const $c={parse:function(e,t){uc=String(e),lc="start",dc=[],hc=0,mc=1,fc=0,gc=void 0,vc=void 0,xc=void 0;do{gc=Cc(),Oc[lc]()}while("eof"!==gc.type);return"function"==typeof t?yc({"":xc},"",t):xc},stringify:function(e,t,i){const n=[];let s,o,a,r="",c="";if(null==t||"object"!=typeof t||Array.isArray(t)||(i=t.space,a=t.quote,t=t.replacer),"function"==typeof t)o=t;else if(Array.isArray(t)){s=[];for(const e of t){let t;"string"==typeof e?t=e:("number"==typeof e||e instanceof String||e instanceof Number)&&(t=String(e)),void 0!==t&&s.indexOf(t)<0&&s.push(t)}}return i instanceof Number?i=Number(i):i instanceof String&&(i=String(i)),"number"==typeof i?i>0&&(i=Math.min(10,Math.floor(i)),c="          ".substr(0,i)):"string"==typeof i&&(c=i.substr(0,10)),p("",{"":e});function p(e,t){let i=t[e];switch(null!=i&&("function"==typeof i.toJSON5?i=i.toJSON5(e):"function"==typeof i.toJSON&&(i=i.toJSON(e))),o&&(i=o.call(t,e,i)),i instanceof Number?i=Number(i):i instanceof String?i=String(i):i instanceof Boolean&&(i=i.valueOf()),i){case null:return"null";case!0:return"true";case!1:return"false"}return"string"==typeof i?u(i):"number"==typeof i?String(i):"object"==typeof i?Array.isArray(i)?function(e){if(n.indexOf(e)>=0)throw TypeError("Converting circular structure to JSON5");n.push(e);let t=r;r+=c;let i,s=[];for(let t=0;t<e.length;t++){const i=p(String(t),e);s.push(void 0!==i?i:"null")}if(0===s.length)i="[]";else if(""===c){i="["+s.join(",")+"]"}else{let e=",\n"+r,n=s.join(e);i="[\n"+r+n+",\n"+t+"]"}return n.pop(),r=t,i}(i):function(e){if(n.indexOf(e)>=0)throw TypeError("Converting circular structure to JSON5");n.push(e);let t=r;r+=c;let i,o=s||Object.keys(e),a=[];for(const t of o){const i=p(t,e);if(void 0!==i){let e=l(t)+":";""!==c&&(e+=" "),e+=i,a.push(e)}}if(0===a.length)i="{}";else{let e;if(""===c)e=a.join(","),i="{"+e+"}";else{let n=",\n"+r;e=a.join(n),i="{\n"+r+e+",\n"+t+"}"}}return n.pop(),r=t,i}(i):void 0}function u(e){const t={"'":.1,'"':.2},i={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let n="";for(let s=0;s<e.length;s++){const o=e[s];switch(o){case"'":case'"':t[o]++,n+=o;continue;case"\0":if(pc.isDigit(e[s+1])){n+="\\x00";continue}}if(i[o])n+=i[o];else if(o<" "){let e=o.charCodeAt(0).toString(16);n+="\\x"+("00"+e).substring(e.length)}else n+=o}const s=a||Object.keys(t).reduce(((e,i)=>t[e]<t[i]?e:i));return n=n.replace(new RegExp(s,"g"),i[s]),s+n+s}function l(e){if(0===e.length)return u(e);const t=String.fromCodePoint(e.codePointAt(0));if(!pc.isIdStartChar(t))return u(e);for(let i=t.length;i<e.length;i++)if(!pc.isIdContinueChar(String.fromCodePoint(e.codePointAt(i))))return u(e);return e}}};var Uc=$c;const qc=Uc||Object.freeze({__proto__:null,default:Uc});function Mc(e){try{let i;if((t.existsSync(e)||t.existsSync(e+="5"))&&(i=t.readFileSync(e,"utf-8")),!i)return;return oc.verbose(`读取配置文件 ${e}`),qc.parse(i)}catch(e){!function(e){if(!rr(e))return;if(e.includes("SyntaxError: JSON5"))throw oc.error(e),new SyntaxError("配置文件存在，但是无法解析！可能 JSON5 格式不正确！");throw new Error(e)}(e.message)}}const zc=e=>b.resolve(process.cwd(),e),Gc=e=>b.resolve(__dirname,"../",e),Vc=Array.from(new Set([zc("./config/config.dev.json"),zc(`./config/${rc.configFileName}`),zc(`./${rc.configFileName}`),Gc(`./config/${rc.configFileName}`),Gc(`./${rc.configFileName}`)])),Wc=["./config.json",zc("./config/config.json")];function Kc(e){let t;const i=Array.isArray(e);if(t=i?e:e.account.filter((e=>e.cookie)),0===t.length)return;if(rc.isQingLongPanel)return function(e){const t=process.argv.find((e=>e.includes("--item")||e.includes("-i")||e.includes("-I")));if(!t)return e[0];const i=Number(t.split("=")[1])-1;return!i||i>=e.length||i<0?(oc.warn("似乎想要指定一个不存在的用户，我们将指定第一个用户"),e[0]):e[i]}(t);oc.warn("在单用户场景下配置了多用户，我们将放弃多余的配置");const n=t[0];return i||(n.message=Object.assign(e.message||{},n.message)),n}function Jc(){if(globalThis.BILITOOLS_CONFIG)return globalThis.BILITOOLS_CONFIG;rc.isQingLongPanel&&Vc.splice(0,1,...Wc);for(let e=0;e<Vc.length;e++){const t=Mc(Vc[e]);if(t)return t}return(()=>{const{BILITOOLS_CONFIG:e,BILI_SCF_CONFIG:t,BILI_CONFIG:i}=process.env,n=e||t||i;if(n)try{return qc.parse(ac(n))}catch{throw new Error("环境中的配置不是有效的 JSON 字符串！")}})()}function Qc(e){if(!e)throw new Error("获取配置失败！未找到配置文件！");if(function(e){if(Array.isArray(e))return!0;return Boolean(e.account&&e.account.length)}(e)){const t=Kc(e);if(t)return t}if(!e.cookie)throw new Error("配置文件中没有 cookie！");return e}function Xc(e){return e?e.split("; ").map((e=>e.split("="))):[]}function Yc(e,t){return e?t&&0!==t.length?function(e){const t=Object.keys(e).reduce(((t,i)=>t+`${i}=${e[i]}; `),"");return t.substring(0,t.length-2||0)}(function(e,t){const i=Xc(null==t?void 0:t[0]).filter((e=>2===e.length)),n=Xc(e).concat(i).filter((e=>2===e.length)),s={};for(const e of n)s[e[0]]?s[e[0]]=e[1]:Object.defineProperty(s,e[0],{value:e[1],enumerable:!0,writable:!0});return s}(e,t)):e:""}function Zc(e,t){if(!e)return null;const i=`(?:^|)${t}=([^;]*)(?:;|$)`,n=e.match(i);return n?n[1]:null}const ep={cookie:"",message:{email:{host:"smtp.163.com",port:465},pushplusToken:process.env.PUSHPLUS_TOKEN,api:void 0},function:{silver2Coin:!0,liveSignTask:!0,addCoins:!0,mangaSign:!1,shareAndWatch:!0,supGroupSign:!1,liveSendMessage:!1,taskReward:!0,charging:!1,getVipPrivilege:!1,giveGift:!1,matchGame:!1,liveLottery:!1,liveRedPack:!1,liveIntimacy:!1},apiDelay:[2,6],userAgent:"",dailyRunTime:"17:30:00-23:40:00",targetLevel:void 0,stayCoins:void 0,targetCoins:void 0,customizeUp:void 0,giftUp:void 0,coinRetryNum:void 0,chargeUpId:void 0,chargePresetTime:void 0,matchCoins:void 0,matchSelection:void 0,matchDiff:void 0,match:{coins:5,selection:1,diff:0},charge:{mid:0,presetTime:31},gift:{mids:[]},coin:{customizeUp:[],retryNum:4,targetLevel:6,stayCoins:0,targetCoins:5},sls:{name:"",description:"",region:"ap-chengdu",dailyRunTime:"17:30:00-23:40:00"},lottery:{excludeAward:["舰","船","航海","代金券","优惠券","自拍","照","写真","图","提督","车车一局","再来一局","游戏道具"],includeAward:["谢"],blackUid:[65566781,1277481241,1643654862,603676925],isMoveTag:!1,moveTag:"天选时刻",pageNum:0,actFollowMsg:"delete"},intimacy:{liveSendMessage:!0,liveShare:!0,liveLike:!0,whiteList:[],blackList:[]},BILIJCT:"",USERID:0};function tp(){return mr(ep,!0)}function ip(e){return function(e){!function(e){e.BILIJCT=function(e){return Zc(e,"bili_jct")||""}(e.cookie),e.USERID=function(e){return Number(Zc(e,"DedeUserID"))||0}(e.cookie)}(e);const{coin:t,gift:i,charge:n}=e;cr(e.apiDelay)?e.apiDelay=xr(e.apiDelay):e.apiDelay=[Number(e.apiDelay)];t.customizeUp=xr(t.customizeUp),i.mids=xr(i.mids),0===i.mids.length&&(i.mids=t.customizeUp);n.mid||(n.mid=e.USERID);return e}(function(e){return Object.keys(np).forEach((t=>{if(void 0!==e[t]){const[i,n]=np[t];e[i]=e[i]||{},e[i][n]=e[t]}delete e[t]})),e}(fr(tp(),e)))}const np={targetLevel:["coin","targetLevel"],stayCoins:["coin","stayCoins"],targetCoins:["coin","targetCoins"],customizeUp:["coin","customizeUp"],coinRetryNum:["coin","retryNum"],giftUp:["gift","mids"],chargeUpId:["charge","mid"],chargePresetTime:["charge","presetTime"],matchCoins:["match","coins"],matchSelection:["match","selection"],matchDiff:["match","diff"]};class sp{constructor(e){this.config=e,this.COOKIE=e.cookie,this.BILIJCT=e.BILIJCT,this.USERID=e.USERID,this.USER_AGENT=e.userAgent,this.BILI_API_DELAY=e.apiDelay;const t=e.message;this.MESSAGE_API=null==t?void 0:t.api,this.PUSHPLUS_TOKEN=t.pushplusToken;const i=e.coin;this.BILI_CUSTOMIZE_UP=i.customizeUp,this.BILI_COIN_RETRY_NUM=i.retryNum,this.BILI_TARGET_LEVEL=i.targetLevel,this.BILI_STAY_COINS=i.stayCoins,this.BILI_TARGET_COINS=i.targetCoins;const n=e.gift;this.BILI_GIFT_UP=n.mids;const s=e.charge;this.CHARGE_ID=s.mid,this.CHARGE_PRESET_TIME=s.presetTime;const o=e.match;this.MATCH_COINS=o.coins,this.MATCH_SELECTION=o.selection,this.MATCH_DIFF=o.diff;const a=e.lottery;this.LOTTERY_EXCLUDE=a.excludeAward,this.LOTTERY_INCLUDE=a.includeAward,this.LOTTERY_UP_BLACKLIST=a.blackUid,this.LOTTERY_MOVE_TAG=a.moveTag,this.LOTTERY_PAGE_NUM=a.pageNum}}let op;const ap=new Proxy({},{get:(e,t)=>(op||cp(),Reflect.get(op,t)),set:(e,t,i)=>"config"===t&&i?(cp(i),!0):Reflect.set(op,t,i)});let rp=null;function cp(e){e||(e=Qc(Jc()));const t=ip(e);op={...new sp(Qc(t)),...t},rp=class extends class{static money=0;static coinsTask=5;static share=!1;static watch=!1;static currentStartFun=0;static bCoinCouponBalance=0;static vipType=0;static userLevel=0}{},rp.coinsTask=op.BILI_TARGET_COINS}var pp={exports:{}},up={},lp={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const i=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];const n=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Blob","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","FormData","URLSearchParams","HTMLElement",...i];const s=["null","undefined","string","number","bigint","boolean","symbol"];function o(e){return t=>typeof t===e}const{toString:a}=Object.prototype,r=e=>{const t=a.call(e).slice(8,-1);return/HTML\w+Element/.test(t)&&p.domElement(e)?"HTMLElement":function(e){return n.includes(e)}(t)?t:void 0},c=e=>t=>r(t)===e;function p(e){if(null===e)return"null";switch(typeof e){case"undefined":return"undefined";case"string":return"string";case"number":return"number";case"boolean":return"boolean";case"function":return"Function";case"bigint":return"bigint";case"symbol":return"symbol"}if(p.observable(e))return"Observable";if(p.array(e))return"Array";if(p.buffer(e))return"Buffer";const t=r(e);if(t)return t;if(e instanceof String||e instanceof Boolean||e instanceof Number)throw new TypeError("Please don't use object wrappers for primitive types");return"Object"}p.undefined=o("undefined"),p.string=o("string");const u=o("number");p.number=e=>u(e)&&!p.nan(e),p.bigint=o("bigint"),p.function_=o("function"),p.null_=e=>null===e,p.class_=e=>p.function_(e)&&e.toString().startsWith("class "),p.boolean=e=>!0===e||!1===e,p.symbol=o("symbol"),p.numericString=e=>p.string(e)&&!p.emptyStringOrWhitespace(e)&&!Number.isNaN(Number(e)),p.array=(e,t)=>!!Array.isArray(e)&&(!p.function_(t)||e.every(t)),p.buffer=e=>{var t,i,n,s;return null!==(s=null===(n=null===(i=null===(t=e)||void 0===t?void 0:t.constructor)||void 0===i?void 0:i.isBuffer)||void 0===n?void 0:n.call(i,e))&&void 0!==s&&s},p.blob=e=>c("Blob")(e),p.nullOrUndefined=e=>p.null_(e)||p.undefined(e),p.object=e=>!p.null_(e)&&("object"==typeof e||p.function_(e)),p.iterable=e=>{var t;return p.function_(null===(t=e)||void 0===t?void 0:t[Symbol.iterator])},p.asyncIterable=e=>{var t;return p.function_(null===(t=e)||void 0===t?void 0:t[Symbol.asyncIterator])},p.generator=e=>{var t,i;return p.iterable(e)&&p.function_(null===(t=e)||void 0===t?void 0:t.next)&&p.function_(null===(i=e)||void 0===i?void 0:i.throw)},p.asyncGenerator=e=>p.asyncIterable(e)&&p.function_(e.next)&&p.function_(e.throw),p.nativePromise=e=>c("Promise")(e);p.promise=e=>p.nativePromise(e)||(e=>{var t,i;return p.function_(null===(t=e)||void 0===t?void 0:t.then)&&p.function_(null===(i=e)||void 0===i?void 0:i.catch)})(e),p.generatorFunction=c("GeneratorFunction"),p.asyncGeneratorFunction=e=>"AsyncGeneratorFunction"===r(e),p.asyncFunction=e=>"AsyncFunction"===r(e),p.boundFunction=e=>p.function_(e)&&!e.hasOwnProperty("prototype"),p.regExp=c("RegExp"),p.date=c("Date"),p.error=c("Error"),p.map=e=>c("Map")(e),p.set=e=>c("Set")(e),p.weakMap=e=>c("WeakMap")(e),p.weakSet=e=>c("WeakSet")(e),p.int8Array=c("Int8Array"),p.uint8Array=c("Uint8Array"),p.uint8ClampedArray=c("Uint8ClampedArray"),p.int16Array=c("Int16Array"),p.uint16Array=c("Uint16Array"),p.int32Array=c("Int32Array"),p.uint32Array=c("Uint32Array"),p.float32Array=c("Float32Array"),p.float64Array=c("Float64Array"),p.bigInt64Array=c("BigInt64Array"),p.bigUint64Array=c("BigUint64Array"),p.arrayBuffer=c("ArrayBuffer"),p.sharedArrayBuffer=c("SharedArrayBuffer"),p.dataView=c("DataView"),p.enumCase=(e,t)=>Object.values(t).includes(e),p.directInstanceOf=(e,t)=>Object.getPrototypeOf(e)===t.prototype,p.urlInstance=e=>c("URL")(e),p.urlString=e=>{if(!p.string(e))return!1;try{return new URL(e),!0}catch(e){return!1}},p.truthy=e=>Boolean(e),p.falsy=e=>!e,p.nan=e=>Number.isNaN(e),p.primitive=e=>p.null_(e)||function(e){return s.includes(e)}(typeof e),p.integer=e=>Number.isInteger(e),p.safeInteger=e=>Number.isSafeInteger(e),p.plainObject=e=>{if("[object Object]"!==a.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.getPrototypeOf({})},p.typedArray=e=>function(e){return i.includes(e)}(r(e));p.arrayLike=e=>!p.nullOrUndefined(e)&&!p.function_(e)&&(e=>p.safeInteger(e)&&e>=0)(e.length),p.inRange=(e,t)=>{if(p.number(t))return e>=Math.min(0,t)&&e<=Math.max(t,0);if(p.array(t)&&2===t.length)return e>=Math.min(...t)&&e<=Math.max(...t);throw new TypeError(`Invalid range: ${JSON.stringify(t)}`)};const l=["innerHTML","ownerDocument","style","attributes","nodeValue"];p.domElement=e=>p.object(e)&&1===e.nodeType&&p.string(e.nodeName)&&!p.plainObject(e)&&l.every((t=>t in e)),p.observable=e=>{var t,i,n,s;return!!e&&(e===(null===(i=(t=e)[Symbol.observable])||void 0===i?void 0:i.call(t))||e===(null===(s=(n=e)["@@observable"])||void 0===s?void 0:s.call(n)))},p.nodeStream=e=>p.object(e)&&p.function_(e.pipe)&&!p.observable(e),p.infinite=e=>e===1/0||e===-1/0;const d=e=>t=>p.integer(t)&&Math.abs(t%2)===e;p.evenInteger=d(0),p.oddInteger=d(1),p.emptyArray=e=>p.array(e)&&0===e.length,p.nonEmptyArray=e=>p.array(e)&&e.length>0,p.emptyString=e=>p.string(e)&&0===e.length;p.emptyStringOrWhitespace=e=>p.emptyString(e)||(e=>p.string(e)&&!/\S/.test(e))(e),p.nonEmptyString=e=>p.string(e)&&e.length>0,p.nonEmptyStringAndNotWhitespace=e=>p.string(e)&&!p.emptyStringOrWhitespace(e),p.emptyObject=e=>p.object(e)&&!p.map(e)&&!p.set(e)&&0===Object.keys(e).length,p.nonEmptyObject=e=>p.object(e)&&!p.map(e)&&!p.set(e)&&Object.keys(e).length>0,p.emptySet=e=>p.set(e)&&0===e.size,p.nonEmptySet=e=>p.set(e)&&e.size>0,p.emptyMap=e=>p.map(e)&&0===e.size,p.nonEmptyMap=e=>p.map(e)&&e.size>0,p.propertyKey=e=>p.any([p.string,p.number,p.symbol],e),p.formData=e=>c("FormData")(e),p.urlSearchParams=e=>c("URLSearchParams")(e);const h=(e,t,i)=>{if(!p.function_(t))throw new TypeError(`Invalid predicate: ${JSON.stringify(t)}`);if(0===i.length)throw new TypeError("Invalid number of values");return e.call(i,t)};p.any=(e,...t)=>(p.array(e)?e:[e]).some((e=>h(Array.prototype.some,e,t))),p.all=(e,...t)=>h(Array.prototype.every,e,t);const m=(e,t,i,n={})=>{if(!e){const{multipleValues:e}=n,s=e?`received values of types ${[...new Set(i.map((e=>`\`${p(e)}\``)))].join(", ")}`:`received value of type \`${p(i)}\``;throw new TypeError(`Expected value which is \`${t}\`, ${s}.`)}};t.assert={undefined:e=>m(p.undefined(e),"undefined",e),string:e=>m(p.string(e),"string",e),number:e=>m(p.number(e),"number",e),bigint:e=>m(p.bigint(e),"bigint",e),function_:e=>m(p.function_(e),"Function",e),null_:e=>m(p.null_(e),"null",e),class_:e=>m(p.class_(e),"Class",e),boolean:e=>m(p.boolean(e),"boolean",e),symbol:e=>m(p.symbol(e),"symbol",e),numericString:e=>m(p.numericString(e),"string with a number",e),array:(e,t)=>{m(p.array(e),"Array",e),t&&e.forEach(t)},buffer:e=>m(p.buffer(e),"Buffer",e),blob:e=>m(p.blob(e),"Blob",e),nullOrUndefined:e=>m(p.nullOrUndefined(e),"null or undefined",e),object:e=>m(p.object(e),"Object",e),iterable:e=>m(p.iterable(e),"Iterable",e),asyncIterable:e=>m(p.asyncIterable(e),"AsyncIterable",e),generator:e=>m(p.generator(e),"Generator",e),asyncGenerator:e=>m(p.asyncGenerator(e),"AsyncGenerator",e),nativePromise:e=>m(p.nativePromise(e),"native Promise",e),promise:e=>m(p.promise(e),"Promise",e),generatorFunction:e=>m(p.generatorFunction(e),"GeneratorFunction",e),asyncGeneratorFunction:e=>m(p.asyncGeneratorFunction(e),"AsyncGeneratorFunction",e),asyncFunction:e=>m(p.asyncFunction(e),"AsyncFunction",e),boundFunction:e=>m(p.boundFunction(e),"Function",e),regExp:e=>m(p.regExp(e),"RegExp",e),date:e=>m(p.date(e),"Date",e),error:e=>m(p.error(e),"Error",e),map:e=>m(p.map(e),"Map",e),set:e=>m(p.set(e),"Set",e),weakMap:e=>m(p.weakMap(e),"WeakMap",e),weakSet:e=>m(p.weakSet(e),"WeakSet",e),int8Array:e=>m(p.int8Array(e),"Int8Array",e),uint8Array:e=>m(p.uint8Array(e),"Uint8Array",e),uint8ClampedArray:e=>m(p.uint8ClampedArray(e),"Uint8ClampedArray",e),int16Array:e=>m(p.int16Array(e),"Int16Array",e),uint16Array:e=>m(p.uint16Array(e),"Uint16Array",e),int32Array:e=>m(p.int32Array(e),"Int32Array",e),uint32Array:e=>m(p.uint32Array(e),"Uint32Array",e),float32Array:e=>m(p.float32Array(e),"Float32Array",e),float64Array:e=>m(p.float64Array(e),"Float64Array",e),bigInt64Array:e=>m(p.bigInt64Array(e),"BigInt64Array",e),bigUint64Array:e=>m(p.bigUint64Array(e),"BigUint64Array",e),arrayBuffer:e=>m(p.arrayBuffer(e),"ArrayBuffer",e),sharedArrayBuffer:e=>m(p.sharedArrayBuffer(e),"SharedArrayBuffer",e),dataView:e=>m(p.dataView(e),"DataView",e),enumCase:(e,t)=>m(p.enumCase(e,t),"EnumCase",e),urlInstance:e=>m(p.urlInstance(e),"URL",e),urlString:e=>m(p.urlString(e),"string with a URL",e),truthy:e=>m(p.truthy(e),"truthy",e),falsy:e=>m(p.falsy(e),"falsy",e),nan:e=>m(p.nan(e),"NaN",e),primitive:e=>m(p.primitive(e),"primitive",e),integer:e=>m(p.integer(e),"integer",e),safeInteger:e=>m(p.safeInteger(e),"integer",e),plainObject:e=>m(p.plainObject(e),"plain object",e),typedArray:e=>m(p.typedArray(e),"TypedArray",e),arrayLike:e=>m(p.arrayLike(e),"array-like",e),domElement:e=>m(p.domElement(e),"HTMLElement",e),observable:e=>m(p.observable(e),"Observable",e),nodeStream:e=>m(p.nodeStream(e),"Node.js Stream",e),infinite:e=>m(p.infinite(e),"infinite number",e),emptyArray:e=>m(p.emptyArray(e),"empty array",e),nonEmptyArray:e=>m(p.nonEmptyArray(e),"non-empty array",e),emptyString:e=>m(p.emptyString(e),"empty string",e),emptyStringOrWhitespace:e=>m(p.emptyStringOrWhitespace(e),"empty string or whitespace",e),nonEmptyString:e=>m(p.nonEmptyString(e),"non-empty string",e),nonEmptyStringAndNotWhitespace:e=>m(p.nonEmptyStringAndNotWhitespace(e),"non-empty string and not whitespace",e),emptyObject:e=>m(p.emptyObject(e),"empty object",e),nonEmptyObject:e=>m(p.nonEmptyObject(e),"non-empty object",e),emptySet:e=>m(p.emptySet(e),"empty set",e),nonEmptySet:e=>m(p.nonEmptySet(e),"non-empty set",e),emptyMap:e=>m(p.emptyMap(e),"empty map",e),nonEmptyMap:e=>m(p.nonEmptyMap(e),"non-empty map",e),propertyKey:e=>m(p.propertyKey(e),"PropertyKey",e),formData:e=>m(p.formData(e),"FormData",e),urlSearchParams:e=>m(p.urlSearchParams(e),"URLSearchParams",e),evenInteger:e=>m(p.evenInteger(e),"even integer",e),oddInteger:e=>m(p.oddInteger(e),"odd integer",e),directInstanceOf:(e,t)=>m(p.directInstanceOf(e,t),"T",e),inRange:(e,t)=>m(p.inRange(e,t),"in range",e),any:(e,...t)=>m(p.any(e,...t),"predicate returns truthy for any value",t,{multipleValues:!0}),all:(e,...t)=>m(p.all(e,...t),"predicate returns truthy for all values",t,{multipleValues:!0})},Object.defineProperties(p,{class:{value:p.class_},function:{value:p.function_},null:{value:p.null_}}),Object.defineProperties(t.assert,{class:{value:t.assert.class_},function:{value:t.assert.function_},null:{value:t.assert.null_}}),t.default=p,e.exports=p,e.exports.default=p,e.exports.assert=t.assert}(lp,lp.exports);var dp,hp={},mp={exports:{}};var fp={},gp={},vp={exports:{}},xp={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const i=(e,t)=>{let i;if("function"==typeof t){i={connect:t}}else i=t;const n="function"==typeof i.connect,s="function"==typeof i.secureConnect,o="function"==typeof i.close,a=()=>{n&&i.connect(),function(e){return e.encrypted}(e)&&s&&(e.authorized?i.secureConnect():e.authorizationError||e.once("secureConnect",i.secureConnect)),o&&e.once("close",i.close)};e.writable&&!e.connecting?a():e.connecting?e.once("connect",a):e.destroyed&&o&&i.close(e._hadError)};t.default=i,e.exports=i,e.exports.default=i}(xp,xp.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const i=xp.exports,n=S.default,s=Number(process.versions.node.split(".")[0]),o=e=>{if(e.timings)return e.timings;const t={start:Date.now(),socket:void 0,lookup:void 0,connect:void 0,secureConnect:void 0,upload:void 0,response:void 0,end:void 0,error:void 0,abort:void 0,phases:{wait:void 0,dns:void 0,tcp:void 0,tls:void 0,request:void 0,firstByte:void 0,download:void 0,total:void 0}};e.timings=t;const o=e=>{const i=e.emit.bind(e);e.emit=(n,...s)=>("error"===n&&(t.error=Date.now(),t.phases.total=t.error-t.start,e.emit=i),i(n,...s))};o(e);const a=()=>{t.abort=Date.now(),(!t.response||s>=13)&&(t.phases.total=Date.now()-t.start)};e.prependOnceListener("abort",a);const r=e=>{if(t.socket=Date.now(),t.phases.wait=t.socket-t.start,n.types.isProxy(e))return;const s=()=>{t.lookup=Date.now(),t.phases.dns=t.lookup-t.socket};e.prependOnceListener("lookup",s),i.default(e,{connect:()=>{t.connect=Date.now(),void 0===t.lookup&&(e.removeListener("lookup",s),t.lookup=t.connect,t.phases.dns=t.lookup-t.socket),t.phases.tcp=t.connect-t.lookup},secureConnect:()=>{t.secureConnect=Date.now(),t.phases.tls=t.secureConnect-t.connect}})};e.socket?r(e.socket):e.prependOnceListener("socket",r);const c=()=>{var e;t.upload=Date.now(),t.phases.request=t.upload-(null!==(e=t.secureConnect)&&void 0!==e?e:t.connect)};return("boolean"==typeof e.writableFinished?!e.writableFinished:!e.finished||0!==e.outputSize||e.socket&&0!==e.socket.writableLength)?e.prependOnceListener("finish",c):c(),e.prependOnceListener("response",(e=>{t.response=Date.now(),t.phases.firstByte=t.response-t.upload,e.timings=t,o(e),e.prependOnceListener("end",(()=>{t.end=Date.now(),t.phases.download=t.end-t.response,t.phases.total=t.end-t.start})),e.prependOnceListener("aborted",a)})),t};t.default=o,e.exports=o,e.exports.default=o}(vp,vp.exports);var yp={exports:{}};const{V4MAPPED:bp,ADDRCONFIG:wp,ALL:_p,promises:{Resolver:Dp},lookup:Ep}=O.default,{promisify:Cp}=S.default,Ap=P.default,kp=Symbol("cacheableLookupCreateConnection"),Sp=Symbol("cacheableLookupInstance"),Fp=Symbol("expires"),Tp="number"==typeof _p,Bp=e=>{if(!e||"function"!=typeof e.createConnection)throw new Error("Expected an Agent instance as the first argument")},Op=()=>{let e=!1,t=!1;for(const i of Object.values(Ap.networkInterfaces()))for(const n of i)if(!n.internal&&("IPv6"===n.family?t=!0:e=!0,e&&t))return{has4:e,has6:t};return{has4:e,has6:t}},Ip={ttl:!0},Pp={all:!0};class jp{constructor({cache:e=new Map,maxTtl:t=1/0,fallbackDuration:i=3600,errorTtl:n=.15,resolver:s=new Dp,lookup:o=Ep}={}){if(this.maxTtl=t,this.errorTtl=n,this._cache=e,this._resolver=s,this._dnsLookup=Cp(o),this._resolver instanceof Dp?(this._resolve4=this._resolver.resolve4.bind(this._resolver),this._resolve6=this._resolver.resolve6.bind(this._resolver)):(this._resolve4=Cp(this._resolver.resolve4.bind(this._resolver)),this._resolve6=Cp(this._resolver.resolve6.bind(this._resolver))),this._iface=Op(),this._pending={},this._nextRemovalTime=!1,this._hostnamesToFallback=new Set,i<1)this._fallback=!1;else{this._fallback=!0;const e=setInterval((()=>{this._hostnamesToFallback.clear()}),1e3*i);e.unref&&e.unref()}this.lookup=this.lookup.bind(this),this.lookupAsync=this.lookupAsync.bind(this)}set servers(e){this.clear(),this._resolver.setServers(e)}get servers(){return this._resolver.getServers()}lookup(e,t,i){if("function"==typeof t?(i=t,t={}):"number"==typeof t&&(t={family:t}),!i)throw new Error("Callback must be a function.");this.lookupAsync(e,t).then((e=>{t.all?i(null,e):i(null,e.address,e.family,e.expires,e.ttl)}),i)}async lookupAsync(e,t={}){"number"==typeof t&&(t={family:t});let i=await this.query(e);if(6===t.family){const e=i.filter((e=>6===e.family));t.hints&bp&&(Tp&&t.hints&_p||0===e.length)?(e=>{for(const t of e)6!==t.family&&(t.address=`::ffff:${t.address}`,t.family=6)})(i):i=e}else 4===t.family&&(i=i.filter((e=>4===e.family)));if(t.hints&wp){const{_iface:e}=this;i=i.filter((t=>6===t.family?e.has6:e.has4))}if(0===i.length){const t=new Error(`cacheableLookup ENOTFOUND ${e}`);throw t.code="ENOTFOUND",t.hostname=e,t}return t.all?i:i[0]}async query(e){let t=await this._cache.get(e);if(!t){const i=this._pending[e];if(i)t=await i;else{const i=this.queryAndCache(e);this._pending[e]=i;try{t=await i}finally{delete this._pending[e]}}}return t=t.map((e=>({...e}))),t}async _resolve(e){const[t,i]=await Promise.all([this._resolve4(e,Ip),this._resolve6(e,Ip)].map((e=>(async e=>{try{return await e}catch(e){if("ENODATA"===e.code||"ENOTFOUND"===e.code)return[];throw e}})(e))));let n=0,s=0,o=0;const a=Date.now();for(const e of t)e.family=4,e.expires=a+1e3*e.ttl,n=Math.max(n,e.ttl);for(const e of i)e.family=6,e.expires=a+1e3*e.ttl,s=Math.max(s,e.ttl);return o=t.length>0?i.length>0?Math.min(n,s):n:s,{entries:[...t,...i],cacheTtl:o}}async _lookup(e){try{return{entries:await this._dnsLookup(e,{all:!0}),cacheTtl:0}}catch(e){return{entries:[],cacheTtl:0}}}async _set(e,t,i){if(this.maxTtl>0&&i>0){i=1e3*Math.min(i,this.maxTtl),t[Fp]=Date.now()+i;try{await this._cache.set(e,t,i)}catch(e){this.lookupAsync=async()=>{const t=new Error("Cache Error. Please recreate the CacheableLookup instance.");throw t.cause=e,t}}n=this._cache,Symbol.iterator in n&&this._tick(i)}var n}async queryAndCache(e){if(this._hostnamesToFallback.has(e))return this._dnsLookup(e,Pp);let t=await this._resolve(e);0===t.entries.length&&this._fallback&&(t=await this._lookup(e),0!==t.entries.length&&this._hostnamesToFallback.add(e));const i=0===t.entries.length?this.errorTtl:t.cacheTtl;return await this._set(e,t.entries,i),t.entries}_tick(e){const t=this._nextRemovalTime;(!t||e<t)&&(clearTimeout(this._removalTimeout),this._nextRemovalTime=e,this._removalTimeout=setTimeout((()=>{this._nextRemovalTime=!1;let e=1/0;const t=Date.now();for(const[i,n]of this._cache){const s=n[Fp];t>=s?this._cache.delete(i):s<e&&(e=s)}e!==1/0&&this._tick(e-t)}),e),this._removalTimeout.unref&&this._removalTimeout.unref())}install(e){if(Bp(e),kp in e)throw new Error("CacheableLookup has been already installed");e[kp]=e.createConnection,e[Sp]=this,e.createConnection=(t,i)=>("lookup"in t||(t.lookup=this.lookup),e[kp](t,i))}uninstall(e){if(Bp(e),e[kp]){if(e[Sp]!==this)throw new Error("The agent is not owned by this CacheableLookup instance");e.createConnection=e[kp],delete e[kp],delete e[Sp]}}updateInterfaceInfo(){const{_iface:e}=this;this._iface=Op(),(e.has4&&!this._iface.has4||e.has6&&!this._iface.has6)&&this._cache.clear()}clear(e){e?this._cache.delete(e):this._cache.clear()}}yp.exports=jp,yp.exports.default=jp;const Rp=(e,t)=>t.some((t=>t instanceof RegExp?t.test(e):t===e));var Lp=(e,t)=>{if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return((e,{stripHash:t})=>{const i=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!i)throw new Error(`Invalid URL: ${e}`);let{type:n,data:s,hash:o}=i.groups;const a=n.split(";");o=t?"":o;let r=!1;"base64"===a[a.length-1]&&(a.pop(),r=!0);const c=(a.shift()||"").toLowerCase(),p=a.map((e=>{let[t,i=""]=e.split("=").map((e=>e.trim()));return"charset"===t&&(i=i.toLowerCase(),"us-ascii"===i)?"":`${t}${i?`=${i}`:""}`})).filter(Boolean),u=[...p];return r&&u.push("base64"),(0!==u.length||c&&"text/plain"!==c)&&u.unshift(c),`data:${u.join(";")},${r?s.trim():s}${o?`#${o}`:""}`})(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");const i=e.startsWith("//");!i&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));const n=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&"https:"===n.protocol&&(n.protocol="http:"),t.forceHttps&&"http:"===n.protocol&&(n.protocol="https:"),t.stripAuthentication&&(n.username="",n.password=""),t.stripHash?n.hash="":t.stripTextFragment&&(n.hash=n.hash.replace(/#?:~:text.*?$/i,"")),n.pathname&&(n.pathname=n.pathname.replace(/(?<!\b(?:[a-z][a-z\d+\-.]{1,50}:))\/{2,}/g,"/")),n.pathname)try{n.pathname=decodeURI(n.pathname)}catch(e){}if(!0===t.removeDirectoryIndex&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let e=n.pathname.split("/");const i=e[e.length-1];Rp(i,t.removeDirectoryIndex)&&(e=e.slice(0,e.length-1),n.pathname=e.slice(1).join("/")+"/")}if(n.hostname&&(n.hostname=n.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)(?:[a-z\-\d]{1,63})\.(?:[a-z.\-\d]{2,63})$/.test(n.hostname)&&(n.hostname=n.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(const e of[...n.searchParams.keys()])Rp(e,t.removeQueryParameters)&&n.searchParams.delete(e);!0===t.removeQueryParameters&&(n.search=""),t.sortQueryParameters&&n.searchParams.sort(),t.removeTrailingSlash&&(n.pathname=n.pathname.replace(/\/$/,""));const s=e;return e=n.toString(),t.removeSingleSlash||"/"!==n.pathname||s.endsWith("/")||""!==n.hash||(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||"/"===n.pathname)&&""===n.hash&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),i&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e},Np={exports:{}},Hp={exports:{}},$p=function e(t,i){if(t&&i)return e(t)(i);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){n[e]=t[e]})),n;function n(){for(var e=new Array(arguments.length),i=0;i<e.length;i++)e[i]=arguments[i];var n=t.apply(this,e),s=e[e.length-1];return"function"==typeof n&&n!==s&&Object.keys(s).forEach((function(e){n[e]=s[e]})),n}};var Up=$p;function qp(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function Mp(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},i=e.name||"Function wrapped with `once`";return t.onceError=i+" shouldn't be called more than once",t.called=!1,t}Hp.exports=Up(qp),Hp.exports.strict=Up(Mp),qp.proto=qp((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return qp(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Mp(this)},configurable:!0})}));var zp=Hp.exports,Gp=function(){},Vp=function(e,t,i){if("function"==typeof t)return Vp(e,null,t);t||(t={}),i=zp(i||Gp);var n=e._writableState,s=e._readableState,o=t.readable||!1!==t.readable&&e.readable,a=t.writable||!1!==t.writable&&e.writable,r=!1,c=function(){e.writable||p()},p=function(){a=!1,o||i.call(e)},u=function(){o=!1,a||i.call(e)},l=function(t){i.call(e,t?new Error("exited with error code: "+t):null)},d=function(t){i.call(e,t)},h=function(){process.nextTick(m)},m=function(){if(!r)return(!o||s&&s.ended&&!s.destroyed)&&(!a||n&&n.ended&&!n.destroyed)?void 0:i.call(e,new Error("premature close"))},f=function(){e.req.on("finish",p)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(e)?a&&!n&&(e.on("end",c),e.on("close",c)):(e.on("complete",p),e.on("abort",h),e.req?f():e.on("request",f)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(e)&&e.on("exit",l),e.on("end",u),e.on("finish",p),!1!==t.error&&e.on("error",d),e.on("close",h),function(){r=!0,e.removeListener("complete",p),e.removeListener("abort",h),e.removeListener("request",f),e.req&&e.req.removeListener("finish",p),e.removeListener("end",c),e.removeListener("close",c),e.removeListener("finish",p),e.removeListener("exit",l),e.removeListener("end",u),e.removeListener("error",d),e.removeListener("close",h)}},Wp=Vp,Kp=Hp.exports,Jp=Wp,Qp=D.default,Xp=function(){},Yp=/^v?\.0/.test(process.version),Zp=function(e){return"function"==typeof e},eu=function(e,t,i,n){n=Kp(n);var s=!1;e.on("close",(function(){s=!0})),Jp(e,{readable:t,writable:i},(function(e){if(e)return n(e);s=!0,n()}));var o=!1;return function(t){if(!s&&!o)return o=!0,function(e){return!!Yp&&!!Qp&&(e instanceof(Qp.ReadStream||Xp)||e instanceof(Qp.WriteStream||Xp))&&Zp(e.close)}(e)?e.close(Xp):function(e){return e.setHeader&&Zp(e.abort)}(e)?e.abort():Zp(e.destroy)?e.destroy():void n(t||new Error("stream was destroyed"))}},tu=function(e){e()},iu=function(e,t){return e.pipe(t)},nu=function(){var e,t=Array.prototype.slice.call(arguments),i=Zp(t[t.length-1]||Xp)&&t.pop()||Xp;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var n=t.map((function(s,o){var a=o<t.length-1;return eu(s,a,o>0,(function(t){e||(e=t),t&&n.forEach(tu),a||(n.forEach(tu),i(e))}))}));return t.reduce(iu)};const{PassThrough:su}=B.default;const{constants:ou}=N.default,au=nu,ru=e=>{e={...e};const{array:t}=e;let{encoding:i}=e;const n="buffer"===i;let s=!1;t?s=!(i||n):i=i||"utf8",n&&(i=null);const o=new su({objectMode:s});i&&o.setEncoding(i);let a=0;const r=[];return o.on("data",(e=>{r.push(e),s?a=r.length:a+=e.length})),o.getBufferedValue=()=>t?r:n?Buffer.concat(r,a):r.join(""),o.getBufferedLength=()=>a,o};class cu extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}}async function pu(e,t){if(!e)return Promise.reject(new Error("Expected a stream"));t={maxBuffer:1/0,...t};const{maxBuffer:i}=t;let n;return await new Promise(((s,o)=>{const a=e=>{e&&n.getBufferedLength()<=ou.MAX_LENGTH&&(e.bufferedData=n.getBufferedValue()),o(e)};n=au(e,ru(t),(e=>{e?a(e):s()})),n.on("data",(()=>{n.getBufferedLength()>i&&a(new cu)}))})),n.getBufferedValue()}Np.exports=pu,Np.exports.default=pu,Np.exports.buffer=(e,t)=>pu(e,{...t,encoding:"buffer"}),Np.exports.array=(e,t)=>pu(e,{...t,array:!0}),Np.exports.MaxBufferError=cu;const uu=new Set([200,203,204,206,300,301,404,405,410,414,501]),lu=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),du=new Set([500,502,503,504]),hu={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},mu={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function fu(e){const t=parseInt(e,10);return isFinite(t)?t:0}function gu(e){const t={};if(!e)return t;const i=e.trim().split(/\s*,\s*/);for(const e of i){const[i,n]=e.split(/\s*=\s*/,2);t[i]=void 0===n||n.replace(/^"|"$/g,"")}return t}function vu(e){let t=[];for(const i in e){const n=e[i];t.push(!0===n?i:i+"="+n)}if(t.length)return t.join(", ")}var xu=e=>{const t={};for(const[i,n]of Object.entries(e))t[i.toLowerCase()]=n;return t};const yu=B.default.Readable,bu=xu;var wu=class extends yu{constructor(e,t,i,n){if("number"!=typeof e)throw new TypeError("Argument `statusCode` should be a number");if("object"!=typeof t)throw new TypeError("Argument `headers` should be an object");if(!(i instanceof Buffer))throw new TypeError("Argument `body` should be a buffer");if("string"!=typeof n)throw new TypeError("Argument `url` should be a string");super(),this.statusCode=e,this.headers=bu(t),this.body=i,this.url=n}_read(){this.push(this.body),this.push(null)}};const _u=["destroy","setTimeout","socket","headers","trailers","rawHeaders","statusCode","httpVersion","httpVersionMinor","httpVersionMajor","rawTrailers","statusMessage"];const Du=B.default.PassThrough,Eu=(e,t)=>{const i=new Set(Object.keys(e).concat(_u));for(const n of i)n in t||(t[n]="function"==typeof e[n]?e[n].bind(e):e[n])};var Cu=e=>{if(!e||!e.pipe)throw new TypeError("Parameter `response` must be a response stream.");const t=new Du;return Eu(e,t),e.pipe(t)};var Au={stringify:function e(t){if(void 0===t)return t;if(t&&Buffer.isBuffer(t))return JSON.stringify(":base64:"+t.toString("base64"));if(t&&t.toJSON&&(t=t.toJSON()),t&&"object"==typeof t){var i="",n=Array.isArray(t);i=n?"[":"{";var s=!0;for(var o in t){var a="function"==typeof t[o]||!n&&void 0===t[o];Object.hasOwnProperty.call(t,o)&&!a&&(s||(i+=","),s=!1,n?null==t[o]?i+="null":i+=e(t[o]):void 0!==t[o]&&(i+=e(o)+":"+e(t[o])))}return i+=n?"]":"}"}return"string"==typeof t?JSON.stringify(/^:/.test(t)?":"+t:t):void 0===t?"null":JSON.stringify(t)},parse:function(e){return JSON.parse(e,(function(e,t){return"string"==typeof t?/^:base64:/.test(t)?Buffer.from(t.substring(8),"base64"):/^:/.test(t)?t.substring(1):t:t}))}},ku={exports:{}};const{promisify:Su}=S.default,Fu=Au,Tu=C.default,Bu=(e={},t={})=>{const i={...e.params||{},...t.params||{}};return{...e,...t,...Object.keys(i).length?{params:i}:{}}},Ou=Su(Tu.brotliCompress),Iu=Su(Tu.brotliDecompress),Pu=e=>e;ku.exports=({enable:e=!0,serialize:t=Fu.stringify,deserialize:i=Fu.parse,compressOptions:n,decompressOptions:s}={})=>e?{serialize:t,deserialize:i,compress:async(e,i={})=>{if(void 0===e)return e;const s=t(e);return Ou(s,Bu(n,i))},decompress:async(e,t={})=>void 0===e?e:i(await Iu(e,Bu(s,t)))}:{serialize:t,deserialize:i,decompress:Pu,compress:Pu},ku.exports.stringify=Fu.stringify,ku.exports.parse=Fu.parse;const ju=A.default,Ru=Au,Lu=ku.exports,Nu=e=>{const t={redis:"@keyv/redis",rediss:"@keyv/redis",mongodb:"@keyv/mongo",mongo:"@keyv/mongo",sqlite:"@keyv/sqlite",postgresql:"@keyv/postgres",postgres:"@keyv/postgres",mysql:"@keyv/mysql",etcd:"@keyv/etcd",offline:"@keyv/offline",tiered:"@keyv/tiered"};if(e.adapter||e.uri){return new(function(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}(t[e.adapter||/^[^:+]*/.exec(e.uri)[0]]))(e)}return new Map},Hu=["sqlite","postgres","mysql","mongo","redis","tiered"];var $u=class extends ju{constructor(e,{emitErrors:t=!0,...i}={}){if(super(),this.opts={namespace:"keyv",serialize:Ru.stringify,deserialize:Ru.parse,..."string"==typeof e?{uri:e}:e,...i},!this.opts.store){const e={...this.opts};this.opts.store=Nu(e)}if(this.opts.compress){const e=Lu(this.opts.compress.opts);this.opts.serialize=async({value:t,expires:i})=>e.serialize({value:await e.compress(t),expires:i}),this.opts.deserialize=async t=>{const{value:i,expires:n}=e.deserialize(t);return{value:await e.decompress(i),expires:n}}}"function"==typeof this.opts.store.on&&t&&this.opts.store.on("error",(e=>this.emit("error",e))),this.opts.store.namespace=this.opts.namespace;const n=e=>async function*(){for await(const[t,i]of"function"==typeof e?e(this.opts.store.namespace):e){const e=this.opts.deserialize(i);this.opts.store.namespace&&!t.includes(this.opts.store.namespace)||("number"==typeof e.expires&&Date.now()>e.expires?this.delete(t):yield[this._getKeyUnprefix(t),e.value])}};"function"==typeof this.opts.store[Symbol.iterator]&&this.opts.store instanceof Map?this.iterator=n(this.opts.store):"function"==typeof this.opts.store.iterator&&this.opts.store.opts&&this._checkIterableAdaptar()&&(this.iterator=n(this.opts.store.iterator.bind(this.opts.store)))}_checkIterableAdaptar(){return Hu.includes(this.opts.store.opts.dialect)||Hu.findIndex((e=>this.opts.store.opts.url.includes(e)))>=0}_getKeyPrefix(e){return`${this.opts.namespace}:${e}`}_getKeyPrefixArray(e){return e.map((e=>`${this.opts.namespace}:${e}`))}_getKeyUnprefix(e){return e.split(":").splice(1).join(":")}get(e,t){const{store:i}=this.opts,n=Array.isArray(e),s=n?this._getKeyPrefixArray(e):this._getKeyPrefix(e);if(n&&void 0===i.getMany){const e=[];for(const n of s)e.push(Promise.resolve().then((()=>i.get(n))).then((e=>"string"==typeof e?this.opts.deserialize(e):e)).then((e=>{if(null!=e)return"number"==typeof e.expires&&Date.now()>e.expires?this.delete(n).then((()=>{})):t&&t.raw?e:e.value})));return Promise.allSettled(e).then((e=>{const t=[];for(const i of e)t.push(i.value);return t.every((e=>void 0===e))?[]:t}))}return Promise.resolve().then((()=>n?i.getMany(s):i.get(s))).then((e=>"string"==typeof e?this.opts.deserialize(e):e)).then((i=>{if(null!=i){if(n){const n=[];if(0===i.length)return[];for(let s of i)"string"==typeof s&&(s=this.opts.deserialize(s)),null!=s?"number"==typeof s.expires&&Date.now()>s.expires?(this.delete(e).then((()=>{})),n.push(void 0)):n.push(t&&t.raw?s:s.value):n.push(void 0);return n.every((e=>void 0===e))?[]:n}return"number"==typeof i.expires&&Date.now()>i.expires?this.delete(e).then((()=>{})):t&&t.raw?i:i.value}}))}set(e,t,i){const n=this._getKeyPrefix(e);void 0===i&&(i=this.opts.ttl),0===i&&(i=void 0);const{store:s}=this.opts;return Promise.resolve().then((()=>{const e="number"==typeof i?Date.now()+i:null;return"symbol"==typeof t&&this.emit("error","symbol cannot be serialized"),t={value:t,expires:e},this.opts.serialize(t)})).then((e=>s.set(n,e,i))).then((()=>!0))}delete(e){const{store:t}=this.opts;if(Array.isArray(e)){const i=this._getKeyPrefixArray(e);if(void 0===t.deleteMany){const e=[];for(const n of i)e.push(t.delete(n));return Promise.allSettled(e).then((e=>e.every((e=>!0===e.value))))}return Promise.resolve().then((()=>t.deleteMany(i)))}const i=this._getKeyPrefix(e);return Promise.resolve().then((()=>t.delete(i)))}clear(){const{store:e}=this.opts;return Promise.resolve().then((()=>e.clear()))}has(e){const t=this._getKeyPrefix(e),{store:i}=this.opts;return Promise.resolve().then((async()=>{if("function"==typeof i.has)return i.has(t);return void 0!==await i.get(t)}))}disconnect(){const{store:e}=this.opts;if("function"==typeof e.disconnect)return e.disconnect()}};const Uu=A.default,qu=k.default,Mu=Lp,zu=Np.exports,Gu=class{constructor(e,t,{shared:i,cacheHeuristic:n,immutableMinTimeToLive:s,ignoreCargoCult:o,_fromObject:a}={}){if(a)this._fromObject(a);else{if(!t||!t.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(e),this._responseTime=this.now(),this._isShared=!1!==i,this._cacheHeuristic=void 0!==n?n:.1,this._immutableMinTtl=void 0!==s?s:864e5,this._status="status"in t?t.status:200,this._resHeaders=t.headers,this._rescc=gu(t.headers["cache-control"]),this._method="method"in e?e.method:"GET",this._url=e.url,this._host=e.headers.host,this._noAuthorization=!e.headers.authorization,this._reqHeaders=t.headers.vary?e.headers:null,this._reqcc=gu(e.headers["cache-control"]),o&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":vu(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),null==t.headers["cache-control"]&&/no-cache/.test(t.headers.pragma)&&(this._rescc["no-cache"]=!0)}}now(){return Date.now()}storable(){return!(this._reqcc["no-store"]||!("GET"===this._method||"HEAD"===this._method||"POST"===this._method&&this._hasExplicitExpiration())||!lu.has(this._status)||this._rescc["no-store"]||this._isShared&&this._rescc.private||this._isShared&&!this._noAuthorization&&!this._allowsStoringAuthenticated()||!(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||uu.has(this._status)))}_hasExplicitExpiration(){return this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires}_assertRequestHasHeaders(e){if(!e||!e.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(e){this._assertRequestHasHeaders(e);const t=gu(e.headers["cache-control"]);if(t["no-cache"]||/no-cache/.test(e.headers.pragma))return!1;if(t["max-age"]&&this.age()>t["max-age"])return!1;if(t["min-fresh"]&&this.timeToLive()<1e3*t["min-fresh"])return!1;if(this.stale()){if(!(t["max-stale"]&&!this._rescc["must-revalidate"]&&(!0===t["max-stale"]||t["max-stale"]>this.age()-this.maxAge())))return!1}return this._requestMatches(e,!1)}_requestMatches(e,t){return(!this._url||this._url===e.url)&&this._host===e.headers.host&&(!e.method||this._method===e.method||t&&"HEAD"===e.method)&&this._varyMatches(e)}_allowsStoringAuthenticated(){return this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"]}_varyMatches(e){if(!this._resHeaders.vary)return!0;if("*"===this._resHeaders.vary)return!1;const t=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(const i of t)if(e.headers[i]!==this._reqHeaders[i])return!1;return!0}_copyWithoutHopByHopHeaders(e){const t={};for(const i in e)hu[i]||(t[i]=e[i]);if(e.connection){const i=e.connection.trim().split(/\s*,\s*/);for(const e of i)delete t[e]}if(t.warning){const e=t.warning.split(/,/).filter((e=>!/^\s*1[0-9][0-9]/.test(e)));e.length?t.warning=e.join(",").trim():delete t.warning}return t}responseHeaders(){const e=this._copyWithoutHopByHopHeaders(this._resHeaders),t=this.age();return t>86400&&!this._hasExplicitExpiration()&&this.maxAge()>86400&&(e.warning=(e.warning?`${e.warning}, `:"")+'113 - "rfc7234 5.5.4"'),e.age=`${Math.round(t)}`,e.date=new Date(this.now()).toUTCString(),e}date(){const e=Date.parse(this._resHeaders.date);return isFinite(e)?e:this._responseTime}age(){return this._ageValue()+(this.now()-this._responseTime)/1e3}_ageValue(){return fu(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"])return 0;if(this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable)return 0;if("*"===this._resHeaders.vary)return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return fu(this._rescc["s-maxage"])}if(this._rescc["max-age"])return fu(this._rescc["max-age"]);const e=this._rescc.immutable?this._immutableMinTtl:0,t=this.date();if(this._resHeaders.expires){const i=Date.parse(this._resHeaders.expires);return Number.isNaN(i)||i<t?0:Math.max(e,(i-t)/1e3)}if(this._resHeaders["last-modified"]){const i=Date.parse(this._resHeaders["last-modified"]);if(isFinite(i)&&t>i)return Math.max(e,(t-i)/1e3*this._cacheHeuristic)}return e}timeToLive(){const e=this.maxAge()-this.age(),t=e+fu(this._rescc["stale-if-error"]),i=e+fu(this._rescc["stale-while-revalidate"]);return 1e3*Math.max(0,e,t,i)}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+fu(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){return this.maxAge()+fu(this._rescc["stale-while-revalidate"])>this.age()}static fromObject(e){return new this(void 0,void 0,{_fromObject:e})}_fromObject(e){if(this._responseTime)throw Error("Reinitialized");if(!e||1!==e.v)throw Error("Invalid serialization");this._responseTime=e.t,this._isShared=e.sh,this._cacheHeuristic=e.ch,this._immutableMinTtl=void 0!==e.imm?e.imm:864e5,this._status=e.st,this._resHeaders=e.resh,this._rescc=e.rescc,this._method=e.m,this._url=e.u,this._host=e.h,this._noAuthorization=e.a,this._reqHeaders=e.reqh,this._reqcc=e.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(e){this._assertRequestHasHeaders(e);const t=this._copyWithoutHopByHopHeaders(e.headers);if(delete t["if-range"],!this._requestMatches(e,!0)||!this.storable())return delete t["if-none-match"],delete t["if-modified-since"],t;this._resHeaders.etag&&(t["if-none-match"]=t["if-none-match"]?`${t["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag);if(t["accept-ranges"]||t["if-match"]||t["if-unmodified-since"]||this._method&&"GET"!=this._method){if(delete t["if-modified-since"],t["if-none-match"]){const e=t["if-none-match"].split(/,/).filter((e=>!/^\s*W\//.test(e)));e.length?t["if-none-match"]=e.join(",").trim():delete t["if-none-match"]}}else this._resHeaders["last-modified"]&&!t["if-modified-since"]&&(t["if-modified-since"]=this._resHeaders["last-modified"]);return t}revalidatedPolicy(e,t){if(this._assertRequestHasHeaders(e),this._useStaleIfError()&&function(e){return!e||du.has(e.status)}(t))return{modified:!1,matches:!1,policy:this};if(!t||!t.headers)throw Error("Response headers missing");let i=!1;if(void 0!==t.status&&304!=t.status?i=!1:t.headers.etag&&!/^\s*W\//.test(t.headers.etag)?i=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===t.headers.etag:this._resHeaders.etag&&t.headers.etag?i=this._resHeaders.etag.replace(/^\s*W\//,"")===t.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?i=this._resHeaders["last-modified"]===t.headers["last-modified"]:this._resHeaders.etag||this._resHeaders["last-modified"]||t.headers.etag||t.headers["last-modified"]||(i=!0),!i)return{policy:new this.constructor(e,t),modified:304!=t.status,matches:!1};const n={};for(const e in this._resHeaders)n[e]=e in t.headers&&!mu[e]?t.headers[e]:this._resHeaders[e];const s=Object.assign({},t,{status:this._status,method:this._method,headers:n});return{policy:new this.constructor(e,s,{shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl}),modified:!1,matches:!0}}},Vu=wu,Wu=xu,Ku=Cu,Ju=$u;class Qu{constructor(e,t){if("function"!=typeof e)throw new TypeError("Parameter `request` must be a function");return this.cache=new Ju({uri:"string"==typeof t&&t,store:"string"!=typeof t&&t,namespace:"cacheable-request"}),this.createCacheableRequest(e)}createCacheableRequest(e){return(t,i)=>{let n;if("string"==typeof t)n=Yu(qu.parse(t)),t={};else if(t instanceof qu.URL)n=Yu(qu.parse(t.toString())),t={};else{const[e,...i]=(t.path||"").split("?"),s=i.length>0?`?${i.join("?")}`:"";n=Yu({...t,pathname:e,search:s})}(t={headers:{},method:"GET",cache:!0,strictTtl:!1,automaticFailover:!1,...t,...Xu(n)}).headers=Wu(t.headers);const s=new Uu,o=Mu(qu.format(n),{stripWWW:!1,removeTrailingSlash:!1,stripAuthentication:!1}),a=`${t.method}:${o}`;let r=!1,c=!1;const p=t=>{c=!0;let n,o=!1;const p=new Promise((e=>{n=()=>{o||(o=!0,e())}})),u=e=>{if(r&&!t.forceRefresh){e.status=e.statusCode;const i=Gu.fromObject(r.cachePolicy).revalidatedPolicy(t,e);if(!i.modified){const t=i.policy.responseHeaders();(e=new Vu(r.statusCode,t,r.body,r.url)).cachePolicy=i.policy,e.fromCache=!0}}let n;e.fromCache||(e.cachePolicy=new Gu(t,e,t),e.fromCache=!1),t.cache&&e.cachePolicy.storable()?(n=Ku(e),(async()=>{try{const i=zu.buffer(e);if(await Promise.race([p,new Promise((t=>e.once("end",t)))]),o)return;const n=await i,s={cachePolicy:e.cachePolicy.toObject(),url:e.url,statusCode:e.fromCache?r.statusCode:e.statusCode,body:n};let c=t.strictTtl?e.cachePolicy.timeToLive():void 0;t.maxTtl&&(c=c?Math.min(c,t.maxTtl):t.maxTtl),await this.cache.set(a,s,c)}catch(e){s.emit("error",new Qu.CacheError(e))}})()):t.cache&&r&&(async()=>{try{await this.cache.delete(a)}catch(e){s.emit("error",new Qu.CacheError(e))}})(),s.emit("response",n||e),"function"==typeof i&&i(n||e)};try{const i=e(t,u);i.once("error",n),i.once("abort",n),s.emit("request",i)}catch(e){s.emit("error",new Qu.RequestError(e))}};return(async()=>{const e=async e=>{await Promise.resolve();const t=e.cache?await this.cache.get(a):void 0;if(void 0===t)return p(e);const n=Gu.fromObject(t.cachePolicy);if(n.satisfiesWithoutRevalidation(e)&&!e.forceRefresh){const e=n.responseHeaders(),o=new Vu(t.statusCode,e,t.body,t.url);o.cachePolicy=n,o.fromCache=!0,s.emit("response",o),"function"==typeof i&&i(o)}else r=t,e.headers=n.revalidationHeaders(e),p(e)},n=e=>s.emit("error",new Qu.CacheError(e));this.cache.once("error",n),s.on("response",(()=>this.cache.removeListener("error",n)));try{await e(t)}catch(e){t.automaticFailover&&!c&&p(t),s.emit("error",new Qu.CacheError(e))}})(),s}}}function Xu(e){const t={...e};return t.path=`${e.pathname||"/"}${e.search||""}`,delete t.pathname,delete t.search,t}function Yu(e){return{protocol:e.protocol,auth:e.auth,hostname:e.hostname||e.host||"localhost",port:e.port,pathname:e.pathname,search:e.search}}Qu.RequestError=class extends Error{constructor(e){super(e.message),this.name="RequestError",Object.assign(this,e)}},Qu.CacheError=class extends Error{constructor(e){super(e.message),this.name="CacheError",Object.assign(this,e)}};var Zu=Qu;const el=["aborted","complete","headers","httpVersion","httpVersionMinor","httpVersionMajor","method","rawHeaders","rawTrailers","setTimeout","socket","statusCode","statusMessage","trailers","url"];const{Transform:tl,PassThrough:il}=B.default,nl=C.default,sl=(e,t)=>{if(t._readableState.autoDestroy)throw new Error("The second stream must have the `autoDestroy` option set to `false`");const i=new Set(Object.keys(e).concat(el)),n={};for(const s of i)s in t||(n[s]={get(){const t=e[s];return"function"==typeof t?t.bind(e):t},set(t){e[s]=t},enumerable:!0,configurable:!1});return Object.defineProperties(t,n),e.once("aborted",(()=>{t.destroy(),t.emit("aborted")})),e.once("close",(()=>{e.complete&&t.readable?t.once("end",(()=>{t.emit("close")})):t.emit("close")})),t};var ol=e=>{const t=(e.headers["content-encoding"]||"").toLowerCase();if(!["gzip","deflate","br"].includes(t))return e;const i="br"===t;if(i&&"function"!=typeof nl.createBrotliDecompress)return e.destroy(new Error("Brotli is not supported on Node.js < 12")),e;let n=!0;const s=new tl({transform(e,t,i){n=!1,i(null,e)},flush(e){e()}}),o=new il({autoDestroy:!1,destroy(t,i){e.destroy(),i(t)}}),a=i?nl.createBrotliDecompress():nl.createUnzip();return a.once("error",(t=>{!n||e.readable?o.destroy(t):o.end()})),sl(e,o),e.pipe(s).pipe(a).pipe(o),o};class al{constructor(e={}){if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(e,t){if(this.cache.set(e,t),this._size++,this._size>=this.maxSize){if(this._size=0,"function"==typeof this.onEviction)for(const[e,t]of this.oldCache.entries())this.onEviction(e,t);this.oldCache=this.cache,this.cache=new Map}}get(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){const t=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,t),t}}set(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}has(e){return this.cache.has(e)||this.oldCache.has(e)}peek(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache)yield e;for(const e of this.oldCache){const[t]=e;this.cache.has(t)||(yield e)}}get size(){let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}}var rl=al;const cl=A.default,pl=R.default,ul=H.default,ll=rl,dl=Symbol("currentStreamsCount"),hl=Symbol("request"),ml=Symbol("cachedOriginSet"),fl=Symbol("gracefullyClosing"),gl=["maxDeflateDynamicTableSize","maxSessionMemory","maxHeaderListPairs","maxOutstandingPings","maxReservedRemoteStreams","maxSendHeaderBlockLength","paddingStrategy","localAddress","path","rejectUnauthorized","minDHSize","ca","cert","clientCertEngine","ciphers","key","pfx","servername","minVersion","maxVersion","secureProtocol","crl","honorCipherOrder","ecdhCurve","dhparam","secureOptions","sessionIdContext"],vl=(e,t)=>e.remoteSettings.maxConcurrentStreams>t.remoteSettings.maxConcurrentStreams,xl=(e,t)=>{for(const i of e)i[ml].length<t[ml].length&&i[ml].every((e=>t[ml].includes(e)))&&i[dl]+t[dl]<=t.remoteSettings.maxConcurrentStreams&&bl(i)},yl=({agent:e,isFree:t})=>{const i={};for(const n in e.sessions){const s=e.sessions[n].filter((e=>{const i=e[wl.kCurrentStreamsCount]<e.remoteSettings.maxConcurrentStreams;return t?i:!i}));0!==s.length&&(i[n]=s)}return i},bl=e=>{e[fl]=!0,0===e[dl]&&e.close()};class wl extends cl{constructor({timeout:e=6e4,maxSessions:t=1/0,maxFreeSessions:i=10,maxCachedTlsSessions:n=100}={}){super(),this.sessions={},this.queue={},this.timeout=e,this.maxSessions=t,this.maxFreeSessions=i,this._freeSessionsCount=0,this._sessionsCount=0,this.settings={enablePush:!1},this.tlsSessionCache=new ll({maxSize:n})}static normalizeOrigin(e,t){return"string"==typeof e&&(e=new URL(e)),t&&e.hostname!==t&&(e.hostname=t),e.origin}normalizeOptions(e){let t="";if(e)for(const i of gl)e[i]&&(t+=`:${e[i]}`);return t}_tryToCreateNewSession(e,t){if(!(e in this.queue)||!(t in this.queue[e]))return;const i=this.queue[e][t];this._sessionsCount<this.maxSessions&&!i.completed&&(i.completed=!0,i())}getSession(e,t,i){return new Promise(((n,s)=>{Array.isArray(i)?(i=[...i],n()):i=[{resolve:n,reject:s}];const o=this.normalizeOptions(t),a=wl.normalizeOrigin(e,t&&t.servername);if(void 0===a){for(const{reject:e}of i)e(new TypeError("The `origin` argument needs to be a string or an URL object"));return}if(o in this.sessions){const e=this.sessions[o];let t,n=-1,s=-1;for(const i of e){const e=i.remoteSettings.maxConcurrentStreams;if(e<n)break;if(i[ml].includes(a)){const o=i[dl];if(o>=e||i[fl]||i.destroyed)continue;t||(n=e),o>s&&(t=i,s=o)}}if(t){if(1!==i.length){for(const{reject:e}of i){e(new Error(`Expected the length of listeners to be 1, got ${i.length}.\nPlease report this to https://github.com/szmarczak/http2-wrapper/`))}return}return void i[0].resolve(t)}}if(o in this.queue){if(a in this.queue[o])return this.queue[o][a].listeners.push(...i),void this._tryToCreateNewSession(o,a)}else this.queue[o]={};const r=()=>{o in this.queue&&this.queue[o][a]===c&&(delete this.queue[o][a],0===Object.keys(this.queue[o]).length&&delete this.queue[o])},c=()=>{const n=`${a}:${o}`;let s=!1;try{const p=ul.connect(e,{createConnection:this.createConnection,settings:this.settings,session:this.tlsSessionCache.get(n),...t});p[dl]=0,p[fl]=!1;const u=()=>p[dl]<p.remoteSettings.maxConcurrentStreams;let l=!0;p.socket.once("session",(e=>{this.tlsSessionCache.set(n,e)})),p.once("error",(e=>{for(const{reject:t}of i)t(e);this.tlsSessionCache.delete(n)})),p.setTimeout(this.timeout,(()=>{p.destroy()})),p.once("close",(()=>{if(s){l&&this._freeSessionsCount--,this._sessionsCount--;const e=this.sessions[o];e.splice(e.indexOf(p),1),0===e.length&&delete this.sessions[o]}else{const e=new Error("Session closed without receiving a SETTINGS frame");e.code="HTTP2WRAPPER_NOSETTINGS";for(const{reject:t}of i)t(e);r()}this._tryToCreateNewSession(o,a)}));const d=()=>{if(o in this.queue&&u())for(const e of p[ml])if(e in this.queue[o]){const{listeners:t}=this.queue[o][e];for(;0!==t.length&&u();)t.shift().resolve(p);const i=this.queue[o];if(0===i[e].listeners.length&&(delete i[e],0===Object.keys(i).length)){delete this.queue[o];break}if(!u())break}};p.on("origin",(()=>{p[ml]=p.originSet,u()&&(d(),xl(this.sessions[o],p))})),p.once("remoteSettings",(()=>{if(p.ref(),p.unref(),this._sessionsCount++,c.destroyed){const e=new Error("Agent has been destroyed");for(const t of i)t.reject(e);p.destroy()}else{p[ml]=p.originSet;{const e=this.sessions;if(o in e){const t=e[o];t.splice(((e,t,i)=>{let n=0,s=e.length;for(;n<s;){const o=n+s>>>1;i(e[o],t)?n=o+1:s=o}return n})(t,p,vl),0,p)}else e[o]=[p]}this._freeSessionsCount+=1,s=!0,this.emit("session",p),d(),r(),0===p[dl]&&this._freeSessionsCount>this.maxFreeSessions&&p.close(),0!==i.length&&(this.getSession(a,t,i),i.length=0),p.on("remoteSettings",(()=>{d(),xl(this.sessions[o],p)}))}})),p[hl]=p.request,p.request=(e,t)=>{if(p[fl])throw new Error("The session is gracefully closing. No new streams are allowed.");const i=p[hl](e,t);return p.ref(),++p[dl],p[dl]===p.remoteSettings.maxConcurrentStreams&&this._freeSessionsCount--,i.once("close",(()=>{if(l=u(),--p[dl],!p.destroyed&&!p.closed&&(((e,t)=>{for(const i of e)t[ml].length<i[ml].length&&t[ml].every((e=>i[ml].includes(e)))&&t[dl]+i[dl]<=i.remoteSettings.maxConcurrentStreams&&bl(t)})(this.sessions[o],p),u()&&!p.closed)){l||(this._freeSessionsCount++,l=!0);const e=0===p[dl];e&&p.unref(),e&&(this._freeSessionsCount>this.maxFreeSessions||p[fl])?p.close():(xl(this.sessions[o],p),d())}})),i}}catch(e){for(const t of i)t.reject(e);r()}};c.listeners=i,c.completed=!1,c.destroyed=!1,this.queue[o][a]=c,this._tryToCreateNewSession(o,a)}))}request(e,t,i,n){return new Promise(((s,o)=>{this.getSession(e,t,[{reject:o,resolve:e=>{try{s(e.request(i,n))}catch(e){o(e)}}}])}))}createConnection(e,t){return wl.connect(e,t)}static connect(e,t){t.ALPNProtocols=["h2"];const i=e.port||443,n=e.hostname||e.host;return void 0===t.servername&&(t.servername=n),pl.connect(i,n,t)}closeFreeSessions(){for(const e of Object.values(this.sessions))for(const t of e)0===t[dl]&&t.close()}destroy(e){for(const t of Object.values(this.sessions))for(const i of t)i.destroy(e);for(const e of Object.values(this.queue))for(const t of Object.values(e))t.destroyed=!0;this.queue={}}get freeSessions(){return yl({agent:this,isFree:!0})}get busySessions(){return yl({agent:this,isFree:!1})}}wl.kCurrentStreamsCount=dl,wl.kGracefullyClosing=fl;var _l={Agent:wl,globalAgent:new wl};const{Readable:Dl}=B.default;var El=class extends Dl{constructor(e,t){super({highWaterMark:t,autoDestroy:!1}),this.statusCode=null,this.statusMessage="",this.httpVersion="2.0",this.httpVersionMajor=2,this.httpVersionMinor=0,this.headers={},this.trailers={},this.req=null,this.aborted=!1,this.complete=!1,this.upgrade=null,this.rawHeaders=[],this.rawTrailers=[],this.socket=e,this.connection=e,this._dumped=!1}_destroy(e){this.req._request.destroy(e)}setTimeout(e,t){return this.req.setTimeout(e,t),this}_dump(){this._dumped||(this._dumped=!0,this.removeAllListeners("data"),this.resume())}_read(){this.req&&this.req._request.resume()}},Cl=e=>{const t={protocol:e.protocol,hostname:"string"==typeof e.hostname&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,host:e.host,hash:e.hash,search:e.search,pathname:e.pathname,href:e.href,path:`${e.pathname||""}${e.search||""}`};return"string"==typeof e.port&&0!==e.port.length&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${e.username||""}:${e.password||""}`),t},Al={exports:{}};!function(e){const t=(t,i,n)=>{e.exports[i]=class extends t{constructor(...e){super("string"==typeof n?n:n(e)),this.name=`${super.name} [${i}]`,this.code=i}}};t(TypeError,"ERR_INVALID_ARG_TYPE",(e=>{const t=e[0].includes(".")?"property":"argument";let i=e[1];const n=Array.isArray(i);return n&&(i=`${i.slice(0,-1).join(", ")} or ${i.slice(-1)}`),`The "${e[0]}" ${t} must be ${n?"one of":"of"} type ${i}. Received ${typeof e[2]}`})),t(TypeError,"ERR_INVALID_PROTOCOL",(e=>`Protocol "${e[0]}" not supported. Expected "${e[1]}"`)),t(Error,"ERR_HTTP_HEADERS_SENT",(e=>`Cannot ${e[0]} headers after they are sent to the client`)),t(TypeError,"ERR_INVALID_HTTP_TOKEN",(e=>`${e[0]} must be a valid HTTP token [${e[1]}]`)),t(TypeError,"ERR_HTTP_INVALID_HEADER_VALUE",(e=>`Invalid value "${e[0]} for header "${e[1]}"`)),t(TypeError,"ERR_INVALID_CHAR",(e=>`Invalid character in ${e[0]} [${e[1]}]`))}(Al);const kl=H.default,{Writable:Sl}=B.default,{Agent:Fl,globalAgent:Tl}=_l,Bl=El,Ol=Cl,Il=(e,t,i)=>{for(const n of i)e.on(n,((...e)=>t.emit(n,...e)))},Pl=e=>{switch(e){case":method":case":scheme":case":authority":case":path":return!0;default:return!1}},{ERR_INVALID_ARG_TYPE:jl,ERR_INVALID_PROTOCOL:Rl,ERR_HTTP_HEADERS_SENT:Ll,ERR_INVALID_HTTP_TOKEN:Nl,ERR_HTTP_INVALID_HEADER_VALUE:Hl,ERR_INVALID_CHAR:$l}=Al.exports,{HTTP2_HEADER_STATUS:Ul,HTTP2_HEADER_METHOD:ql,HTTP2_HEADER_PATH:Ml,HTTP2_METHOD_CONNECT:zl}=kl.constants,Gl=Symbol("headers"),Vl=Symbol("origin"),Wl=Symbol("session"),Kl=Symbol("options"),Jl=Symbol("flushedHeaders"),Ql=Symbol("jobs"),Xl=/^[\^`\-\w!#$%&*+.|~]+$/,Yl=/[^\t\u0020-\u007E\u0080-\u00FF]/;var Zl=class extends Sl{constructor(e,t,i){super({autoDestroy:!1});const n="string"==typeof e||e instanceof URL;if(n&&(e=Ol(e instanceof URL?e:new URL(e))),"function"==typeof t||void 0===t?(i=t,t=n?e:{...e}):t={...e,...t},t.h2session)this[Wl]=t.h2session;else if(!1===t.agent)this.agent=new Fl({maxFreeSessions:0});else if(void 0===t.agent||null===t.agent)"function"==typeof t.createConnection?(this.agent=new Fl({maxFreeSessions:0}),this.agent.createConnection=t.createConnection):this.agent=Tl;else{if("function"!=typeof t.agent.request)throw new jl("options.agent",["Agent-like Object","undefined","false"],t.agent);this.agent=t.agent}if(t.protocol&&"https:"!==t.protocol)throw new Rl(t.protocol,"https:");const s=t.port||t.defaultPort||this.agent&&this.agent.defaultPort||443,o=t.hostname||t.host||"localhost";delete t.hostname,delete t.host,delete t.port;const{timeout:a}=t;if(t.timeout=void 0,this[Gl]=Object.create(null),this[Ql]=[],this.socket=null,this.connection=null,this.method=t.method||"GET",this.path=t.path,this.res=null,this.aborted=!1,this.reusedSocket=!1,t.headers)for(const[e,i]of Object.entries(t.headers))this.setHeader(e,i);t.auth&&!("authorization"in this[Gl])&&(this[Gl].authorization="Basic "+Buffer.from(t.auth).toString("base64")),t.session=t.tlsSession,t.path=t.socketPath,this[Kl]=t,443===s?(this[Vl]=`https://${o}`,":authority"in this[Gl]||(this[Gl][":authority"]=o)):(this[Vl]=`https://${o}:${s}`,":authority"in this[Gl]||(this[Gl][":authority"]=`${o}:${s}`)),a&&this.setTimeout(a),i&&this.once("response",i),this[Jl]=!1}get method(){return this[Gl][ql]}set method(e){e&&(this[Gl][ql]=e.toUpperCase())}get path(){return this[Gl][Ml]}set path(e){e&&(this[Gl][Ml]=e)}get _mustNotHaveABody(){return"GET"===this.method||"HEAD"===this.method||"DELETE"===this.method}_write(e,t,i){if(this._mustNotHaveABody)return void i(new Error("The GET, HEAD and DELETE methods must NOT have a body"));this.flushHeaders();const n=()=>this._request.write(e,t,i);this._request?n():this[Ql].push(n)}_final(e){if(this.destroyed)return;this.flushHeaders();const t=()=>{this._mustNotHaveABody?e():this._request.end(e)};this._request?t():this[Ql].push(t)}abort(){this.res&&this.res.complete||(this.aborted||process.nextTick((()=>this.emit("abort"))),this.aborted=!0,this.destroy())}_destroy(e,t){this.res&&this.res._dump(),this._request&&this._request.destroy(),t(e)}async flushHeaders(){if(this[Jl]||this.destroyed)return;this[Jl]=!0;const e=this.method===zl,t=t=>{if(this._request=t,this.destroyed)return void t.destroy();e||Il(t,this,["timeout","continue","close","error"]);const i=e=>(...t)=>{this.writable||this.destroyed?this.once("finish",(()=>{e(...t)})):e(...t)};t.once("response",i(((i,n,s)=>{const o=new Bl(this.socket,t.readableHighWaterMark);this.res=o,o.req=this,o.statusCode=i[Ul],o.headers=i,o.rawHeaders=s,o.once("end",(()=>{this.aborted?(o.aborted=!0,o.emit("aborted")):(o.complete=!0,o.socket=null,o.connection=null)})),e?(o.upgrade=!0,this.emit("connect",o,t,Buffer.alloc(0))?this.emit("close"):t.destroy()):(t.on("data",(e=>{o._dumped||o.push(e)||t.pause()})),t.once("end",(()=>{o.push(null)})),this.emit("response",o)||o._dump())}))),t.once("headers",i((e=>this.emit("information",{statusCode:e[Ul]})))),t.once("trailers",i(((e,t,i)=>{const{res:n}=this;n.trailers=e,n.rawTrailers=i})));const{socket:n}=t.session;this.socket=n,this.connection=n;for(const e of this[Ql])e();this.emit("socket",this.socket)};if(this[Wl])try{t(this[Wl].request(this[Gl]))}catch(e){this.emit("error",e)}else{this.reusedSocket=!0;try{t(await this.agent.request(this[Vl],this[Kl],this[Gl]))}catch(e){this.emit("error",e)}}}getHeader(e){if("string"!=typeof e)throw new jl("name","string",e);return this[Gl][e.toLowerCase()]}get headersSent(){return this[Jl]}removeHeader(e){if("string"!=typeof e)throw new jl("name","string",e);if(this.headersSent)throw new Ll("remove");delete this[Gl][e.toLowerCase()]}setHeader(e,t){if(this.headersSent)throw new Ll("set");if("string"!=typeof e||!Xl.test(e)&&!Pl(e))throw new Nl("Header name",e);if(void 0===t)throw new Hl(t,e);if(Yl.test(t))throw new $l("header content",e);this[Gl][e.toLowerCase()]=t}setNoDelay(){}setSocketKeepAlive(){}setTimeout(e,t){const i=()=>this._request.setTimeout(e,t);return this._request?i():this[Ql].push(i),this}get maxHeadersCount(){if(!this.destroyed&&this._request)return this._request.session.localSettings.maxHeaderListSize}set maxHeadersCount(e){}},ed={exports:{}};const td=R.default;const id=I.default;const nd=F.default,sd=T.default,od=(e={},t=td.connect)=>new Promise(((i,n)=>{let s,o=!1;const a=async()=>{await c,s.off("timeout",r),s.off("error",n),e.resolveSocket?(i({alpnProtocol:s.alpnProtocol,socket:s,timeout:o}),o&&(await Promise.resolve(),s.emit("timeout"))):(s.destroy(),i({alpnProtocol:s.alpnProtocol,timeout:o}))},r=async()=>{o=!0,a()},c=(async()=>{try{s=await t(e,a),s.on("error",n),s.once("timeout",r)}catch(e){n(e)}})()})),ad=Zl,rd=e=>{let t=e.host;const i=e.headers&&e.headers.host;if(i)if(i.startsWith("[")){t=-1===i.indexOf("]")?i:i.slice(1,-1)}else t=i.split(":",1)[0];return id.isIP(t)?"":t},cd=Cl,pd=new rl({maxSize:100}),ud=new Map,ld=(e,t,i)=>{t._httpMessage={shouldKeepAlive:!0};const n=()=>{e.emit("free",t,i)};t.on("free",n);const s=()=>{e.removeSocket(t,i)};t.on("close",s);const o=()=>{e.removeSocket(t,i),t.off("close",s),t.off("free",n),t.off("agentRemove",o)};t.on("agentRemove",o),e.emit("free",t,i)};ed.exports=async(e,t,i)=>{if(("string"==typeof e||e instanceof URL)&&(e=cd(new URL(e))),"function"==typeof t&&(i=t,t=void 0),t={ALPNProtocols:["h2","http/1.1"],...e,...t,resolveSocket:!0},!Array.isArray(t.ALPNProtocols)||0===t.ALPNProtocols.length)throw new Error("The `ALPNProtocols` option must be an Array with at least one entry");t.protocol=t.protocol||"https:";const n="https:"===t.protocol;t.host=t.hostname||t.host||"localhost",t.session=t.tlsSession,t.servername=t.servername||rd(t),t.port=t.port||(n?443:80),t._defaultAgent=n?sd.globalAgent:nd.globalAgent;const s=t.agent;if(s){if(s.addRequest)throw new Error("The `options.agent` object can contain only `http`, `https` or `http2` properties");t.agent=s[n?"https":"http"]}if(n){const e=await(async e=>{const t=`${e.host}:${e.port}:${e.ALPNProtocols.sort()}`;if(!pd.has(t)){if(ud.has(t))return(await ud.get(t)).alpnProtocol;const{path:i,agent:n}=e;e.path=e.socketPath;const s=od(e);ud.set(t,s);try{const{socket:o,alpnProtocol:a}=await s;if(pd.set(t,a),e.path=i,"h2"===a)o.destroy();else{const{globalAgent:t}=sd,i=sd.Agent.prototype.createConnection;n?n.createConnection===i?ld(n,o,e):o.destroy():t.createConnection===i?ld(t,o,e):o.destroy()}return ud.delete(t),a}catch(e){throw ud.delete(t),e}}return pd.get(t)})(t);if("h2"===e)return s&&(t.agent=s.http2),new ad(t,i)}return nd.request(t,i)},ed.exports.protocolCache=pd;const dd=H.default,hd=_l,md=Zl,fd=El,gd=ed.exports;var vd={...dd,ClientRequest:md,IncomingMessage:fd,...hd,request:(e,t,i)=>new md(e,t,i),get:(e,t,i)=>{const n=new md(e,t,i);return n.end(),n},auto:gd},xd={},yd={};Object.defineProperty(yd,"__esModule",{value:!0});const bd=lp.exports;yd.default=e=>bd.default.nodeStream(e)&&bd.default.function_(e.getBoundary),Object.defineProperty(xd,"__esModule",{value:!0});const wd=D.default,_d=S.default,Dd=lp.exports,Ed=yd,Cd=_d.promisify(wd.stat);xd.default=async(e,t)=>{if(t&&"content-length"in t)return Number(t["content-length"]);if(!e)return 0;if(Dd.default.string(e))return Buffer.byteLength(e);if(Dd.default.buffer(e))return e.length;if(Ed.default(e))return _d.promisify(e.getLength.bind(e))();if(e instanceof wd.ReadStream){const{size:t}=await Cd(e.path);if(0===t)return;return t}};var Ad,kd={};function Sd(){if(Ad)return kd;return Ad=1,Object.defineProperty(kd,"__esModule",{value:!0}),kd.default=function(e,t,i){const n={};for(const s of i)n[s]=(...e)=>{t.emit(s,...e)},e.on(s,n[s]);return()=>{for(const t of i)e.off(t,n[t])}},kd}var Fd={},Td={};Object.defineProperty(Td,"__esModule",{value:!0}),Td.default=()=>{const e=[];return{once(t,i,n){t.once(i,n),e.push({origin:t,event:i,fn:n})},unhandleAll(){for(const t of e){const{origin:e,event:i,fn:n}=t;e.removeListener(i,n)}e.length=0}}},Object.defineProperty(Fd,"__esModule",{value:!0}),Fd.TimeoutError=void 0;const Bd=I.default,Od=Td,Id=Symbol("reentry"),Pd=()=>{};class jd extends Error{constructor(e,t){super(`Timeout awaiting '${t}' for ${e}ms`),this.event=t,this.name="TimeoutError",this.code="ETIMEDOUT"}}Fd.TimeoutError=jd,Fd.default=(e,t,i)=>{if(Id in e)return Pd;e[Id]=!0;const n=[],{once:s,unhandleAll:o}=Od.default(),a=(e,t,i)=>{var s;const o=setTimeout(t,e,e,i);null===(s=o.unref)||void 0===s||s.call(o);const a=()=>{clearTimeout(o)};return n.push(a),a},{host:r,hostname:c}=i,p=(t,i)=>{e.destroy(new jd(t,i))},u=()=>{for(const e of n)e();o()};if(e.once("error",(t=>{if(u(),0===e.listenerCount("error"))throw t})),e.once("close",u),s(e,"response",(e=>{s(e,"end",u)})),void 0!==t.request&&a(t.request,p,"request"),void 0!==t.socket){const i=()=>{p(t.socket,"socket")};e.setTimeout(t.socket,i),n.push((()=>{e.removeListener("timeout",i)}))}return s(e,"socket",(n=>{var o;const{socketPath:u}=e;if(n.connecting){const e=Boolean(null!=u?u:0!==Bd.isIP(null!==(o=null!=c?c:r)&&void 0!==o?o:""));if(void 0!==t.lookup&&!e&&void 0===n.address().address){const e=a(t.lookup,p,"lookup");s(n,"lookup",e)}if(void 0!==t.connect){const i=()=>a(t.connect,p,"connect");e?s(n,"connect",i()):s(n,"lookup",(e=>{null===e&&s(n,"connect",i())}))}void 0!==t.secureConnect&&"https:"===i.protocol&&s(n,"connect",(()=>{const e=a(t.secureConnect,p,"secureConnect");s(n,"secureConnect",e)}))}if(void 0!==t.send){const i=()=>a(t.send,p,"send");n.connecting?s(n,"connect",(()=>{s(e,"upload-complete",i())})):s(e,"upload-complete",i())}})),void 0!==t.response&&s(e,"upload-complete",(()=>{const i=a(t.response,p,"response");s(e,"response",i)})),u};var Rd={};Object.defineProperty(Rd,"__esModule",{value:!0});const Ld=lp.exports;Rd.default=e=>{const t={protocol:e.protocol,hostname:Ld.default.string(e.hostname)&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,host:e.host,hash:e.hash,search:e.search,pathname:e.pathname,href:e.href,path:`${e.pathname||""}${e.search||""}`};return Ld.default.string(e.port)&&e.port.length>0&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${e.username||""}:${e.password||""}`),t};var Nd={};Object.defineProperty(Nd,"__esModule",{value:!0});const Hd=k.default,$d=["protocol","host","hostname","port","pathname","search"];Nd.default=(e,t)=>{var i,n;if(t.path){if(t.pathname)throw new TypeError("Parameters `path` and `pathname` are mutually exclusive.");if(t.search)throw new TypeError("Parameters `path` and `search` are mutually exclusive.");if(t.searchParams)throw new TypeError("Parameters `path` and `searchParams` are mutually exclusive.")}if(t.search&&t.searchParams)throw new TypeError("Parameters `search` and `searchParams` are mutually exclusive.");if(!e){if(!t.protocol)throw new TypeError("No URL protocol specified");e=`${t.protocol}//${null!==(n=null!==(i=t.hostname)&&void 0!==i?i:t.host)&&void 0!==n?n:""}`}const s=new Hd.URL(e);if(t.path){const e=t.path.indexOf("?");-1===e?t.pathname=t.path:(t.pathname=t.path.slice(0,e),t.search=t.path.slice(e+1)),delete t.path}for(const e of $d)t[e]&&(s[e]=t[e].toString());return s};var Ud={};Object.defineProperty(Ud,"__esModule",{value:!0});Ud.default=class{constructor(){this.weakMap=new WeakMap,this.map=new Map}set(e,t){"object"==typeof e?this.weakMap.set(e,t):this.map.set(e,t)}get(e){return"object"==typeof e?this.weakMap.get(e):this.map.get(e)}has(e){return"object"==typeof e?this.weakMap.has(e):this.map.has(e)}};var qd,Md={};function zd(){if(qd)return Md;qd=1,Object.defineProperty(Md,"__esModule",{value:!0});return Md.default=async e=>{const t=[];let i=0;for await(const n of e)t.push(n),i+=Buffer.byteLength(n);return Buffer.isBuffer(t[0])?Buffer.concat(t,i):Buffer.from(t.join(""))},Md}var Gd={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.dnsLookupIpVersionToFamily=e.isDnsLookupIpVersion=void 0;const t={auto:0,ipv4:4,ipv6:6};e.isDnsLookupIpVersion=e=>e in t,e.dnsLookupIpVersionToFamily=i=>{if(e.isDnsLookupIpVersion(i))return t[i];throw new Error("Invalid DNS lookup IP version")}}(Gd);var Vd,Wd={};function Kd(){return Vd||(Vd=1,Object.defineProperty(Wd,"__esModule",{value:!0}),Wd.isResponseOk=void 0,Wd.isResponseOk=e=>{const{statusCode:t}=e,i=e.request.options.followRedirect?299:399;return t>=200&&t<=i||304===t}),Wd}var Jd={};Object.defineProperty(Jd,"__esModule",{value:!0});const Qd=new Set;Jd.default=e=>{Qd.has(e)||(Qd.add(e),process.emitWarning(`Got: ${e}`,{type:"DeprecationWarning"}))};var Xd={};Object.defineProperty(Xd,"__esModule",{value:!0});const Yd=lp.exports;Xd.default=(e,t)=>{if(Yd.default.null_(e.encoding))throw new TypeError("To get a Buffer, set `options.responseType` to `buffer` instead");Yd.assert.any([Yd.default.string,Yd.default.undefined],e.encoding),Yd.assert.any([Yd.default.boolean,Yd.default.undefined],e.resolveBodyOnly),Yd.assert.any([Yd.default.boolean,Yd.default.undefined],e.methodRewriting),Yd.assert.any([Yd.default.boolean,Yd.default.undefined],e.isStream),Yd.assert.any([Yd.default.string,Yd.default.undefined],e.responseType),void 0===e.responseType&&(e.responseType="text");const{retry:i}=e;if(e.retry=t?{...t.retry}:{calculateDelay:e=>e.computedValue,limit:0,methods:[],statusCodes:[],errorCodes:[],maxRetryAfter:void 0},Yd.default.object(i)?(e.retry={...e.retry,...i},e.retry.methods=[...new Set(e.retry.methods.map((e=>e.toUpperCase())))],e.retry.statusCodes=[...new Set(e.retry.statusCodes)],e.retry.errorCodes=[...new Set(e.retry.errorCodes)]):Yd.default.number(i)&&(e.retry.limit=i),Yd.default.undefined(e.retry.maxRetryAfter)&&(e.retry.maxRetryAfter=Math.min(...[e.timeout.request,e.timeout.connect].filter(Yd.default.number))),Yd.default.object(e.pagination)){t&&(e.pagination={...t.pagination,...e.pagination});const{pagination:i}=e;if(!Yd.default.function_(i.transform))throw new Error("`options.pagination.transform` must be implemented");if(!Yd.default.function_(i.shouldContinue))throw new Error("`options.pagination.shouldContinue` must be implemented");if(!Yd.default.function_(i.filter))throw new TypeError("`options.pagination.filter` must be implemented");if(!Yd.default.function_(i.paginate))throw new Error("`options.pagination.paginate` must be implemented")}return"json"===e.responseType&&void 0===e.headers.accept&&(e.headers.accept="application/json"),e};var Zd={};Object.defineProperty(Zd,"__esModule",{value:!0}),Zd.retryAfterStatusCodes=void 0,Zd.retryAfterStatusCodes=new Set([413,429,503]);var eh;function th(){return eh||(eh=1,function(e){var t=$&&$.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),i=$&&$.__exportStar||function(e,i){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||t(i,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.CancelError=e.ParseError=void 0;const n=gp;e.ParseError=class extends n.RequestError{constructor(e,t){const{options:i}=t.request;super(`${e.message} in "${i.url.toString()}"`,e,t.request),this.name="ParseError",this.code="ERR_GOT_REQUEST_ERROR"===this.code?"ERR_BODY_PARSE_FAILURE":this.code}};e.CancelError=class extends n.RequestError{constructor(e){super("Promise was canceled",{},e),this.name="CancelError",this.code="ERR_CANCELED"}get isCanceled(){return!0}},i(gp,e)}(fp)),fp}Zd.default=({attemptCount:e,retryOptions:t,error:i,retryAfter:n})=>{if(e>t.limit)return 0;const s=t.methods.includes(i.options.method),o=t.errorCodes.includes(i.code),a=i.response&&t.statusCodes.includes(i.response.statusCode);if(!s||!o&&!a)return 0;if(i.response){if(n)return void 0===t.maxRetryAfter||n>t.maxRetryAfter?0:n;if(413===i.response.statusCode)return 0}return 2**(e-1)*1e3+100*Math.random()},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.UnsupportedProtocolError=e.ReadError=e.TimeoutError=e.UploadError=e.CacheError=e.HTTPError=e.MaxRedirectsError=e.RequestError=e.setNonEnumerableProperties=e.knownHookEvents=e.withoutBody=e.kIsNormalizedAlready=void 0;const t=S.default,i=B.default,n=D.default,s=k.default,o=F.default,a=F.default,r=T.default,c=vp.exports,p=yp.exports,u=Zu,l=ol,d=vd,h=xu,m=lp.exports,f=xd,g=yd,v=Sd(),x=Fd,y=Rd,b=Nd,w=Ud,_=zd(),E=Gd,C=Kd(),A=Jd,O=Xd,I=Zd;let P;const j=Symbol("request"),R=Symbol("response"),L=Symbol("responseSize"),N=Symbol("downloadedSize"),H=Symbol("bodySize"),$=Symbol("uploadedSize"),U=Symbol("serverResponsesPiped"),q=Symbol("unproxyEvents"),M=Symbol("isFromCache"),z=Symbol("cancelTimeouts"),G=Symbol("startedReading"),V=Symbol("stopReading"),W=Symbol("triggerRead"),K=Symbol("body"),J=Symbol("jobs"),Q=Symbol("originalResponse"),X=Symbol("retryTimeout");e.kIsNormalizedAlready=Symbol("isNormalizedAlready");const Y=m.default.string(process.versions.brotli);e.withoutBody=new Set(["GET","HEAD"]),e.knownHookEvents=["init","beforeRequest","beforeRedirect","beforeError","beforeRetry","afterResponse"];const Z=new w.default,ee=new Set([300,301,302,303,304,307,308]),te=["context","body","json","form"];e.setNonEnumerableProperties=(e,t)=>{const i={};for(const t of e)if(t)for(const e of te)e in t&&(i[e]={writable:!0,configurable:!0,enumerable:!1,value:t[e]});Object.defineProperties(t,i)};class ie extends Error{constructor(e,t,i){var n,s;if(super(e),Error.captureStackTrace(this,this.constructor),this.name="RequestError",this.code=null!==(n=t.code)&&void 0!==n?n:"ERR_GOT_REQUEST_ERROR",i instanceof le?(Object.defineProperty(this,"request",{enumerable:!1,value:i}),Object.defineProperty(this,"response",{enumerable:!1,value:i[R]}),Object.defineProperty(this,"options",{enumerable:!1,value:i.options})):Object.defineProperty(this,"options",{enumerable:!1,value:i}),this.timings=null===(s=this.request)||void 0===s?void 0:s.timings,m.default.string(t.stack)&&m.default.string(this.stack)){const e=this.stack.indexOf(this.message)+this.message.length,i=this.stack.slice(e).split("\n").reverse(),n=t.stack.slice(t.stack.indexOf(t.message)+t.message.length).split("\n").reverse();for(;0!==n.length&&n[0]===i[0];)i.shift();this.stack=`${this.stack.slice(0,e)}${i.reverse().join("\n")}${n.reverse().join("\n")}`}}}e.RequestError=ie;class ne extends ie{constructor(e){super(`Redirected ${e.options.maxRedirects} times. Aborting.`,{},e),this.name="MaxRedirectsError",this.code="ERR_TOO_MANY_REDIRECTS"}}e.MaxRedirectsError=ne;class se extends ie{constructor(e){super(`Response code ${e.statusCode} (${e.statusMessage})`,{},e.request),this.name="HTTPError",this.code="ERR_NON_2XX_3XX_RESPONSE"}}e.HTTPError=se;class oe extends ie{constructor(e,t){super(e.message,e,t),this.name="CacheError",this.code="ERR_GOT_REQUEST_ERROR"===this.code?"ERR_CACHE_ACCESS":this.code}}e.CacheError=oe;class ae extends ie{constructor(e,t){super(e.message,e,t),this.name="UploadError",this.code="ERR_GOT_REQUEST_ERROR"===this.code?"ERR_UPLOAD":this.code}}e.UploadError=ae;class re extends ie{constructor(e,t,i){super(e.message,e,i),this.name="TimeoutError",this.event=e.event,this.timings=t}}e.TimeoutError=re;class ce extends ie{constructor(e,t){super(e.message,e,t),this.name="ReadError",this.code="ERR_GOT_REQUEST_ERROR"===this.code?"ERR_READING_RESPONSE_STREAM":this.code}}e.ReadError=ce;class pe extends ie{constructor(e){super(`Unsupported protocol "${e.url.protocol}"`,{},e),this.name="UnsupportedProtocolError",this.code="ERR_UNSUPPORTED_PROTOCOL"}}e.UnsupportedProtocolError=pe;const ue=["socket","connect","continue","information","upgrade","timeout"];class le extends i.Duplex{constructor(t,i={},s){super({autoDestroy:!1,highWaterMark:0}),this[N]=0,this[$]=0,this.requestInitialized=!1,this[U]=new Set,this.redirects=[],this[V]=!1,this[W]=!1,this[J]=[],this.retryCount=0,this._progressCallbacks=[];const o=()=>this._unlockWrite(),r=()=>this._lockWrite();this.on("pipe",(e=>{e.prependListener("data",o),e.on("data",r),e.prependListener("end",o),e.on("end",r)})),this.on("unpipe",(e=>{e.off("data",o),e.off("data",r),e.off("end",o),e.off("end",r)})),this.on("pipe",(e=>{e instanceof a.IncomingMessage&&(this.options.headers={...e.headers,...this.options.headers})}));const{json:c,body:p,form:u}=i;if((c||p||u)&&this._lockWrite(),e.kIsNormalizedAlready in i)this.options=i;else try{this.options=this.constructor.normalizeArguments(t,i,s)}catch(e){return m.default.nodeStream(i.body)&&i.body.destroy(),void this.destroy(e)}(async()=>{var e;try{this.options.body instanceof n.ReadStream&&await(async e=>new Promise(((t,i)=>{const n=e=>{i(e)};e.pending||t(),e.once("error",n),e.once("ready",(()=>{e.off("error",n),t()}))})))(this.options.body);const{url:t}=this.options;if(!t)throw new TypeError("Missing `url` property");if(this.requestUrl=t.toString(),decodeURI(this.requestUrl),await this._finalizeBody(),await this._makeRequest(),this.destroyed)return void(null===(e=this[j])||void 0===e||e.destroy());for(const e of this[J])e();this[J].length=0,this.requestInitialized=!0}catch(e){if(e instanceof ie)return void this._beforeError(e);this.destroyed||this.destroy(e)}})()}static normalizeArguments(i,n,o){var a,r,c,l,d;const f=n;if(m.default.object(i)&&!m.default.urlInstance(i))n={...o,...i,...n};else{if(i&&n&&void 0!==n.url)throw new TypeError("The `url` option is mutually exclusive with the `input` argument");n={...o,...n},void 0!==i&&(n.url=i),m.default.urlInstance(n.url)&&(n.url=new s.URL(n.url.toString()))}if(!1===n.cache&&(n.cache=void 0),!1===n.dnsCache&&(n.dnsCache=void 0),m.assert.any([m.default.string,m.default.undefined],n.method),m.assert.any([m.default.object,m.default.undefined],n.headers),m.assert.any([m.default.string,m.default.urlInstance,m.default.undefined],n.prefixUrl),m.assert.any([m.default.object,m.default.undefined],n.cookieJar),m.assert.any([m.default.object,m.default.string,m.default.undefined],n.searchParams),m.assert.any([m.default.object,m.default.string,m.default.undefined],n.cache),m.assert.any([m.default.object,m.default.number,m.default.undefined],n.timeout),m.assert.any([m.default.object,m.default.undefined],n.context),m.assert.any([m.default.object,m.default.undefined],n.hooks),m.assert.any([m.default.boolean,m.default.undefined],n.decompress),m.assert.any([m.default.boolean,m.default.undefined],n.ignoreInvalidCookies),m.assert.any([m.default.boolean,m.default.undefined],n.followRedirect),m.assert.any([m.default.number,m.default.undefined],n.maxRedirects),m.assert.any([m.default.boolean,m.default.undefined],n.throwHttpErrors),m.assert.any([m.default.boolean,m.default.undefined],n.http2),m.assert.any([m.default.boolean,m.default.undefined],n.allowGetBody),m.assert.any([m.default.string,m.default.undefined],n.localAddress),m.assert.any([E.isDnsLookupIpVersion,m.default.undefined],n.dnsLookupIpVersion),m.assert.any([m.default.object,m.default.undefined],n.https),m.assert.any([m.default.boolean,m.default.undefined],n.rejectUnauthorized),n.https&&(m.assert.any([m.default.boolean,m.default.undefined],n.https.rejectUnauthorized),m.assert.any([m.default.function_,m.default.undefined],n.https.checkServerIdentity),m.assert.any([m.default.string,m.default.object,m.default.array,m.default.undefined],n.https.certificateAuthority),m.assert.any([m.default.string,m.default.object,m.default.array,m.default.undefined],n.https.key),m.assert.any([m.default.string,m.default.object,m.default.array,m.default.undefined],n.https.certificate),m.assert.any([m.default.string,m.default.undefined],n.https.passphrase),m.assert.any([m.default.string,m.default.buffer,m.default.array,m.default.undefined],n.https.pfx)),m.assert.any([m.default.object,m.default.undefined],n.cacheOptions),m.default.string(n.method)?n.method=n.method.toUpperCase():n.method="GET",n.headers===(null==o?void 0:o.headers)?n.headers={...n.headers}:n.headers=h({...null==o?void 0:o.headers,...n.headers}),"slashes"in n)throw new TypeError("The legacy `url.Url` has been deprecated. Use `URL` instead.");if("auth"in n)throw new TypeError("Parameter `auth` is deprecated. Use `username` / `password` instead.");if("searchParams"in n&&n.searchParams&&n.searchParams!==(null==o?void 0:o.searchParams)){let e;if(m.default.string(n.searchParams)||n.searchParams instanceof s.URLSearchParams)e=new s.URLSearchParams(n.searchParams);else{!function(e){for(const t in e){const i=e[t];if(!(m.default.string(i)||m.default.number(i)||m.default.boolean(i)||m.default.null_(i)||m.default.undefined(i)))throw new TypeError(`The \`searchParams\` value '${String(i)}' must be a string, number, boolean or null`)}}(n.searchParams),e=new s.URLSearchParams;for(const t in n.searchParams){const i=n.searchParams[t];null===i?e.append(t,""):void 0!==i&&e.append(t,i)}}null===(a=null==o?void 0:o.searchParams)||void 0===a||a.forEach(((t,i)=>{e.has(i)||e.append(i,t)})),n.searchParams=e}if(n.username=null!==(r=n.username)&&void 0!==r?r:"",n.password=null!==(c=n.password)&&void 0!==c?c:"",m.default.undefined(n.prefixUrl)?n.prefixUrl=null!==(l=null==o?void 0:o.prefixUrl)&&void 0!==l?l:"":(n.prefixUrl=n.prefixUrl.toString(),""===n.prefixUrl||n.prefixUrl.endsWith("/")||(n.prefixUrl+="/")),m.default.string(n.url)){if(n.url.startsWith("/"))throw new Error("`input` must not start with a slash when using `prefixUrl`");n.url=b.default(n.prefixUrl+n.url,n)}else(m.default.undefined(n.url)&&""!==n.prefixUrl||n.protocol)&&(n.url=b.default(n.prefixUrl,n));if(n.url){"port"in n&&delete n.port;let{prefixUrl:e}=n;Object.defineProperty(n,"prefixUrl",{set:t=>{const i=n.url;if(!i.href.startsWith(t))throw new Error(`Cannot change \`prefixUrl\` from ${e} to ${t}: ${i.href}`);n.url=new s.URL(t+i.href.slice(e.length)),e=t},get:()=>e});let{protocol:t}=n.url;if("unix:"===t&&(t="http:",n.url=new s.URL(`http://unix${n.url.pathname}${n.url.search}`)),n.searchParams&&(n.url.search=n.searchParams.toString()),"http:"!==t&&"https:"!==t)throw new pe(n);""===n.username?n.username=n.url.username:n.url.username=n.username,""===n.password?n.password=n.url.password:n.url.password=n.password}const{cookieJar:g}=n;if(g){let{setCookie:e,getCookieString:i}=g;m.assert.function_(e),m.assert.function_(i),4===e.length&&0===i.length&&(e=t.promisify(e.bind(n.cookieJar)),i=t.promisify(i.bind(n.cookieJar)),n.cookieJar={setCookie:e,getCookieString:i})}const{cache:v}=n;if(v&&(Z.has(v)||Z.set(v,new u(((e,t)=>{const i=e[j](e,t);return m.default.promise(i)&&(i.once=(e,t)=>{if("error"===e)i.catch(t);else{if("abort"!==e)throw new Error(`Unknown HTTP2 promise event: ${e}`);(async()=>{try{(await i).once("abort",t)}catch(e){}})()}return i}),i}),v))),n.cacheOptions={...n.cacheOptions},!0===n.dnsCache)P||(P=new p.default),n.dnsCache=P;else if(!m.default.undefined(n.dnsCache)&&!n.dnsCache.lookup)throw new TypeError(`Parameter \`dnsCache\` must be a CacheableLookup instance or a boolean, got ${m.default(n.dnsCache)}`);m.default.number(n.timeout)?n.timeout={request:n.timeout}:o&&n.timeout!==o.timeout?n.timeout={...o.timeout,...n.timeout}:n.timeout={...n.timeout},n.context||(n.context={});const x=n.hooks===(null==o?void 0:o.hooks);n.hooks={...n.hooks};for(const t of e.knownHookEvents)if(t in n.hooks){if(!m.default.array(n.hooks[t]))throw new TypeError(`Parameter \`${t}\` must be an Array, got ${m.default(n.hooks[t])}`);n.hooks[t]=[...n.hooks[t]]}else n.hooks[t]=[];if(o&&!x)for(const t of e.knownHookEvents){o.hooks[t].length>0&&(n.hooks[t]=[...o.hooks[t],...n.hooks[t]])}if("family"in n&&A.default('"options.family" was never documented, please use "options.dnsLookupIpVersion"'),(null==o?void 0:o.https)&&(n.https={...o.https,...n.https}),"rejectUnauthorized"in n&&A.default('"options.rejectUnauthorized" is now deprecated, please use "options.https.rejectUnauthorized"'),"checkServerIdentity"in n&&A.default('"options.checkServerIdentity" was never documented, please use "options.https.checkServerIdentity"'),"ca"in n&&A.default('"options.ca" was never documented, please use "options.https.certificateAuthority"'),"key"in n&&A.default('"options.key" was never documented, please use "options.https.key"'),"cert"in n&&A.default('"options.cert" was never documented, please use "options.https.certificate"'),"passphrase"in n&&A.default('"options.passphrase" was never documented, please use "options.https.passphrase"'),"pfx"in n&&A.default('"options.pfx" was never documented, please use "options.https.pfx"'),"followRedirects"in n)throw new TypeError("The `followRedirects` option does not exist. Use `followRedirect` instead.");if(n.agent)for(const e in n.agent)if("http"!==e&&"https"!==e&&"http2"!==e)throw new TypeError(`Expected the \`options.agent\` properties to be \`http\`, \`https\` or \`http2\`, got \`${e}\``);return n.maxRedirects=null!==(d=n.maxRedirects)&&void 0!==d?d:0,e.setNonEnumerableProperties([o,f],n),O.default(n,o)}_lockWrite(){const e=()=>{throw new TypeError("The payload has been already provided")};this.write=e,this.end=e}_unlockWrite(){this.write=super.write,this.end=super.end}async _finalizeBody(){const{options:t}=this,{headers:n}=t,o=!m.default.undefined(t.form),a=!m.default.undefined(t.json),r=!m.default.undefined(t.body),c=o||a||r,p=e.withoutBody.has(t.method)&&!("GET"===t.method&&t.allowGetBody);if(this._cannotHaveBody=p,c){if(p)throw new TypeError(`The \`${t.method}\` method cannot be used with a body`);if([r,o,a].filter((e=>e)).length>1)throw new TypeError("The `body`, `json` and `form` options are mutually exclusive");if(r&&!(t.body instanceof i.Readable)&&!m.default.string(t.body)&&!m.default.buffer(t.body)&&!g.default(t.body))throw new TypeError("The `body` option must be a stream.Readable, string or Buffer");if(o&&!m.default.object(t.form))throw new TypeError("The `form` option must be an Object");{const e=!m.default.string(n["content-type"]);r?(g.default(t.body)&&e&&(n["content-type"]=`multipart/form-data; boundary=${t.body.getBoundary()}`),this[K]=t.body):o?(e&&(n["content-type"]="application/x-www-form-urlencoded"),this[K]=new s.URLSearchParams(t.form).toString()):(e&&(n["content-type"]="application/json"),this[K]=t.stringifyJson(t.json));const i=await f.default(this[K],t.headers);m.default.undefined(n["content-length"])&&m.default.undefined(n["transfer-encoding"])&&(p||m.default.undefined(i)||(n["content-length"]=String(i)))}}else p?this._lockWrite():this._unlockWrite();this[H]=Number(n["content-length"])||void 0}async _onResponseBase(e){const{options:t}=this,{url:i}=t;this[Q]=e,t.decompress&&(e=l(e));const n=e.statusCode,a=e;a.statusMessage=a.statusMessage?a.statusMessage:o.STATUS_CODES[n],a.url=t.url.toString(),a.requestUrl=this.requestUrl,a.redirectUrls=this.redirects,a.request=this,a.isFromCache=e.fromCache||!1,a.ip=this.ip,a.retryCount=this.retryCount,this[M]=a.isFromCache,this[L]=Number(e.headers["content-length"])||void 0,this[R]=e,e.once("end",(()=>{this[L]=this[N],this.emit("downloadProgress",this.downloadProgress)})),e.once("error",(t=>{e.destroy(),this._beforeError(new ce(t,this))})),e.once("aborted",(()=>{this._beforeError(new ce({name:"Error",message:"The server aborted pending request",code:"ECONNRESET"},this))})),this.emit("downloadProgress",this.downloadProgress);const r=e.headers["set-cookie"];if(m.default.object(t.cookieJar)&&r){let c=r.map((async e=>t.cookieJar.setCookie(e,i.toString())));t.ignoreInvalidCookies&&(c=c.map((async e=>e.catch((()=>{})))));try{await Promise.all(c)}catch(p){return void this._beforeError(p)}}if(t.followRedirect&&e.headers.location&&ee.has(n)){e.resume(),this[j]&&(this[z](),delete this[j],this[q]());if(!(303===n&&"GET"!==t.method&&"HEAD"!==t.method)&&t.methodRewriting||(t.method="GET","body"in t&&delete t.body,"json"in t&&delete t.json,"form"in t&&delete t.form,this[K]=void 0,delete t.headers["content-length"]),this.redirects.length>=t.maxRedirects)return void this._beforeError(new ne(this));try{const u=Buffer.from(e.headers.location,"binary").toString(),d=new s.URL(u,i),h=d.toString();function f(e){return"unix:"===e.protocol||"unix"===e.hostname}if(decodeURI(h),!f(i)&&f(d))return void this._beforeError(new ie("Cannot redirect to UNIX socket",{},this));d.hostname!==i.hostname||d.port!==i.port?("host"in t.headers&&delete t.headers.host,"cookie"in t.headers&&delete t.headers.cookie,"authorization"in t.headers&&delete t.headers.authorization,(t.username||t.password)&&(t.username="",t.password="")):(d.username=t.username,d.password=t.password),this.redirects.push(h),t.url=d;for(const g of t.hooks.beforeRedirect)await g(t,a);this.emit("redirect",a,t),await this._makeRequest()}catch(v){return void this._beforeError(v)}}else if(t.isStream&&t.throwHttpErrors&&!C.isResponseOk(a))this._beforeError(new se(a));else{e.on("readable",(()=>{this[W]&&this._read()})),this.on("resume",(()=>{e.resume()})),this.on("pause",(()=>{e.pause()})),e.once("end",(()=>{this.push(null)})),this.emit("response",e);for(const x of this[U])if(!x.headersSent){for(const y in e.headers){const b=!t.decompress||"content-encoding"!==y,w=e.headers[y];b&&x.setHeader(y,w)}x.statusCode=n}}}async _onResponse(e){try{await this._onResponseBase(e)}catch(e){this._beforeError(e)}}_onRequest(e){const{options:t}=this,{timeout:i,url:n}=t;c.default(e),this[z]=x.default(e,i,n);const s=t.cache?"cacheableResponse":"response";e.once(s,(e=>{this._onResponse(e)})),e.once("error",(t=>{var i;e.destroy(),null===(i=e.res)||void 0===i||i.removeAllListeners("end"),t=t instanceof x.TimeoutError?new re(t,this.timings,this):new ie(t.message,t,this),this._beforeError(t)})),this[q]=v.default(e,this,ue),this[j]=e,this.emit("uploadProgress",this.uploadProgress);const o=this[K],a=0===this.redirects.length?this:e;m.default.nodeStream(o)?(o.pipe(a),o.once("error",(e=>{this._beforeError(new ae(e,this))}))):(this._unlockWrite(),m.default.undefined(o)?(this._cannotHaveBody||this._noPipe)&&(a.end(),this._lockWrite()):(this._writeRequest(o,void 0,(()=>{})),a.end(),this._lockWrite())),this.emit("request",e)}async _createCacheableRequest(e,t){return new Promise(((i,n)=>{let s;Object.assign(t,y.default(e)),delete t.url;const o=Z.get(t.cache)(t,(async e=>{e._readableState.autoDestroy=!1,s&&(await s).emit("cacheableResponse",e),i(e)}));t.url=e,o.once("error",n),o.once("request",(async e=>{s=e,i(s)}))}))}async _makeRequest(){var e,t,i,n,s;const{options:a}=this,{headers:c}=a;for(const e in c)if(m.default.undefined(c[e]))delete c[e];else if(m.default.null_(c[e]))throw new TypeError(`Use \`undefined\` instead of \`null\` to delete the \`${e}\` header`);if(a.decompress&&m.default.undefined(c["accept-encoding"])&&(c["accept-encoding"]=Y?"gzip, deflate, br":"gzip, deflate"),a.cookieJar){const e=await a.cookieJar.getCookieString(a.url.toString());m.default.nonEmptyString(e)&&(a.headers.cookie=e)}for(const e of a.hooks.beforeRequest){const t=await e(a);if(!m.default.undefined(t)){a.request=()=>t;break}}a.body&&this[K]!==a.body&&(this[K]=a.body);const{agent:p,request:l,timeout:h,url:f}=a;if(a.dnsCache&&!("lookup"in a)&&(a.lookup=a.dnsCache.lookup),"unix"===f.hostname){const e=/(?<socketPath>.+?):(?<path>.+)/.exec(`${f.pathname}${f.search}`);if(null==e?void 0:e.groups){const{socketPath:t,path:i}=e.groups;Object.assign(a,{socketPath:t,path:i,host:""})}}const g="https:"===f.protocol;let v;v=a.http2?d.auto:g?r.request:o.request;const x=null!==(e=a.request)&&void 0!==e?e:v,y=a.cache?this._createCacheableRequest:x;p&&!a.http2&&(a.agent=p[g?"https":"http"]),a[j]=x,delete a.request,delete a.timeout;const b=a;if(b.shared=null===(t=a.cacheOptions)||void 0===t?void 0:t.shared,b.cacheHeuristic=null===(i=a.cacheOptions)||void 0===i?void 0:i.cacheHeuristic,b.immutableMinTimeToLive=null===(n=a.cacheOptions)||void 0===n?void 0:n.immutableMinTimeToLive,b.ignoreCargoCult=null===(s=a.cacheOptions)||void 0===s?void 0:s.ignoreCargoCult,void 0!==a.dnsLookupIpVersion)try{b.family=E.dnsLookupIpVersionToFamily(a.dnsLookupIpVersion)}catch(e){throw new Error("Invalid `dnsLookupIpVersion` option value")}a.https&&("rejectUnauthorized"in a.https&&(b.rejectUnauthorized=a.https.rejectUnauthorized),a.https.checkServerIdentity&&(b.checkServerIdentity=a.https.checkServerIdentity),a.https.certificateAuthority&&(b.ca=a.https.certificateAuthority),a.https.certificate&&(b.cert=a.https.certificate),a.https.key&&(b.key=a.https.key),a.https.passphrase&&(b.passphrase=a.https.passphrase),a.https.pfx&&(b.pfx=a.https.pfx));try{let e=await y(f,b);m.default.undefined(e)&&(e=v(f,b)),a.request=l,a.timeout=h,a.agent=p,a.https&&("rejectUnauthorized"in a.https&&delete b.rejectUnauthorized,a.https.checkServerIdentity&&delete b.checkServerIdentity,a.https.certificateAuthority&&delete b.ca,a.https.certificate&&delete b.cert,a.https.key&&delete b.key,a.https.passphrase&&delete b.passphrase,a.https.pfx&&delete b.pfx),!function(e){return m.default.object(e)&&!("statusCode"in e)}(e)?this.writable?(this.once("finish",(()=>{this._onResponse(e)})),this._unlockWrite(),this.end(),this._lockWrite()):this._onResponse(e):this._onRequest(e)}catch(e){if(e instanceof u.CacheError)throw new oe(e,this);throw new ie(e.message,e,this)}}async _error(e){try{for(const t of this.options.hooks.beforeError)e=await t(e)}catch(t){e=new ie(t.message,t,this)}this.destroy(e)}_beforeError(e){if(this[V])return;const{options:t}=this,i=this.retryCount+1;this[V]=!0,e instanceof ie||(e=new ie(e.message,e,this));const n=e,{response:s}=n;(async()=>{if(s&&!s.body){s.setEncoding(this._readableState.encoding);try{s.rawBody=await _.default(s),s.body=s.rawBody.toString()}catch(e){}}if(0!==this.listenerCount("retry")){let o;try{let e;s&&"retry-after"in s.headers&&(e=Number(s.headers["retry-after"]),Number.isNaN(e)?(e=Date.parse(s.headers["retry-after"])-Date.now(),e<=0&&(e=1)):e*=1e3),o=await t.retry.calculateDelay({attemptCount:i,retryOptions:t.retry,error:n,retryAfter:e,computedValue:I.default({attemptCount:i,retryOptions:t.retry,error:n,retryAfter:e,computedValue:0})})}catch(e){return void this._error(new ie(e.message,e,this))}if(o){const t=async()=>{try{for(const e of this.options.hooks.beforeRetry)await e(this.options,n,i)}catch(t){return void this._error(new ie(t.message,e,this))}this.destroyed||(this.destroy(),this.emit("retry",i,e))};return void(this[X]=setTimeout(t,o))}}this._error(n)})()}_read(){this[W]=!0;const e=this[R];if(e&&!this[V]){let t;for(e.readableLength&&(this[W]=!1);null!==(t=e.read());){this[N]+=t.length,this[G]=!0;const e=this.downloadProgress;e.percent<1&&this.emit("downloadProgress",e),this.push(t)}}}_write(e,t,i){const n=()=>{this._writeRequest(e,t,i)};this.requestInitialized?n():this[J].push(n)}_writeRequest(e,t,i){this[j].destroyed||(this._progressCallbacks.push((()=>{this[$]+=Buffer.byteLength(e,t);const i=this.uploadProgress;i.percent<1&&this.emit("uploadProgress",i)})),this[j].write(e,t,(e=>{!e&&this._progressCallbacks.length>0&&this._progressCallbacks.shift()(),i(e)})))}_final(e){const t=()=>{for(;0!==this._progressCallbacks.length;)this._progressCallbacks.shift()();j in this?this[j].destroyed?e():this[j].end((t=>{t||(this[H]=this[$],this.emit("uploadProgress",this.uploadProgress),this[j].emit("upload-complete")),e(t)})):e()};this.requestInitialized?t():this[J].push(t)}_destroy(e,t){var i;this[V]=!0,clearTimeout(this[X]),j in this&&(this[z](),(null===(i=this[R])||void 0===i?void 0:i.complete)||this[j].destroy()),null===e||m.default.undefined(e)||e instanceof ie||(e=new ie(e.message,e,this)),t(e)}get _isAboutToError(){return this[V]}get ip(){var e;return null===(e=this.socket)||void 0===e?void 0:e.remoteAddress}get aborted(){var e,t,i;return(null!==(t=null===(e=this[j])||void 0===e?void 0:e.destroyed)&&void 0!==t?t:this.destroyed)&&!(null===(i=this[Q])||void 0===i?void 0:i.complete)}get socket(){var e,t;return null!==(t=null===(e=this[j])||void 0===e?void 0:e.socket)&&void 0!==t?t:void 0}get downloadProgress(){let e;return e=this[L]?this[N]/this[L]:this[L]===this[N]?1:0,{percent:e,transferred:this[N],total:this[L]}}get uploadProgress(){let e;return e=this[H]?this[$]/this[H]:this[H]===this[$]?1:0,{percent:e,transferred:this[$],total:this[H]}}get timings(){var e;return null===(e=this[j])||void 0===e?void 0:e.timings}get isFromCache(){return this[M]}pipe(e,t){if(this[G])throw new Error("Failed to pipe. The response has been emitted already.");return e instanceof a.ServerResponse&&this[U].add(e),super.pipe(e,t)}unpipe(e){return e instanceof a.ServerResponse&&this[U].delete(e),super.unpipe(e),this}}e.default=le}(gp);var ih,nh,sh={};function oh(){return nh||(nh=1,function(e){var t=$&&$.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),i=$&&$.__exportStar||function(e,i){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||t(i,e,n)};Object.defineProperty(e,"__esModule",{value:!0});const n=A.default,s=lp.exports,o=function(){if(dp)return mp.exports;dp=1;class e extends Error{constructor(e){super(e||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}}class t{static fn(e){return(...i)=>new t(((t,n,s)=>{i.push(s),e(...i).then(t,n)}))}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise(((t,i)=>{this._reject=i;const n=e=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(e)};return Object.defineProperties(n,{shouldReject:{get:()=>this._rejectOnCancel,set:e=>{this._rejectOnCancel=e}}}),e((e=>{this._isCanceled&&n.shouldReject||(this._isPending=!1,t(e))}),(e=>{this._isPending=!1,i(e)}),n)}))}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(t){if(this._isPending&&!this._isCanceled){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(const e of this._cancelHandlers)e()}catch(e){return void this._reject(e)}this._rejectOnCancel&&this._reject(new e(t))}}get isCanceled(){return this._isCanceled}}return Object.setPrototypeOf(t.prototype,Promise.prototype),mp.exports=t,mp.exports.CancelError=e,mp.exports}(),a=th(),r=function(){if(ih)return sh;ih=1,Object.defineProperty(sh,"__esModule",{value:!0});const e=th();return sh.default=(t,i,n,s)=>{const{rawBody:o}=t;try{if("text"===i)return o.toString(s);if("json"===i)return 0===o.length?"":n(o.toString());if("buffer"===i)return o;throw new e.ParseError({message:`Unknown body type '${i}'`,name:"Error"},t)}catch(i){throw new e.ParseError(i,t)}},sh}(),c=gp,p=Sd(),u=zd(),l=Kd(),d=["request","response","redirect","uploadProgress","downloadProgress"];e.default=function e(t){let i,h;const m=new n.EventEmitter,f=new o(((n,o,g)=>{const v=x=>{const y=new c.default(void 0,t);y.retryCount=x,y._noPipe=!0,g((()=>y.destroy())),g.shouldReject=!1,g((()=>o(new a.CancelError(y)))),i=y,y.once("response",(async t=>{var i;if(t.retryCount=x,t.request.aborted)return;let s;try{s=await u.default(y),t.rawBody=s}catch(e){return}if(y._isAboutToError)return;const o=(null!==(i=t.headers["content-encoding"])&&void 0!==i?i:"").toLowerCase(),p=["gzip","deflate","br"].includes(o),{options:d}=y;if(p&&!d.decompress)t.body=s;else try{t.body=r.default(t,d.responseType,d.parseJson,d.encoding)}catch(e){if(t.body=s.toString(),l.isResponseOk(t))return void y._beforeError(e)}try{for(const[i,n]of d.hooks.afterResponse.entries())t=await n(t,(async t=>{const n=c.default.normalizeArguments(void 0,{...t,retry:{calculateDelay:()=>0},throwHttpErrors:!1,resolveBodyOnly:!1},d);n.hooks.afterResponse=n.hooks.afterResponse.slice(0,i);for(const e of n.hooks.beforeRetry)await e(n);const s=e(n);return g((()=>{s.catch((()=>{})),s.cancel()})),s}))}catch(e){return void y._beforeError(new a.RequestError(e.message,e,y))}h=t,l.isResponseOk(t)?n(y.options.resolveBodyOnly?t.body:t):y._beforeError(new a.HTTPError(t))}));const b=e=>{if(f.isCanceled)return;const{options:t}=y;if(e instanceof a.HTTPError&&!t.throwHttpErrors){const{response:t}=e;n(y.options.resolveBodyOnly?t.body:t)}else o(e)};y.once("error",b);const w=y.options.body;y.once("retry",((e,t)=>{var i,n;w===(null===(i=t.request)||void 0===i?void 0:i.options.body)&&s.default.nodeStream(null===(n=t.request)||void 0===n?void 0:n.options.body)?b(t):v(e)})),p.default(y,m,d)};v(0)}));f.on=(e,t)=>(m.on(e,t),f);const g=e=>{const t=(async()=>{await f;const{options:t}=h.request;return r.default(h,e,t.parseJson,t.encoding)})();return Object.defineProperties(t,Object.getOwnPropertyDescriptors(f)),t};return f.json=()=>{const{headers:e}=i.options;return i.writableFinished||void 0!==e.accept||(e.accept="application/json"),g("json")},f.buffer=()=>g("buffer"),f.text=()=>g("text"),f},i(th(),e)}(hp)),hp}var ah={};Object.defineProperty(ah,"__esModule",{value:!0});const rh=th();ah.default=function(e,...t){const i=(async()=>{if(e instanceof rh.RequestError)try{for(const i of t)if(i)for(const t of i)e=await t(e)}catch(t){e=t}throw e})(),n=()=>i;return i.json=n,i.text=n,i.buffer=n,i.on=n,i};var ch={};Object.defineProperty(ch,"__esModule",{value:!0});const ph=lp.exports;ch.default=function e(t){for(const i of Object.values(t))(ph.default.plainObject(i)||ph.default.array(i))&&e(i);return Object.freeze(t)};var uh,lh={};!function(e){var t=$&&$.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),i=$&&$.__exportStar||function(e,i){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||t(i,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.defaultHandler=void 0;const n=lp.exports,s=oh(),o=ah,a=gp,r=ch,c={RequestError:s.RequestError,CacheError:s.CacheError,ReadError:s.ReadError,HTTPError:s.HTTPError,MaxRedirectsError:s.MaxRedirectsError,TimeoutError:s.TimeoutError,ParseError:s.ParseError,CancelError:s.CancelError,UnsupportedProtocolError:s.UnsupportedProtocolError,UploadError:s.UploadError},p=async e=>new Promise((t=>{setTimeout(t,e)})),{normalizeArguments:u}=a.default,l=(...e)=>{let t;for(const i of e)t=u(void 0,i,t);return t},d=e=>e.isStream?new a.default(void 0,e):s.default(e),h=e=>"defaults"in e&&"options"in e.defaults,m=["get","post","put","patch","head","delete"];e.defaultHandler=(e,t)=>t(e);const f=(e,t)=>{if(e)for(const i of e)i(t)},g=t=>{t._rawHandlers=t.handlers,t.handlers=t.handlers.map((e=>(t,i)=>{let n;const s=e(t,(e=>(n=i(e),n)));if(s!==n&&!t.isStream&&n){const e=s,{then:t,catch:i,finally:o}=e;Object.setPrototypeOf(e,Object.getPrototypeOf(n)),Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)),e.then=t,e.catch=i,e.finally=o}return s}));const i=(e,i={},r)=>{var c,p;let l=0;const h=e=>t.handlers[l++](e,l===t.handlers.length?d:h);if(n.default.plainObject(e)){const t={...e,...i};a.setNonEnumerableProperties([e,i],t),i=t,e=void 0}try{let n;try{f(t.options.hooks.init,i),f(null===(c=i.hooks)||void 0===c?void 0:c.init,i)}catch(e){n=e}const o=u(e,i,null!=r?r:t.options);if(o[a.kIsNormalizedAlready]=!0,n)throw new s.RequestError(n.message,n,o);return h(o)}catch(e){if(i.isStream)throw e;return o.default(e,t.options.hooks.beforeError,null===(p=i.hooks)||void 0===p?void 0:p.beforeError)}};i.extend=(...i)=>{const n=[t.options];let s,o=[...t._rawHandlers];for(const e of i)h(e)?(n.push(e.defaults.options),o.push(...e.defaults._rawHandlers),s=e.defaults.mutableDefaults):(n.push(e),"handlers"in e&&o.push(...e.handlers),s=e.mutableDefaults);return o=o.filter((t=>t!==e.defaultHandler)),0===o.length&&o.push(e.defaultHandler),g({options:l(...n),handlers:o,mutableDefaults:Boolean(s)})};const v=async function*(e,s){let o=u(e,s,t.options);o.resolveBodyOnly=!1;const a=o.pagination;if(!n.default.object(a))throw new TypeError("`options.pagination` must be implemented");const r=[];let{countLimit:c}=a,l=0;for(;l<a.requestLimit;){0!==l&&await p(a.backoff);const e=await i(void 0,void 0,o),t=await a.transform(e),n=[];for(const e of t)if(a.filter(e,r,n)){if(!a.shouldContinue(e,r,n))return;if(yield e,a.stackAllItems&&r.push(e),n.push(e),--c<=0)return}const s=a.paginate(e,r,n);if(!1===s)return;s===e.request.options?o=e.request.options:void 0!==s&&(o=u(void 0,s,o)),l++}};(i.paginate=v).all=async(e,t)=>{const i=[];for await(const n of v(e,t))i.push(n);return i},i.paginate.each=v,i.stream=(e,t)=>i(e,{...t,isStream:!0});for(const e of m)i[e]=(t,n)=>i(t,{...n,method:e}),i.stream[e]=(t,n)=>i(t,{...n,method:e,isStream:!0});return Object.assign(i,c),Object.defineProperty(i,"defaults",{value:t.mutableDefaults?t:r.default(t),writable:t.mutableDefaults,configurable:t.mutableDefaults,enumerable:!0}),i.mergeOptions=l,i};e.default=g,i((uh||(uh=1,Object.defineProperty(lh,"__esModule",{value:!0})),lh),e)}(up),function(e,t){var i=$&&$.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),n=$&&$.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});const s=k.default,o=up,a={options:{method:"GET",retry:{limit:2,methods:["GET","PUT","HEAD","DELETE","OPTIONS","TRACE"],statusCodes:[408,413,429,500,502,503,504,521,522,524],errorCodes:["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"],maxRetryAfter:void 0,calculateDelay:({computedValue:e})=>e},timeout:{},headers:{"user-agent":"got (https://github.com/sindresorhus/got)"},hooks:{init:[],beforeRequest:[],beforeRedirect:[],beforeRetry:[],beforeError:[],afterResponse:[]},cache:void 0,dnsCache:void 0,decompress:!0,throwHttpErrors:!0,followRedirect:!0,isStream:!1,responseType:"text",resolveBodyOnly:!1,maxRedirects:10,prefixUrl:"",methodRewriting:!0,ignoreInvalidCookies:!1,context:{},http2:!1,allowGetBody:!1,https:void 0,pagination:{transform:e=>"json"===e.request.options.responseType?e.body:JSON.parse(e.body),paginate:e=>{if(!Reflect.has(e.headers,"link"))return!1;const t=e.headers.link.split(",");let i;for(const e of t){const t=e.split(";");if(t[1].includes("next")){i=t[0].trimStart().trim(),i=i.slice(1,-1);break}}if(i){return{url:new s.URL(i)}}return!1},filter:()=>!0,shouldContinue:()=>!0,countLimit:1/0,backoff:0,requestLimit:1e4,stackAllItems:!0},parseJson:e=>JSON.parse(e),stringifyJson:e=>JSON.stringify(e),cacheOptions:{}},handlers:[o.defaultHandler],mutableDefaults:!1},r=o.default(a);t.default=r,e.exports=r,e.exports.default=r,e.exports.__esModule=!0,n(up,t),n(oh(),t)}(pp,pp.exports);var dh=U(pp.exports);const hh=(e,t)=>{const{isTransformResponse:i,isReturnNativeResponse:n}=t;if(n)return e;if(!1===i)return e.body;const{body:s}=e;if(t.isJsonp&&rr(s))return function(e){const t=e.replace(/^\w+\(/,"").replace(/\)$/,"");return JSON.parse(t)}(s);try{if(rr(s)&&s.startsWith("{"))return JSON.parse(s)}catch{}return s};class mh{name="VGot";constructor(e){e.baseURL&&(e.prefixUrl=e.baseURL),this.options=e,this.gotInstance=dh.extend(e,{hooks:{afterResponse:[e=>{const{requestOptions:t}=e.request.options;var i;null!=t&&t.withBiliCookie&&(ap.COOKIE=Yc(ap.COOKIE,(null===(i=e.headers)||void 0===i?void 0:i["set-cookie"])||[]));return e}]}})}request(e){const{requestOptions:t={},headers:i={}}=this.options;return e.requestOptions=Object.assign({},t,e.requestOptions),e.headers=Object.assign({},i,e.headers),t.withBiliCookie&&(e.headers.Cookie=ap.COOKIE),t.retry&&(e.retry=t.retry),e=function(e){var t;function i(t){e.agent||(e.agent={}),e.agent[t]=e[`${t}Agent`]}return rr(e.url)||(e.url=e.url.toString()),ar(e.params)&&!rr(e.searchParams)&&(e.searchParams={...e.searchParams,...e.params}),ar(e.data)&&(null!==(t=e.headers["content-type"])&&void 0!==t&&t.startsWith("application/x-www-form-urlencoded")?e.body=gr(e.data):e.json=e.data),e.httpAgent&&i("http"),e.httpsAgent&&i("https"),e.url&&e.url.startsWith("/")&&(e.url=e.url.substring(1)),e}(e),new Promise(((t,i)=>{this.gotInstance(e).then((n=>{{"function"!=typeof hh;try{const i=hh(n,e.requestOptions);t(i)}catch(e){i(e||new Error("请求错误!"))}}})).catch((e=>{i(e)}))}))}get(e,t){return rr(e)?this.request({...t,method:"GET",url:e}):this.request({...e,method:"GET"})}post(e,t,i){return rr(e)?this.request({...i,method:"POST",url:e,data:t}):this.request({...e,method:"POST"})}put(e,t,i){return this.request({...i,method:"PUT",url:e,data:t})}delete(e,t,i){return this.request({...i,method:"DELETE",url:e,data:t})}patch(e,t,i){return this.request({...i,method:"PATCH",url:e,data:t})}}function fh(e){return new mh(fr({timeout:1e4,headers:{"content-type":ir["content-type"],"user-agent":ir["user-agent"],"accept-language":ir["accept-language"],"accept-encoding":ir["accept-encoding"]},requestOptions:{isTransformResponse:!0,ignoreCancelToken:!0,withBiliCookie:!0}},e||{}))}const gh=fh({requestOptions:{withBiliCookie:!1}}),vh=fh();async function xh(){let e="v0.5.0";e.includes(".")?oc.info("当前版本【v0.5.0】"):e=void 0;try{if(e||(e=function(){try{return require("../../package.json").version}catch{}}()||function(){try{return _.readFileSync(b.resolve(__dirname,"../version.txt"),"utf8").trim()}catch{}}(),oc.info(`当前版本【v${e}】`)),!e)return;const t=await async function(){const e={timeout:6e3};try{return(await Promise.any([gh.get("https://api.github.com/repos/catlair/BiliTools/releases/latest",e),gh.get("https://gitee.com/api/v5/repos/catlair/BiliTools/releases/latest",e)])).tag_name}catch(e){return}}();t&&t!==`v${e}`&&oc.info(`可更新：最新版本【${t}】`)}catch{}}function yh(e){const t=function(){const e=ap.function;return e.addCoins||e.shareAndWatch||(e.taskReward=!1),e.liveIntimacy&&(e.liveSendMessage=!1),e}();return e.map((e=>t[e.name]?e:null)).filter((e=>e))}function bh(e,t){const i=function(e,t){if(e&&t)return lr(e,t);if(e)return e;const i=ap.BILI_API_DELAY;if(1===i.length)return 1e3*i[0];return 1e3*lr(i[0]||2,i[1]||6)}(e,t);return new Promise((e=>{setTimeout((()=>{e(i)}),i)}))}process.env.IS_LOCAL="true",async function(){const{dailyTasks:e}=await Promise.resolve().then((function(){return Lx}));await xh(),await e()}();var wh={exports:{}},_h={exports:{}};const Dh=k.default;var Eh=class{constructor(e){this.options=e||{},this.cookies=[]}set(e,t){let i,n=Dh.parse(t||""),s=this.parse(e);return s.domain?(i=s.domain.replace(/^\./,""),(n.hostname.length<i.length||("."+n.hostname).substr(1-i.length)!=="."+i)&&(s.domain=n.hostname)):s.domain=n.hostname,s.path||(s.path=this.getPath(n.pathname)),s.expires||(s.expires=new Date(Date.now()+1e3*(Number(this.options.sessionTimeout||1800)||1800))),this.add(s)}get(e){return this.list(e).map((e=>e.name+"="+e.value)).join("; ")}list(e){let t,i,n=[];for(t=this.cookies.length-1;t>=0;t--)i=this.cookies[t],this.isExpired(i)?this.cookies.splice(t,t):this.match(i,e)&&n.unshift(i);return n}parse(e){let t={};return(e||"").toString().split(";").forEach((e=>{let i,n=e.split("="),s=n.shift().trim().toLowerCase(),o=n.join("=").trim();if(s)switch(s){case"expires":o=new Date(o),"Invalid Date"!==o.toString()&&(t.expires=o);break;case"path":t.path=o;break;case"domain":i=o.toLowerCase(),i.length&&"."!==i.charAt(0)&&(i="."+i),t.domain=i;break;case"max-age":t.expires=new Date(Date.now()+1e3*(Number(o)||0));break;case"secure":t.secure=!0;break;case"httponly":t.httponly=!0;break;default:t.name||(t.name=s,t.value=o)}})),t}match(e,t){let i=Dh.parse(t||"");return(i.hostname===e.domain||"."===e.domain.charAt(0)&&("."+i.hostname).substr(-e.domain.length)===e.domain)&&(this.getPath(i.pathname).substr(0,e.path.length)===e.path&&(!e.secure||"https:"===i.protocol))}add(e){let t,i;if(!e||!e.name)return!1;for(t=0,i=this.cookies.length;t<i;t++)if(this.compare(this.cookies[t],e))return this.isExpired(e)?(this.cookies.splice(t,1),!1):(this.cookies[t]=e,!0);return this.isExpired(e)||this.cookies.push(e),!0}compare(e,t){return e.name===t.name&&e.path===t.path&&e.domain===t.domain&&e.secure===t.secure&&e.httponly==e.httponly}isExpired(e){return e.expires&&e.expires<new Date||!e.value}getPath(e){let t=(e||"/").split("/");return t.pop(),t=t.join("/").trim(),"/"!==t.charAt(0)&&(t="/"+t),"/"!==t.substr(-1)&&(t+="/"),t}},Ch={name:"nodemailer",version:"6.7.5",description:"Easy as cake e-mail sending from your Node.js applications",main:"lib/nodemailer.js",scripts:{test:"grunt --trace-warnings"},repository:{type:"git",url:"https://github.com/nodemailer/nodemailer.git"},keywords:["Nodemailer"],author:"Andris Reinman",license:"MIT",bugs:{url:"https://github.com/nodemailer/nodemailer/issues"},homepage:"https://nodemailer.com/",devDependencies:{"@aws-sdk/client-ses":"3.79.0","aws-sdk":"2.1124.0",bunyan:"1.8.15",chai:"4.3.6","eslint-config-nodemailer":"1.2.0","eslint-config-prettier":"8.5.0",grunt:"1.5.2","grunt-cli":"1.4.3","grunt-eslint":"24.0.0","grunt-mocha-test":"0.13.3",libbase64:"1.2.1",libmime:"5.1.0",libqp:"1.1.0",mocha:"9.2.2","nodemailer-ntlm-auth":"1.0.1",proxy:"1.0.2","proxy-test-server":"1.0.0",sinon:"13.0.2","smtp-server":"3.11.0"},engines:{node:">=6.0.0"}};const Ah=F.default,kh=T.default,Sh=k.default,Fh=C.default,Th=B.default.PassThrough,Bh=Eh,Oh=Ch;function Ih(e,t){(t=t||{}).fetchRes=t.fetchRes||new Th,t.cookies=t.cookies||new Bh,t.redirects=t.redirects||0,t.maxRedirects=isNaN(t.maxRedirects)?5:t.maxRedirects,t.cookie&&([].concat(t.cookie||[]).forEach((i=>{t.cookies.set(i,e)})),t.cookie=!1);let i,n,s,o=t.fetchRes,a=Sh.parse(e),r=(t.method||"").toString().trim().toUpperCase()||"GET",c=!1,p="https:"===a.protocol?kh:Ah,u={"accept-encoding":"gzip,deflate","user-agent":"nodemailer/"+Oh.version};if(Object.keys(t.headers||{}).forEach((e=>{u[e.toLowerCase().trim()]=t.headers[e]})),t.userAgent&&(u["user-agent"]=t.userAgent),a.auth&&(u.Authorization="Basic "+Buffer.from(a.auth).toString("base64")),(i=t.cookies.get(e))&&(u.cookie=i),t.body){if(!1!==t.contentType&&(u["Content-Type"]=t.contentType||"application/x-www-form-urlencoded"),"function"==typeof t.body.pipe)u["Transfer-Encoding"]="chunked",n=t.body,n.on("error",(t=>{c||(c=!0,t.type="FETCH",t.sourceUrl=e,o.emit("error",t))}));else{if(t.body instanceof Buffer)n=t.body;else if("object"==typeof t.body)try{n=Buffer.from(Object.keys(t.body).map((e=>{let i=t.body[e].toString().trim();return encodeURIComponent(e)+"="+encodeURIComponent(i)})).join("&"))}catch(t){if(c)return;return c=!0,t.type="FETCH",t.sourceUrl=e,void o.emit("error",t)}else n=Buffer.from(t.body.toString().trim());u["Content-Type"]=t.contentType||"application/x-www-form-urlencoded",u["Content-Length"]=n.length}r=(t.method||"").toString().trim().toUpperCase()||"POST"}let l={method:r,host:a.hostname,path:a.path,port:a.port?a.port:"https:"===a.protocol?443:80,headers:u,rejectUnauthorized:!1,agent:!1};t.tls&&Object.keys(t.tls).forEach((e=>{l[e]=t.tls[e]}));try{s=p.request(l)}catch(t){return c=!0,setImmediate((()=>{t.type="FETCH",t.sourceUrl=e,o.emit("error",t)})),o}return t.timeout&&s.setTimeout(t.timeout,(()=>{if(c)return;c=!0,s.abort();let t=new Error("Request Timeout");t.type="FETCH",t.sourceUrl=e,o.emit("error",t)})),s.on("error",(t=>{c||(c=!0,t.type="FETCH",t.sourceUrl=e,o.emit("error",t))})),s.on("response",(i=>{let n;if(!c){switch(i.headers["content-encoding"]){case"gzip":case"deflate":n=Fh.createUnzip()}if(i.headers["set-cookie"]&&[].concat(i.headers["set-cookie"]||[]).forEach((i=>{t.cookies.set(i,e)})),[301,302,303,307,308].includes(i.statusCode)&&i.headers.location){if(t.redirects++,t.redirects>t.maxRedirects){c=!0;let t=new Error("Maximum redirect count exceeded");return t.type="FETCH",t.sourceUrl=e,o.emit("error",t),void s.abort()}return t.method="GET",t.body=!1,Ih(Sh.resolve(e,i.headers.location),t)}if(o.statusCode=i.statusCode,o.headers=i.headers,i.statusCode>=300&&!t.allowErrorResponse){c=!0;let t=new Error("Invalid status code "+i.statusCode);return t.type="FETCH",t.sourceUrl=e,o.emit("error",t),void s.abort()}i.on("error",(t=>{c||(c=!0,t.type="FETCH",t.sourceUrl=e,o.emit("error",t),s.abort())})),n?(i.pipe(n).pipe(o),n.on("error",(t=>{c||(c=!0,t.type="FETCH",t.sourceUrl=e,o.emit("error",t),s.abort())}))):i.pipe(o)}})),setImmediate((()=>{if(n)try{if("function"==typeof n.pipe)return n.pipe(s);s.write(n)}catch(t){return c=!0,t.type="FETCH",t.sourceUrl=e,void o.emit("error",t)}s.end()})),o}_h.exports=function(e,t){return Ih(e,t)},_h.exports.Cookies=Bh,function(e){const t=k.default,i=S.default,n=D.default,s=_h.exports,o=O.default,a=I.default,r=P.default,c=3e5,p=e.exports.networkInterfaces=r.networkInterfaces(),u=e=>{const t=Object.keys(p).map((e=>p[e])).reduce(((e,t)=>e.concat(t)),[]).filter((e=>!e.internal)).filter((t=>t.family==="IPv"+e||t.family===e)).length>0;return t},l=(e,t,i)=>{if(!u(e))return i(null,[]);o["resolve"+e](t,((e,t)=>{if(e){switch(e.code){case o.NODATA:case o.NOTFOUND:case o.NOTIMP:case o.SERVFAIL:case o.CONNREFUSED:case"EAI_AGAIN":return i(null,[])}return i(e)}return i(null,Array.isArray(t)?t:[].concat(t||[]))}))},d=e.exports.dnsCache=new Map,h=(e,t)=>e?Object.assign({servername:e.servername,host:e.addresses&&e.addresses.length?1===e.addresses.length?e.addresses[0]:e.addresses[Math.floor(Math.random()*e.addresses.length)]:null},t||{}):Object.assign({},t||{});function m(e,t){let i=!1,n=[],s=0;e.on("error",(e=>{i||(i=!0,t(e))})),e.on("readable",(()=>{let t;for(;null!==(t=e.read());)n.push(t),s+=t.length})),e.on("end",(()=>{if(i)return;let e;i=!0;try{e=Buffer.concat(n,s)}catch(e){return t(e)}t(null,e)}))}e.exports.resolveHostname=(e,t)=>{if(!(e=e||{}).host&&e.servername&&(e.host=e.servername),!e.host||a.isIP(e.host)){let i={addresses:[e.host],servername:e.servername||!1};return t(null,h(i,{cached:!1}))}let i;if(d.has(e.host)&&(i=d.get(e.host),!i.expires||i.expires>=Date.now()))return t(null,h(i.value,{cached:!0}));l(4,e.host,((n,s)=>{if(n)return i?t(null,h(i.value,{cached:!0,error:n})):t(n);if(s&&s.length){let i={addresses:s,servername:e.servername||e.host};return d.set(e.host,{value:i,expires:Date.now()+(e.dnsTtl||c)}),t(null,h(i,{cached:!1}))}l(6,e.host,((n,s)=>{if(n)return i?t(null,h(i.value,{cached:!0,error:n})):t(n);if(s&&s.length){let i={addresses:s,servername:e.servername||e.host};return d.set(e.host,{value:i,expires:Date.now()+(e.dnsTtl||c)}),t(null,h(i,{cached:!1}))}try{o.lookup(e.host,{all:!0},((n,s)=>{if(n)return i?t(null,h(i.value,{cached:!0,error:n})):t(n);let o=!!s&&s.filter((e=>u(e.family))).map((e=>e.address)).shift();if(s&&s.length&&!o){let e=new Error(`Can not use IPv${s[0].family} addresses with current network`);return t(e)}if(!o&&i)return t(null,h(i.value,{cached:!0}));let a={addresses:o?[o]:[e.host],servername:e.servername||e.host};return d.set(e.host,{value:a,expires:Date.now()+(e.dnsTtl||c)}),t(null,h(a,{cached:!1}))}))}catch(n){return i?t(null,h(i.value,{cached:!0,error:n})):t(n)}}))}))},e.exports.parseConnectionUrl=e=>{e=e||"";let i={};return[t.parse(e,!0)].forEach((e=>{let t;switch(e.protocol){case"smtp:":i.secure=!1;break;case"smtps:":i.secure=!0;break;case"direct:":i.direct=!0}!isNaN(e.port)&&Number(e.port)&&(i.port=Number(e.port)),e.hostname&&(i.host=e.hostname),e.auth&&(t=e.auth.split(":"),i.auth||(i.auth={}),i.auth.user=t.shift(),i.auth.pass=t.join(":")),Object.keys(e.query||{}).forEach((t=>{let n=i,s=t,o=e.query[t];switch(isNaN(o)||(o=Number(o)),o){case"true":o=!0;break;case"false":o=!1}if(0===t.indexOf("tls."))s=t.substr(4),i.tls||(i.tls={}),n=i.tls;else if(t.indexOf(".")>=0)return;s in n||(n[s]=o)}))})),i},e.exports._logFunc=(e,t,i,n,s,...o)=>{let a={};Object.keys(i||{}).forEach((e=>{"level"!==e&&(a[e]=i[e])})),Object.keys(n||{}).forEach((e=>{"level"!==e&&(a[e]=n[e])})),e[t](a,s,...o)},e.exports.getLogger=(t,n)=>{let s={},o=["trace","debug","info","warn","error","fatal"];if(!(t=t||{}).logger)return o.forEach((e=>{s[e]=()=>!1})),s;let a=t.logger;return!0===t.logger&&(a=function(e){let t=0,n=new Map;e.forEach((e=>{e.length>t&&(t=e.length)})),e.forEach((e=>{let i=e.toUpperCase();i.length<t&&(i+=" ".repeat(t-i.length)),n.set(e,i)}));let s=(e,t,s,...o)=>{let a="";t&&("server"===t.tnx?a="S: ":"client"===t.tnx&&(a="C: "),t.sid&&(a="["+t.sid+"] "+a),t.cid&&(a="[#"+t.cid+"] "+a)),(s=i.format(s,...o)).split(/\r?\n/).forEach((t=>{console.log("[%s] %s %s",(new Date).toISOString().substr(0,19).replace(/T/," "),n.get(e),a+t)}))},o={};return e.forEach((e=>{o[e]=s.bind(null,e)})),o}(o)),o.forEach((t=>{s[t]=(i,s,...o)=>{e.exports._logFunc(a,t,n,i,s,...o)}})),s},e.exports.callbackPromise=(e,t)=>function(){let i=Array.from(arguments),n=i.shift();n?t(n):e(...i)},e.exports.resolveContent=(t,i,o)=>{let a;o||(a=new Promise(((t,i)=>{o=e.exports.callbackPromise(t,i)})));let r,c=t&&t[i]&&t[i].content||t[i],p=("object"==typeof t[i]&&t[i].encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");if(!c)return o(null,c);if("object"==typeof c){if("function"==typeof c.pipe)return m(c,((e,n)=>{if(e)return o(e);t[i].content?t[i].content=n:t[i]=n,o(null,n)}));if(/^https?:\/\//i.test(c.path||c.href))return r=s(c.path||c.href),m(r,o);if(/^data:/i.test(c.path||c.href)){let e=(c.path||c.href).match(/^data:((?:[^;]*;)*(?:[^,]*)),(.*)$/i);return o(null,e?/\bbase64$/i.test(e[1])?Buffer.from(e[2],"base64"):Buffer.from(decodeURIComponent(e[2])):Buffer.from(0))}if(c.path)return m(n.createReadStream(c.path),o)}return"string"!=typeof t[i].content||["utf8","usascii","ascii"].includes(p)||(c=Buffer.from(t[i].content,p)),setImmediate((()=>o(null,c))),a},e.exports.assign=function(){let e=Array.from(arguments),t=e.shift()||{};return e.forEach((e=>{Object.keys(e||{}).forEach((i=>{["tls","auth"].includes(i)&&e[i]&&"object"==typeof e[i]?(t[i]||(t[i]={}),Object.keys(e[i]).forEach((n=>{t[i][n]=e[i][n]}))):t[i]=e[i]}))})),t},e.exports.encodeXText=e=>{if(!/[^\x21-\x2A\x2C-\x3C\x3E-\x7E]/.test(e))return e;let t=Buffer.from(e),i="";for(let e=0,n=t.length;e<n;e++){let n=t[e];i+=n<33||n>126||43===n||61===n?"+"+(n<16?"0":"")+n.toString(16).toUpperCase():String.fromCharCode(n)}return i}}(wh);const Ph=w.default,jh=new Map([["application/acad","dwg"],["application/applixware","aw"],["application/arj","arj"],["application/atom+xml","xml"],["application/atomcat+xml","atomcat"],["application/atomsvc+xml","atomsvc"],["application/base64",["mm","mme"]],["application/binhex","hqx"],["application/binhex4","hqx"],["application/book",["book","boo"]],["application/ccxml+xml,","ccxml"],["application/cdf","cdf"],["application/cdmi-capability","cdmia"],["application/cdmi-container","cdmic"],["application/cdmi-domain","cdmid"],["application/cdmi-object","cdmio"],["application/cdmi-queue","cdmiq"],["application/clariscad","ccad"],["application/commonground","dp"],["application/cu-seeme","cu"],["application/davmount+xml","davmount"],["application/drafting","drw"],["application/dsptype","tsp"],["application/dssc+der","dssc"],["application/dssc+xml","xdssc"],["application/dxf","dxf"],["application/ecmascript",["js","es"]],["application/emma+xml","emma"],["application/envoy","evy"],["application/epub+zip","epub"],["application/excel",["xls","xl","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/exi","exi"],["application/font-tdpfr","pfr"],["application/fractals","fif"],["application/freeloader","frl"],["application/futuresplash","spl"],["application/gnutar","tgz"],["application/groupwise","vew"],["application/hlp","hlp"],["application/hta","hta"],["application/hyperstudio","stk"],["application/i-deas","unv"],["application/iges",["iges","igs"]],["application/inf","inf"],["application/internet-property-stream","acx"],["application/ipfix","ipfix"],["application/java","class"],["application/java-archive","jar"],["application/java-byte-code","class"],["application/java-serialized-object","ser"],["application/java-vm","class"],["application/javascript","js"],["application/json","json"],["application/lha","lha"],["application/lzx","lzx"],["application/mac-binary","bin"],["application/mac-binhex","hqx"],["application/mac-binhex40","hqx"],["application/mac-compactpro","cpt"],["application/macbinary","bin"],["application/mads+xml","mads"],["application/marc","mrc"],["application/marcxml+xml","mrcx"],["application/mathematica","ma"],["application/mathml+xml","mathml"],["application/mbedlet","mbd"],["application/mbox","mbox"],["application/mcad","mcd"],["application/mediaservercontrol+xml","mscml"],["application/metalink4+xml","meta4"],["application/mets+xml","mets"],["application/mime","aps"],["application/mods+xml","mods"],["application/mp21","m21"],["application/mp4","mp4"],["application/mspowerpoint",["ppt","pot","pps","ppz"]],["application/msword",["doc","dot","w6w","wiz","word"]],["application/mswrite","wri"],["application/mxf","mxf"],["application/netmc","mcp"],["application/octet-stream",["*"]],["application/oda","oda"],["application/oebps-package+xml","opf"],["application/ogg","ogx"],["application/olescript","axs"],["application/onenote","onetoc"],["application/patch-ops-error+xml","xer"],["application/pdf","pdf"],["application/pgp-encrypted","asc"],["application/pgp-signature","pgp"],["application/pics-rules","prf"],["application/pkcs-12","p12"],["application/pkcs-crl","crl"],["application/pkcs10","p10"],["application/pkcs7-mime",["p7c","p7m"]],["application/pkcs7-signature","p7s"],["application/pkcs8","p8"],["application/pkix-attr-cert","ac"],["application/pkix-cert",["cer","crt"]],["application/pkix-crl","crl"],["application/pkix-pkipath","pkipath"],["application/pkixcmp","pki"],["application/plain","text"],["application/pls+xml","pls"],["application/postscript",["ps","ai","eps"]],["application/powerpoint","ppt"],["application/pro_eng",["part","prt"]],["application/prs.cww","cww"],["application/pskc+xml","pskcxml"],["application/rdf+xml","rdf"],["application/reginfo+xml","rif"],["application/relax-ng-compact-syntax","rnc"],["application/resource-lists+xml","rl"],["application/resource-lists-diff+xml","rld"],["application/ringing-tones","rng"],["application/rls-services+xml","rs"],["application/rsd+xml","rsd"],["application/rss+xml","xml"],["application/rtf",["rtf","rtx"]],["application/sbml+xml","sbml"],["application/scvp-cv-request","scq"],["application/scvp-cv-response","scs"],["application/scvp-vp-request","spq"],["application/scvp-vp-response","spp"],["application/sdp","sdp"],["application/sea","sea"],["application/set","set"],["application/set-payment-initiation","setpay"],["application/set-registration-initiation","setreg"],["application/shf+xml","shf"],["application/sla","stl"],["application/smil",["smi","smil"]],["application/smil+xml","smi"],["application/solids","sol"],["application/sounder","sdr"],["application/sparql-query","rq"],["application/sparql-results+xml","srx"],["application/srgs","gram"],["application/srgs+xml","grxml"],["application/sru+xml","sru"],["application/ssml+xml","ssml"],["application/step",["step","stp"]],["application/streamingmedia","ssm"],["application/tei+xml","tei"],["application/thraud+xml","tfi"],["application/timestamped-data","tsd"],["application/toolbook","tbk"],["application/vda","vda"],["application/vnd.3gpp.pic-bw-large","plb"],["application/vnd.3gpp.pic-bw-small","psb"],["application/vnd.3gpp.pic-bw-var","pvb"],["application/vnd.3gpp2.tcap","tcap"],["application/vnd.3m.post-it-notes","pwn"],["application/vnd.accpac.simply.aso","aso"],["application/vnd.accpac.simply.imp","imp"],["application/vnd.acucobol","acu"],["application/vnd.acucorp","atc"],["application/vnd.adobe.air-application-installer-package+zip","air"],["application/vnd.adobe.fxp","fxp"],["application/vnd.adobe.xdp+xml","xdp"],["application/vnd.adobe.xfdf","xfdf"],["application/vnd.ahead.space","ahead"],["application/vnd.airzip.filesecure.azf","azf"],["application/vnd.airzip.filesecure.azs","azs"],["application/vnd.amazon.ebook","azw"],["application/vnd.americandynamics.acc","acc"],["application/vnd.amiga.ami","ami"],["application/vnd.android.package-archive","apk"],["application/vnd.anser-web-certificate-issue-initiation","cii"],["application/vnd.anser-web-funds-transfer-initiation","fti"],["application/vnd.antix.game-component","atx"],["application/vnd.apple.installer+xml","mpkg"],["application/vnd.apple.mpegurl","m3u8"],["application/vnd.aristanetworks.swi","swi"],["application/vnd.audiograph","aep"],["application/vnd.blueice.multipass","mpm"],["application/vnd.bmi","bmi"],["application/vnd.businessobjects","rep"],["application/vnd.chemdraw+xml","cdxml"],["application/vnd.chipnuts.karaoke-mmd","mmd"],["application/vnd.cinderella","cdy"],["application/vnd.claymore","cla"],["application/vnd.cloanto.rp9","rp9"],["application/vnd.clonk.c4group","c4g"],["application/vnd.cluetrust.cartomobile-config","c11amc"],["application/vnd.cluetrust.cartomobile-config-pkg","c11amz"],["application/vnd.commonspace","csp"],["application/vnd.contact.cmsg","cdbcmsg"],["application/vnd.cosmocaller","cmc"],["application/vnd.crick.clicker","clkx"],["application/vnd.crick.clicker.keyboard","clkk"],["application/vnd.crick.clicker.palette","clkp"],["application/vnd.crick.clicker.template","clkt"],["application/vnd.crick.clicker.wordbank","clkw"],["application/vnd.criticaltools.wbs+xml","wbs"],["application/vnd.ctc-posml","pml"],["application/vnd.cups-ppd","ppd"],["application/vnd.curl.car","car"],["application/vnd.curl.pcurl","pcurl"],["application/vnd.data-vision.rdz","rdz"],["application/vnd.denovo.fcselayout-link","fe_launch"],["application/vnd.dna","dna"],["application/vnd.dolby.mlp","mlp"],["application/vnd.dpgraph","dpg"],["application/vnd.dreamfactory","dfac"],["application/vnd.dvb.ait","ait"],["application/vnd.dvb.service","svc"],["application/vnd.dynageo","geo"],["application/vnd.ecowin.chart","mag"],["application/vnd.enliven","nml"],["application/vnd.epson.esf","esf"],["application/vnd.epson.msf","msf"],["application/vnd.epson.quickanime","qam"],["application/vnd.epson.salt","slt"],["application/vnd.epson.ssf","ssf"],["application/vnd.eszigno3+xml","es3"],["application/vnd.ezpix-album","ez2"],["application/vnd.ezpix-package","ez3"],["application/vnd.fdf","fdf"],["application/vnd.fdsn.seed","seed"],["application/vnd.flographit","gph"],["application/vnd.fluxtime.clip","ftc"],["application/vnd.framemaker","fm"],["application/vnd.frogans.fnc","fnc"],["application/vnd.frogans.ltf","ltf"],["application/vnd.fsc.weblaunch","fsc"],["application/vnd.fujitsu.oasys","oas"],["application/vnd.fujitsu.oasys2","oa2"],["application/vnd.fujitsu.oasys3","oa3"],["application/vnd.fujitsu.oasysgp","fg5"],["application/vnd.fujitsu.oasysprs","bh2"],["application/vnd.fujixerox.ddd","ddd"],["application/vnd.fujixerox.docuworks","xdw"],["application/vnd.fujixerox.docuworks.binder","xbd"],["application/vnd.fuzzysheet","fzs"],["application/vnd.genomatix.tuxedo","txd"],["application/vnd.geogebra.file","ggb"],["application/vnd.geogebra.tool","ggt"],["application/vnd.geometry-explorer","gex"],["application/vnd.geonext","gxt"],["application/vnd.geoplan","g2w"],["application/vnd.geospace","g3w"],["application/vnd.gmx","gmx"],["application/vnd.google-earth.kml+xml","kml"],["application/vnd.google-earth.kmz","kmz"],["application/vnd.grafeq","gqf"],["application/vnd.groove-account","gac"],["application/vnd.groove-help","ghf"],["application/vnd.groove-identity-message","gim"],["application/vnd.groove-injector","grv"],["application/vnd.groove-tool-message","gtm"],["application/vnd.groove-tool-template","tpl"],["application/vnd.groove-vcard","vcg"],["application/vnd.hal+xml","hal"],["application/vnd.handheld-entertainment+xml","zmm"],["application/vnd.hbci","hbci"],["application/vnd.hhe.lesson-player","les"],["application/vnd.hp-hpgl",["hgl","hpg","hpgl"]],["application/vnd.hp-hpid","hpid"],["application/vnd.hp-hps","hps"],["application/vnd.hp-jlyt","jlt"],["application/vnd.hp-pcl","pcl"],["application/vnd.hp-pclxl","pclxl"],["application/vnd.hydrostatix.sof-data","sfd-hdstx"],["application/vnd.hzn-3d-crossword","x3d"],["application/vnd.ibm.minipay","mpy"],["application/vnd.ibm.modcap","afp"],["application/vnd.ibm.rights-management","irm"],["application/vnd.ibm.secure-container","sc"],["application/vnd.iccprofile","icc"],["application/vnd.igloader","igl"],["application/vnd.immervision-ivp","ivp"],["application/vnd.immervision-ivu","ivu"],["application/vnd.insors.igm","igm"],["application/vnd.intercon.formnet","xpw"],["application/vnd.intergeo","i2g"],["application/vnd.intu.qbo","qbo"],["application/vnd.intu.qfx","qfx"],["application/vnd.ipunplugged.rcprofile","rcprofile"],["application/vnd.irepository.package+xml","irp"],["application/vnd.is-xpr","xpr"],["application/vnd.isac.fcs","fcs"],["application/vnd.jam","jam"],["application/vnd.jcp.javame.midlet-rms","rms"],["application/vnd.jisp","jisp"],["application/vnd.joost.joda-archive","joda"],["application/vnd.kahootz","ktz"],["application/vnd.kde.karbon","karbon"],["application/vnd.kde.kchart","chrt"],["application/vnd.kde.kformula","kfo"],["application/vnd.kde.kivio","flw"],["application/vnd.kde.kontour","kon"],["application/vnd.kde.kpresenter","kpr"],["application/vnd.kde.kspread","ksp"],["application/vnd.kde.kword","kwd"],["application/vnd.kenameaapp","htke"],["application/vnd.kidspiration","kia"],["application/vnd.kinar","kne"],["application/vnd.koan","skp"],["application/vnd.kodak-descriptor","sse"],["application/vnd.las.las+xml","lasxml"],["application/vnd.llamagraphics.life-balance.desktop","lbd"],["application/vnd.llamagraphics.life-balance.exchange+xml","lbe"],["application/vnd.lotus-1-2-3","123"],["application/vnd.lotus-approach","apr"],["application/vnd.lotus-freelance","pre"],["application/vnd.lotus-notes","nsf"],["application/vnd.lotus-organizer","org"],["application/vnd.lotus-screencam","scm"],["application/vnd.lotus-wordpro","lwp"],["application/vnd.macports.portpkg","portpkg"],["application/vnd.mcd","mcd"],["application/vnd.medcalcdata","mc1"],["application/vnd.mediastation.cdkey","cdkey"],["application/vnd.mfer","mwf"],["application/vnd.mfmp","mfm"],["application/vnd.micrografx.flo","flo"],["application/vnd.micrografx.igx","igx"],["application/vnd.mif","mif"],["application/vnd.mobius.daf","daf"],["application/vnd.mobius.dis","dis"],["application/vnd.mobius.mbk","mbk"],["application/vnd.mobius.mqy","mqy"],["application/vnd.mobius.msl","msl"],["application/vnd.mobius.plc","plc"],["application/vnd.mobius.txf","txf"],["application/vnd.mophun.application","mpn"],["application/vnd.mophun.certificate","mpc"],["application/vnd.mozilla.xul+xml","xul"],["application/vnd.ms-artgalry","cil"],["application/vnd.ms-cab-compressed","cab"],["application/vnd.ms-excel",["xls","xla","xlc","xlm","xlt","xlw","xlb","xll"]],["application/vnd.ms-excel.addin.macroenabled.12","xlam"],["application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsb"],["application/vnd.ms-excel.sheet.macroenabled.12","xlsm"],["application/vnd.ms-excel.template.macroenabled.12","xltm"],["application/vnd.ms-fontobject","eot"],["application/vnd.ms-htmlhelp","chm"],["application/vnd.ms-ims","ims"],["application/vnd.ms-lrm","lrm"],["application/vnd.ms-officetheme","thmx"],["application/vnd.ms-outlook","msg"],["application/vnd.ms-pki.certstore","sst"],["application/vnd.ms-pki.pko","pko"],["application/vnd.ms-pki.seccat","cat"],["application/vnd.ms-pki.stl","stl"],["application/vnd.ms-pkicertstore","sst"],["application/vnd.ms-pkiseccat","cat"],["application/vnd.ms-pkistl","stl"],["application/vnd.ms-powerpoint",["ppt","pot","pps","ppa","pwz"]],["application/vnd.ms-powerpoint.addin.macroenabled.12","ppam"],["application/vnd.ms-powerpoint.presentation.macroenabled.12","pptm"],["application/vnd.ms-powerpoint.slide.macroenabled.12","sldm"],["application/vnd.ms-powerpoint.slideshow.macroenabled.12","ppsm"],["application/vnd.ms-powerpoint.template.macroenabled.12","potm"],["application/vnd.ms-project","mpp"],["application/vnd.ms-word.document.macroenabled.12","docm"],["application/vnd.ms-word.template.macroenabled.12","dotm"],["application/vnd.ms-works",["wks","wcm","wdb","wps"]],["application/vnd.ms-wpl","wpl"],["application/vnd.ms-xpsdocument","xps"],["application/vnd.mseq","mseq"],["application/vnd.musician","mus"],["application/vnd.muvee.style","msty"],["application/vnd.neurolanguage.nlu","nlu"],["application/vnd.noblenet-directory","nnd"],["application/vnd.noblenet-sealer","nns"],["application/vnd.noblenet-web","nnw"],["application/vnd.nokia.configuration-message","ncm"],["application/vnd.nokia.n-gage.data","ngdat"],["application/vnd.nokia.n-gage.symbian.install","n-gage"],["application/vnd.nokia.radio-preset","rpst"],["application/vnd.nokia.radio-presets","rpss"],["application/vnd.nokia.ringing-tone","rng"],["application/vnd.novadigm.edm","edm"],["application/vnd.novadigm.edx","edx"],["application/vnd.novadigm.ext","ext"],["application/vnd.oasis.opendocument.chart","odc"],["application/vnd.oasis.opendocument.chart-template","otc"],["application/vnd.oasis.opendocument.database","odb"],["application/vnd.oasis.opendocument.formula","odf"],["application/vnd.oasis.opendocument.formula-template","odft"],["application/vnd.oasis.opendocument.graphics","odg"],["application/vnd.oasis.opendocument.graphics-template","otg"],["application/vnd.oasis.opendocument.image","odi"],["application/vnd.oasis.opendocument.image-template","oti"],["application/vnd.oasis.opendocument.presentation","odp"],["application/vnd.oasis.opendocument.presentation-template","otp"],["application/vnd.oasis.opendocument.spreadsheet","ods"],["application/vnd.oasis.opendocument.spreadsheet-template","ots"],["application/vnd.oasis.opendocument.text","odt"],["application/vnd.oasis.opendocument.text-master","odm"],["application/vnd.oasis.opendocument.text-template","ott"],["application/vnd.oasis.opendocument.text-web","oth"],["application/vnd.olpc-sugar","xo"],["application/vnd.oma.dd2+xml","dd2"],["application/vnd.openofficeorg.extension","oxt"],["application/vnd.openxmlformats-officedocument.presentationml.presentation","pptx"],["application/vnd.openxmlformats-officedocument.presentationml.slide","sldx"],["application/vnd.openxmlformats-officedocument.presentationml.slideshow","ppsx"],["application/vnd.openxmlformats-officedocument.presentationml.template","potx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlsx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.template","xltx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.document","docx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.template","dotx"],["application/vnd.osgeo.mapguide.package","mgp"],["application/vnd.osgi.dp","dp"],["application/vnd.palm","pdb"],["application/vnd.pawaafile","paw"],["application/vnd.pg.format","str"],["application/vnd.pg.osasli","ei6"],["application/vnd.picsel","efif"],["application/vnd.pmi.widget","wg"],["application/vnd.pocketlearn","plf"],["application/vnd.powerbuilder6","pbd"],["application/vnd.previewsystems.box","box"],["application/vnd.proteus.magazine","mgz"],["application/vnd.publishare-delta-tree","qps"],["application/vnd.pvi.ptid1","ptid"],["application/vnd.quark.quarkxpress","qxd"],["application/vnd.realvnc.bed","bed"],["application/vnd.recordare.musicxml","mxl"],["application/vnd.recordare.musicxml+xml","musicxml"],["application/vnd.rig.cryptonote","cryptonote"],["application/vnd.rim.cod","cod"],["application/vnd.rn-realmedia","rm"],["application/vnd.rn-realplayer","rnx"],["application/vnd.route66.link66+xml","link66"],["application/vnd.sailingtracker.track","st"],["application/vnd.seemail","see"],["application/vnd.sema","sema"],["application/vnd.semd","semd"],["application/vnd.semf","semf"],["application/vnd.shana.informed.formdata","ifm"],["application/vnd.shana.informed.formtemplate","itp"],["application/vnd.shana.informed.interchange","iif"],["application/vnd.shana.informed.package","ipk"],["application/vnd.simtech-mindmapper","twd"],["application/vnd.smaf","mmf"],["application/vnd.smart.teacher","teacher"],["application/vnd.solent.sdkm+xml","sdkm"],["application/vnd.spotfire.dxp","dxp"],["application/vnd.spotfire.sfs","sfs"],["application/vnd.stardivision.calc","sdc"],["application/vnd.stardivision.draw","sda"],["application/vnd.stardivision.impress","sdd"],["application/vnd.stardivision.math","smf"],["application/vnd.stardivision.writer","sdw"],["application/vnd.stardivision.writer-global","sgl"],["application/vnd.stepmania.stepchart","sm"],["application/vnd.sun.xml.calc","sxc"],["application/vnd.sun.xml.calc.template","stc"],["application/vnd.sun.xml.draw","sxd"],["application/vnd.sun.xml.draw.template","std"],["application/vnd.sun.xml.impress","sxi"],["application/vnd.sun.xml.impress.template","sti"],["application/vnd.sun.xml.math","sxm"],["application/vnd.sun.xml.writer","sxw"],["application/vnd.sun.xml.writer.global","sxg"],["application/vnd.sun.xml.writer.template","stw"],["application/vnd.sus-calendar","sus"],["application/vnd.svd","svd"],["application/vnd.symbian.install","sis"],["application/vnd.syncml+xml","xsm"],["application/vnd.syncml.dm+wbxml","bdm"],["application/vnd.syncml.dm+xml","xdm"],["application/vnd.tao.intent-module-archive","tao"],["application/vnd.tmobile-livetv","tmo"],["application/vnd.trid.tpt","tpt"],["application/vnd.triscape.mxs","mxs"],["application/vnd.trueapp","tra"],["application/vnd.ufdl","ufd"],["application/vnd.uiq.theme","utz"],["application/vnd.umajin","umj"],["application/vnd.unity","unityweb"],["application/vnd.uoml+xml","uoml"],["application/vnd.vcx","vcx"],["application/vnd.visio","vsd"],["application/vnd.visionary","vis"],["application/vnd.vsf","vsf"],["application/vnd.wap.wbxml","wbxml"],["application/vnd.wap.wmlc","wmlc"],["application/vnd.wap.wmlscriptc","wmlsc"],["application/vnd.webturbo","wtb"],["application/vnd.wolfram.player","nbp"],["application/vnd.wordperfect","wpd"],["application/vnd.wqd","wqd"],["application/vnd.wt.stf","stf"],["application/vnd.xara",["web","xar"]],["application/vnd.xfdl","xfdl"],["application/vnd.yamaha.hv-dic","hvd"],["application/vnd.yamaha.hv-script","hvs"],["application/vnd.yamaha.hv-voice","hvp"],["application/vnd.yamaha.openscoreformat","osf"],["application/vnd.yamaha.openscoreformat.osfpvg+xml","osfpvg"],["application/vnd.yamaha.smaf-audio","saf"],["application/vnd.yamaha.smaf-phrase","spf"],["application/vnd.yellowriver-custom-menu","cmp"],["application/vnd.zul","zir"],["application/vnd.zzazz.deck+xml","zaz"],["application/vocaltec-media-desc","vmd"],["application/vocaltec-media-file","vmf"],["application/voicexml+xml","vxml"],["application/widget","wgt"],["application/winhlp","hlp"],["application/wordperfect",["wp","wp5","wp6","wpd"]],["application/wordperfect6.0",["w60","wp5"]],["application/wordperfect6.1","w61"],["application/wsdl+xml","wsdl"],["application/wspolicy+xml","wspolicy"],["application/x-123","wk1"],["application/x-7z-compressed","7z"],["application/x-abiword","abw"],["application/x-ace-compressed","ace"],["application/x-aim","aim"],["application/x-authorware-bin","aab"],["application/x-authorware-map","aam"],["application/x-authorware-seg","aas"],["application/x-bcpio","bcpio"],["application/x-binary","bin"],["application/x-binhex40","hqx"],["application/x-bittorrent","torrent"],["application/x-bsh",["bsh","sh","shar"]],["application/x-bytecode.elisp","elc"],["applicaiton/x-bytecode.python","pyc"],["application/x-bzip","bz"],["application/x-bzip2",["boz","bz2"]],["application/x-cdf","cdf"],["application/x-cdlink","vcd"],["application/x-chat",["cha","chat"]],["application/x-chess-pgn","pgn"],["application/x-cmu-raster","ras"],["application/x-cocoa","cco"],["application/x-compactpro","cpt"],["application/x-compress","z"],["application/x-compressed",["tgz","gz","z","zip"]],["application/x-conference","nsc"],["application/x-cpio","cpio"],["application/x-cpt","cpt"],["application/x-csh","csh"],["application/x-debian-package","deb"],["application/x-deepv","deepv"],["application/x-director",["dir","dcr","dxr"]],["application/x-doom","wad"],["application/x-dtbncx+xml","ncx"],["application/x-dtbook+xml","dtb"],["application/x-dtbresource+xml","res"],["application/x-dvi","dvi"],["application/x-elc","elc"],["application/x-envoy",["env","evy"]],["application/x-esrehber","es"],["application/x-excel",["xls","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/x-font-bdf","bdf"],["application/x-font-ghostscript","gsf"],["application/x-font-linux-psf","psf"],["application/x-font-otf","otf"],["application/x-font-pcf","pcf"],["application/x-font-snf","snf"],["application/x-font-ttf","ttf"],["application/x-font-type1","pfa"],["application/x-font-woff","woff"],["application/x-frame","mif"],["application/x-freelance","pre"],["application/x-futuresplash","spl"],["application/x-gnumeric","gnumeric"],["application/x-gsp","gsp"],["application/x-gss","gss"],["application/x-gtar","gtar"],["application/x-gzip",["gz","gzip"]],["application/x-hdf","hdf"],["application/x-helpfile",["help","hlp"]],["application/x-httpd-imap","imap"],["application/x-ima","ima"],["application/x-internet-signup",["ins","isp"]],["application/x-internett-signup","ins"],["application/x-inventor","iv"],["application/x-ip2","ip"],["application/x-iphone","iii"],["application/x-java-class","class"],["application/x-java-commerce","jcm"],["application/x-java-jnlp-file","jnlp"],["application/x-javascript","js"],["application/x-koan",["skd","skm","skp","skt"]],["application/x-ksh","ksh"],["application/x-latex",["latex","ltx"]],["application/x-lha","lha"],["application/x-lisp","lsp"],["application/x-livescreen","ivy"],["application/x-lotus","wq1"],["application/x-lotusscreencam","scm"],["application/x-lzh","lzh"],["application/x-lzx","lzx"],["application/x-mac-binhex40","hqx"],["application/x-macbinary","bin"],["application/x-magic-cap-package-1.0","mc$"],["application/x-mathcad","mcd"],["application/x-meme","mm"],["application/x-midi",["mid","midi"]],["application/x-mif","mif"],["application/x-mix-transfer","nix"],["application/x-mobipocket-ebook","prc"],["application/x-mplayer2","asx"],["application/x-ms-application","application"],["application/x-ms-wmd","wmd"],["application/x-ms-wmz","wmz"],["application/x-ms-xbap","xbap"],["application/x-msaccess","mdb"],["application/x-msbinder","obd"],["application/x-mscardfile","crd"],["application/x-msclip","clp"],["application/x-msdownload",["exe","dll"]],["application/x-msexcel",["xls","xla","xlw"]],["application/x-msmediaview",["mvb","m13","m14"]],["application/x-msmetafile","wmf"],["application/x-msmoney","mny"],["application/x-mspowerpoint","ppt"],["application/x-mspublisher","pub"],["application/x-msschedule","scd"],["application/x-msterminal","trm"],["application/x-mswrite","wri"],["application/x-navi-animation","ani"],["application/x-navidoc","nvd"],["application/x-navimap","map"],["application/x-navistyle","stl"],["application/x-netcdf",["cdf","nc"]],["application/x-newton-compatible-pkg","pkg"],["application/x-nokia-9000-communicator-add-on-software","aos"],["application/x-omc","omc"],["application/x-omcdatamaker","omcd"],["application/x-omcregerator","omcr"],["application/x-pagemaker",["pm4","pm5"]],["application/x-pcl","pcl"],["application/x-perfmon",["pma","pmc","pml","pmr","pmw"]],["application/x-pixclscript","plx"],["application/x-pkcs10","p10"],["application/x-pkcs12",["p12","pfx"]],["application/x-pkcs7-certificates",["p7b","spc"]],["application/x-pkcs7-certreqresp","p7r"],["application/x-pkcs7-mime",["p7m","p7c"]],["application/x-pkcs7-signature",["p7s","p7a"]],["application/x-pointplus","css"],["application/x-portable-anymap","pnm"],["application/x-project",["mpc","mpt","mpv","mpx"]],["application/x-qpro","wb1"],["application/x-rar-compressed","rar"],["application/x-rtf","rtf"],["application/x-sdp","sdp"],["application/x-sea","sea"],["application/x-seelogo","sl"],["application/x-sh","sh"],["application/x-shar",["shar","sh"]],["application/x-shockwave-flash","swf"],["application/x-silverlight-app","xap"],["application/x-sit","sit"],["application/x-sprite",["spr","sprite"]],["application/x-stuffit","sit"],["application/x-stuffitx","sitx"],["application/x-sv4cpio","sv4cpio"],["application/x-sv4crc","sv4crc"],["application/x-tar","tar"],["application/x-tbook",["sbk","tbk"]],["application/x-tcl","tcl"],["application/x-tex","tex"],["application/x-tex-tfm","tfm"],["application/x-texinfo",["texi","texinfo"]],["application/x-troff",["roff","t","tr"]],["application/x-troff-man","man"],["application/x-troff-me","me"],["application/x-troff-ms","ms"],["application/x-troff-msvideo","avi"],["application/x-ustar","ustar"],["application/x-visio",["vsd","vst","vsw"]],["application/x-vnd.audioexplosion.mzz","mzz"],["application/x-vnd.ls-xpix","xpix"],["application/x-vrml","vrml"],["application/x-wais-source",["src","wsrc"]],["application/x-winhelp","hlp"],["application/x-wintalk","wtk"],["application/x-world",["wrl","svr"]],["application/x-wpwin","wpd"],["application/x-wri","wri"],["application/x-x509-ca-cert",["cer","crt","der"]],["application/x-x509-user-cert","crt"],["application/x-xfig","fig"],["application/x-xpinstall","xpi"],["application/x-zip-compressed","zip"],["application/xcap-diff+xml","xdf"],["application/xenc+xml","xenc"],["application/xhtml+xml","xhtml"],["application/xml","xml"],["application/xml-dtd","dtd"],["application/xop+xml","xop"],["application/xslt+xml","xslt"],["application/xspf+xml","xspf"],["application/xv+xml","mxml"],["application/yang","yang"],["application/yin+xml","yin"],["application/ynd.ms-pkipko","pko"],["application/zip","zip"],["audio/adpcm","adp"],["audio/aiff",["aiff","aif","aifc"]],["audio/basic",["snd","au"]],["audio/it","it"],["audio/make",["funk","my","pfunk"]],["audio/make.my.funk","pfunk"],["audio/mid",["mid","rmi"]],["audio/midi",["midi","kar","mid"]],["audio/mod","mod"],["audio/mp4","mp4a"],["audio/mpeg",["mpga","mp3","m2a","mp2","mpa","mpg"]],["audio/mpeg3","mp3"],["audio/nspaudio",["la","lma"]],["audio/ogg","oga"],["audio/s3m","s3m"],["audio/tsp-audio","tsi"],["audio/tsplayer","tsp"],["audio/vnd.dece.audio","uva"],["audio/vnd.digital-winds","eol"],["audio/vnd.dra","dra"],["audio/vnd.dts","dts"],["audio/vnd.dts.hd","dtshd"],["audio/vnd.lucent.voice","lvp"],["audio/vnd.ms-playready.media.pya","pya"],["audio/vnd.nuera.ecelp4800","ecelp4800"],["audio/vnd.nuera.ecelp7470","ecelp7470"],["audio/vnd.nuera.ecelp9600","ecelp9600"],["audio/vnd.qcelp","qcp"],["audio/vnd.rip","rip"],["audio/voc","voc"],["audio/voxware","vox"],["audio/wav","wav"],["audio/webm","weba"],["audio/x-aac","aac"],["audio/x-adpcm","snd"],["audio/x-aiff",["aiff","aif","aifc"]],["audio/x-au","au"],["audio/x-gsm",["gsd","gsm"]],["audio/x-jam","jam"],["audio/x-liveaudio","lam"],["audio/x-mid",["mid","midi"]],["audio/x-midi",["midi","mid"]],["audio/x-mod","mod"],["audio/x-mpeg","mp2"],["audio/x-mpeg-3","mp3"],["audio/x-mpegurl","m3u"],["audio/x-mpequrl","m3u"],["audio/x-ms-wax","wax"],["audio/x-ms-wma","wma"],["audio/x-nspaudio",["la","lma"]],["audio/x-pn-realaudio",["ra","ram","rm","rmm","rmp"]],["audio/x-pn-realaudio-plugin",["ra","rmp","rpm"]],["audio/x-psid","sid"],["audio/x-realaudio","ra"],["audio/x-twinvq","vqf"],["audio/x-twinvq-plugin",["vqe","vql"]],["audio/x-vnd.audioexplosion.mjuicemediafile","mjf"],["audio/x-voc","voc"],["audio/x-wav","wav"],["audio/xm","xm"],["chemical/x-cdx","cdx"],["chemical/x-cif","cif"],["chemical/x-cmdf","cmdf"],["chemical/x-cml","cml"],["chemical/x-csml","csml"],["chemical/x-pdb",["pdb","xyz"]],["chemical/x-xyz","xyz"],["drawing/x-dwf","dwf"],["i-world/i-vrml","ivr"],["image/bmp",["bmp","bm"]],["image/cgm","cgm"],["image/cis-cod","cod"],["image/cmu-raster",["ras","rast"]],["image/fif","fif"],["image/florian",["flo","turbot"]],["image/g3fax","g3"],["image/gif","gif"],["image/ief",["ief","iefs"]],["image/jpeg",["jpeg","jpe","jpg","jfif","jfif-tbnl"]],["image/jutvision","jut"],["image/ktx","ktx"],["image/naplps",["nap","naplps"]],["image/pict",["pic","pict"]],["image/pipeg","jfif"],["image/pjpeg",["jfif","jpe","jpeg","jpg"]],["image/png",["png","x-png"]],["image/prs.btif","btif"],["image/svg+xml","svg"],["image/tiff",["tif","tiff"]],["image/vasa","mcf"],["image/vnd.adobe.photoshop","psd"],["image/vnd.dece.graphic","uvi"],["image/vnd.djvu","djvu"],["image/vnd.dvb.subtitle","sub"],["image/vnd.dwg",["dwg","dxf","svf"]],["image/vnd.dxf","dxf"],["image/vnd.fastbidsheet","fbs"],["image/vnd.fpx","fpx"],["image/vnd.fst","fst"],["image/vnd.fujixerox.edmics-mmr","mmr"],["image/vnd.fujixerox.edmics-rlc","rlc"],["image/vnd.ms-modi","mdi"],["image/vnd.net-fpx",["fpx","npx"]],["image/vnd.rn-realflash","rf"],["image/vnd.rn-realpix","rp"],["image/vnd.wap.wbmp","wbmp"],["image/vnd.xiff","xif"],["image/webp","webp"],["image/x-cmu-raster","ras"],["image/x-cmx","cmx"],["image/x-dwg",["dwg","dxf","svf"]],["image/x-freehand","fh"],["image/x-icon","ico"],["image/x-jg","art"],["image/x-jps","jps"],["image/x-niff",["niff","nif"]],["image/x-pcx","pcx"],["image/x-pict",["pct","pic"]],["image/x-portable-anymap","pnm"],["image/x-portable-bitmap","pbm"],["image/x-portable-graymap","pgm"],["image/x-portable-greymap","pgm"],["image/x-portable-pixmap","ppm"],["image/x-quicktime",["qif","qti","qtif"]],["image/x-rgb","rgb"],["image/x-tiff",["tif","tiff"]],["image/x-windows-bmp","bmp"],["image/x-xbitmap","xbm"],["image/x-xbm","xbm"],["image/x-xpixmap",["xpm","pm"]],["image/x-xwd","xwd"],["image/x-xwindowdump","xwd"],["image/xbm","xbm"],["image/xpm","xpm"],["message/rfc822",["eml","mht","mhtml","nws","mime"]],["model/iges",["iges","igs"]],["model/mesh","msh"],["model/vnd.collada+xml","dae"],["model/vnd.dwf","dwf"],["model/vnd.gdl","gdl"],["model/vnd.gtw","gtw"],["model/vnd.mts","mts"],["model/vnd.vtu","vtu"],["model/vrml",["vrml","wrl","wrz"]],["model/x-pov","pov"],["multipart/x-gzip","gzip"],["multipart/x-ustar","ustar"],["multipart/x-zip","zip"],["music/crescendo",["mid","midi"]],["music/x-karaoke","kar"],["paleovu/x-pv","pvu"],["text/asp","asp"],["text/calendar","ics"],["text/css","css"],["text/csv","csv"],["text/ecmascript","js"],["text/h323","323"],["text/html",["html","htm","stm","acgi","htmls","htx","shtml"]],["text/iuls","uls"],["text/javascript","js"],["text/mcf","mcf"],["text/n3","n3"],["text/pascal","pas"],["text/plain",["txt","bas","c","h","c++","cc","com","conf","cxx","def","f","f90","for","g","hh","idc","jav","java","list","log","lst","m","mar","pl","sdml","text"]],["text/plain-bas","par"],["text/prs.lines.tag","dsc"],["text/richtext",["rtx","rt","rtf"]],["text/scriplet","wsc"],["text/scriptlet","sct"],["text/sgml",["sgm","sgml"]],["text/tab-separated-values","tsv"],["text/troff","t"],["text/turtle","ttl"],["text/uri-list",["uni","unis","uri","uris"]],["text/vnd.abc","abc"],["text/vnd.curl","curl"],["text/vnd.curl.dcurl","dcurl"],["text/vnd.curl.mcurl","mcurl"],["text/vnd.curl.scurl","scurl"],["text/vnd.fly","fly"],["text/vnd.fmi.flexstor","flx"],["text/vnd.graphviz","gv"],["text/vnd.in3d.3dml","3dml"],["text/vnd.in3d.spot","spot"],["text/vnd.rn-realtext","rt"],["text/vnd.sun.j2me.app-descriptor","jad"],["text/vnd.wap.wml","wml"],["text/vnd.wap.wmlscript","wmls"],["text/webviewhtml","htt"],["text/x-asm",["asm","s"]],["text/x-audiosoft-intra","aip"],["text/x-c",["c","cc","cpp"]],["text/x-component","htc"],["text/x-fortran",["for","f","f77","f90"]],["text/x-h",["h","hh"]],["text/x-java-source",["java","jav"]],["text/x-java-source,java","java"],["text/x-la-asf","lsx"],["text/x-m","m"],["text/x-pascal","p"],["text/x-script","hlb"],["text/x-script.csh","csh"],["text/x-script.elisp","el"],["text/x-script.guile","scm"],["text/x-script.ksh","ksh"],["text/x-script.lisp","lsp"],["text/x-script.perl","pl"],["text/x-script.perl-module","pm"],["text/x-script.phyton","py"],["text/x-script.rexx","rexx"],["text/x-script.scheme","scm"],["text/x-script.sh","sh"],["text/x-script.tcl","tcl"],["text/x-script.tcsh","tcsh"],["text/x-script.zsh","zsh"],["text/x-server-parsed-html",["shtml","ssi"]],["text/x-setext","etx"],["text/x-sgml",["sgm","sgml"]],["text/x-speech",["spc","talk"]],["text/x-uil","uil"],["text/x-uuencode",["uu","uue"]],["text/x-vcalendar","vcs"],["text/x-vcard","vcf"],["text/xml","xml"],["video/3gpp","3gp"],["video/3gpp2","3g2"],["video/animaflex","afl"],["video/avi","avi"],["video/avs-video","avs"],["video/dl","dl"],["video/fli","fli"],["video/gl","gl"],["video/h261","h261"],["video/h263","h263"],["video/h264","h264"],["video/jpeg","jpgv"],["video/jpm","jpm"],["video/mj2","mj2"],["video/mp4","mp4"],["video/mpeg",["mpeg","mp2","mpa","mpe","mpg","mpv2","m1v","m2v","mp3"]],["video/msvideo","avi"],["video/ogg","ogv"],["video/quicktime",["mov","qt","moov"]],["video/vdo","vdo"],["video/vivo",["viv","vivo"]],["video/vnd.dece.hd","uvh"],["video/vnd.dece.mobile","uvm"],["video/vnd.dece.pd","uvp"],["video/vnd.dece.sd","uvs"],["video/vnd.dece.video","uvv"],["video/vnd.fvt","fvt"],["video/vnd.mpegurl","mxu"],["video/vnd.ms-playready.media.pyv","pyv"],["video/vnd.rn-realvideo","rv"],["video/vnd.uvvu.mp4","uvu"],["video/vnd.vivo",["viv","vivo"]],["video/vosaic","vos"],["video/webm","webm"],["video/x-amt-demorun","xdr"],["video/x-amt-showrun","xsr"],["video/x-atomic3d-feature","fmf"],["video/x-dl","dl"],["video/x-dv",["dif","dv"]],["video/x-f4v","f4v"],["video/x-fli","fli"],["video/x-flv","flv"],["video/x-gl","gl"],["video/x-isvideo","isu"],["video/x-la-asf",["lsf","lsx"]],["video/x-m4v","m4v"],["video/x-motion-jpeg","mjpg"],["video/x-mpeg",["mp3","mp2"]],["video/x-mpeq2a","mp2"],["video/x-ms-asf",["asf","asr","asx"]],["video/x-ms-asf-plugin","asx"],["video/x-ms-wm","wm"],["video/x-ms-wmv","wmv"],["video/x-ms-wmx","wmx"],["video/x-ms-wvx","wvx"],["video/x-msvideo","avi"],["video/x-qtc","qtc"],["video/x-scm","scm"],["video/x-sgi-movie",["movie","mv"]],["windows/metafile","wmf"],["www/mime","mime"],["x-conference/x-cooltalk","ice"],["x-music/x-midi",["mid","midi"]],["x-world/x-3dmf",["3dm","3dmf","qd3","qd3d"]],["x-world/x-svr","svr"],["x-world/x-vrml",["flr","vrml","wrl","wrz","xaf","xof"]],["x-world/x-vrt","vrt"],["xgl/drawing","xgz"],["xgl/movie","xmz"]]),Rh=new Map([["123","application/vnd.lotus-1-2-3"],["323","text/h323"],["*","application/octet-stream"],["3dm","x-world/x-3dmf"],["3dmf","x-world/x-3dmf"],["3dml","text/vnd.in3d.3dml"],["3g2","video/3gpp2"],["3gp","video/3gpp"],["7z","application/x-7z-compressed"],["a","application/octet-stream"],["aab","application/x-authorware-bin"],["aac","audio/x-aac"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abc","text/vnd.abc"],["abw","application/x-abiword"],["ac","application/pkix-attr-cert"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acgi","text/html"],["acu","application/vnd.acucobol"],["acx","application/internet-property-stream"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afl","video/animaflex"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/postscript"],["aif",["audio/aiff","audio/x-aiff"]],["aifc",["audio/aiff","audio/x-aiff"]],["aiff",["audio/aiff","audio/x-aiff"]],["aim","application/x-aim"],["aip","text/x-audiosoft-intra"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["ani","application/x-navi-animation"],["aos","application/x-nokia-9000-communicator-add-on-software"],["apk","application/vnd.android.package-archive"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["aps","application/mime"],["arc","application/octet-stream"],["arj",["application/arj","application/octet-stream"]],["art","image/x-jg"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asp","text/asp"],["asr","video/x-ms-asf"],["asx",["video/x-ms-asf","application/x-mplayer2","video/x-ms-asf-plugin"]],["atc","application/vnd.acucorp"],["atomcat","application/atomcat+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au",["audio/basic","audio/x-au"]],["avi",["video/avi","video/msvideo","application/x-troff-msvideo","video/x-msvideo"]],["avs","video/avs-video"],["aw","application/applixware"],["axs","application/olescript"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azw","application/vnd.amazon.ebook"],["bas","text/plain"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin",["application/octet-stream","application/mac-binary","application/macbinary","application/x-macbinary","application/x-binary"]],["bm","image/bmp"],["bmi","application/vnd.bmi"],["bmp",["image/bmp","image/x-windows-bmp"]],["boo","application/book"],["book","application/book"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bsh","application/x-bsh"],["btif","image/prs.btif"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c",["text/plain","text/x-c"]],["c++","text/plain"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["c4g","application/vnd.clonk.c4group"],["cab","application/vnd.ms-cab-compressed"],["car","application/vnd.curl.car"],["cat",["application/vnd.ms-pkiseccat","application/vnd.ms-pki.seccat"]],["cc",["text/plain","text/x-c"]],["ccad","application/clariscad"],["cco","application/x-cocoa"],["ccxml","application/ccxml+xml,"],["cdbcmsg","application/vnd.contact.cmsg"],["cdf",["application/cdf","application/x-cdf","application/x-netcdf"]],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer",["application/pkix-cert","application/x-x509-ca-cert"]],["cgm","image/cgm"],["cha","application/x-chat"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cla","application/vnd.claymore"],["class",["application/octet-stream","application/java","application/java-byte-code","application/java-vm","application/x-java-class"]],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod",["image/cis-cod","application/vnd.rim.cod"]],["com",["application/octet-stream","text/plain"]],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt",["application/mac-compactpro","application/x-compactpro","application/x-cpt"]],["crd","application/x-mscardfile"],["crl",["application/pkix-crl","application/pkcs-crl"]],["crt",["application/pkix-cert","application/x-x509-user-cert","application/x-x509-ca-cert"]],["cryptonote","application/vnd.rig.cryptonote"],["csh",["text/x-script.csh","application/x-csh"]],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["css",["text/css","application/x-pointplus"]],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxx","text/plain"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["davmount","application/davmount+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["deb","application/x-debian-package"],["deepv","application/x-deepv"],["def","text/plain"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dif","video/x-dv"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["djvu","image/vnd.djvu"],["dl",["video/dl","video/x-dl"]],["dll","application/x-msdownload"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.document.macroenabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroenabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp",["application/commonground","application/vnd.osgi.dp"]],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drw","application/drafting"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dv","video/x-dv"],["dvi","application/x-dvi"],["dwf",["model/vnd.dwf","drawing/x-dwf"]],["dwg",["application/acad","image/vnd.dwg","image/x-dwg"]],["dxf",["application/dxf","image/vnd.dwg","image/vnd.dxf","image/x-dwg"]],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["el","text/x-script.elisp"],["elc",["application/x-elc","application/x-bytecode.elisp"]],["eml","message/rfc822"],["emma","application/emma+xml"],["env","application/x-envoy"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es",["application/ecmascript","application/x-esrehber"]],["es3","application/vnd.eszigno3+xml"],["esf","application/vnd.epson.esf"],["etx","text/x-setext"],["evy",["application/envoy","application/x-envoy"]],["exe",["application/octet-stream","application/x-msdownload"]],["exi","application/exi"],["ext","application/vnd.novadigm.ext"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f",["text/plain","text/x-fortran"]],["f4v","video/x-f4v"],["f77","text/x-fortran"],["f90",["text/plain","text/x-fortran"]],["fbs","image/vnd.fastbidsheet"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fh","image/x-freehand"],["fif",["application/fractals","image/fif"]],["fig","application/x-xfig"],["fli",["video/fli","video/x-fli"]],["flo",["image/florian","application/vnd.micrografx.flo"]],["flr","x-world/x-vrml"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fmf","video/x-atomic3d-feature"],["fnc","application/vnd.frogans.fnc"],["for",["text/plain","text/x-fortran"]],["fpx",["image/vnd.fpx","image/vnd.net-fpx"]],["frl","application/freeloader"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["funk","audio/make"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g","text/plain"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gdl","model/vnd.gdl"],["geo","application/vnd.dynageo"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["gl",["video/gl","video/x-gl"]],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gph","application/vnd.flographit"],["gqf","application/vnd.grafeq"],["gram","application/srgs"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsd","audio/x-gsm"],["gsf","application/x-font-ghostscript"],["gsm","audio/x-gsm"],["gsp","application/x-gsp"],["gss","application/x-gss"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxt","application/vnd.geonext"],["gz",["application/x-gzip","application/x-compressed"]],["gzip",["multipart/x-gzip","application/x-gzip"]],["h",["text/plain","text/x-h"]],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hdf","application/x-hdf"],["help","application/x-helpfile"],["hgl","application/vnd.hp-hpgl"],["hh",["text/plain","text/x-h"]],["hlb","text/x-script"],["hlp",["application/winhlp","application/hlp","application/x-helpfile","application/x-winhelp"]],["hpg","application/vnd.hp-hpgl"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx",["application/mac-binhex40","application/binhex","application/binhex4","application/mac-binhex","application/x-binhex40","application/x-mac-binhex40"]],["hta","application/hta"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["htmls","text/html"],["htt","text/webviewhtml"],["htx","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["ico","image/x-icon"],["ics","text/calendar"],["idc","text/plain"],["ief","image/ief"],["iefs","image/ief"],["ifm","application/vnd.shana.informed.formdata"],["iges",["application/iges","model/iges"]],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs",["application/iges","model/iges"]],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["iii","application/x-iphone"],["ima","application/x-ima"],["imap","application/x-httpd-imap"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["inf","application/inf"],["ins",["application/x-internet-signup","application/x-internett-signup"]],["ip","application/x-ip2"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["isp","application/x-internet-signup"],["isu","video/x-isvideo"],["it","audio/it"],["itp","application/vnd.shana.informed.formtemplate"],["iv","application/x-inventor"],["ivp","application/vnd.immervision-ivp"],["ivr","i-world/i-vrml"],["ivu","application/vnd.immervision-ivu"],["ivy","application/x-livescreen"],["jad","text/vnd.sun.j2me.app-descriptor"],["jam",["application/vnd.jam","audio/x-jam"]],["jar","application/java-archive"],["jav",["text/plain","text/x-java-source"]],["java",["text/plain","text/x-java-source,java","text/x-java-source"]],["jcm","application/x-java-commerce"],["jfif",["image/pipeg","image/jpeg","image/pjpeg"]],["jfif-tbnl","image/jpeg"],["jisp","application/vnd.jisp"],["jlt","application/vnd.hp-jlyt"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jpe",["image/jpeg","image/pjpeg"]],["jpeg",["image/jpeg","image/pjpeg"]],["jpg",["image/jpeg","image/pjpeg"]],["jpgv","video/jpeg"],["jpm","video/jpm"],["jps","image/x-jps"],["js",["application/javascript","application/ecmascript","text/javascript","text/ecmascript","application/x-javascript"]],["json","application/json"],["jut","image/jutvision"],["kar",["audio/midi","music/x-karaoke"]],["karbon","application/vnd.kde.karbon"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["ksh",["application/x-ksh","text/x-script.ksh"]],["ksp","application/vnd.kde.kspread"],["ktx","image/ktx"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["la",["audio/nspaudio","audio/x-nspaudio"]],["lam","audio/x-liveaudio"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["lha",["application/octet-stream","application/lha","application/x-lha"]],["lhx","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["lma",["audio/nspaudio","audio/x-nspaudio"]],["log","text/plain"],["lrm","application/vnd.ms-lrm"],["lsf","video/x-la-asf"],["lsp",["application/x-lisp","text/x-script.lisp"]],["lst","text/plain"],["lsx",["video/x-la-asf","text/x-la-asf"]],["ltf","application/vnd.frogans.ltf"],["ltx","application/x-latex"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh",["application/octet-stream","application/x-lzh"]],["lzx",["application/lzx","application/octet-stream","application/x-lzx"]],["m",["text/plain","text/x-m"]],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m1v","video/mpeg"],["m21","application/mp21"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3u",["audio/x-mpegurl","audio/x-mpequrl"]],["m3u8","application/vnd.apple.mpegurl"],["m4v","video/x-m4v"],["ma","application/mathematica"],["mads","application/mads+xml"],["mag","application/vnd.ecowin.chart"],["man","application/x-troff-man"],["map","application/x-navimap"],["mar","text/plain"],["mathml","application/mathml+xml"],["mbd","application/mbedlet"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc$","application/x-magic-cap-package-1.0"],["mc1","application/vnd.medcalcdata"],["mcd",["application/mcad","application/vnd.mcd","application/x-mathcad"]],["mcf",["image/vasa","text/mcf"]],["mcp","application/netmc"],["mcurl","text/vnd.curl.mcurl"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["me","application/x-troff-me"],["meta4","application/metalink4+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mht","message/rfc822"],["mhtml","message/rfc822"],["mid",["audio/mid","audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["midi",["audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["mif",["application/vnd.mif","application/x-mif","application/x-frame"]],["mime",["message/rfc822","www/mime"]],["mj2","video/mj2"],["mjf","audio/x-vnd.audioexplosion.mjuicemediafile"],["mjpg","video/x-motion-jpeg"],["mlp","application/vnd.dolby.mlp"],["mm",["application/base64","application/x-meme"]],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mme","application/base64"],["mmf","application/vnd.smaf"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mny","application/x-msmoney"],["mod",["audio/mod","audio/x-mod"]],["mods","application/mods+xml"],["moov","video/quicktime"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2",["video/mpeg","audio/mpeg","video/x-mpeg","audio/x-mpeg","video/x-mpeq2a"]],["mp3",["audio/mpeg","audio/mpeg3","video/mpeg","audio/x-mpeg-3","video/x-mpeg"]],["mp4",["video/mp4","application/mp4"]],["mp4a","audio/mp4"],["mpa",["video/mpeg","audio/mpeg"]],["mpc",["application/vnd.mophun.certificate","application/x-project"]],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg",["video/mpeg","audio/mpeg"]],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/x-project"],["mpv","application/x-project"],["mpv2","video/mpeg"],["mpx","application/x-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","application/x-troff-ms"],["mscml","application/mediaservercontrol+xml"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msl","application/vnd.mobius.msl"],["msty","application/vnd.muvee.style"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musicxml","application/vnd.recordare.musicxml+xml"],["mv","video/x-sgi-movie"],["mvb","application/x-msmediaview"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["my","audio/make"],["mzz","application/x-vnd.audioexplosion.mzz"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nap","image/naplps"],["naplps","image/naplps"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncm","application/vnd.nokia.configuration-message"],["ncx","application/x-dtbncx+xml"],["ngdat","application/vnd.nokia.n-gage.data"],["nif","image/x-niff"],["niff","image/x-niff"],["nix","application/x-mix-transfer"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nvd","application/x-navidoc"],["nws","message/rfc822"],["o","application/octet-stream"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omc","application/x-omc"],["omcd","application/x-omcdatamaker"],["omcr","application/x-omcregerator"],["onetoc","application/onenote"],["opf","application/oebps-package+xml"],["org","application/vnd.lotus-organizer"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","application/x-font-otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p10",["application/pkcs10","application/x-pkcs10"]],["p12",["application/pkcs-12","application/x-pkcs12"]],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7m",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7r","application/x-pkcs7-certreqresp"],["p7s",["application/pkcs7-signature","application/x-pkcs7-signature"]],["p8","application/pkcs8"],["par","text/plain-bas"],["part","application/pro_eng"],["pas","text/pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcf","application/x-font-pcf"],["pcl",["application/vnd.hp-pcl","application/x-pcl"]],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb",["application/vnd.palm","chemical/x-pdb"]],["pdf","application/pdf"],["pfa","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfunk",["audio/make","audio/make.my.funk"]],["pfx","application/x-pkcs12"],["pgm",["image/x-portable-graymap","image/x-portable-greymap"]],["pgn","application/x-chess-pgn"],["pgp","application/pgp-signature"],["pic",["image/pict","image/x-pict"]],["pict","image/pict"],["pkg","application/x-newton-compatible-pkg"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pko",["application/ynd.ms-pkipko","application/vnd.ms-pki.pko"]],["pl",["text/plain","text/x-script.perl"]],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["plx","application/x-pixclscript"],["pm",["text/x-script.perl-module","image/x-xpixmap"]],["pm4","application/x-pagemaker"],["pm5","application/x-pagemaker"],["pma","application/x-perfmon"],["pmc","application/x-perfmon"],["pml",["application/vnd.ctc-posml","application/x-perfmon"]],["pmr","application/x-perfmon"],["pmw","application/x-perfmon"],["png","image/png"],["pnm",["application/x-portable-anymap","image/x-portable-anymap"]],["portpkg","application/vnd.macports.portpkg"],["pot",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["potm","application/vnd.ms-powerpoint.template.macroenabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["pov","model/x-pov"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroenabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["ppsm","application/vnd.ms-powerpoint.slideshow.macroenabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt",["application/vnd.ms-powerpoint","application/mspowerpoint","application/powerpoint","application/x-mspowerpoint"]],["pptm","application/vnd.ms-powerpoint.presentation.macroenabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["ppz","application/mspowerpoint"],["prc","application/x-mobipocket-ebook"],["pre",["application/vnd.lotus-freelance","application/x-freelance"]],["prf","application/pics-rules"],["prt","application/pro_eng"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd",["application/octet-stream","image/vnd.adobe.photoshop"]],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pvu","paleovu/x-pv"],["pwn","application/vnd.3m.post-it-notes"],["pwz","application/vnd.ms-powerpoint"],["py","text/x-script.phyton"],["pya","audio/vnd.ms-playready.media.pya"],["pyc","applicaiton/x-bytecode.python"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qcp","audio/vnd.qcelp"],["qd3","x-world/x-3dmf"],["qd3d","x-world/x-3dmf"],["qfx","application/vnd.intu.qfx"],["qif","image/x-quicktime"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qtc","video/x-qtc"],["qti","image/x-quicktime"],["qtif","image/x-quicktime"],["qxd","application/vnd.quark.quarkxpress"],["ra",["audio/x-realaudio","audio/x-pn-realaudio","audio/x-pn-realaudio-plugin"]],["ram","audio/x-pn-realaudio"],["rar","application/x-rar-compressed"],["ras",["image/cmu-raster","application/x-cmu-raster","image/x-cmu-raster"]],["rast","image/cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rexx","text/x-script.rexx"],["rf","image/vnd.rn-realflash"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm",["application/vnd.rn-realmedia","audio/x-pn-realaudio"]],["rmi","audio/mid"],["rmm","audio/x-pn-realaudio"],["rmp",["audio/x-pn-realaudio-plugin","audio/x-pn-realaudio"]],["rms","application/vnd.jcp.javame.midlet-rms"],["rnc","application/relax-ng-compact-syntax"],["rng",["application/ringing-tones","application/vnd.nokia.ringing-tone"]],["rnx","application/vnd.rn-realplayer"],["roff","application/x-troff"],["rp","image/vnd.rn-realpix"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsd","application/rsd+xml"],["rt",["text/richtext","text/vnd.rn-realtext"]],["rtf",["application/rtf","text/richtext","application/x-rtf"]],["rtx",["text/richtext","application/rtf"]],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["saveme","application/octet-stream"],["sbk","application/x-tbook"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm",["application/vnd.lotus-screencam","video/x-scm","text/x-script.guile","application/x-lotusscreencam","text/x-script.scheme"]],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["sct","text/scriptlet"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkm","application/vnd.solent.sdkm+xml"],["sdml","text/plain"],["sdp",["application/sdp","application/x-sdp"]],["sdr","application/sounder"],["sdw","application/vnd.stardivision.writer"],["sea",["application/sea","application/x-sea"]],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["ser","application/java-serialized-object"],["set","application/set"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sgl","application/vnd.stardivision.writer-global"],["sgm",["text/sgml","text/x-sgml"]],["sgml",["text/sgml","text/x-sgml"]],["sh",["application/x-shar","application/x-bsh","application/x-sh","text/x-script.sh"]],["shar",["application/x-bsh","application/x-shar"]],["shf","application/shf+xml"],["shtml",["text/html","text/x-server-parsed-html"]],["sid","audio/x-psid"],["sis","application/vnd.symbian.install"],["sit",["application/x-stuffit","application/x-sit"]],["sitx","application/x-stuffitx"],["skd","application/x-koan"],["skm","application/x-koan"],["skp",["application/vnd.koan","application/x-koan"]],["skt","application/x-koan"],["sl","application/x-seelogo"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi",["application/smil","application/smil+xml"]],["smil","application/smil"],["snd",["audio/basic","audio/x-adpcm"]],["snf","application/x-font-snf"],["sol","application/solids"],["spc",["text/x-speech","application/x-pkcs7-certificates"]],["spf","application/vnd.yamaha.smaf-phrase"],["spl",["application/futuresplash","application/x-futuresplash"]],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spr","application/x-sprite"],["sprite","application/x-sprite"],["src","application/x-wais-source"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssi","text/x-server-parsed-html"],["ssm","application/streamingmedia"],["ssml","application/ssml+xml"],["sst",["application/vnd.ms-pkicertstore","application/vnd.ms-pki.certstore"]],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["step","application/step"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl",["application/vnd.ms-pkistl","application/sla","application/vnd.ms-pki.stl","application/x-navistyle"]],["stm","text/html"],["stp","application/step"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["sub","image/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svf",["image/vnd.dwg","image/x-dwg"]],["svg","image/svg+xml"],["svr",["x-world/x-svr","application/x-world"]],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t",["text/troff","application/x-troff"]],["talk","text/x-speech"],["tao","application/vnd.tao.intent-module-archive"],["tar","application/x-tar"],["tbk",["application/toolbook","application/x-tbook"]],["tcap","application/vnd.3gpp2.tcap"],["tcl",["text/x-script.tcl","application/x-tcl"]],["tcsh","text/x-script.tcsh"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text",["application/plain","text/plain"]],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tgz",["application/gnutar","application/x-compressed"]],["thmx","application/vnd.ms-officetheme"],["tif",["image/tiff","image/x-tiff"]],["tiff",["image/tiff","image/x-tiff"]],["tmo","application/vnd.tmobile-livetv"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","application/x-troff"],["tra","application/vnd.trueapp"],["trm","application/x-msterminal"],["tsd","application/timestamped-data"],["tsi","audio/tsp-audio"],["tsp",["application/dsptype","audio/tsplayer"]],["tsv","text/tab-separated-values"],["ttf","application/x-font-ttf"],["ttl","text/turtle"],["turbot","image/florian"],["twd","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["ufd","application/vnd.ufdl"],["uil","text/x-uil"],["uls","text/iuls"],["umj","application/vnd.umajin"],["uni","text/uri-list"],["unis","text/uri-list"],["unityweb","application/vnd.unity"],["unv","application/i-deas"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["ustar",["application/x-ustar","multipart/x-ustar"]],["utz","application/vnd.uiq.theme"],["uu",["application/octet-stream","text/x-uuencode"]],["uue","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vda","application/vda"],["vdo","video/vdo"],["vew","application/groupwise"],["vis","application/vnd.visionary"],["viv",["video/vivo","video/vnd.vivo"]],["vivo",["video/vivo","video/vnd.vivo"]],["vmd","application/vocaltec-media-desc"],["vmf","application/vocaltec-media-file"],["voc",["audio/voc","audio/x-voc"]],["vos","video/vosaic"],["vox","audio/voxware"],["vqe","audio/x-twinvq-plugin"],["vqf","audio/x-twinvq"],["vql","audio/x-twinvq-plugin"],["vrml",["model/vrml","x-world/x-vrml","application/x-vrml"]],["vrt","x-world/x-vrt"],["vsd",["application/vnd.visio","application/x-visio"]],["vsf","application/vnd.vsf"],["vst","application/x-visio"],["vsw","application/x-visio"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w60","application/wordperfect6.0"],["w61","application/wordperfect6.1"],["w6w","application/msword"],["wad","application/x-doom"],["wav",["audio/wav","audio/x-wav"]],["wax","audio/x-ms-wax"],["wb1","application/x-qpro"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/vnd.wap.wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["web","application/vnd.xara"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wiz","application/msword"],["wk1","application/x-123"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf",["windows/metafile","application/x-msmetafile"]],["wml","text/vnd.wap.wml"],["wmlc","application/vnd.wap.wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-ms-wmz"],["woff","application/x-font-woff"],["word","application/msword"],["wp","application/wordperfect"],["wp5",["application/wordperfect","application/wordperfect6.0"]],["wp6","application/wordperfect"],["wpd",["application/wordperfect","application/vnd.wordperfect","application/x-wpwin"]],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wq1","application/x-lotus"],["wqd","application/vnd.wqd"],["wri",["application/mswrite","application/x-wri","application/x-mswrite"]],["wrl",["model/vrml","x-world/x-vrml","application/x-world"]],["wrz",["model/vrml","x-world/x-vrml"]],["wsc","text/scriplet"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wsrc","application/x-wais-source"],["wtb","application/vnd.webturbo"],["wtk","application/x-wintalk"],["wvx","video/x-ms-wvx"],["x-png","image/png"],["x3d","application/vnd.hzn-3d-crossword"],["xaf","x-world/x-vrml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm",["image/xbm","image/x-xbm","image/x-xbitmap"]],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdr","video/x-amt-demorun"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xgz","xgl/drawing"],["xhtml","application/xhtml+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlam","application/vnd.ms-excel.addin.macroenabled.12"],["xlb",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlc",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xld",["application/excel","application/x-excel"]],["xlk",["application/excel","application/x-excel"]],["xll",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlm",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xls",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlsb","application/vnd.ms-excel.sheet.binary.macroenabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroenabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xltm","application/vnd.ms-excel.template.macroenabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlv",["application/excel","application/x-excel"]],["xlw",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xm","audio/xm"],["xml",["application/xml","text/xml","application/atom+xml","application/rss+xml"]],["xmz","xgl/movie"],["xo","application/vnd.olpc-sugar"],["xof","x-world/x-vrml"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpix","application/x-vnd.ls-xpix"],["xpm",["image/xpm","image/x-xpixmap"]],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xsr","video/x-amt-showrun"],["xul","application/vnd.mozilla.xul+xml"],["xwd",["image/x-xwd","image/x-xwindowdump"]],["xyz",["chemical/x-xyz","chemical/x-pdb"]],["yang","application/yang"],["yin","application/yin+xml"],["z",["application/x-compressed","application/x-compress"]],["zaz","application/vnd.zzazz.deck+xml"],["zip",["application/zip","multipart/x-zip","application/x-zip-compressed","application/x-compressed"]],["zir","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zoo","application/octet-stream"],["zsh","text/x-script.zsh"]]);var Lh={detectMimeType(e){if(!e)return"application/octet-stream";let t=Ph.parse(e),i=(t.ext.substr(1)||t.name||"").split("?").shift().trim().toLowerCase(),n="application/octet-stream";return Rh.has(i)&&(n=Rh.get(i)),Array.isArray(n)?n[0]:n},detectExtension(e){if(!e)return"bin";let t=(e||"").toLowerCase().trim().split("/"),i=t.shift().trim(),n=t.join("/").trim();if(jh.has(i+"/"+n)){let e=jh.get(i+"/"+n);return Array.isArray(e)?e[0]:e}return"text"===i?"txt":"bin"}};const Nh=B.default.Transform;function Hh(e){return"string"==typeof e&&(e=Buffer.from(e,"utf-8")),e.toString("base64")}function $h(e,t){if(t=t||76,(e=(e||"").toString()).length<=t)return e;let i=[],n=0,s=1024*t;for(;n<e.length;){let o=e.substr(n,s).replace(new RegExp(".{"+t+"}","g"),"$&\r\n").trim();i.push(o),n+=s}return i.join("\r\n").trim()}var Uh={encode:Hh,wrap:$h,Encoder:class extends Nh{constructor(e){super(),this.options=e||{},!1!==this.options.lineLength&&(this.options.lineLength=this.options.lineLength||76),this._curLine="",this._remainingBytes=!1,this.inputBytes=0,this.outputBytes=0}_transform(e,t,i){if("buffer"!==t&&(e=Buffer.from(e,t)),!e||!e.length)return setImmediate(i);this.inputBytes+=e.length,this._remainingBytes&&this._remainingBytes.length&&(e=Buffer.concat([this._remainingBytes,e],this._remainingBytes.length+e.length),this._remainingBytes=!1),e.length%3?(this._remainingBytes=e.slice(e.length-e.length%3),e=e.slice(0,e.length-e.length%3)):this._remainingBytes=!1;let n=this._curLine+Hh(e);if(this.options.lineLength){n=$h(n,this.options.lineLength);let e=n.lastIndexOf("\n");e<0?(this._curLine=n,n=""):e===n.length-1?this._curLine="":(this._curLine=n.substr(e+1),n=n.substr(0,e+1))}n&&(this.outputBytes+=n.length,this.push(Buffer.from(n,"ascii"))),setImmediate(i)}_flush(e){this._remainingBytes&&this._remainingBytes.length&&(this._curLine+=Hh(this._remainingBytes)),this._curLine&&(this._curLine=$h(this._curLine,this.options.lineLength),this.outputBytes+=this._curLine.length,this.push(this._curLine,"ascii"),this._curLine=""),e()}}};const qh=B.default.Transform;function Mh(e){"string"==typeof e&&(e=Buffer.from(e,"utf-8"));let t,i=[[9],[10],[13],[32,60],[62,126]],n="";for(let s=0,o=e.length;s<o;s++)t=e[s],Gh(t,i)&&(32!==t&&9!==t||s!==o-1&&10!==e[s+1]&&13!==e[s+1])?n+=String.fromCharCode(t):n+="="+(t<16?"0":"")+t.toString(16).toUpperCase();return n}function zh(e,t){if(t=t||76,(e=(e||"").toString()).length<=t)return e;let i,n,s,o=0,a=e.length,r=Math.floor(t/3),c="";for(;o<a;)if(s=e.substr(o,t),i=s.match(/\r\n/))s=s.substr(0,i.index+i[0].length),c+=s,o+=s.length;else if("\n"!==s.substr(-1))if(i=s.substr(-r).match(/\n.*?$/))s=s.substr(0,s.length-(i[0].length-1)),c+=s,o+=s.length;else{if(s.length>t-r&&(i=s.substr(-r).match(/[ \t.,!?][^ \t.,!?]*$/)))s=s.substr(0,s.length-(i[0].length-1));else if(s.match(/[=][\da-f]{0,2}$/i))for((i=s.match(/[=][\da-f]{0,1}$/i))&&(s=s.substr(0,s.length-i[0].length));s.length>3&&s.length<a-o&&!s.match(/^(?:=[\da-f]{2}){1,4}$/i)&&(i=s.match(/[=][\da-f]{2}$/gi))&&(n=parseInt(i[0].substr(1,2),16),!(n<128))&&(s=s.substr(0,s.length-3),!(n>=192)););o+s.length<a&&"\n"!==s.substr(-1)?(s.length===t&&s.match(/[=][\da-f]{2}$/i)?s=s.substr(0,s.length-3):s.length===t&&(s=s.substr(0,s.length-1)),o+=s.length,s+="=\r\n"):o+=s.length,c+=s}else c+=s,o+=s.length;return c}function Gh(e,t){for(let i=t.length-1;i>=0;i--)if(t[i].length){if(1===t[i].length&&e===t[i][0])return!0;if(2===t[i].length&&e>=t[i][0]&&e<=t[i][1])return!0}return!1}var Vh={encode:Mh,wrap:zh,Encoder:class extends qh{constructor(e){super(),this.options=e||{},!1!==this.options.lineLength&&(this.options.lineLength=this.options.lineLength||76),this._curLine="",this.inputBytes=0,this.outputBytes=0}_transform(e,t,i){let n;if("buffer"!==t&&(e=Buffer.from(e,t)),!e||!e.length)return i();this.inputBytes+=e.length,this.options.lineLength?(n=this._curLine+Mh(e),n=zh(n,this.options.lineLength),n=n.replace(/(^|\n)([^\n]*)$/,((e,t,i)=>(this._curLine=i,t))),n&&(this.outputBytes+=n.length,this.push(n))):(n=Mh(e),this.outputBytes+=n.length,this.push(n,"ascii")),i()}_flush(e){this._curLine&&(this.outputBytes+=this._curLine.length,this.push(this._curLine,"ascii")),e()}}};const Wh=Uh,Kh=Vh,Jh=Lh;var Qh={isPlainText:(e,t)=>"string"==typeof e&&!(t?/[\x00-\x08\x0b\x0c\x0e-\x1f"\u0080-\uFFFF]/:/[\x00-\x08\x0b\x0c\x0e-\x1f\u0080-\uFFFF]/).test(e),hasLongerLines:(e,t)=>e.length>131072||new RegExp("^.{"+(t+1)+",}","m").test(e),encodeWord(e,t,i){let n;t=(t||"Q").toString().toUpperCase().trim().charAt(0);let s="UTF-8";if((i=i||0)&&i>7+s.length&&(i-=7+s.length),"Q"===t?n=Kh.encode(e).replace(/[^a-z0-9!*+\-/=]/gi,(e=>{let t=e.charCodeAt(0).toString(16).toUpperCase();return" "===e?"_":"="+(1===t.length?"0"+t:t)})):"B"===t&&(n="string"==typeof e?e:Wh.encode(e),i=i?Math.max(3,(i-i%4)/4*3):0),i&&("B"!==t?n:Wh.encode(e)).length>i)if("Q"===t)n=this.splitMimeEncodedString(n,i).join("?= =?UTF-8?"+t+"?");else{let e=[],s="";for(let t=0,o=n.length;t<o;t++){let o=n.charAt(t);Buffer.byteLength(s+o)<=i||0===t?s+=o:(e.push(Wh.encode(s)),s=o)}s&&e.push(Wh.encode(s)),n=e.length>1?e.join("?= =?UTF-8?"+t+"?"):e.join("")}else"B"===t&&(n=Wh.encode(e));return"=?UTF-8?"+t+"?"+n+("?="===n.substr(-2)?"":"?=")},encodeWords(e,t,i,n){let s;i=i||0;let o=e.match(/(?:^|\s)([^\s]*["\u0080-\uFFFF])/);if(!o)return e;if(n)return this.encodeWord(e,t,i);let a=e.match(/(["\u0080-\uFFFF][^\s]*)[^"\u0080-\uFFFF]*$/);if(!a)return e;let r=o.index+(o[0].match(/[^\s]/)||{index:0}).index,c=a.index+(a[1]||"").length;return s=(r?e.substr(0,r):"")+this.encodeWord(e.substring(r,c),t||"Q",i)+(c<e.length?e.substr(c):""),s},buildHeaderValue(e){let t=[];return Object.keys(e.params||{}).forEach((i=>{let n=e.params[i];!this.isPlainText(n,!0)||n.length>=75?this.buildHeaderParam(i,n,50).forEach((e=>{/[\s"\\;:/=(),<>@[\]?]|^[-']|'$/.test(e.value)&&"*"!==e.key.substr(-1)?t.push(e.key+"="+JSON.stringify(e.value)):t.push(e.key+"="+e.value)})):/[\s'"\\;:/=(),<>@[\]?]|^-/.test(n)?t.push(i+"="+JSON.stringify(n)):t.push(i+"="+n)})),e.value+(t.length?"; "+t.join("; "):"")},buildHeaderParam(e,t,i){let n,s,o,a,r,c,p=[],u="string"==typeof t?t:(t||"").toString(),l=0;if(i=i||50,this.isPlainText(t,!0)){if(u.length<=i)return[{key:e,value:u}];u=u.replace(new RegExp(".{"+i+"}","g"),(e=>(p.push({line:e}),""))),u&&p.push({line:u})}else{if(/[\uD800-\uDBFF]/.test(u)){for(n=[],r=0,c=u.length;r<c;r++)s=u.charAt(r),o=s.charCodeAt(0),o>=55296&&o<=56319&&r<c-1?(s+=u.charAt(r+1),n.push(s),r++):n.push(s);u=n}a="utf-8''";let e=!0;for(l=0,r=0,c=u.length;r<c;r++){if(s=u[r],e)s=this.safeEncodeURIComponent(s);else if(s=" "===s?s:this.safeEncodeURIComponent(s),s!==u[r]){if(!((this.safeEncodeURIComponent(a)+s).length>=i)){e=!0,r=l,a="";continue}p.push({line:a,encoded:e}),a="",l=r-1}(a+s).length>=i?(p.push({line:a,encoded:e}),a=s=" "===u[r]?" ":this.safeEncodeURIComponent(u[r]),s===u[r]?(e=!1,l=r-1):e=!0):a+=s}a&&p.push({line:a,encoded:e})}return p.map(((t,i)=>({key:e+"*"+i+(t.encoded?"*":""),value:t.line})))},parseHeaderValue(e){let t,i={value:!1,params:{}},n=!1,s="",o="value",a=!1,r=!1;for(let c=0,p=e.length;c<p;c++)if(t=e.charAt(c),"key"===o){if("="===t){n=s.trim().toLowerCase(),o="value",s="";continue}s+=t}else{if(r)s+=t;else{if("\\"===t){r=!0;continue}a&&t===a?a=!1:a||'"'!==t?a||";"!==t?s+=t:(!1===n?i.value=s.trim():i.params[n]=s.trim(),o="key",s=""):a=t}r=!1}return"value"===o?!1===n?i.value=s.trim():i.params[n]=s.trim():s.trim()&&(i.params[s.trim().toLowerCase()]=""),Object.keys(i.params).forEach((e=>{let t,n,s,o;(s=e.match(/(\*(\d+)|\*(\d+)\*|\*)$/))&&(t=e.substr(0,s.index),n=Number(s[2]||s[3])||0,i.params[t]&&"object"==typeof i.params[t]||(i.params[t]={charset:!1,values:[]}),o=i.params[e],0===n&&"*"===s[0].substr(-1)&&(s=o.match(/^([^']*)'[^']*'(.*)$/))&&(i.params[t].charset=s[1]||"iso-8859-1",o=s[2]),i.params[t].values[n]=o,delete i.params[e])})),Object.keys(i.params).forEach((e=>{let t;i.params[e]&&Array.isArray(i.params[e].values)&&(t=i.params[e].values.map((e=>e||"")).join(""),i.params[e].charset?i.params[e]="=?"+i.params[e].charset+"?Q?"+t.replace(/[=?_\s]/g,(e=>{let t=e.charCodeAt(0).toString(16);return" "===e?"_":"%"+(t.length<2?"0":"")+t})).replace(/%/g,"=")+"?=":i.params[e]=t)})),i},detectExtension:e=>Jh.detectExtension(e),detectMimeType:e=>Jh.detectMimeType(e),foldLines(e,t,i){t=t||76;let n,s,o=0,a=(e=(e||"").toString()).length,r="";for(;o<a;){if(n=e.substr(o,t),n.length<t){r+=n;break}(s=n.match(/^[^\n\r]*(\r?\n|\r)/))?(n=s[0],r+=n,o+=n.length):((s=n.match(/(\s+)[^\s]*$/))&&s[0].length-(i?(s[1]||"").length:0)<n.length?n=n.substr(0,n.length-(s[0].length-(i?(s[1]||"").length:0))):(s=e.substr(o+n.length).match(/^[^\s]+(\s*)/))&&(n+=s[0].substr(0,s[0].length-(i?0:(s[1]||"").length))),r+=n,o+=n.length,o<a&&(r+="\r\n"))}return r},splitMimeEncodedString:(e,t)=>{let i,n,s,o,a=[];for(t=Math.max(t||0,12);e.length;){for(i=e.substr(0,t),(n=i.match(/[=][0-9A-F]?$/i))&&(i=i.substr(0,n.index)),o=!1;!o;)o=!0,(n=e.substr(i.length).match(/^[=]([0-9A-F]{2})/i))&&(s=parseInt(n[1],16),s<194&&s>127&&(i=i.substr(0,i.length-3),o=!1));i.length&&a.push(i),e=e.substr(i.length)}return a},encodeURICharComponent:e=>{let t="",i=e.charCodeAt(0).toString(16).toUpperCase();if(i.length%2&&(i="0"+i),i.length>2)for(let e=0,n=i.length/2;e<n;e++)t+="%"+i.substr(e,2);else t+="%"+i;return t},safeEncodeURIComponent(e){e=(e||"").toString();try{e=encodeURIComponent(e)}catch(t){return e.replace(/[^\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]+/g,"")}return e.replace(/[\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]/g,(e=>this.encodeURICharComponent(e)))}};class Xh{constructor(e){this.str=(e||"").toString(),this.operatorCurrent="",this.operatorExpecting="",this.node=null,this.escaped=!1,this.list=[],this.operators={'"':'"',"(":")","<":">",",":"",":":";",";":""}}tokenize(){let e,t=[];for(let t=0,i=this.str.length;t<i;t++)e=this.str.charAt(t),this.checkChar(e);return this.list.forEach((e=>{e.value=(e.value||"").toString().trim(),e.value&&t.push(e)})),t}checkChar(e){if(this.escaped);else{if(e===this.operatorExpecting)return this.node={type:"operator",value:e},this.list.push(this.node),this.node=null,this.operatorExpecting="",void(this.escaped=!1);if(!this.operatorExpecting&&e in this.operators)return this.node={type:"operator",value:e},this.list.push(this.node),this.node=null,this.operatorExpecting=this.operators[e],void(this.escaped=!1);if(['"',"'"].includes(this.operatorExpecting)&&"\\"===e)return void(this.escaped=!0)}this.node||(this.node={type:"text",value:""},this.list.push(this.node)),"\n"===e&&(e=" "),(e.charCodeAt(0)>=33||[" ","\t"].includes(e))&&(this.node.value+=e),this.escaped=!1}}function Yh(e,t){t=t||{};let i=new Xh(e).tokenize(),n=[],s=[],o=[];if(i.forEach((e=>{"operator"!==e.type||","!==e.value&&";"!==e.value?s.push(e):(s.length&&n.push(s),s=[])})),s.length&&n.push(s),n.forEach((e=>{e=function(e){let t,i,n,s,o=!1,a="text",r=[],c={address:[],comment:[],group:[],text:[]};for(n=0,s=e.length;n<s;n++)if(t=e[n],"operator"===t.type)switch(t.value){case"<":a="address";break;case"(":a="comment";break;case":":a="group",o=!0;break;default:a="text"}else t.value&&("address"===a&&(t.value=t.value.replace(/^[^<]*<\s*/,"")),c[a].push(t.value));if(!c.text.length&&c.comment.length&&(c.text=c.comment,c.comment=[]),o)c.text=c.text.join(" "),r.push({name:c.text||i&&i.name,group:c.group.length?Yh(c.group.join(",")):[]});else{if(!c.address.length&&c.text.length){for(n=c.text.length-1;n>=0;n--)if(c.text[n].match(/^[^@\s]+@[^@\s]+$/)){c.address=c.text.splice(n,1);break}let e=function(e){return c.address.length?e:(c.address=[e.trim()]," ")};if(!c.address.length)for(n=c.text.length-1;n>=0&&(c.text[n]=c.text[n].replace(/\s*\b[^@\s]+@[^\s]+\b\s*/,e).trim(),!c.address.length);n--);}if(!c.text.length&&c.comment.length&&(c.text=c.comment,c.comment=[]),c.address.length>1&&(c.text=c.text.concat(c.address.splice(1))),c.text=c.text.join(" "),c.address=c.address.join(" "),!c.address&&o)return[];i={address:c.address||c.text||"",name:c.text||c.address||""},i.address===i.name&&((i.address||"").match(/@/)?i.name="":i.address=""),r.push(i)}return r}(e),e.length&&(o=o.concat(e))})),t.flatten){let e=[],t=i=>{i.forEach((i=>{if(i.group)return t(i.group);e.push(i)}))};return t(o),e}return o}var Zh=Yh;const em=B.default.Transform;var tm=class extends em{constructor(){super(),this.lastByte=!1}_transform(e,t,i){e.length&&(this.lastByte=e[e.length-1]),this.push(e),i()}_flush(e){return 10===this.lastByte?e():13===this.lastByte?(this.push(Buffer.from("\n")),e()):(this.push(Buffer.from("\r\n")),e())}};const im=B.default.Transform;var nm=class extends im{constructor(e){super(e),this.options=e||{},this.lastByte=!1}_transform(e,t,i){let n,s=0;for(let t=0,i=e.length;t<i;t++)10===e[t]&&(t&&13!==e[t-1]||!t&&13!==this.lastByte)&&(t>s&&(n=e.slice(s,t),this.push(n)),this.push(Buffer.from("\r\n")),s=t+1);s&&s<e.length?(n=e.slice(s),this.push(n)):s||this.push(e),this.lastByte=e[e.length-1],i()}};const sm=B.default.Transform;var om=class extends sm{constructor(e){super(e),this.options=e||{}}_transform(e,t,i){let n,s=0;for(let t=0,i=e.length;t<i;t++)13===e[t]&&(n=e.slice(s,t),s=t+1,this.push(n));s&&s<e.length?(n=e.slice(s),this.push(n)):s||this.push(e),i()}};const am=E.default,rm=P.default,cm=D.default,pm=j.default,um=B.default.PassThrough,lm=wh.exports,dm=Qh,hm=Vh,mm=Uh,fm=Zh,gm=_h.exports,vm=tm,xm=nm,ym=om;class bm{constructor(e,t){this.nodeCounter=0,t=t||{},this.baseBoundary=t.baseBoundary||am.randomBytes(8).toString("hex"),this.boundaryPrefix=t.boundaryPrefix||"--_NmP",this.disableFileAccess=!!t.disableFileAccess,this.disableUrlAccess=!!t.disableUrlAccess,this.normalizeHeaderKey=t.normalizeHeaderKey,this.date=new Date,this.rootNode=t.rootNode||this,this.keepBcc=!!t.keepBcc,t.filename&&(this.filename=t.filename,e||(e=dm.detectMimeType(this.filename.split(".").pop()))),this.textEncoding=(t.textEncoding||"").toString().trim().charAt(0).toUpperCase(),this.parentNode=t.parentNode,this.hostname=t.hostname,this.newline=t.newline,this.childNodes=[],this._nodeId=++this.rootNode.nodeCounter,this._headers=[],this._isPlainText=!1,this._hasLongLines=!1,this._envelope=!1,this._raw=!1,this._transforms=[],this._processFuncs=[],e&&this.setHeader("Content-Type",e)}createChild(e,t){t||"object"!=typeof e||(t=e,e=void 0);let i=new bm(e,t);return this.appendChild(i),i}appendChild(e){return e.rootNode!==this.rootNode&&(e.rootNode=this.rootNode,e._nodeId=++this.rootNode.nodeCounter),e.parentNode=this,this.childNodes.push(e),e}replace(e){return e===this?this:(this.parentNode.childNodes.forEach(((t,i)=>{t===this&&(e.rootNode=this.rootNode,e.parentNode=this.parentNode,e._nodeId=this._nodeId,this.rootNode=this,this.parentNode=void 0,e.parentNode.childNodes[i]=e)})),e)}remove(){if(!this.parentNode)return this;for(let e=this.parentNode.childNodes.length-1;e>=0;e--)if(this.parentNode.childNodes[e]===this)return this.parentNode.childNodes.splice(e,1),this.parentNode=void 0,this.rootNode=this,this}setHeader(e,t){let i,n=!1;if(!t&&e&&"object"==typeof e)return e.key&&"value"in e?this.setHeader(e.key,e.value):Array.isArray(e)?e.forEach((e=>{this.setHeader(e.key,e.value)})):Object.keys(e).forEach((t=>{this.setHeader(t,e[t])})),this;i={key:e=this._normalizeHeaderKey(e),value:t};for(let t=0,s=this._headers.length;t<s;t++)this._headers[t].key===e&&(n?(this._headers.splice(t,1),t--,s--):(this._headers[t]=i,n=!0));return n||this._headers.push(i),this}addHeader(e,t){return!t&&e&&"object"==typeof e?(e.key&&e.value?this.addHeader(e.key,e.value):Array.isArray(e)?e.forEach((e=>{this.addHeader(e.key,e.value)})):Object.keys(e).forEach((t=>{this.addHeader(t,e[t])})),this):Array.isArray(t)?(t.forEach((t=>{this.addHeader(e,t)})),this):(this._headers.push({key:this._normalizeHeaderKey(e),value:t}),this)}getHeader(e){e=this._normalizeHeaderKey(e);for(let t=0,i=this._headers.length;t<i;t++)if(this._headers[t].key===e)return this._headers[t].value}setContent(e){return this.content=e,"function"==typeof this.content.pipe?(this._contentErrorHandler=e=>{this.content.removeListener("error",this._contentErrorHandler),this.content=e},this.content.once("error",this._contentErrorHandler)):"string"==typeof this.content&&(this._isPlainText=dm.isPlainText(this.content),this._isPlainText&&dm.hasLongerLines(this.content,76)&&(this._hasLongLines=!0)),this}build(e){let t;e||(t=new Promise(((t,i)=>{e=lm.callbackPromise(t,i)})));let i=this.createReadStream(),n=[],s=0,o=!1;return i.on("readable",(()=>{let e;for(;null!==(e=i.read());)n.push(e),s+=e.length})),i.once("error",(t=>{if(!o)return o=!0,e(t)})),i.once("end",(t=>{if(!o)return o=!0,t&&t.length&&(n.push(t),s+=t.length),e(null,Buffer.concat(n,s))})),t}getTransferEncoding(){let e=!1,t=(this.getHeader("Content-Type")||"").toString().toLowerCase().trim();return this.content&&(e=(this.getHeader("Content-Transfer-Encoding")||"").toString().toLowerCase().trim(),e&&["base64","quoted-printable"].includes(e)||(/^text\//i.test(t)?e=this._isPlainText&&!this._hasLongLines?"7bit":"string"==typeof this.content||this.content instanceof Buffer?"Q"===this._getTextEncoding(this.content)?"quoted-printable":"base64":"B"===this.textEncoding?"base64":"quoted-printable":/^(multipart|message)\//i.test(t)||(e=e||"base64"))),e}buildHeaders(){let e=this.getTransferEncoding(),t=[];return e&&this.setHeader("Content-Transfer-Encoding",e),this.filename&&!this.getHeader("Content-Disposition")&&this.setHeader("Content-Disposition","attachment"),this.rootNode===this&&(this.getHeader("Date")||this.setHeader("Date",this.date.toUTCString().replace(/GMT/,"+0000")),this.messageId(),this.getHeader("MIME-Version")||this.setHeader("MIME-Version","1.0")),this._headers.forEach((e=>{let i,n,s=e.key,o=e.value,a={};if(!o||"object"!=typeof o||["From","Sender","To","Cc","Bcc","Reply-To","Date","References"].includes(s)||(Object.keys(o).forEach((e=>{"value"!==e&&(a[e]=o[e])})),o=(o.value||"").toString(),o.trim()))if(a.prepared)a.foldLines?t.push(dm.foldLines(s+": "+o)):t.push(s+": "+o);else{switch(e.key){case"Content-Disposition":i=dm.parseHeaderValue(o),this.filename&&(i.params.filename=this.filename),o=dm.buildHeaderValue(i);break;case"Content-Type":i=dm.parseHeaderValue(o),this._handleContentType(i),i.value.match(/^text\/plain\b/)&&"string"==typeof this.content&&/[\u0080-\uFFFF]/.test(this.content)&&(i.params.charset="utf-8"),o=dm.buildHeaderValue(i),this.filename&&(n=this._encodeWords(this.filename),(n!==this.filename||/[\s'"\\;:/=(),<>@[\]?]|^-/.test(n))&&(n='"'+n+'"'),o+="; name="+n);break;case"Bcc":if(!this.keepBcc)return}if(o=this._encodeHeaderValue(s,o),(o||"").toString().trim()){if("function"==typeof this.normalizeHeaderKey){let e=this.normalizeHeaderKey(s,o);e&&"string"==typeof e&&e.length&&(s=e)}t.push(dm.foldLines(s+": "+o,76))}}})),t.join("\r\n")}createReadStream(e){let t,i=new um(e=e||{}),n=i;this.stream(i,e,(e=>{e?n.emit("error",e):i.end()}));for(let e=0,i=this._transforms.length;e<i;e++)t="function"==typeof this._transforms[e]?this._transforms[e]():this._transforms[e],n.once("error",(e=>{t.emit("error",e)})),n=n.pipe(t);t=new vm,n.once("error",(e=>{t.emit("error",e)})),n=n.pipe(t);for(let e=0,i=this._processFuncs.length;e<i;e++)t=this._processFuncs[e],n=t(n);if(this.newline){const e=["win","windows","dos","\r\n"].includes(this.newline.toString().toLowerCase())?new xm:new ym,t=n.pipe(e);return n.on("error",(e=>t.emit("error",e))),t}return n}transform(e){this._transforms.push(e)}processFunc(e){this._processFuncs.push(e)}stream(e,t,i){let n,s,o=this.getTransferEncoding(),a=!1,r=e=>{a||(a=!0,i(e))},c=()=>{let i=0,n=()=>{if(i>=this.childNodes.length)return e.write("\r\n--"+this.boundary+"--\r\n"),r();let s=this.childNodes[i++];e.write((i>1?"\r\n":"")+"--"+this.boundary+"\r\n"),s.stream(e,t,(e=>{if(e)return r(e);setImmediate(n)}))};if(!this.multipart)return r();setImmediate(n)},p=()=>{if(!this.content)return setImmediate(c);{if("[object Error]"===Object.prototype.toString.call(this.content))return r(this.content);"function"==typeof this.content.pipe&&(this.content.removeListener("error",this._contentErrorHandler),this._contentErrorHandler=e=>r(e),this.content.once("error",this._contentErrorHandler));let i=()=>{["quoted-printable","base64"].includes(o)?(n=new("base64"===o?mm:hm).Encoder(t),n.pipe(e,{end:!1}),n.once("end",c),n.once("error",(e=>r(e))),s=this._getStream(this.content),s.pipe(n)):(s=this._getStream(this.content),s.pipe(e,{end:!1}),s.once("end",c)),s.once("error",(e=>r(e)))};if(this.content._resolve){let e=[],t=0,n=!1,s=this._getStream(this.content);s.on("error",(e=>{n||(n=!0,r(e))})),s.on("readable",(()=>{let i;for(;null!==(i=s.read());)e.push(i),t+=i.length})),s.on("end",(()=>{n||(n=!0,this.content._resolve=!1,this.content._resolvedValue=Buffer.concat(e,t),setImmediate(i))}))}else setImmediate(i)}};this._raw?setImmediate((()=>{if("[object Error]"===Object.prototype.toString.call(this._raw))return r(this._raw);"function"==typeof this._raw.pipe&&this._raw.removeListener("error",this._contentErrorHandler);let t=this._getStream(this._raw);t.pipe(e,{end:!1}),t.on("error",(t=>e.emit("error",t))),t.on("end",c)})):(e.write(this.buildHeaders()+"\r\n\r\n"),setImmediate(p))}setEnvelope(e){let t;this._envelope={from:!1,to:[]},e.from&&(t=[],this._convertAddresses(this._parseAddresses(e.from),t),t=t.filter((e=>e&&e.address)),t.length&&t[0]&&(this._envelope.from=t[0].address)),["to","cc","bcc"].forEach((t=>{e[t]&&this._convertAddresses(this._parseAddresses(e[t]),this._envelope.to)})),this._envelope.to=this._envelope.to.map((e=>e.address)).filter((e=>e));let i=["to","cc","bcc","from"];return Object.keys(e).forEach((t=>{i.includes(t)||(this._envelope[t]=e[t])})),this}getAddresses(){let e={};return this._headers.forEach((t=>{let i=t.key.toLowerCase();["from","sender","reply-to","to","cc","bcc"].includes(i)&&(Array.isArray(e[i])||(e[i]=[]),this._convertAddresses(this._parseAddresses(t.value),e[i]))})),e}getEnvelope(){if(this._envelope)return this._envelope;let e={from:!1,to:[]};return this._headers.forEach((t=>{let i=[];"From"===t.key||!e.from&&["Reply-To","Sender"].includes(t.key)?(this._convertAddresses(this._parseAddresses(t.value),i),i.length&&i[0]&&(e.from=i[0].address)):["To","Cc","Bcc"].includes(t.key)&&this._convertAddresses(this._parseAddresses(t.value),e.to)})),e.to=e.to.map((e=>e.address)),e}messageId(){let e=this.getHeader("Message-ID");return e||(e=this._generateMessageId(),this.setHeader("Message-ID",e)),e}setRaw(e){return this._raw=e,this._raw&&"function"==typeof this._raw.pipe&&(this._contentErrorHandler=e=>{this._raw.removeListener("error",this._contentErrorHandler),this._raw=e},this._raw.once("error",this._contentErrorHandler)),this}_getStream(e){let t;return e._resolvedValue?(t=new um,setImmediate((()=>t.end(e._resolvedValue))),t):"function"==typeof e.pipe?e:e&&"string"==typeof e.path&&!e.href?this.disableFileAccess?(t=new um,setImmediate((()=>t.emit("error",new Error("File access rejected for "+e.path)))),t):cm.createReadStream(e.path):e&&"string"==typeof e.href?this.disableUrlAccess?(t=new um,setImmediate((()=>t.emit("error",new Error("Url access rejected for "+e.href)))),t):gm(e.href,{headers:e.httpHeaders}):(t=new um,setImmediate((()=>t.end(e||""))),t)}_parseAddresses(e){return[].concat.apply([],[].concat(e).map((e=>e&&e.address?(e.address=this._normalizeAddress(e.address),e.name=e.name||"",[e]):fm(e))))}_normalizeHeaderKey(e){return e=(e||"").toString().replace(/\r?\n|\r/g," ").trim().toLowerCase().replace(/^X-SMTPAPI$|^(MIME|DKIM|ARC|BIMI)\b|^[a-z]|-(SPF|FBL|ID|MD5)$|-[a-z]/gi,(e=>e.toUpperCase())).replace(/^Content-Features$/i,"Content-features"),e}_handleContentType(e){this.contentType=e.value.trim().toLowerCase(),this.multipart=!!/^multipart\//i.test(this.contentType)&&this.contentType.substr(this.contentType.indexOf("/")+1),this.multipart?this.boundary=e.params.boundary=e.params.boundary||this.boundary||this._generateBoundary():this.boundary=!1}_generateBoundary(){return this.rootNode.boundaryPrefix+"-"+this.rootNode.baseBoundary+"-Part_"+this._nodeId}_encodeHeaderValue(e,t){switch(e=this._normalizeHeaderKey(e)){case"From":case"Sender":case"To":case"Cc":case"Bcc":case"Reply-To":return this._convertAddresses(this._parseAddresses(t));case"Message-ID":case"In-Reply-To":case"Content-Id":return"<"!==(t=(t||"").toString().replace(/\r?\n|\r/g," ")).charAt(0)&&(t="<"+t),">"!==t.charAt(t.length-1)&&(t+=">"),t;case"References":return(t=[].concat.apply([],[].concat(t||"").map((e=>(e=(e||"").toString().replace(/\r?\n|\r/g," ").trim()).replace(/<[^>]*>/g,(e=>e.replace(/\s/g,""))).split(/\s+/)))).map((e=>("<"!==e.charAt(0)&&(e="<"+e),">"!==e.charAt(e.length-1)&&(e+=">"),e)))).join(" ").trim();case"Date":return"[object Date]"===Object.prototype.toString.call(t)?t.toUTCString().replace(/GMT/,"+0000"):(t=(t||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(t));case"Content-Type":case"Content-Disposition":return(t||"").toString().replace(/\r?\n|\r/g," ");default:return t=(t||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(t)}}_convertAddresses(e,t){let i=[];return t=t||[],[].concat(e||[]).forEach((e=>{if(e.address)e.address=this._normalizeAddress(e.address),e.name?e.name&&i.push(`${this._encodeAddressName(e.name)} <${e.address}>`):i.push(e.address.indexOf(" ")>=0?`<${e.address}>`:`${e.address}`),e.address&&(t.filter((t=>t.address===e.address)).length||t.push(e));else if(e.group){let n=(e.group.length?this._convertAddresses(e.group,t):"").trim();i.push(`${this._encodeAddressName(e.name)}:${n};`)}})),i.join(", ")}_normalizeAddress(e){let t=(e=(e||"").toString().replace(/[\x00-\x1F<>]+/g," ").trim()).lastIndexOf("@");if(t<0)return e;let i,n=e.substr(0,t),s=e.substr(t+1);try{i=pm.toASCII(s.toLowerCase())}catch(e){}return n.indexOf(" ")>=0&&('"'!==n.charAt(0)&&(n='"'+n),'"'!==n.substr(-1)&&(n+='"')),`${n}@${i}`}_encodeAddressName(e){return/^[\w ']*$/.test(e)?e:/^[\x20-\x7e]*$/.test(e)?'"'+e.replace(/([\\"])/g,"\\$1")+'"':dm.encodeWord(e,this._getTextEncoding(e),52)}_encodeWords(e){return dm.encodeWords(e,this._getTextEncoding(e),52,!0)}_getTextEncoding(e){e=(e||"").toString();let t,i,n=this.textEncoding;return n||(i=(e.match(/[\x00-\x08\x0B\x0C\x0E-\x1F\u0080-\uFFFF]/g)||[]).length,t=(e.match(/[a-z]/gi)||[]).length,n=i<t?"Q":"B"),n}_generateMessageId(){return"<"+[2,2,2,6].reduce(((e,t)=>e+"-"+am.randomBytes(t).toString("hex")),am.randomBytes(4).toString("hex"))+"@"+(this.getEnvelope().from||this.hostname||rm.hostname()||"localhost").split("@").pop()+">"}}var wm=bm;const _m=wm,Dm=Qh;var Em=class{constructor(e){this.mail=e||{},this.message=!1}compile(){return this._alternatives=this.getAlternatives(),this._htmlNode=this._alternatives.filter((e=>/^text\/html\b/i.test(e.contentType))).pop(),this._attachments=this.getAttachments(!!this._htmlNode),this._useRelated=!(!this._htmlNode||!this._attachments.related.length),this._useAlternative=this._alternatives.length>1,this._useMixed=this._attachments.attached.length>1||this._alternatives.length&&1===this._attachments.attached.length,this.mail.raw?this.message=new _m("message/rfc822",{newline:this.mail.newline}).setRaw(this.mail.raw):this._useMixed?this.message=this._createMixed():this._useAlternative?this.message=this._createAlternative():this._useRelated?this.message=this._createRelated():this.message=this._createContentNode(!1,[].concat(this._alternatives||[]).concat(this._attachments.attached||[]).shift()||{contentType:"text/plain",content:""}),this.mail.headers&&this.message.addHeader(this.mail.headers),["from","sender","to","cc","bcc","reply-to","in-reply-to","references","subject","message-id","date"].forEach((e=>{let t=e.replace(/-(\w)/g,((e,t)=>t.toUpperCase()));this.mail[t]&&this.message.setHeader(e,this.mail[t])})),this.mail.envelope&&this.message.setEnvelope(this.mail.envelope),this.message.messageId(),this.message}getAttachments(e){let t,i,n=[].concat(this.mail.attachments||[]).map(((e,t)=>{let i,n=/^message\//i.test(e.contentType);return/^data:/i.test(e.path||e.href)&&(e=this._processDataUrl(e)),i={contentType:e.contentType||Dm.detectMimeType(e.filename||e.path||e.href||"bin"),contentDisposition:e.contentDisposition||(n?"inline":"attachment"),contentTransferEncoding:"contentTransferEncoding"in e?e.contentTransferEncoding:"base64"},e.filename?i.filename=e.filename:n||!1===e.filename||(i.filename=(e.path||e.href||"").split("/").pop().split("?").shift()||"attachment-"+(t+1),i.filename.indexOf(".")<0&&(i.filename+="."+Dm.detectExtension(i.contentType))),/^https?:\/\//i.test(e.path)&&(e.href=e.path,e.path=void 0),e.cid&&(i.cid=e.cid),e.raw?i.raw=e.raw:e.path?i.content={path:e.path}:e.href?i.content={href:e.href,httpHeaders:e.httpHeaders}:i.content=e.content||"",e.encoding&&(i.encoding=e.encoding),e.headers&&(i.headers=e.headers),i}));return this.mail.icalEvent&&(t="object"==typeof this.mail.icalEvent&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?this.mail.icalEvent:{content:this.mail.icalEvent},i={},Object.keys(t).forEach((e=>{i[e]=t[e]})),i.contentType="application/ics",i.headers||(i.headers={}),i.filename=i.filename||"invite.ics",i.headers["Content-Disposition"]="attachment",i.headers["Content-Transfer-Encoding"]="base64"),e?{attached:n.filter((e=>!e.cid)).concat(i||[]),related:n.filter((e=>!!e.cid))}:{attached:n.concat(i||[]),related:[]}}getAlternatives(){let e,t,i,n,s,o,a=[];return this.mail.text&&(e="object"==typeof this.mail.text&&(this.mail.text.content||this.mail.text.path||this.mail.text.href||this.mail.text.raw)?this.mail.text:{content:this.mail.text},e.contentType="text/plain; charset=utf-8"),this.mail.watchHtml&&(i="object"==typeof this.mail.watchHtml&&(this.mail.watchHtml.content||this.mail.watchHtml.path||this.mail.watchHtml.href||this.mail.watchHtml.raw)?this.mail.watchHtml:{content:this.mail.watchHtml},i.contentType="text/watch-html; charset=utf-8"),this.mail.amp&&(n="object"==typeof this.mail.amp&&(this.mail.amp.content||this.mail.amp.path||this.mail.amp.href||this.mail.amp.raw)?this.mail.amp:{content:this.mail.amp},n.contentType="text/x-amp-html; charset=utf-8"),this.mail.icalEvent&&(s="object"==typeof this.mail.icalEvent&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?this.mail.icalEvent:{content:this.mail.icalEvent},o={},Object.keys(s).forEach((e=>{o[e]=s[e]})),o.content&&"object"==typeof o.content&&(o.content._resolve=!0),o.filename=!1,o.contentType="text/calendar; charset=utf-8; method="+(o.method||"PUBLISH").toString().trim().toUpperCase(),o.headers||(o.headers={})),this.mail.html&&(t="object"==typeof this.mail.html&&(this.mail.html.content||this.mail.html.path||this.mail.html.href||this.mail.html.raw)?this.mail.html:{content:this.mail.html},t.contentType="text/html; charset=utf-8"),[].concat(e||[]).concat(i||[]).concat(n||[]).concat(t||[]).concat(o||[]).concat(this.mail.alternatives||[]).forEach((e=>{let t;/^data:/i.test(e.path||e.href)&&(e=this._processDataUrl(e)),t={contentType:e.contentType||Dm.detectMimeType(e.filename||e.path||e.href||"txt"),contentTransferEncoding:e.contentTransferEncoding},e.filename&&(t.filename=e.filename),/^https?:\/\//i.test(e.path)&&(e.href=e.path,e.path=void 0),e.raw?t.raw=e.raw:e.path?t.content={path:e.path}:e.href?t.content={href:e.href}:t.content=e.content||"",e.encoding&&(t.encoding=e.encoding),e.headers&&(t.headers=e.headers),a.push(t)})),a}_createMixed(e){let t;return t=e?e.createChild("multipart/mixed",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new _m("multipart/mixed",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._useAlternative?this._createAlternative(t):this._useRelated&&this._createRelated(t),[].concat(!this._useAlternative&&this._alternatives||[]).concat(this._attachments.attached||[]).forEach((e=>{this._useRelated&&e===this._htmlNode||this._createContentNode(t,e)})),t}_createAlternative(e){let t;return t=e?e.createChild("multipart/alternative",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new _m("multipart/alternative",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._alternatives.forEach((e=>{this._useRelated&&this._htmlNode===e?this._createRelated(t):this._createContentNode(t,e)})),t}_createRelated(e){let t;return t=e?e.createChild('multipart/related; type="text/html"',{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new _m('multipart/related; type="text/html"',{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._createContentNode(t,this._htmlNode),this._attachments.related.forEach((e=>this._createContentNode(t,e))),t}_createContentNode(e,t){let i;(t=t||{}).content=t.content||"";let n=(t.encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");return i=e?e.createChild(t.contentType,{filename:t.filename,textEncoding:this.mail.textEncoding,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):new _m(t.contentType,{filename:t.filename,baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),t.headers&&i.addHeader(t.headers),t.cid&&i.setHeader("Content-Id","<"+t.cid.replace(/[<>]/g,"")+">"),t.contentTransferEncoding?i.setHeader("Content-Transfer-Encoding",t.contentTransferEncoding):this.mail.encoding&&/^text\//i.test(t.contentType)&&i.setHeader("Content-Transfer-Encoding",this.mail.encoding),/^text\//i.test(t.contentType)&&!t.contentDisposition||i.setHeader("Content-Disposition",t.contentDisposition||(t.cid?"inline":"attachment")),"string"!=typeof t.content||["utf8","usascii","ascii"].includes(n)||(t.content=Buffer.from(t.content,n)),t.raw?i.setRaw(t.raw):i.setContent(t.content),i}_processDataUrl(e){let t=(e.path||e.href).match(/^data:((?:[^;]*;)*(?:[^,]*)),(.*)$/i);return t?(e.content=/\bbase64$/i.test(t[1])?Buffer.from(t[2],"base64"):Buffer.from(decodeURIComponent(t[2])),"path"in e&&(e.path=!1),"href"in e&&(e.href=!1),t[1].split(";").forEach((t=>{/^\w+\/[^/]+$/i.test(t)&&(e.contentType=e.contentType||t.toLowerCase())})),e):e}};const Cm=B.default.Transform;var Am=class extends Cm{constructor(e){super(e),this.lastBytes=Buffer.alloc(4),this.headersParsed=!1,this.headerBytes=0,this.headerChunks=[],this.rawHeaders=!1,this.bodySize=0}updateLastBytes(e){let t=this.lastBytes.length,i=Math.min(e.length,t);for(let e=0,n=t-i;e<n;e++)this.lastBytes[e]=this.lastBytes[e+i];for(let n=1;n<=i;n++)this.lastBytes[t-n]=e[e.length-n]}checkHeaders(e){if(this.headersParsed)return!0;let t=this.lastBytes.length,i=0;this.curLinePos=0;for(let n=0,s=this.lastBytes.length+e.length;n<s;n++){let s;if(s=n<t?this.lastBytes[n]:e[n-t],10===s&&n){let s=n-1<t?this.lastBytes[n-1]:e[n-1-t],o=n>1&&(n-2<t?this.lastBytes[n-2]:e[n-2-t]);if(10===s){this.headersParsed=!0,i=n-t+1,this.headerBytes+=i;break}if(13===s&&10===o){this.headersParsed=!0,i=n-t+1,this.headerBytes+=i;break}}}if(this.headersParsed){if(this.headerChunks.push(e.slice(0,i)),this.rawHeaders=Buffer.concat(this.headerChunks,this.headerBytes),this.headerChunks=null,this.emit("headers",this.parseHeaders()),e.length-1>i){let t=e.slice(i);this.bodySize+=t.length,setImmediate((()=>this.push(t)))}return!1}return this.headerBytes+=e.length,this.headerChunks.push(e),this.updateLastBytes(e),!1}_transform(e,t,i){if(!e||!e.length)return i();let n;"string"==typeof e&&(e=Buffer.from(e,t));try{n=this.checkHeaders(e)}catch(e){return i(e)}n&&(this.bodySize+=e.length,this.push(e)),setImmediate(i)}_flush(e){if(this.headerChunks){let e=Buffer.concat(this.headerChunks,this.headerBytes);this.bodySize+=e.length,this.push(e),this.headerChunks=null}e()}parseHeaders(){let e=(this.rawHeaders||"").toString().split(/\r?\n/);for(let t=e.length-1;t>0;t--)/^\s/.test(e[t])&&(e[t-1]+="\n"+e[t],e.splice(t,1));return e.filter((e=>e.trim())).map((e=>({key:e.substr(0,e.indexOf(":")).trim().toLowerCase(),line:e})))}};const km=B.default.Transform,Sm=E.default;var Fm=class extends km{constructor(e){super(),e=e||{},this.chunkBuffer=[],this.chunkBufferLen=0,this.bodyHash=Sm.createHash(e.hashAlgo||"sha1"),this.remainder="",this.byteLength=0,this.debug=e.debug,this._debugBody=!!e.debug&&[]}updateHash(e){let t,i="",n="file";for(let t=e.length-1;t>=0;t--){let s=e[t];if("file"!==n||10!==s&&13!==s)if("file"!==n||9!==s&&32!==s)if("line"!==n||9!==s&&32!==s){if(("file"===n||"line"===n)&&(n="body",t===e.length-1))break}else;else n="line";else;if(0===t){if("file"===n&&(!this.remainder||/[\r\n]$/.test(this.remainder))||"line"===n&&(!this.remainder||/[ \t]$/.test(this.remainder)))return void(this.remainder+=e.toString("binary"));if("line"===n||"file"===n){i=e.toString("binary"),e=!1;break}}if("body"===n){i=e.slice(t+1).toString("binary"),e=e.slice(0,t+1);break}}let s=!!this.remainder;if(e&&!s)for(let t=0,i=e.length;t<i;t++){if(t&&10===e[t]&&13!==e[t-1]){s=!0;break}if(t&&13===e[t]&&32===e[t-1]){s=!0;break}if(t&&32===e[t]&&32===e[t-1]){s=!0;break}if(9===e[t]){s=!0;break}}s?(t=this.remainder+(e?e.toString("binary"):""),this.remainder=i,t=t.replace(/\r?\n/g,"\n").replace(/[ \t]*$/gm,"").replace(/[ \t]+/gm," ").replace(/\n/g,"\r\n"),e=Buffer.from(t,"binary")):i&&(this.remainder=i),this.debug&&this._debugBody.push(e),this.bodyHash.update(e)}_transform(e,t,i){if(!e||!e.length)return i();"string"==typeof e&&(e=Buffer.from(e,t)),this.updateHash(e),this.byteLength+=e.length,this.push(e),i()}_flush(e){/[\r\n]$/.test(this.remainder)&&this.byteLength>2&&this.bodyHash.update(Buffer.from("\r\n")),this.byteLength||this.push(Buffer.from("\r\n")),this.emit("hash",this.bodyHash.digest("base64"),!!this.debug&&Buffer.concat(this._debugBody)),e()}},Tm={exports:{}};const Bm=j.default,Om=Qh,Im=E.default;function Pm(e,t,i){let n=new Set,s=new Set,o=new Map;(i||"").toLowerCase().split(":").forEach((e=>{s.add(e.trim())})),(t||"").toLowerCase().split(":").filter((e=>!s.has(e.trim()))).forEach((e=>{n.add(e.trim())}));for(let t=e.length-1;t>=0;t--){let i=e[t];n.has(i.key)&&!o.has(i.key)&&o.set(i.key,jm(i.line))}let a=[],r=[];return n.forEach((e=>{o.has(e)&&(r.push(e),a.push(e+":"+o.get(e)))})),{headers:a.join("\r\n")+"\r\n",fieldNames:r.join(":")}}function jm(e){return e.substr(e.indexOf(":")+1).replace(/\r?\n/g,"").replace(/\s+/g," ").trim()}Tm.exports=(e,t,i,n)=>{let s,o,a=Pm(e,(n=n||{}).headerFieldNames||"From:Sender:Reply-To:Subject:Date:Message-ID:To:Cc:MIME-Version:Content-Type:Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:In-Reply-To:References:List-Id:List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive",n.skipFields),r=function(e,t,i,n,s){let o=["v=1","a=rsa-"+n,"c=relaxed/relaxed","d="+Bm.toASCII(e),"q=dns/txt","s="+t,"bh="+s,"h="+i].join("; ");return Om.foldLines("DKIM-Signature: "+o,76)+";\r\n b="}(n.domainName,n.keySelector,a.fieldNames,t,i);a.headers+="dkim-signature:"+jm(r),s=Im.createSign(("rsa-"+t).toUpperCase()),s.update(a.headers);try{o=s.sign(n.privateKey,"base64")}catch(e){return!1}return r+o.replace(/(^.{73}|.{75}(?!\r?\n|\r))/g,"$&\r\n ").trim()},Tm.exports.relaxedHeaders=Pm;const Rm=Am,Lm=Fm,Nm=Tm.exports,Hm=B.default.PassThrough,$m=D.default,Um=w.default,qm=E.default;class Mm{constructor(e,t,i,n){this.options=e||{},this.keys=t,this.cacheTreshold=Number(this.options.cacheTreshold)||131072,this.hashAlgo=this.options.hashAlgo||"sha256",this.cacheDir=this.options.cacheDir||!1,this.chunks=[],this.chunklen=0,this.readPos=0,this.cachePath=!!this.cacheDir&&Um.join(this.cacheDir,"message."+Date.now()+"-"+qm.randomBytes(14).toString("hex")),this.cache=!1,this.headers=!1,this.bodyHash=!1,this.parser=!1,this.relaxedBody=!1,this.input=i,this.output=n,this.output.usingCache=!1,this.hasErrored=!1,this.input.on("error",(e=>{this.hasErrored=!0,this.cleanup(),n.emit("error",e)}))}cleanup(){this.cache&&this.cachePath&&$m.unlink(this.cachePath,(()=>!1))}createReadCache(){this.cache=$m.createReadStream(this.cachePath),this.cache.once("error",(e=>{this.cleanup(),this.output.emit("error",e)})),this.cache.once("close",(()=>{this.cleanup()})),this.cache.pipe(this.output)}sendNextChunk(){if(this.hasErrored)return;if(this.readPos>=this.chunks.length)return this.cache?this.createReadCache():this.output.end();let e=this.chunks[this.readPos++];if(!1===this.output.write(e))return this.output.once("drain",(()=>{this.sendNextChunk()}));setImmediate((()=>this.sendNextChunk()))}sendSignedOutput(){let e=0,t=()=>{if(e>=this.keys.length)return this.output.write(this.parser.rawHeaders),setImmediate((()=>this.sendNextChunk()));let i=this.keys[e++],n=Nm(this.headers,this.hashAlgo,this.bodyHash,{domainName:i.domainName,keySelector:i.keySelector,privateKey:i.privateKey,headerFieldNames:this.options.headerFieldNames,skipFields:this.options.skipFields});return n&&this.output.write(Buffer.from(n+"\r\n")),setImmediate(t)};if(this.bodyHash&&this.headers)return t();this.output.write(this.parser.rawHeaders),this.sendNextChunk()}createWriteCache(){this.output.usingCache=!0,this.cache=$m.createWriteStream(this.cachePath),this.cache.once("error",(e=>{this.cleanup(),this.relaxedBody.unpipe(this.cache),this.relaxedBody.on("readable",(()=>{for(;null!==this.relaxedBody.read(););})),this.hasErrored=!0,this.output.emit("error",e)})),this.cache.once("close",(()=>{this.sendSignedOutput()})),this.relaxedBody.removeAllListeners("readable"),this.relaxedBody.pipe(this.cache)}signStream(){this.parser=new Rm,this.relaxedBody=new Lm({hashAlgo:this.hashAlgo}),this.parser.on("headers",(e=>{this.headers=e})),this.relaxedBody.on("hash",(e=>{this.bodyHash=e})),this.relaxedBody.on("readable",(()=>{let e;if(!this.cache)for(;null!==(e=this.relaxedBody.read());)if(this.chunks.push(e),this.chunklen+=e.length,this.chunklen>=this.cacheTreshold&&this.cachePath)return this.createWriteCache()})),this.relaxedBody.on("end",(()=>{this.cache||this.sendSignedOutput()})),this.parser.pipe(this.relaxedBody),setImmediate((()=>this.input.pipe(this.parser)))}}var zm=class{constructor(e){this.options=e||{},this.keys=[].concat(this.options.keys||{domainName:e.domainName,keySelector:e.keySelector,privateKey:e.privateKey})}sign(e,t){let i=new Hm,n=e,s=!1;Buffer.isBuffer(e)?(s=e,n=new Hm):"string"==typeof e&&(s=Buffer.from(e),n=new Hm);let o=this.options;t&&Object.keys(t).length&&(o={},Object.keys(this.options||{}).forEach((e=>{o[e]=this.options[e]})),Object.keys(t||{}).forEach((e=>{e in o||(o[e]=t[e])})));let a=new Mm(o,this.keys,n,i);return setImmediate((()=>{a.signStream(),s&&setImmediate((()=>{n.end(s)}))})),i}};const Gm=I.default,Vm=R.default,Wm=k.default;var Km=function(e,t,i,n){let s,o,a,r=Wm.parse(e);s={host:r.hostname,port:Number(r.port)?Number(r.port):"https:"===r.protocol?443:80},"https:"===r.protocol?(s.rejectUnauthorized=!1,o=Vm.connect.bind(Vm)):o=Gm.connect.bind(Gm);let c=!1,p=function(e){if(!c){c=!0;try{a.destroy()}catch(e){}n(e)}};a=o(s,(()=>{if(c)return;let e={Host:i+":"+t,Connection:"close"};r.auth&&(e["Proxy-Authorization"]="Basic "+Buffer.from(r.auth).toString("base64")),a.write("CONNECT "+i+":"+t+" HTTP/1.1\r\n"+Object.keys(e).map((t=>t+": "+e[t])).join("\r\n")+"\r\n\r\n");let s="",o=e=>{let t,i;if(!c&&(s+=e.toString("binary"),t=s.match(/\r\n\r\n/))){if(a.removeListener("data",o),i=s.substr(t.index+t[0].length),s=s.substr(0,t.index),i&&a.unshift(Buffer.from(i,"binary")),c=!0,t=s.match(/^HTTP\/\d+\.\d+ (\d+)/i),!t||"2"!==(t[1]||"").charAt(0)){try{a.destroy()}catch(e){}return n(new Error("Invalid response from proxy"+(t&&": "+t[1]||"")))}return a.removeListener("error",p),n(null,a)}};a.on("data",o)})),a.once("error",p)};const Jm=wh.exports,Qm=wm,Xm=Qh;var Ym=class{constructor(e,t){this.mailer=e,this.data={},this.message=null,t=t||{};let i=e.options||{},n=e._defaults||{};Object.keys(t).forEach((e=>{this.data[e]=t[e]})),this.data.headers=this.data.headers||{},Object.keys(n).forEach((e=>{e in this.data?"headers"===e&&Object.keys(n.headers).forEach((e=>{e in this.data.headers||(this.data.headers[e]=n.headers[e])})):this.data[e]=n[e]})),["disableFileAccess","disableUrlAccess","normalizeHeaderKey"].forEach((e=>{e in i&&(this.data[e]=i[e])}))}resolveContent(...e){return Jm.resolveContent(...e)}resolveAll(e){let t=[[this.data,"html"],[this.data,"text"],[this.data,"watchHtml"],[this.data,"amp"],[this.data,"icalEvent"]];this.data.alternatives&&this.data.alternatives.length&&this.data.alternatives.forEach(((e,i)=>{t.push([this.data.alternatives,i])})),this.data.attachments&&this.data.attachments.length&&this.data.attachments.forEach(((e,i)=>{e.filename||(e.filename=(e.path||e.href||"").split("/").pop().split("?").shift()||"attachment-"+(i+1),e.filename.indexOf(".")<0&&(e.filename+="."+Xm.detectExtension(e.contentType))),e.contentType||(e.contentType=Xm.detectMimeType(e.filename||e.path||e.href||"bin")),t.push([this.data.attachments,i])}));let i=new Qm;["from","to","cc","bcc","sender","replyTo"].forEach((e=>{let t;this.message?t=[].concat(i._parseAddresses(this.message.getHeader("replyTo"===e?"reply-to":e))||[]):this.data[e]&&(t=[].concat(i._parseAddresses(this.data[e])||[])),t&&t.length?this.data[e]=t:e in this.data&&(this.data[e]=null)}));["from","sender","replyTo"].forEach((e=>{this.data[e]&&(this.data[e]=this.data[e].shift())}));let n=0,s=()=>{if(n>=t.length)return e(null,this.data);let i=t[n++];if(!i[0]||!i[0][i[1]])return s();Jm.resolveContent(...i,((t,n)=>{if(t)return e(t);let o={content:n};i[0][i[1]]&&"object"==typeof i[0][i[1]]&&!Buffer.isBuffer(i[0][i[1]])&&Object.keys(i[0][i[1]]).forEach((e=>{e in o||["content","path","href","raw"].includes(e)||(o[e]=i[0][i[1]][e])})),i[0][i[1]]=o,s()}))};setImmediate((()=>s()))}normalize(e){let t=this.data.envelope||this.message.getEnvelope(),i=this.message.messageId();this.resolveAll(((n,s)=>{if(n)return e(n);if(s.envelope=t,s.messageId=i,["html","text","watchHtml","amp"].forEach((e=>{s[e]&&s[e].content&&("string"==typeof s[e].content?s[e]=s[e].content:Buffer.isBuffer(s[e].content)&&(s[e]=s[e].content.toString()))})),s.icalEvent&&Buffer.isBuffer(s.icalEvent.content)&&(s.icalEvent.content=s.icalEvent.content.toString("base64"),s.icalEvent.encoding="base64"),s.alternatives&&s.alternatives.length&&s.alternatives.forEach((e=>{e&&e.content&&Buffer.isBuffer(e.content)&&(e.content=e.content.toString("base64"),e.encoding="base64")})),s.attachments&&s.attachments.length&&s.attachments.forEach((e=>{e&&e.content&&Buffer.isBuffer(e.content)&&(e.content=e.content.toString("base64"),e.encoding="base64")})),s.normalizedHeaders={},Object.keys(s.headers||{}).forEach((e=>{let t=[].concat(s.headers[e]||[]).shift();t=t&&t.value||t,t&&(["references","in-reply-to","message-id","content-id"].includes(e)&&(t=this.message._encodeHeaderValue(e,t)),s.normalizedHeaders[e]=t)})),s.list&&"object"==typeof s.list){this._getListHeaders(s.list).forEach((e=>{s.normalizedHeaders[e.key]=e.value.map((e=>e&&e.value||e)).join(", ")}))}return s.references&&(s.normalizedHeaders.references=this.message._encodeHeaderValue("references",s.references)),s.inReplyTo&&(s.normalizedHeaders["in-reply-to"]=this.message._encodeHeaderValue("in-reply-to",s.inReplyTo)),e(null,s)}))}setMailerHeader(){this.message&&this.data.xMailer&&this.message.setHeader("X-Mailer",this.data.xMailer)}setPriorityHeaders(){if(this.message&&this.data.priority)switch((this.data.priority||"").toString().toLowerCase()){case"high":this.message.setHeader("X-Priority","1 (Highest)"),this.message.setHeader("X-MSMail-Priority","High"),this.message.setHeader("Importance","High");break;case"low":this.message.setHeader("X-Priority","5 (Lowest)"),this.message.setHeader("X-MSMail-Priority","Low"),this.message.setHeader("Importance","Low")}}setListHeaders(){this.message&&this.data.list&&"object"==typeof this.data.list&&this.data.list&&"object"==typeof this.data.list&&this._getListHeaders(this.data.list).forEach((e=>{e.value.forEach((t=>{this.message.addHeader(e.key,t)}))}))}_getListHeaders(e){return Object.keys(e).map((t=>({key:"list-"+t.toLowerCase().trim(),value:[].concat(e[t]||[]).map((e=>({prepared:!0,foldLines:!0,value:[].concat(e||[]).map((e=>{if("string"==typeof e&&(e={url:e}),e&&e.url){if("id"===t.toLowerCase().trim()){let t=e.comment||"";return t=Xm.isPlainText(t)?'"'+t+'"':Xm.encodeWord(t),(e.comment?t+" ":"")+this._formatListUrl(e.url).replace(/^<[^:]+\/{,2}/,"")}let i=e.comment||"";return Xm.isPlainText(i)||(i=Xm.encodeWord(i)),this._formatListUrl(e.url)+(e.comment?" ("+i+")":"")}return""})).filter((e=>e)).join(", ")})))})))}_formatListUrl(e){return e=e.replace(/[\s<]+|[\s>]+/g,""),/^(https?|mailto|ftp):/.test(e)?"<"+e+">":/^[^@]+@[^@]+$/.test(e)?"<mailto:"+e+">":"<http://"+e+">"}};const Zm=A.default,ef=wh.exports,tf=Lh,nf=Em,sf=zm,of=Km,af=S.default,rf=k.default,cf=Ch,pf=Ym,uf=I.default,lf=O.default,df=E.default;var hf=class extends Zm{constructor(e,t,i){super(),this.options=t||{},this._defaults=i||{},this._defaultPlugins={compile:[(...e)=>this._convertDataImages(...e)],stream:[]},this._userPlugins={compile:[],stream:[]},this.meta=new Map,this.dkim=!!this.options.dkim&&new sf(this.options.dkim),this.transporter=e,this.transporter.mailer=this,this.logger=ef.getLogger(this.options,{component:this.options.component||"mail"}),this.logger.debug({tnx:"create"},"Creating transport: %s",this.getVersionString()),"function"==typeof this.transporter.on&&(this.transporter.on("log",(e=>{this.logger.debug({tnx:"transport"},"%s: %s",e.type,e.message)})),this.transporter.on("error",(e=>{this.logger.error({err:e,tnx:"transport"},"Transport Error: %s",e.message),this.emit("error",e)})),this.transporter.on("idle",((...e)=>{this.emit("idle",...e)}))),["close","isIdle","verify"].forEach((e=>{this[e]=(...t)=>"function"==typeof this.transporter[e]?("verify"===e&&"function"==typeof this.getSocket&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1),this.transporter[e](...t)):(this.logger.warn({tnx:"transport",methodName:e},"Non existing method %s called for transport",e),!1)})),this.options.proxy&&"string"==typeof this.options.proxy&&this.setupProxy(this.options.proxy)}use(e,t){return e=(e||"").toString(),this._userPlugins.hasOwnProperty(e)?this._userPlugins[e].push(t):this._userPlugins[e]=[t],this}sendMail(e,t){let i;t||(i=new Promise(((e,i)=>{t=ef.callbackPromise(e,i)}))),"function"==typeof this.getSocket&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1);let n=new pf(this,e);return this.logger.debug({tnx:"transport",name:this.transporter.name,version:this.transporter.version,action:"send"},"Sending mail using %s/%s",this.transporter.name,this.transporter.version),this._processPlugins("compile",n,(e=>{if(e)return this.logger.error({err:e,tnx:"plugin",action:"compile"},"PluginCompile Error: %s",e.message),t(e);n.message=new nf(n.data).compile(),n.setMailerHeader(),n.setPriorityHeaders(),n.setListHeaders(),this._processPlugins("stream",n,(e=>{if(e)return this.logger.error({err:e,tnx:"plugin",action:"stream"},"PluginStream Error: %s",e.message),t(e);(n.data.dkim||this.dkim)&&n.message.processFunc((e=>{let t=n.data.dkim?new sf(n.data.dkim):this.dkim;return this.logger.debug({tnx:"DKIM",messageId:n.message.messageId(),dkimDomains:t.keys.map((e=>e.keySelector+"."+e.domainName)).join(", ")},"Signing outgoing message with %s keys",t.keys.length),t.sign(e,n.data._dkim)})),this.transporter.send(n,((...e)=>{e[0]&&this.logger.error({err:e[0],tnx:"transport",action:"send"},"Send Error: %s",e[0].message),t(...e)}))}))})),i}getVersionString(){return af.format("%s (%s; +%s; %s/%s)",cf.name,cf.version,cf.homepage,this.transporter.name,this.transporter.version)}_processPlugins(e,t,i){if(e=(e||"").toString(),!this._userPlugins.hasOwnProperty(e))return i();let n=this._userPlugins[e]||[],s=this._defaultPlugins[e]||[];if(n.length&&this.logger.debug({tnx:"transaction",pluginCount:n.length,step:e},"Using %s plugins for %s",n.length,e),n.length+s.length===0)return i();let o=0,a="default",r=()=>{let e="default"===a?s:n;if(o>=e.length){if("default"!==a||!n.length)return i();a="user",o=0,e=n}(0,e[o++])(t,(e=>{if(e)return i(e);r()}))};r()}setupProxy(e){let t=rf.parse(e);this.getSocket=(e,i)=>{let n=t.protocol.replace(/:$/,"").toLowerCase();if(this.meta.has("proxy_handler_"+n))return this.meta.get("proxy_handler_"+n)(t,e,i);switch(n){case"http":case"https":return void of(t.href,e.port,e.host,((e,t)=>e?i(e):i(null,{connection:t})));case"socks":case"socks5":case"socks4":case"socks4a":{if(!this.meta.has("proxy_socks_module"))return i(new Error("Socks module not loaded"));let n=n=>{let s=!!this.meta.get("proxy_socks_module").SocksClient,o=s?this.meta.get("proxy_socks_module").SocksClient:this.meta.get("proxy_socks_module"),a=Number(t.protocol.replace(/\D/g,""))||5,r={proxy:{ipaddress:n,port:Number(t.port),type:a},[s?"destination":"target"]:{host:e.host,port:e.port},command:"connect"};if(t.auth){let e=decodeURIComponent(t.auth.split(":").shift()),i=decodeURIComponent(t.auth.split(":").pop());s?(r.proxy.userId=e,r.proxy.password=i):4===a?r.userid=e:r.authentication={username:e,password:i}}o.createConnection(r,((e,t)=>e?i(e):i(null,{connection:t.socket||t})))};return uf.isIP(t.hostname)?n(t.hostname):lf.resolve(t.hostname,((e,t)=>{if(e)return i(e);n(Array.isArray(t)?t[0]:t)}))}}i(new Error("Unknown proxy configuration"))}}_convertDataImages(e,t){if(!this.options.attachDataUrls&&!e.data.attachDataUrls||!e.data.html)return t();e.resolveContent(e.data,"html",((i,n)=>{if(i)return t(i);let s=0;n=(n||"").toString().replace(/(<img\b[^>]* src\s*=[\s"']*)(data:([^;]+);[^"'>\s]+)/gi,((t,i,n,o)=>{let a=df.randomBytes(10).toString("hex")+"@localhost";return e.data.attachments||(e.data.attachments=[]),Array.isArray(e.data.attachments)||(e.data.attachments=[].concat(e.data.attachments||[])),e.data.attachments.push({path:n,cid:a,filename:"image-"+ ++s+"."+tf.detectExtension(o)}),i+"cid:"+a})),e.data.html=n,t()}))}set(e,t){return this.meta.set(e,t)}get(e){return this.meta.get(e)}};const mf=B.default.Transform;var ff=class extends mf{constructor(e){super(e),this.options=e||{},this._curLine="",this.inByteCount=0,this.outByteCount=0,this.lastByte=!1}_transform(e,t,i){let n,s,o,a=[],r=0,c=0;if(!e||!e.length)return i();for("string"==typeof e&&(e=Buffer.from(e)),this.inByteCount+=e.length,n=0,s=e.length;n<s;n++)46===e[n]?(n&&10===e[n-1]||!n&&(!this.lastByte||10===this.lastByte))&&(o=e.slice(c,n+1),a.push(o),a.push(Buffer.from(".")),r+=o.length+1,c=n+1):10===e[n]&&(n&&13!==e[n-1]||!n&&13!==this.lastByte)&&(n>c?(o=e.slice(c,n),a.push(o),r+=o.length+2):r+=2,a.push(Buffer.from("\r\n")),c=n+1);r?(c<e.length&&(o=e.slice(c),a.push(o),r+=o.length),this.outByteCount+=r,this.push(Buffer.concat(a,r))):(this.outByteCount+=e.length,this.push(e)),this.lastByte=e[e.length-1],i()}_flush(e){let t;t=10===this.lastByte?Buffer.from(".\r\n"):13===this.lastByte?Buffer.from("\n.\r\n"):Buffer.from("\r\n.\r\n"),this.outByteCount+=t.length,this.push(t),e()}};const gf=Ch,vf=A.default.EventEmitter,xf=I.default,yf=R.default,bf=P.default,wf=E.default,_f=ff,Df=B.default.PassThrough,Ef=wh.exports;var Cf=class extends vf{constructor(e){super(e),this.id=wf.randomBytes(8).toString("base64").replace(/\W/g,""),this.stage="init",this.options=e||{},this.secureConnection=!!this.options.secure,this.alreadySecured=!!this.options.secured,this.port=Number(this.options.port)||(this.secureConnection?465:587),this.host=this.options.host||"localhost",void 0===this.options.secure&&465===this.port&&(this.secureConnection=!0),this.name=this.options.name||this._getHostname(),this.logger=Ef.getLogger(this.options,{component:this.options.component||"smtp-connection",sid:this.id}),this.customAuth=new Map,Object.keys(this.options.customAuth||{}).forEach((e=>{let t=(e||"").toString().trim().toUpperCase();t&&this.customAuth.set(t,this.options.customAuth[e])})),this.version=gf.version,this.authenticated=!1,this.destroyed=!1,this.secure=!!this.secureConnection,this._remainder="",this._responseQueue=[],this.lastServerResponse=!1,this._socket=!1,this._supportedAuth=[],this.allowsAuth=!1,this._envelope=!1,this._supportedExtensions=[],this._maxAllowedSize=0,this._responseActions=[],this._recipientQueue=[],this._greetingTimeout=!1,this._connectionTimeout=!1,this._destroyed=!1,this._closing=!1,this._onSocketData=e=>this._onData(e),this._onSocketError=e=>this._onError(e,"ESOCKET",!1,"CONN"),this._onSocketClose=()=>this._onClose(),this._onSocketEnd=()=>this._onEnd(),this._onSocketTimeout=()=>this._onTimeout()}connect(e){if("function"==typeof e){this.once("connect",(()=>{this.logger.debug({tnx:"smtp"},"SMTP handshake finished"),e()}));const t=this._isDestroyedMessage("connect");if(t)return e(this._formatError(t,"ECONNECTION",!1,"CONN"))}let t={port:this.port,host:this.host};this.options.localAddress&&(t.localAddress=this.options.localAddress);let i=()=>{this._connectionTimeout=setTimeout((()=>{this._onError("Connection timeout","ETIMEDOUT",!1,"CONN")}),this.options.connectionTimeout||12e4),this._socket.on("error",this._onSocketError)};return this.options.connection?(this._socket=this.options.connection,void(this.secureConnection&&!this.alreadySecured?setImmediate((()=>this._upgradeConnection((e=>{e?this._onError(new Error("Error initiating TLS - "+(e.message||e)),"ETLS",!1,"CONN"):this._onConnect()})))):setImmediate((()=>this._onConnect())))):this.options.socket?(this._socket=this.options.socket,Ef.resolveHostname(t,((e,n)=>{if(e)return setImmediate((()=>this._onError(e,"EDNS",!1,"CONN")));this.logger.debug({tnx:"dns",source:t.host,resolved:n.host,cached:!!n.cached},"Resolved %s as %s [cache %s]",t.host,n.host,n.cached?"hit":"miss"),Object.keys(n).forEach((e=>{"_"!==e.charAt(0)&&n[e]&&(t[e]=n[e])}));try{this._socket.connect(this.port,this.host,(()=>{this._socket.setKeepAlive(!0),this._onConnect()})),i()}catch(e){return setImmediate((()=>this._onError(e,"ECONNECTION",!1,"CONN")))}}))):this.secureConnection?(this.options.tls&&Object.keys(this.options.tls).forEach((e=>{t[e]=this.options.tls[e]})),Ef.resolveHostname(t,((e,n)=>{if(e)return setImmediate((()=>this._onError(e,"EDNS",!1,"CONN")));this.logger.debug({tnx:"dns",source:t.host,resolved:n.host,cached:!!n.cached},"Resolved %s as %s [cache %s]",t.host,n.host,n.cached?"hit":"miss"),Object.keys(n).forEach((e=>{"_"!==e.charAt(0)&&n[e]&&(t[e]=n[e])}));try{this._socket=yf.connect(t,(()=>{this._socket.setKeepAlive(!0),this._onConnect()})),i()}catch(e){return setImmediate((()=>this._onError(e,"ECONNECTION",!1,"CONN")))}}))):Ef.resolveHostname(t,((e,n)=>{if(e)return setImmediate((()=>this._onError(e,"EDNS",!1,"CONN")));this.logger.debug({tnx:"dns",source:t.host,resolved:n.host,cached:!!n.cached},"Resolved %s as %s [cache %s]",t.host,n.host,n.cached?"hit":"miss"),Object.keys(n).forEach((e=>{"_"!==e.charAt(0)&&n[e]&&(t[e]=n[e])}));try{this._socket=xf.connect(t,(()=>{this._socket.setKeepAlive(!0),this._onConnect()})),i()}catch(e){return setImmediate((()=>this._onError(e,"ECONNECTION",!1,"CONN")))}}))}quit(){this._sendCommand("QUIT"),this._responseActions.push(this.close)}close(){if(clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._responseActions=[],this._closing)return;this._closing=!0;let e="end";"init"===this.stage&&(e="destroy"),this.logger.debug({tnx:"smtp"},'Closing connection to the server using "%s"',e);let t=this._socket&&this._socket.socket||this._socket;if(t&&!t.destroyed)try{this._socket[e]()}catch(e){}this._destroy()}login(e,t){const i=this._isDestroyedMessage("login");if(i)return t(this._formatError(i,"ECONNECTION",!1,"API"));if(this._auth=e||{},this._authMethod=(this._auth.method||"").toString().trim().toUpperCase()||!1,this._authMethod||!this._auth.oauth2||this._auth.credentials?this._authMethod&&("XOAUTH2"!==this._authMethod||this._auth.oauth2)||(this._authMethod=(this._supportedAuth[0]||"PLAIN").toUpperCase().trim()):this._authMethod="XOAUTH2",!("XOAUTH2"===this._authMethod||this._auth.credentials&&this._auth.credentials.user&&this._auth.credentials.pass)){if(!this._auth.user||!this._auth.pass)return t(this._formatError('Missing credentials for "'+this._authMethod+'"',"EAUTH",!1,"API"));this._auth.credentials={user:this._auth.user,pass:this._auth.pass,options:this._auth.options}}if(!this.customAuth.has(this._authMethod)){switch(this._authMethod){case"XOAUTH2":return void this._handleXOauth2Token(!1,t);case"LOGIN":return this._responseActions.push((e=>{this._actionAUTH_LOGIN_USER(e,t)})),void this._sendCommand("AUTH LOGIN");case"PLAIN":return this._responseActions.push((e=>{this._actionAUTHComplete(e,t)})),void this._sendCommand("AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0"+this._auth.credentials.pass,"utf-8").toString("base64"),"AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0/* secret */","utf-8").toString("base64"));case"CRAM-MD5":return this._responseActions.push((e=>{this._actionAUTH_CRAM_MD5(e,t)})),void this._sendCommand("AUTH CRAM-MD5")}return t(this._formatError('Unknown authentication method "'+this._authMethod+'"',"EAUTH",!1,"API"))}{let e,i=this.customAuth.get(this._authMethod),n=!1,s=()=>{n||(n=!0,this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,t(null,!0))},o=i=>{n||(n=!0,t(this._formatError(i,"EAUTH",e,"AUTH "+this._authMethod)))},a=i({auth:this._auth,method:this._authMethod,extensions:[].concat(this._supportedExtensions),authMethods:[].concat(this._supportedAuth),maxAllowedSize:this._maxAllowedSize||!1,sendCommand:(t,i)=>{let n;return i||(n=new Promise(((e,t)=>{i=Ef.callbackPromise(e,t)}))),this._responseActions.push((n=>{e=n;let s=n.match(/^(\d+)(?:\s(\d+\.\d+\.\d+))?\s/),o={command:t,response:n};s?(o.status=Number(s[1])||0,s[2]&&(o.code=s[2]),o.text=n.substr(s[0].length)):(o.text=n,o.status=0),i(null,o)})),setImmediate((()=>this._sendCommand(t))),n},resolve:s,reject:o});a&&"function"==typeof a.catch&&a.then(s).catch(o)}}send(e,t,i){if(!t)return i(this._formatError("Empty message","EMESSAGE",!1,"API"));const n=this._isDestroyedMessage("send message");if(n)return i(this._formatError(n,"ECONNECTION",!1,"API"));if(this._maxAllowedSize&&e.size>this._maxAllowedSize)return setImmediate((()=>{i(this._formatError("Message size larger than allowed "+this._maxAllowedSize,"EMESSAGE",!1,"MAIL FROM"))}));let s=!1,o=function(){s||(s=!0,i(...arguments))};"function"==typeof t.on&&t.on("error",(e=>o(this._formatError(e,"ESTREAM",!1,"API"))));let a=Date.now();this._setEnvelope(e,((e,i)=>{if(e)return o(e);let n=Date.now(),s=this._createSendStream(((e,t)=>e?o(e):(i.envelopeTime=n-a,i.messageTime=Date.now()-n,i.messageSize=s.outByteCount,i.response=t,o(null,i))));"function"==typeof t.pipe?t.pipe(s):(s.write(t),s.end())}))}reset(e){this._sendCommand("RSET"),this._responseActions.push((t=>"2"!==t.charAt(0)?e(this._formatError("Could not reset session state. response="+t,"EPROTOCOL",t,"RSET")):(this._envelope=!1,e(null,!0))))}_onConnect(){clearTimeout(this._connectionTimeout),this.logger.info({tnx:"network",localAddress:this._socket.localAddress,localPort:this._socket.localPort,remoteAddress:this._socket.remoteAddress,remotePort:this._socket.remotePort},"%s established to %s:%s",this.secure?"Secure connection":"Connection",this._socket.remoteAddress,this._socket.remotePort),this._destroyed?this.close():(this.stage="connected",this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout),this._socket.removeListener("close",this._onSocketClose),this._socket.removeListener("end",this._onSocketEnd),this._socket.on("data",this._onSocketData),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||6e5),this._socket.on("timeout",this._onSocketTimeout),this._greetingTimeout=setTimeout((()=>{this._socket&&!this._destroyed&&this._responseActions[0]===this._actionGreeting&&this._onError("Greeting never received","ETIMEDOUT",!1,"CONN")}),this.options.greetingTimeout||3e4),this._responseActions.push(this._actionGreeting),this._socket.resume())}_onData(e){if(this._destroyed||!e||!e.length)return;let t,i=(e||"").toString("binary"),n=(this._remainder+i).split(/\r?\n/);this._remainder=n.pop();for(let e=0,i=n.length;e<i;e++)this._responseQueue.length&&(t=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(t.split("\n").pop()))?this._responseQueue[this._responseQueue.length-1]+="\n"+n[e]:this._responseQueue.push(n[e]);this._responseQueue.length&&(t=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(t.split("\n").pop()))||this._processResponse()}_onError(e,t,i,n){clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._destroyed||(e=this._formatError(e,t,i,n),this.logger.error(i,e.message),this.emit("error",e),this.close())}_formatError(e,t,i,n){let s;s=/Error\]$/i.test(Object.prototype.toString.call(e))?e:new Error(e),t&&"Error"!==t&&(s.code=t),i&&(s.response=i,s.message+=": "+i);let o="string"==typeof i&&Number((i.match(/^\d+/)||[])[0])||!1;return o&&(s.responseCode=o),n&&(s.command=n),s}_onClose(){return this.logger.info({tnx:"network"},"Connection closed"),this.upgrading&&!this._destroyed?this._onError(new Error("Connection closed unexpectedly"),"ETLS",!1,"CONN"):[this._actionGreeting,this.close].includes(this._responseActions[0])||this._destroyed?void this._destroy():this._onError(new Error("Connection closed unexpectedly"),"ECONNECTION",!1,"CONN")}_onEnd(){this._socket&&!this._socket.destroyed&&this._socket.destroy()}_onTimeout(){return this._onError(new Error("Timeout"),"ETIMEDOUT",!1,"CONN")}_destroy(){this._destroyed||(this._destroyed=!0,this.emit("end"))}_upgradeConnection(e){this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout);let t=this._socket,i={socket:this._socket,host:this.host};Object.keys(this.options.tls||{}).forEach((e=>{i[e]=this.options.tls[e]})),this.upgrading=!0;try{this._socket=yf.connect(i,(()=>(this.secure=!0,this.upgrading=!1,this._socket.on("data",this._onSocketData),t.removeListener("close",this._onSocketClose),t.removeListener("end",this._onSocketEnd),e(null,!0))))}catch(t){return e(t)}this._socket.on("error",this._onSocketError),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||6e5),this._socket.on("timeout",this._onSocketTimeout),t.resume()}_processResponse(){if(!this._responseQueue.length)return!1;let e=this.lastServerResponse=(this._responseQueue.shift()||"").toString();if(/^\d+-/.test(e.split("\n").pop()))return;(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"server"},e.replace(/\r?\n$/,"")),e.trim()||setImmediate((()=>this._processResponse(!0)));let t=this._responseActions.shift();if("function"!=typeof t)return this._onError(new Error("Unexpected Response"),"EPROTOCOL",e,"CONN");t.call(this,e),setImmediate((()=>this._processResponse(!0)))}_sendCommand(e,t){if(!this._destroyed){if(this._socket.destroyed)return this.close();(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"client"},(t||e||"").toString().replace(/\r?\n$/,"")),this._socket.write(Buffer.from(e+"\r\n","utf-8"))}}_setEnvelope(e,t){let i=[],n=!1;if(this._envelope=e||{},this._envelope.from=(this._envelope.from&&this._envelope.from.address||this._envelope.from||"").toString().trim(),this._envelope.to=[].concat(this._envelope.to||[]).map((e=>(e&&e.address||e||"").toString().trim())),!this._envelope.to.length)return t(this._formatError("No recipients defined","EENVELOPE",!1,"API"));if(this._envelope.from&&/[\r\n<>]/.test(this._envelope.from))return t(this._formatError("Invalid sender "+JSON.stringify(this._envelope.from),"EENVELOPE",!1,"API"));/[\x80-\uFFFF]/.test(this._envelope.from)&&(n=!0);for(let e=0,i=this._envelope.to.length;e<i;e++){if(!this._envelope.to[e]||/[\r\n<>]/.test(this._envelope.to[e]))return t(this._formatError("Invalid recipient "+JSON.stringify(this._envelope.to[e]),"EENVELOPE",!1,"API"));/[\x80-\uFFFF]/.test(this._envelope.to[e])&&(n=!0)}if(this._envelope.rcptQueue=JSON.parse(JSON.stringify(this._envelope.to||[])),this._envelope.rejected=[],this._envelope.rejectedErrors=[],this._envelope.accepted=[],this._envelope.dsn)try{this._envelope.dsn=this._setDsnEnvelope(this._envelope.dsn)}catch(e){return t(this._formatError("Invalid DSN "+e.message,"EENVELOPE",!1,"API"))}this._responseActions.push((e=>{this._actionMAIL(e,t)})),n&&this._supportedExtensions.includes("SMTPUTF8")&&(i.push("SMTPUTF8"),this._usingSmtpUtf8=!0),this._envelope.use8BitMime&&this._supportedExtensions.includes("8BITMIME")&&(i.push("BODY=8BITMIME"),this._using8BitMime=!0),this._envelope.size&&this._supportedExtensions.includes("SIZE")&&i.push("SIZE="+this._envelope.size),this._envelope.dsn&&this._supportedExtensions.includes("DSN")&&(this._envelope.dsn.ret&&i.push("RET="+Ef.encodeXText(this._envelope.dsn.ret)),this._envelope.dsn.envid&&i.push("ENVID="+Ef.encodeXText(this._envelope.dsn.envid))),this._sendCommand("MAIL FROM:<"+this._envelope.from+">"+(i.length?" "+i.join(" "):""))}_setDsnEnvelope(e){let t=(e.ret||e.return||"").toString().toUpperCase()||null;if(t)switch(t){case"HDRS":case"HEADERS":t="HDRS";break;case"FULL":case"BODY":t="FULL"}if(t&&!["FULL","HDRS"].includes(t))throw new Error("ret: "+JSON.stringify(t));let i=(e.envid||e.id||"").toString()||null,n=e.notify||null;if(n){"string"==typeof n&&(n=n.split(",")),n=n.map((e=>e.trim().toUpperCase()));let e=["NEVER","SUCCESS","FAILURE","DELAY"];if(n.filter((t=>!e.includes(t))).length||n.length>1&&n.includes("NEVER"))throw new Error("notify: "+JSON.stringify(n.join(",")));n=n.join(",")}let s=(e.recipient||e.orcpt||"").toString()||null;return s&&s.indexOf(";")<0&&(s="rfc822;"+s),{ret:t,envid:i,notify:n,orcpt:s}}_getDsnRcptToArgs(){let e=[];return this._envelope.dsn&&this._supportedExtensions.includes("DSN")&&(this._envelope.dsn.notify&&e.push("NOTIFY="+Ef.encodeXText(this._envelope.dsn.notify)),this._envelope.dsn.orcpt&&e.push("ORCPT="+Ef.encodeXText(this._envelope.dsn.orcpt))),e.length?" "+e.join(" "):""}_createSendStream(e){let t,i=new _f;return this.options.lmtp?this._envelope.accepted.forEach(((t,i)=>{let n=i===this._envelope.accepted.length-1;this._responseActions.push((i=>{this._actionLMTPStream(t,n,i,e)}))})):this._responseActions.push((t=>{this._actionSMTPStream(t,e)})),i.pipe(this._socket,{end:!1}),this.options.debug&&(t=new Df,t.on("readable",(()=>{let e;for(;e=t.read();)this.logger.debug({tnx:"message"},e.toString("binary").replace(/\r?\n$/,""))})),i.pipe(t)),i.once("end",(()=>{this.logger.info({tnx:"message",inByteCount:i.inByteCount,outByteCount:i.outByteCount},"<%s bytes encoded mime message (source size %s bytes)>",i.outByteCount,i.inByteCount)})),i}_actionGreeting(e){clearTimeout(this._greetingTimeout),"220"===e.substr(0,3)?this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name)):this._onError(new Error("Invalid greeting. response="+e),"EPROTOCOL",e,"CONN")}_actionLHLO(e){"2"===e.charAt(0)?this._actionEHLO(e):this._onError(new Error("Invalid LHLO. response="+e),"EPROTOCOL",e,"LHLO")}_actionEHLO(e){let t;if("421"!==e.substr(0,3)){if("2"!==e.charAt(0))return this.options.requireTLS?void this._onError(new Error("EHLO failed but HELO does not support required STARTTLS. response="+e),"ECONNECTION",e,"EHLO"):(this._responseActions.push(this._actionHELO),void this._sendCommand("HELO "+this.name));if(!this.secure&&!this.options.ignoreTLS&&(/[ -]STARTTLS\b/im.test(e)||this.options.requireTLS))return this._sendCommand("STARTTLS"),void this._responseActions.push(this._actionSTARTTLS);/[ -]SMTPUTF8\b/im.test(e)&&this._supportedExtensions.push("SMTPUTF8"),/[ -]DSN\b/im.test(e)&&this._supportedExtensions.push("DSN"),/[ -]8BITMIME\b/im.test(e)&&this._supportedExtensions.push("8BITMIME"),/[ -]PIPELINING\b/im.test(e)&&this._supportedExtensions.push("PIPELINING"),/[ -]AUTH\b/i.test(e)&&(this.allowsAuth=!0),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)PLAIN/i.test(e)&&this._supportedAuth.push("PLAIN"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)LOGIN/i.test(e)&&this._supportedAuth.push("LOGIN"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)CRAM-MD5/i.test(e)&&this._supportedAuth.push("CRAM-MD5"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)XOAUTH2/i.test(e)&&this._supportedAuth.push("XOAUTH2"),(t=e.match(/[ -]SIZE(?:[ \t]+(\d+))?/im))&&(this._supportedExtensions.push("SIZE"),this._maxAllowedSize=Number(t[1])||0),this.emit("connect")}else this._onError(new Error("Server terminates connection. response="+e),"ECONNECTION",e,"EHLO")}_actionHELO(e){"2"===e.charAt(0)?(this.allowsAuth=!0,this.emit("connect")):this._onError(new Error("Invalid HELO. response="+e),"EPROTOCOL",e,"HELO")}_actionSTARTTLS(e){if("2"!==e.charAt(0))return this.options.opportunisticTLS?(this.logger.info({tnx:"smtp"},"Failed STARTTLS upgrade, continuing unencrypted"),this.emit("connect")):void this._onError(new Error("Error upgrading connection with STARTTLS"),"ETLS",e,"STARTTLS");this._upgradeConnection(((e,t)=>{e?this._onError(new Error("Error initiating TLS - "+(e.message||e)),"ETLS",!1,"STARTTLS"):(this.logger.info({tnx:"smtp"},"Connection upgraded with STARTTLS"),t?this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name)):this.emit("connect"))}))}_actionAUTH_LOGIN_USER(e,t){/^334[ -]/.test(e)?(this._responseActions.push((e=>{this._actionAUTH_LOGIN_PASS(e,t)})),this._sendCommand(Buffer.from(this._auth.credentials.user+"","utf-8").toString("base64"))):t(this._formatError('Invalid login sequence while waiting for "334 VXNlcm5hbWU6"',"EAUTH",e,"AUTH LOGIN"))}_actionAUTH_CRAM_MD5(e,t){let i=e.match(/^334\s+(.+)$/),n="";if(!i)return t(this._formatError("Invalid login sequence while waiting for server challenge string","EAUTH",e,"AUTH CRAM-MD5"));n=i[1];let s=Buffer.from(n,"base64").toString("ascii"),o=wf.createHmac("md5",this._auth.credentials.pass);o.update(s);let a=this._auth.credentials.user+" "+o.digest("hex");this._responseActions.push((e=>{this._actionAUTH_CRAM_MD5_PASS(e,t)})),this._sendCommand(Buffer.from(a).toString("base64"),Buffer.from(this._auth.credentials.user+" /* secret */").toString("base64"))}_actionAUTH_CRAM_MD5_PASS(e,t){if(!e.match(/^235\s+/))return t(this._formatError('Invalid login sequence while waiting for "235"',"EAUTH",e,"AUTH CRAM-MD5"));this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,t(null,!0)}_actionAUTH_LOGIN_PASS(e,t){if(!/^334[ -]/.test(e))return t(this._formatError('Invalid login sequence while waiting for "334 UGFzc3dvcmQ6"',"EAUTH",e,"AUTH LOGIN"));this._responseActions.push((e=>{this._actionAUTHComplete(e,t)})),this._sendCommand(Buffer.from((this._auth.credentials.pass||"").toString(),"utf-8").toString("base64"),Buffer.from("/* secret */","utf-8").toString("base64"))}_actionAUTHComplete(e,t,i){return i||"function"!=typeof t||(i=t,t=!1),"334"===e.substr(0,3)?(this._responseActions.push((e=>{t||"XOAUTH2"!==this._authMethod?this._actionAUTHComplete(e,!0,i):setImmediate((()=>this._handleXOauth2Token(!0,i)))})),void this._sendCommand("")):"2"!==e.charAt(0)?(this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),i(this._formatError("Invalid login","EAUTH",e,"AUTH "+this._authMethod))):(this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,void i(null,!0))}_actionMAIL(e,t){let i,n;if(2!==Number(e.charAt(0)))return i=this._usingSmtpUtf8&&/^550 /.test(e)&&/[\x80-\uFFFF]/.test(this._envelope.from)?"Internationalized mailbox name not allowed":"Mail command failed",t(this._formatError(i,"EENVELOPE",e,"MAIL FROM"));if(!this._envelope.rcptQueue.length)return t(this._formatError("Can't send mail - no recipients defined","EENVELOPE",!1,"API"));if(this._recipientQueue=[],this._supportedExtensions.includes("PIPELINING"))for(;this._envelope.rcptQueue.length;)n=this._envelope.rcptQueue.shift(),this._recipientQueue.push(n),this._responseActions.push((e=>{this._actionRCPT(e,t)})),this._sendCommand("RCPT TO:<"+n+">"+this._getDsnRcptToArgs());else n=this._envelope.rcptQueue.shift(),this._recipientQueue.push(n),this._responseActions.push((e=>{this._actionRCPT(e,t)})),this._sendCommand("RCPT TO:<"+n+">"+this._getDsnRcptToArgs())}_actionRCPT(e,t){let i,n,s=this._recipientQueue.shift();if(2!==Number(e.charAt(0))?(i=this._usingSmtpUtf8&&/^553 /.test(e)&&/[\x80-\uFFFF]/.test(s)?"Internationalized mailbox name not allowed":"Recipient command failed",this._envelope.rejected.push(s),n=this._formatError(i,"EENVELOPE",e,"RCPT TO"),n.recipient=s,this._envelope.rejectedErrors.push(n)):this._envelope.accepted.push(s),this._envelope.rcptQueue.length||this._recipientQueue.length)this._envelope.rcptQueue.length&&(s=this._envelope.rcptQueue.shift(),this._recipientQueue.push(s),this._responseActions.push((e=>{this._actionRCPT(e,t)})),this._sendCommand("RCPT TO:<"+s+">"+this._getDsnRcptToArgs()));else{if(!(this._envelope.rejected.length<this._envelope.to.length))return n=this._formatError("Can't send mail - all recipients were rejected","EENVELOPE",e,"RCPT TO"),n.rejected=this._envelope.rejected,n.rejectedErrors=this._envelope.rejectedErrors,t(n);this._responseActions.push((e=>{this._actionDATA(e,t)})),this._sendCommand("DATA")}}_actionDATA(e,t){if(!/^[23]/.test(e))return t(this._formatError("Data command failed","EENVELOPE",e,"DATA"));let i={accepted:this._envelope.accepted,rejected:this._envelope.rejected};this._envelope.rejectedErrors.length&&(i.rejectedErrors=this._envelope.rejectedErrors),t(null,i)}_actionSMTPStream(e,t){return 2!==Number(e.charAt(0))?t(this._formatError("Message failed","EMESSAGE",e,"DATA")):t(null,e)}_actionLMTPStream(e,t,i,n){let s;if(2!==Number(i.charAt(0))){s=this._formatError("Message failed for recipient "+e,"EMESSAGE",i,"DATA"),s.recipient=e,this._envelope.rejected.push(e),this._envelope.rejectedErrors.push(s);for(let t=0,i=this._envelope.accepted.length;t<i;t++)this._envelope.accepted[t]===e&&this._envelope.accepted.splice(t,1)}if(t)return n(null,i)}_handleXOauth2Token(e,t){this._auth.oauth2.getToken(e,((i,n)=>{if(i)return this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),t(this._formatError(i,"EAUTH",!1,"AUTH XOAUTH2"));this._responseActions.push((i=>{this._actionAUTHComplete(i,e,t)})),this._sendCommand("AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token(n),"AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token("/* secret */"))}))}_isDestroyedMessage(e){if(this._destroyed)return"Cannot "+e+" - smtp connection is already destroyed.";if(this._socket){if(this._socket.destroyed)return"Cannot "+e+" - smtp connection socket is already destroyed.";if(!this._socket.writable)return"Cannot "+e+" - smtp connection socket is already half-closed."}}_getHostname(){let e=bf.hostname()||"";return e.indexOf(".")<0&&(e="[127.0.0.1]"),e.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)&&(e="["+e+"]"),e}};const Af=B.default.Stream,kf=_h.exports,Sf=E.default,Ff=wh.exports;var Tf=class extends Af{constructor(e,t){if(super(),this.options=e||{},e&&e.serviceClient){if(!e.privateKey||!e.user)return void setImmediate((()=>this.emit("error",new Error('Options "privateKey" and "user" are required for service account!'))));let t=Math.min(Math.max(Number(this.options.serviceRequestTimeout)||0,0),3600);this.options.serviceRequestTimeout=t||300}if(this.logger=Ff.getLogger({logger:t},{component:this.options.component||"OAuth2"}),this.provisionCallback="function"==typeof this.options.provisionCallback&&this.options.provisionCallback,this.options.accessUrl=this.options.accessUrl||"https://accounts.google.com/o/oauth2/token",this.options.customHeaders=this.options.customHeaders||{},this.options.customParams=this.options.customParams||{},this.accessToken=this.options.accessToken||!1,this.options.expires&&Number(this.options.expires))this.expires=this.options.expires;else{let e=Math.max(Number(this.options.timeout)||0,0);this.expires=e&&Date.now()+1e3*e||0}}getToken(e,t){if(!e&&this.accessToken&&(!this.expires||this.expires>Date.now()))return t(null,this.accessToken);let i=(...e)=>{e[0]?this.logger.error({err:e[0],tnx:"OAUTH2",user:this.options.user,action:"renew"},"Failed generating new Access Token for %s",this.options.user):this.logger.info({tnx:"OAUTH2",user:this.options.user,action:"renew"},"Generated new Access Token for %s",this.options.user),t(...e)};this.provisionCallback?this.provisionCallback(this.options.user,!!e,((e,t,n)=>{!e&&t&&(this.accessToken=t,this.expires=n||0),i(e,t)})):this.generateToken(i)}updateToken(e,t){this.accessToken=e,t=Math.max(Number(t)||0,0),this.expires=t&&Date.now()+1e3*t||0,this.emit("token",{user:this.options.user,accessToken:e||"",expires:this.expires})}generateToken(e){let t,i;if(this.options.serviceClient){let n,s=Math.floor(Date.now()/1e3),o={iss:this.options.serviceClient,scope:this.options.scope||"https://mail.google.com/",sub:this.options.user,aud:this.options.accessUrl,iat:s,exp:s+this.options.serviceRequestTimeout};try{n=this.jwtSignRS256(o)}catch(t){return e(new Error("Can't generate token. Check your auth options"))}t={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:n},i={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:o}}else{if(!this.options.refreshToken)return e(new Error("Can't create new access token for user"));t={client_id:this.options.clientId||"",client_secret:this.options.clientSecret||"",refresh_token:this.options.refreshToken,grant_type:"refresh_token"},i={client_id:this.options.clientId||"",client_secret:(this.options.clientSecret||"").substr(0,6)+"...",refresh_token:(this.options.refreshToken||"").substr(0,6)+"...",grant_type:"refresh_token"}}Object.keys(this.options.customParams).forEach((e=>{t[e]=this.options.customParams[e],i[e]=this.options.customParams[e]})),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"generate"},"Requesting token using: %s",JSON.stringify(i)),this.postRequest(this.options.accessUrl,t,this.options,((t,i)=>{let n;if(t)return e(t);try{n=JSON.parse(i.toString())}catch(t){return e(t)}if(!n||"object"!=typeof n)return this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",(i||"").toString()),e(new Error("Invalid authentication response"));let s={};if(Object.keys(n).forEach((e=>{s[e]="access_token"!==e?n[e]:(n[e]||"").toString().substr(0,6)+"..."})),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",JSON.stringify(s)),n.error){let t=n.error;return n.error_description&&(t+=": "+n.error_description),n.error_uri&&(t+=" ("+n.error_uri+")"),e(new Error(t))}return n.access_token?(this.updateToken(n.access_token,n.expires_in),e(null,this.accessToken)):e(new Error("No access token"))}))}buildXOAuth2Token(e){let t=["user="+(this.options.user||""),"auth=Bearer "+(e||this.accessToken),"",""];return Buffer.from(t.join(""),"utf-8").toString("base64")}postRequest(e,t,i,n){let s=!1,o=[],a=0,r=kf(e,{method:"post",headers:i.customHeaders,body:t,allowErrorResponse:!0});r.on("readable",(()=>{let e;for(;null!==(e=r.read());)o.push(e),a+=e.length})),r.once("error",(e=>{if(!s)return s=!0,n(e)})),r.once("end",(()=>{if(!s)return s=!0,n(null,Buffer.concat(o,a))}))}toBase64URL(e){return"string"==typeof e&&(e=Buffer.from(e)),e.toString("base64").replace(/[=]+/g,"").replace(/\+/g,"-").replace(/\//g,"_")}jwtSignRS256(e){e=['{"alg":"RS256","typ":"JWT"}',JSON.stringify(e)].map((e=>this.toBase64URL(e))).join(".");let t=Sf.createSign("RSA-SHA256").update(e).sign(this.options.privateKey);return e+"."+this.toBase64URL(t)}};const Bf=Cf,Of=wh.exports.assign,If=Tf,Pf=A.default;var jf=class extends Pf{constructor(e){if(super(),this.pool=e,this.options=e.options,this.logger=this.pool.logger,this.options.auth)switch((this.options.auth.type||"").toString().toUpperCase()){case"OAUTH2":{let e=new If(this.options.auth,this.logger);e.provisionCallback=this.pool.mailer&&this.pool.mailer.get("oauth2_provision_cb")||e.provisionCallback,this.auth={type:"OAUTH2",user:this.options.auth.user,oauth2:e,method:"XOAUTH2"},e.on("token",(e=>this.pool.mailer.emit("token",e))),e.on("error",(e=>this.emit("error",e)));break}default:if(!this.options.auth.user&&!this.options.auth.pass)break;this.auth={type:(this.options.auth.type||"").toString().toUpperCase()||"LOGIN",user:this.options.auth.user,credentials:{user:this.options.auth.user||"",pass:this.options.auth.pass,options:this.options.auth.options},method:(this.options.auth.method||"").trim().toUpperCase()||this.options.authMethod||!1}}this._connection=!1,this._connected=!1,this.messages=0,this.available=!0}connect(e){this.pool.getSocket(this.options,((t,i)=>{if(t)return e(t);let n=!1,s=this.options;i&&i.connection&&(this.logger.info({tnx:"proxy",remoteAddress:i.connection.remoteAddress,remotePort:i.connection.remotePort,destHost:s.host||"",destPort:s.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",i.connection.remoteAddress,i.connection.remotePort,s.host||"",s.port||""),s=Of(!1,s),Object.keys(i).forEach((e=>{s[e]=i[e]}))),this.connection=new Bf(s),this.connection.once("error",(t=>{if(this.emit("error",t),!n)return n=!0,e(t)})),this.connection.once("end",(()=>{if(this.close(),n)return;n=!0;let t=setTimeout((()=>{if(n)return;let t=new Error("Unexpected socket close");this.connection&&this.connection._socket&&this.connection._socket.upgrading&&(t.code="ETLS"),e(t)}),1e3);try{t.unref()}catch(e){}})),this.connection.connect((()=>{if(!n)return this.auth&&(this.connection.allowsAuth||s.forceAuth)?void this.connection.login(this.auth,(t=>{if(!n){if(n=!0,t)return this.connection.close(),this.emit("error",t),e(t);this._connected=!0,e(null,!0)}})):(n=!0,this._connected=!0,e(null,!0))}))}))}send(e,t){if(!this._connected)return this.connect((i=>i?t(i):this.send(e,t)));let i=e.message.getEnvelope(),n=e.message.messageId(),s=[].concat(i.to||[]);s.length>3&&s.push("...and "+s.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:n,cid:this.id},"Sending message %s using #%s to <%s>",n,this.id,s.join(", ")),e.data.dsn&&(i.dsn=e.data.dsn),this.connection.send(i,e.message.createReadStream(),((e,s)=>{if(this.messages++,e)return this.connection.close(),this.emit("error",e),t(e);s.envelope={from:i.from,to:i.to},s.messageId=n,setImmediate((()=>{let e;this.messages>=this.options.maxMessages?(e=new Error("Resource exhausted"),e.code="EMAXLIMIT",this.connection.close(),this.emit("error",e)):this.pool._checkRateLimit((()=>{this.available=!0,this.emit("available")}))})),t(null,s)}))}close(){this._connected=!1,this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.connection&&this.connection.close(),this.emit("close")}};const Rf={126:{host:"smtp.126.com",port:465,secure:!0},163:{host:"smtp.163.com",port:465,secure:!0},"1und1":{host:"smtp.1und1.de",port:465,secure:!0,authMethod:"LOGIN"},AOL:{domains:["aol.com"],host:"smtp.aol.com",port:587},DebugMail:{host:"debugmail.io",port:25},DynectEmail:{aliases:["Dynect"],host:"smtp.dynect.net",port:25},Ethereal:{aliases:["ethereal.email"],host:"smtp.ethereal.email",port:587},FastMail:{domains:["fastmail.fm"],host:"smtp.fastmail.com",port:465,secure:!0},GandiMail:{aliases:["Gandi","Gandi Mail"],host:"mail.gandi.net",port:587},Gmail:{aliases:["Google Mail"],domains:["gmail.com","googlemail.com"],host:"smtp.gmail.com",port:465,secure:!0},Godaddy:{host:"smtpout.secureserver.net",port:25},GodaddyAsia:{host:"smtp.asia.secureserver.net",port:25},GodaddyEurope:{host:"smtp.europe.secureserver.net",port:25},"hot.ee":{host:"mail.hot.ee"},Hotmail:{aliases:["Outlook","Outlook.com","Hotmail.com"],domains:["hotmail.com","outlook.com"],host:"smtp-mail.outlook.com",port:587},iCloud:{aliases:["Me","Mac"],domains:["me.com","mac.com"],host:"smtp.mail.me.com",port:587},Infomaniak:{host:"mail.infomaniak.com",domains:["ik.me","ikmail.com","etik.com"],port:587},"mail.ee":{host:"smtp.mail.ee"},"Mail.ru":{host:"smtp.mail.ru",port:465,secure:!0},Maildev:{port:1025,ignoreTLS:!0},Mailgun:{host:"smtp.mailgun.org",port:465,secure:!0},Mailjet:{host:"in.mailjet.com",port:587},Mailosaur:{host:"mailosaur.io",port:25},Mailtrap:{host:"smtp.mailtrap.io",port:2525},Mandrill:{host:"smtp.mandrillapp.com",port:587},Naver:{host:"smtp.naver.com",port:587},One:{host:"send.one.com",port:465,secure:!0},OpenMailBox:{aliases:["OMB","openmailbox.org"],host:"smtp.openmailbox.org",port:465,secure:!0},Outlook365:{host:"smtp.office365.com",port:587,secure:!1},OhMySMTP:{host:"smtp.ohmysmtp.com",port:587,secure:!1},Postmark:{aliases:["PostmarkApp"],host:"smtp.postmarkapp.com",port:2525},"qiye.aliyun":{host:"smtp.mxhichina.com",port:"465",secure:!0},QQ:{domains:["qq.com"],host:"smtp.qq.com",port:465,secure:!0},QQex:{aliases:["QQ Enterprise"],domains:["exmail.qq.com"],host:"smtp.exmail.qq.com",port:465,secure:!0},SendCloud:{host:"smtpcloud.sohu.com",port:25},SendGrid:{host:"smtp.sendgrid.net",port:587},SendinBlue:{host:"smtp-relay.sendinblue.com",port:587},SendPulse:{host:"smtp-pulse.com",port:465,secure:!0},SES:{host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},"SES-US-EAST-1":{host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},"SES-US-WEST-2":{host:"email-smtp.us-west-2.amazonaws.com",port:465,secure:!0},"SES-EU-WEST-1":{host:"email-smtp.eu-west-1.amazonaws.com",port:465,secure:!0},Sparkpost:{aliases:["SparkPost","SparkPost Mail"],domains:["sparkpost.com"],host:"smtp.sparkpostmail.com",port:587,secure:!1},Tipimail:{host:"smtp.tipimail.com",port:587},Yahoo:{domains:["yahoo.com"],host:"smtp.mail.yahoo.com",port:465,secure:!0},Yandex:{domains:["yandex.ru"],host:"smtp.yandex.ru",port:465,secure:!0},Zoho:{host:"smtp.zoho.com",port:465,secure:!0,authMethod:"LOGIN"}},Lf={};function Nf(e){return e.replace(/[^a-zA-Z0-9.-]/g,"").toLowerCase()}function Hf(e){let t=["domains","aliases"],i={};return Object.keys(e).forEach((n=>{t.indexOf(n)<0&&(i[n]=e[n])})),i}Object.keys(Rf).forEach((e=>{let t=Rf[e];Lf[Nf(e)]=Hf(t),[].concat(t.aliases||[]).forEach((e=>{Lf[Nf(e)]=Hf(t)})),[].concat(t.domains||[]).forEach((e=>{Lf[Nf(e)]=Hf(t)}))}));var $f=function(e){return e=Nf(e.split("@").pop()),Lf[e]||!1};const Uf=A.default,qf=jf,Mf=Cf,zf=$f,Gf=wh.exports,Vf=Ch;var Wf=class extends Uf{constructor(e){let t;super(),"string"==typeof(e=e||{})&&(e={url:e});let i=e.service;"function"==typeof e.getSocket&&(this.getSocket=e.getSocket),e.url&&(t=Gf.parseConnectionUrl(e.url),i=i||t.service),this.options=Gf.assign(!1,e,t,i&&zf(i)),this.options.maxConnections=this.options.maxConnections||5,this.options.maxMessages=this.options.maxMessages||100,this.logger=Gf.getLogger(this.options,{component:this.options.component||"smtp-pool"});let n=new Mf(this.options);this.name="SMTP (pool)",this.version=Vf.version+"[client:"+n.version+"]",this._rateLimit={counter:0,timeout:null,waiting:[],checkpoint:!1,delta:Number(this.options.rateDelta)||1e3,limit:Number(this.options.rateLimit)||0},this._closed=!1,this._queue=[],this._connections=[],this._connectionCounter=0,this.idling=!0,setImmediate((()=>{this.idling&&this.emit("idle")}))}getSocket(e,t){return setImmediate((()=>t(null,!1)))}send(e,t){return!this._closed&&(this._queue.push({mail:e,requeueAttempts:0,callback:t}),this.idling&&this._queue.length>=this.options.maxConnections&&(this.idling=!1),setImmediate((()=>this._processMessages())),!0)}close(){let e,t=this._connections.length;if(this._closed=!0,clearTimeout(this._rateLimit.timeout),!t&&!this._queue.length)return;for(let i=t-1;i>=0;i--)this._connections[i]&&this._connections[i].available&&(e=this._connections[i],e.close(),this.logger.info({tnx:"connection",cid:e.id,action:"removed"},"Connection #%s removed",e.id));if(t&&!this._connections.length&&this.logger.debug({tnx:"connection"},"All connections removed"),!this._queue.length)return;let i=()=>{if(!this._queue.length)return void this.logger.debug({tnx:"connection"},"Pending queue entries cleared");let t=this._queue.shift();if(t&&"function"==typeof t.callback)try{t.callback(new Error("Connection pool was closed"))}catch(t){this.logger.error({err:t,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,t.message)}setImmediate(i)};setImmediate(i)}_processMessages(){let e,t,i;if(this._closed)return;if(!this._queue.length)return void(this.idling||(this.idling=!0,this.emit("idle")));for(t=0,i=this._connections.length;t<i;t++)if(this._connections[t].available){e=this._connections[t];break}if(!e&&this._connections.length<this.options.maxConnections&&(e=this._createConnection()),!e)return void(this.idling=!1);!this.idling&&this._queue.length<this.options.maxConnections&&(this.idling=!0,this.emit("idle"));let n=e.queueEntry=this._queue.shift();n.messageId=(e.queueEntry.mail.message.getHeader("message-id")||"").replace(/[<>\s]/g,""),e.available=!1,this.logger.debug({tnx:"pool",cid:e.id,messageId:n.messageId,action:"assign"},"Assigned message <%s> to #%s (%s)",n.messageId,e.id,e.messages+1),this._rateLimit.limit&&(this._rateLimit.counter++,this._rateLimit.checkpoint||(this._rateLimit.checkpoint=Date.now())),e.send(n.mail,((t,i)=>{if(n===e.queueEntry){try{n.callback(t,i)}catch(t){this.logger.error({err:t,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,t.message)}e.queueEntry=!1}}))}_createConnection(){let e=new qf(this);return e.id=++this._connectionCounter,this.logger.info({tnx:"pool",cid:e.id,action:"conection"},"Created new pool resource #%s",e.id),e.on("available",(()=>{this.logger.debug({tnx:"connection",cid:e.id,action:"available"},"Connection #%s became available",e.id),this._closed?this.close():this._processMessages()})),e.once("error",(t=>{if("EMAXLIMIT"!==t.code?this.logger.error({err:t,tnx:"pool",cid:e.id},"Pool Error for #%s: %s",e.id,t.message):this.logger.debug({tnx:"pool",cid:e.id,action:"maxlimit"},"Max messages limit exchausted for #%s",e.id),e.queueEntry){try{e.queueEntry.callback(t)}catch(t){this.logger.error({err:t,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,t.message)}e.queueEntry=!1}this._removeConnection(e),this._continueProcessing()})),e.once("close",(()=>{this.logger.info({tnx:"connection",cid:e.id,action:"closed"},"Connection #%s was closed",e.id),this._removeConnection(e),e.queueEntry?setTimeout((()=>{e.queueEntry&&(this._shouldRequeuOnConnectionClose(e.queueEntry)?this._requeueEntryOnConnectionClose(e):this._failDeliveryOnConnectionClose(e)),this._continueProcessing()}),50):this._continueProcessing()})),this._connections.push(e),e}_shouldRequeuOnConnectionClose(e){return void 0===this.options.maxRequeues||this.options.maxRequeues<0||e.requeueAttempts<this.options.maxRequeues}_failDeliveryOnConnectionClose(e){if(e.queueEntry&&e.queueEntry.callback){try{e.queueEntry.callback(new Error("Reached maximum number of retries after connection was closed"))}catch(t){this.logger.error({err:t,tnx:"callback",messageId:e.queueEntry.messageId,cid:e.id},"Callback error for #%s: %s",e.id,t.message)}e.queueEntry=!1}}_requeueEntryOnConnectionClose(e){e.queueEntry.requeueAttempts=e.queueEntry.requeueAttempts+1,this.logger.debug({tnx:"pool",cid:e.id,messageId:e.queueEntry.messageId,action:"requeue"},"Re-queued message <%s> for #%s. Attempt: #%s",e.queueEntry.messageId,e.id,e.queueEntry.requeueAttempts),this._queue.unshift(e.queueEntry),e.queueEntry=!1}_continueProcessing(){this._closed?this.close():setTimeout((()=>this._processMessages()),100)}_removeConnection(e){let t=this._connections.indexOf(e);-1!==t&&this._connections.splice(t,1)}_checkRateLimit(e){if(!this._rateLimit.limit)return e();let t=Date.now();return this._rateLimit.counter<this._rateLimit.limit?e():(this._rateLimit.waiting.push(e),this._rateLimit.checkpoint<=t-this._rateLimit.delta?this._clearRateLimit():void(this._rateLimit.timeout||(this._rateLimit.timeout=setTimeout((()=>this._clearRateLimit()),this._rateLimit.delta-(t-this._rateLimit.checkpoint)),this._rateLimit.checkpoint=t)))}_clearRateLimit(){for(clearTimeout(this._rateLimit.timeout),this._rateLimit.timeout=null,this._rateLimit.counter=0,this._rateLimit.checkpoint=!1;this._rateLimit.waiting.length;){let e=this._rateLimit.waiting.shift();setImmediate(e)}}isIdle(){return this.idling}verify(e){let t;e||(t=new Promise(((t,i)=>{e=Gf.callbackPromise(t,i)})));let i=new qf(this).auth;return this.getSocket(this.options,((t,n)=>{if(t)return e(t);let s=this.options;n&&n.connection&&(this.logger.info({tnx:"proxy",remoteAddress:n.connection.remoteAddress,remotePort:n.connection.remotePort,destHost:s.host||"",destPort:s.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",n.connection.remoteAddress,n.connection.remotePort,s.host||"",s.port||""),s=Gf.assign(!1,s),Object.keys(n).forEach((e=>{s[e]=n[e]})));let o=new Mf(s),a=!1;o.once("error",(t=>{if(!a)return a=!0,o.close(),e(t)})),o.once("end",(()=>{if(!a)return a=!0,e(new Error("Connection closed"))}));let r=()=>{if(!a)return a=!0,o.quit(),e(null,!0)};o.connect((()=>{a||(i&&(o.allowsAuth||s.forceAuth)?o.login(i,(t=>{if(!a)return t?(a=!0,o.close(),e(t)):void r()})):r())}))})),t}};const Kf=A.default,Jf=Cf,Qf=$f,Xf=wh.exports,Yf=Tf,Zf=Ch;var eg=class extends Kf{constructor(e){let t;super(),"string"==typeof(e=e||{})&&(e={url:e});let i=e.service;"function"==typeof e.getSocket&&(this.getSocket=e.getSocket),e.url&&(t=Xf.parseConnectionUrl(e.url),i=i||t.service),this.options=Xf.assign(!1,e,t,i&&Qf(i)),this.logger=Xf.getLogger(this.options,{component:this.options.component||"smtp-transport"});let n=new Jf(this.options);this.name="SMTP",this.version=Zf.version+"[client:"+n.version+"]",this.options.auth&&(this.auth=this.getAuth({}))}getSocket(e,t){return setImmediate((()=>t(null,!1)))}getAuth(e){if(!e)return this.auth;let t=!1,i={};if(this.options.auth&&"object"==typeof this.options.auth&&Object.keys(this.options.auth).forEach((e=>{t=!0,i[e]=this.options.auth[e]})),e&&"object"==typeof e&&Object.keys(e).forEach((n=>{t=!0,i[n]=e[n]})),!t)return!1;if("OAUTH2"===(i.type||"").toString().toUpperCase()){if(!i.service&&!i.user)return!1;let e=new Yf(i,this.logger);return e.provisionCallback=this.mailer&&this.mailer.get("oauth2_provision_cb")||e.provisionCallback,e.on("token",(e=>this.mailer.emit("token",e))),e.on("error",(e=>this.emit("error",e))),{type:"OAUTH2",user:i.user,oauth2:e,method:"XOAUTH2"}}return{type:(i.type||"").toString().toUpperCase()||"LOGIN",user:i.user,credentials:{user:i.user||"",pass:i.pass,options:i.options},method:(i.method||"").trim().toUpperCase()||this.options.authMethod||!1}}send(e,t){this.getSocket(this.options,((i,n)=>{if(i)return t(i);let s=!1,o=this.options;n&&n.connection&&(this.logger.info({tnx:"proxy",remoteAddress:n.connection.remoteAddress,remotePort:n.connection.remotePort,destHost:o.host||"",destPort:o.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",n.connection.remoteAddress,n.connection.remotePort,o.host||"",o.port||""),o=Xf.assign(!1,o),Object.keys(n).forEach((e=>{o[e]=n[e]})));let a=new Jf(o);a.once("error",(e=>{if(!s)return s=!0,a.close(),t(e)})),a.once("end",(()=>{if(s)return;let e=setTimeout((()=>{if(s)return;s=!0;let e=new Error("Unexpected socket close");a&&a._socket&&a._socket.upgrading&&(e.code="ETLS"),t(e)}),1e3);try{e.unref()}catch(e){}}));let r=()=>{let i=e.message.getEnvelope(),n=e.message.messageId(),o=[].concat(i.to||[]);o.length>3&&o.push("...and "+o.splice(2).length+" more"),e.data.dsn&&(i.dsn=e.data.dsn),this.logger.info({tnx:"send",messageId:n},"Sending message %s to <%s>",n,o.join(", ")),a.send(i,e.message.createReadStream(),((e,o)=>{if(s=!0,a.close(),e)return this.logger.error({err:e,tnx:"send"},"Send error for %s: %s",n,e.message),t(e);o.envelope={from:i.from,to:i.to},o.messageId=n;try{return t(null,o)}catch(e){this.logger.error({err:e,tnx:"callback"},"Callback error for %s: %s",n,e.message)}}))};a.connect((()=>{if(s)return;let i=this.getAuth(e.data.auth);i&&(a.allowsAuth||o.forceAuth)?a.login(i,(e=>{if(i&&i!==this.auth&&i.oauth2&&i.oauth2.removeAllListeners(),!s)return e?(s=!0,a.close(),t(e)):void r()})):r()}))}))}verify(e){let t;return e||(t=new Promise(((t,i)=>{e=Xf.callbackPromise(t,i)}))),this.getSocket(this.options,((t,i)=>{if(t)return e(t);let n=this.options;i&&i.connection&&(this.logger.info({tnx:"proxy",remoteAddress:i.connection.remoteAddress,remotePort:i.connection.remotePort,destHost:n.host||"",destPort:n.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",i.connection.remoteAddress,i.connection.remotePort,n.host||"",n.port||""),n=Xf.assign(!1,n),Object.keys(i).forEach((e=>{n[e]=i[e]})));let s=new Jf(n),o=!1;s.once("error",(t=>{if(!o)return o=!0,s.close(),e(t)})),s.once("end",(()=>{if(!o)return o=!0,e(new Error("Connection closed"))}));let a=()=>{if(!o)return o=!0,s.quit(),e(null,!0)};s.connect((()=>{if(o)return;let t=this.getAuth({});t&&(s.allowsAuth||n.forceAuth)?s.login(t,(t=>{if(!o)return t?(o=!0,s.close(),e(t)):void a()})):a()}))})),t}close(){this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.emit("close")}};const tg=L.default.spawn,ig=Ch,ng=wh.exports;var sg=class{constructor(e){e=e||{},this._spawn=tg,this.options=e||{},this.name="Sendmail",this.version=ig.version,this.path="sendmail",this.args=!1,this.winbreak=!1,this.logger=ng.getLogger(this.options,{component:this.options.component||"sendmail"}),e&&("string"==typeof e?this.path=e:"object"==typeof e&&(e.path&&(this.path=e.path),Array.isArray(e.args)&&(this.args=e.args),this.winbreak=["win","windows","dos","\r\n"].includes((e.newline||"").toString().toLowerCase())))}send(e,t){e.message.keepBcc=!0;let i,n,s,o=e.data.envelope||e.message.getEnvelope(),a=e.message.messageId();if([].concat(o.from||[]).concat(o.to||[]).some((e=>/^-/.test(e))))return t(new Error("Can not send mail. Invalid envelope addresses."));i=this.args?["-i"].concat(this.args).concat(o.to):["-i"].concat(o.from?["-f",o.from]:[]).concat(o.to);let r=i=>{if(!s)return s=!0,"function"==typeof t?i?t(i):t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:a,response:"Messages queued for delivery"}):void 0};try{n=this._spawn(this.path,i)}catch(e){return this.logger.error({err:e,tnx:"spawn",messageId:a},"Error occurred while spawning sendmail. %s",e.message),r(e)}if(!n)return r(new Error("sendmail was not found"));{n.on("error",(e=>{this.logger.error({err:e,tnx:"spawn",messageId:a},"Error occurred when sending message %s. %s",a,e.message),r(e)})),n.once("exit",(e=>{if(!e)return r();let t;t=127===e?new Error("Sendmail command not found, process exited with code "+e):new Error("Sendmail exited with code "+e),this.logger.error({err:t,tnx:"stdin",messageId:a},"Error sending message %s to sendmail. %s",a,t.message),r(t)})),n.once("close",r),n.stdin.on("error",(e=>{this.logger.error({err:e,tnx:"stdin",messageId:a},"Error occurred when piping message %s to sendmail. %s",a,e.message),r(e)}));let t=[].concat(o.to||[]);t.length>3&&t.push("...and "+t.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:a},"Sending message %s to <%s>",a,t.join(", "));let i=e.message.createReadStream();i.once("error",(e=>{this.logger.error({err:e,tnx:"stdin",messageId:a},"Error occurred when generating message %s. %s",a,e.message),n.kill("SIGINT"),r(e)})),i.pipe(n.stdin)}}};const og=Ch,ag=wh.exports;var rg=class{constructor(e){e=e||{},this.options=e||{},this.name="StreamTransport",this.version=og.version,this.logger=ag.getLogger(this.options,{component:this.options.component||"stream-transport"}),this.winbreak=["win","windows","dos","\r\n"].includes((e.newline||"").toString().toLowerCase())}send(e,t){e.message.keepBcc=!0;let i=e.data.envelope||e.message.getEnvelope(),n=e.message.messageId(),s=[].concat(i.to||[]);s.length>3&&s.push("...and "+s.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:n},"Sending message %s to <%s> using %s line breaks",n,s.join(", "),this.winbreak?"<CR><LF>":"<LF>"),setImmediate((()=>{let i;try{i=e.message.createReadStream()}catch(e){return this.logger.error({err:e,tnx:"send",messageId:n},"Creating send stream failed for %s. %s",n,e.message),t(e)}if(!this.options.buffer)return i.once("error",(e=>{this.logger.error({err:e,tnx:"send",messageId:n},"Failed creating message for %s. %s",n,e.message)})),t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:n,message:i});let s=[],o=0;i.on("readable",(()=>{let e;for(;null!==(e=i.read());)s.push(e),o+=e.length})),i.once("error",(e=>(this.logger.error({err:e,tnx:"send",messageId:n},"Failed creating message for %s. %s",n,e.message),t(e)))),i.on("end",(()=>t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:n,message:Buffer.concat(s,o)})))}))}};const cg=Ch,pg=wh.exports;var ug=class{constructor(e){e=e||{},this.options=e||{},this.name="JSONTransport",this.version=cg.version,this.logger=pg.getLogger(this.options,{component:this.options.component||"json-transport"})}send(e,t){e.message.keepBcc=!0;let i=e.data.envelope||e.message.getEnvelope(),n=e.message.messageId(),s=[].concat(i.to||[]);s.length>3&&s.push("...and "+s.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:n},"Composing JSON structure of %s to <%s>",n,s.join(", ")),setImmediate((()=>{e.normalize(((e,s)=>e?(this.logger.error({err:e,tnx:"send",messageId:n},"Failed building JSON structure for %s. %s",n,e.message),t(e)):(delete s.envelope,delete s.normalizedHeaders,t(null,{envelope:i,messageId:n,message:this.options.skipEncoding?s:JSON.stringify(s)}))))}))}};const lg=A.default,dg=Ch,hg=wh.exports,mg=nm;var fg=class extends lg{constructor(e){super(),e=e||{},this.options=e||{},this.ses=this.options.SES,this.name="SESTransport",this.version=dg.version,this.logger=hg.getLogger(this.options,{component:this.options.component||"ses-transport"}),this.maxConnections=Number(this.options.maxConnections)||1/0,this.connections=0,this.sendingRate=Number(this.options.sendingRate)||1/0,this.sendingRateTTL=null,this.rateInterval=1e3,this.rateMessages=[],this.pending=[],this.idling=!0,setImmediate((()=>{this.idling&&this.emit("idle")}))}send(e,t){return this.connections>=this.maxConnections?(this.idling=!1,this.pending.push({mail:e,callback:t})):this._checkSendingRate()?void this._send(e,((...e)=>{setImmediate((()=>t(...e))),this._sent()})):(this.idling=!1,this.pending.push({mail:e,callback:t}))}_checkRatedQueue(){if(this.connections>=this.maxConnections||!this._checkSendingRate())return;if(!this.pending.length)return void(this.idling||(this.idling=!0,this.emit("idle")));let e=this.pending.shift();this._send(e.mail,((...t)=>{setImmediate((()=>e.callback(...t))),this._sent()}))}_checkSendingRate(){clearTimeout(this.sendingRateTTL);let e=Date.now(),t=!1;for(let i=this.rateMessages.length-1;i>=0;i--)this.rateMessages[i].ts>=e-this.rateInterval&&(!t||this.rateMessages[i].ts<t)&&(t=this.rateMessages[i].ts),this.rateMessages[i].ts<e-this.rateInterval&&!this.rateMessages[i].pending&&this.rateMessages.splice(i,1);if(this.rateMessages.length<this.sendingRate)return!0;let i=Math.max(t+1001,e+20);this.sendingRateTTL=setTimeout((()=>this._checkRatedQueue()),e-i);try{this.sendingRateTTL.unref()}catch(e){}return!1}_sent(){this.connections--,this._checkRatedQueue()}isIdle(){return this.idling}_send(e,t){let i={ts:Date.now(),pending:!0};this.connections++,this.rateMessages.push(i);let n=e.data.envelope||e.message.getEnvelope(),s=e.message.messageId(),o=[].concat(n.to||[]);o.length>3&&o.push("...and "+o.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:s},"Sending message %s to <%s>",s,o.join(", "));setImmediate((()=>(t=>{e.data._dkim||(e.data._dkim={}),e.data._dkim.skipFields&&"string"==typeof e.data._dkim.skipFields?e.data._dkim.skipFields+=":date:message-id":e.data._dkim.skipFields="date:message-id";let i=e.message.createReadStream(),n=i.pipe(new mg),s=[],o=0;n.on("readable",(()=>{let e;for(;null!==(e=n.read());)s.push(e),o+=e.length})),i.once("error",(e=>n.emit("error",e))),n.once("error",(e=>{t(e)})),n.once("end",(()=>t(null,Buffer.concat(s,o))))})(((o,a)=>{if(o)return this.logger.error({err:o,tnx:"send",messageId:s},"Failed creating message for %s. %s",s,o.message),i.pending=!1,t(o);let r={RawMessage:{Data:a},Source:n.from,Destinations:n.to};Object.keys(e.data.ses||{}).forEach((t=>{r[t]=e.data.ses[t]}));let c=(this.ses.aws?this.ses.ses:this.ses)||{},p=this.ses.aws||{};var u;u=(e,o)=>{let u;!e&&o||(o="us-east-1"),u="function"==typeof c.send&&p.SendRawEmailCommand?c.send(new p.SendRawEmailCommand(r)):c.sendRawEmail(r).promise(),u.then((e=>{"us-east-1"===o&&(o="email"),i.pending=!1,t(null,{envelope:{from:n.from,to:n.to},messageId:"<"+e.MessageId+(/@/.test(e.MessageId)?"":"@"+o+".amazonses.com")+">",response:e.MessageId,raw:a})})).catch((e=>{this.logger.error({err:e,tnx:"send"},"Send error for %s: %s",s,e.message),i.pending=!1,t(e)}))},c.config&&"function"==typeof c.config.region?c.config.region().then((e=>u(null,e))).catch((e=>u(e))):u(null,c.config&&c.config.region||"us-east-1")}))))}verify(e){let t,i=(this.ses.aws?this.ses.ses:this.ses)||{},n=this.ses.aws||{};const s={RawMessage:{Data:"From: invalid@invalid\r\nTo: invalid@invalid\r\n Subject: Invalid\r\n\r\nInvalid"},Source:"invalid@invalid",Destinations:["invalid@invalid"]};e||(t=new Promise(((t,i)=>{e=hg.callbackPromise(t,i)})));const o=t=>t&&"InvalidParameterValue"!==(t.code||t.Code)?e(t):e(null,!0);return"function"==typeof i.send&&n.SendRawEmailCommand?(s.RawMessage.Data=Buffer.from(s.RawMessage.Data),i.send(new n.SendRawEmailCommand(s),o)):i.sendRawEmail(s,o),t}};const gg=hf,vg=wh.exports,xg=Wf,yg=eg,bg=sg,wg=rg,_g=ug,Dg=fg;(process.env.ETHEREAL_API||"https://api.nodemailer.com").replace(/\/+$/,""),(process.env.ETHEREAL_WEB||"https://ethereal.email").replace(/\/+$/,""),["true","yes","y","1"].includes((process.env.ETHEREAL_CACHE||"yes").toString().trim().toLowerCase());var Eg,Cg={exports:{}},Ag={},kg=R.default,Sg=F.default,Fg=T.default,Tg=A.default,Bg=S.default;function Og(e){var t=this;t.options=e||{},t.proxyOptions=t.options.proxy||{},t.maxSockets=t.options.maxSockets||Sg.Agent.defaultMaxSockets,t.requests=[],t.sockets=[],t.on("free",(function(e,i,n,s){for(var o=Pg(i,n,s),a=0,r=t.requests.length;a<r;++a){var c=t.requests[a];if(c.host===o.host&&c.port===o.port)return t.requests.splice(a,1),void c.request.onSocket(e)}e.destroy(),t.removeSocket(e)}))}function Ig(e,t){var i=this;Og.prototype.createSocket.call(i,e,(function(n){var s=e.request.getHeader("host"),o=jg({},i.options,{socket:n,servername:s?s.replace(/:.*$/,""):e.host}),a=kg.connect(0,o);i.sockets[i.sockets.indexOf(n)]=a,t(a)}))}function Pg(e,t,i){return"string"==typeof e?{host:e,port:t,localAddress:i}:e}function jg(e){for(var t=1,i=arguments.length;t<i;++t){var n=arguments[t];if("object"==typeof n)for(var s=Object.keys(n),o=0,a=s.length;o<a;++o){var r=s[o];void 0!==n[r]&&(e[r]=n[r])}}return e}function Rg(){var e;const t=(null===(e=ap.config)||void 0===e?void 0:e.message)||{};["GOBOT_URL","GOBOT_TOKEN","GOBOT_QQ","SCKEY","QQ_SKEY","QQ_MODE","BARK_PUSH","BARK_SOUND","BARK_GROUP","TG_BOT_TOKEN","TG_USER_ID","TG_PROXY_AUTH","TG_PROXY_HOST","TG_PROXY_PORT","TG_API_HOST","DD_BOT_TOKEN","DD_BOT_SECRET","QYWX_KEY","QYWX_AM","IGOT_PUSH_KEY","PUSH_PLUS_TOKEN","PUSH_PLUS_USER"].forEach((e=>{const i=t[(n=e,n.toLowerCase().replace(/_(\w)/g,((e,t)=>t.toUpperCase())))]||t[e]||process.env[e];var n;i&&(process.env[e]=i)})),ap.PUSHPLUS_TOKEN&&(process.env.PUSH_PLUS_TOKEN=ap.PUSHPLUS_TOKEN),function(){process.env.PUSH_KEY&&(Lg=process.env.PUSH_KEY);process.env.QQ_SKEY&&(ev=process.env.QQ_SKEY);process.env.QQ_MODE&&(tv=process.env.QQ_MODE);process.env.BARK_PUSH?(Ng=process.env.BARK_PUSH.indexOf("https")>-1||process.env.BARK_PUSH.indexOf("http")>-1?process.env.BARK_PUSH:`https://api.day.app/${process.env.BARK_PUSH}`,process.env.BARK_SOUND&&(Hg=process.env.BARK_SOUND),process.env.BARK_GROUP&&($g=process.env.BARK_GROUP)):Ng&&-1===Ng.indexOf("https")&&-1===Ng.indexOf("http")&&(Ng=`https://api.day.app/${Ng}`);process.env.TG_BOT_TOKEN&&(Ug=process.env.TG_BOT_TOKEN);process.env.TG_USER_ID&&(qg=process.env.TG_USER_ID);process.env.TG_PROXY_AUTH&&(Gg=process.env.TG_PROXY_AUTH);process.env.TG_PROXY_HOST&&(Mg=process.env.TG_PROXY_HOST);process.env.TG_PROXY_PORT&&(zg=process.env.TG_PROXY_PORT);process.env.TG_API_HOST&&(Vg=process.env.TG_API_HOST);process.env.DD_BOT_TOKEN&&(Wg=process.env.DD_BOT_TOKEN,process.env.DD_BOT_SECRET&&(Kg=process.env.DD_BOT_SECRET));process.env.QYWX_KEY&&(Jg=process.env.QYWX_KEY);process.env.QYWX_AM&&(Qg=process.env.QYWX_AM);process.env.IGOT_PUSH_KEY&&(Xg=process.env.IGOT_PUSH_KEY);process.env.PUSH_PLUS_TOKEN&&(Yg=process.env.PUSH_PLUS_TOKEN);process.env.PUSH_PLUS_USER&&(Zg=process.env.PUSH_PLUS_USER)}()}Ag.httpOverHttp=function(e){var t=new Og(e);return t.request=Sg.request,t},Ag.httpsOverHttp=function(e){var t=new Og(e);return t.request=Sg.request,t.createSocket=Ig,t.defaultPort=443,t},Ag.httpOverHttps=function(e){var t=new Og(e);return t.request=Fg.request,t},Ag.httpsOverHttps=function(e){var t=new Og(e);return t.request=Fg.request,t.createSocket=Ig,t.defaultPort=443,t},Bg.inherits(Og,Tg.EventEmitter),Og.prototype.addRequest=function(e,t,i,n){var s=this,o=jg({request:e},s.options,Pg(t,i,n));s.sockets.length>=this.maxSockets?s.requests.push(o):s.createSocket(o,(function(t){function i(){s.emit("free",t,o)}function n(e){s.removeSocket(t),t.removeListener("free",i),t.removeListener("close",n),t.removeListener("agentRemove",n)}t.on("free",i),t.on("close",n),t.on("agentRemove",n),e.onSocket(t)}))},Og.prototype.createSocket=function(e,t){var i=this,n={};i.sockets.push(n);var s=jg({},i.proxyOptions,{method:"CONNECT",path:e.host+":"+e.port,agent:!1,headers:{host:e.host+":"+e.port}});e.localAddress&&(s.localAddress=e.localAddress),s.proxyAuth&&(s.headers=s.headers||{},s.headers["Proxy-Authorization"]="Basic "+new Buffer(s.proxyAuth).toString("base64")),Eg("making CONNECT request");var o=i.request(s);function a(s,a,r){var c;return o.removeAllListeners(),a.removeAllListeners(),200!==s.statusCode?(Eg("tunneling socket could not be established, statusCode=%d",s.statusCode),a.destroy(),(c=new Error("tunneling socket could not be established, statusCode="+s.statusCode)).code="ECONNRESET",e.request.emit("error",c),void i.removeSocket(n)):r.length>0?(Eg("got illegal response body from proxy"),a.destroy(),(c=new Error("got illegal response body from proxy")).code="ECONNRESET",e.request.emit("error",c),void i.removeSocket(n)):(Eg("tunneling connection has established"),i.sockets[i.sockets.indexOf(n)]=a,t(a))}o.useChunkedEncodingByDefault=!1,o.once("response",(function(e){e.upgrade=!0})),o.once("upgrade",(function(e,t,i){process.nextTick((function(){a(e,t,i)}))})),o.once("connect",a),o.once("error",(function(t){o.removeAllListeners(),Eg("tunneling socket could not be established, cause=%s\n",t.message,t.stack);var s=new Error("tunneling socket could not be established, cause="+t.message);s.code="ECONNRESET",e.request.emit("error",s),i.removeSocket(n)})),o.end()},Og.prototype.removeSocket=function(e){var t=this.sockets.indexOf(e);if(-1!==t){this.sockets.splice(t,1);var i=this.requests.shift();i&&this.createSocket(i,(function(e){i.request.onSocket(e)}))}},Eg=process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments);"string"==typeof e[0]?e[0]="TUNNEL: "+e[0]:e.unshift("TUNNEL:"),console.error.apply(console,e)}:function(){},Ag.debug=Eg,Cg.exports=Ag;let Lg="",Ng="",Hg="",$g="QingLong",Ug="",qg="",Mg="",zg="",Gg="",Vg="api.telegram.org",Wg="",Kg="",Jg="",Qg="",Xg="",Yg="",Zg="",ev="",tv="";async function iv(e,t){var i;const n=null===(i=ap.config.message)||void 0===i?void 0:i.email;if(!(n&&n.pass&&n.from&&n.host))return;const s=Number(n.port)||465,o=function(e,t){let i,n,s;return("object"==typeof e&&"function"!=typeof e.send||"string"==typeof e&&/^(smtps?|direct):/i.test(e))&&(n=(i="string"==typeof e?e:e.url)?vg.parseConnectionUrl(i):e,e=n.pool?new xg(n):n.sendmail?new bg(n):n.streamTransport?new wg(n):n.jsonTransport?new _g(n):n.SES?new Dg(n):new yg(n)),s=new gg(e,n,t),s}({host:n.host,port:s,secure:465===s,auth:{user:n.from,pass:n.pass}}),a=await o.sendMail({from:`${e} <${n.from}>`,to:n.to,subject:e,headers:{"Content-Type":"text/plain; charset=utf-8"},text:t.replace(/\n/g,"\r\n")});oc.info(`邮件消息已发送: ${a.messageId}`)}async function nv(e,t){try{const i=ap.MESSAGE_API;if(!i)return;const n=i.replace("{title}",e).replace("{text}",t);await gh.get(n)}catch(e){oc.info(`自定义接口消息发送失败: ${e}`),oc.error(e)}}function sv(e,t,i=2100){return new Promise((n=>{if(Lg){t=t.replace(/[\n\r]/g,"\n\n");const s={url:Lg.includes("SCT")?`https://sctapi.ftqq.com/${Lg}.send`:`https://sc.ftqq.com/${Lg}.send`,params:`text=${e}&desp=${t}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};setTimeout((()=>{gh.post(s).then((e=>{0===e.errno||0===e.data.errno?oc.info("server酱发送通知消息成功🎉"):1024===e.errno?oc.info(`server酱发送通知消息异常: ${e.errmsg}`):oc.info(`server酱发送通知消息异常\n${JSON.stringify(e)}`)})).catch((e=>{oc.info("发送通知调用API失败！！"),oc.info(e)})).finally((()=>{n("")}))}),i)}else n("")}))}function ov(e,t){return new Promise((i=>{if(ev){const n={url:`https://push.xuthus.cc/${tv}/${ev}`,headers:{"Content-Type":"application/json"},data:{},params:{}};e=e.replace(/京豆/g,"豆豆"),t=(t=(t=t.replace(/京豆/g,"")).replace(/🐶/g,"")).replace(/红包/g,"H包"),"email"===tv?n.data={t:e,c:t}:n.params=`${e}\n\n${t}`;const s=function(e){switch(e){case"send":return"个人";case"group":return"QQ群";case"wx":return"微信";case"ww":return"企业微信";case"email":return"邮件";default:return"未知方式"}};gh.post(n).then((e=>{200===e.code?oc.info(`酷推发送${s(tv)}通知消息成功🎉`):400===e.code?oc.info(`QQ酷推(Cool Push)发送${s(tv)}推送失败：${e.msg}`):503===e.code?oc.info(`QQ酷推出错，${e.message}：${e.data}`):oc.info(`酷推推送异常: ${JSON.stringify(e)}`)})).catch((e=>{oc.info(`发送${s(tv)}通知调用API失败！！`),oc.info(e)})).finally((()=>{i("")}))}else i("")}))}function av(e,t,i={}){return new Promise((n=>{if(Ng){const s={url:`${Ng}/${encodeURIComponent(e)}/${encodeURIComponent(t)}?sound=${Hg}&group=${$g}&${gr(i)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};gh.get(s).then((e=>{200===e.code?oc.info("Bark APP发送通知消息成功🎉"):oc.info(`Bark APP发送通失败：${e.message}`)})).catch((e=>{oc.info("Bark APP发送通知调用API失败！！"),oc.error(e)})).finally((()=>{n("")}))}n("")}))}function rv(e,t){return new Promise((i=>{if(Ug&&qg){const n={url:`https://${Vg}/bot${Ug}/sendMessage`,params:`chat_id=${qg}&text=${e}\n\n${t}&disable_web_page_preview=true`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};if(Mg&&zg){const e=Cg.exports.httpsOverHttp({proxy:{host:Mg,port:+zg,proxyAuth:Gg},maxSockets:1});Object.assign(n,{httpsAgent:e})}gh.post(n).then((e=>{e.ok?oc.info("Telegram发送通知消息成功🎉。"):400===e.error_code?oc.info("请主动给bot发送一条消息并检查接收用户ID是否正确。"):401===e.error_code&&oc.info("Telegram bot token 填写错误。")})).catch((e=>{oc.info("telegram发送通知消息失败！！"),oc.info(e)})).finally((()=>{i("")}))}else i("")}))}function cv(e,t){return new Promise((i=>{const n={url:`https://oapi.dingtalk.com/robot/send?access_token=${Wg}`,data:{msgtype:"text",text:{content:` ${e}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};if(Wg){if(Kg){const e=require("crypto"),t=Date.now(),i=e.createHmac("sha256",Kg);i.update(`${t}\n${Kg}`);const s=encodeURIComponent(i.digest("base64"));n.url=`${n.url}&timestamp=${t}&sign=${s}`}gh.post(n).then((e=>{0===e.errcode?oc.info("钉钉发送通知消息成功🎉。"):oc.info(`钉钉发送通知失败：${e.errmsg}`)})).catch((e=>{oc.info("钉钉发送通知消息失败！！"),oc.info(e)})),i("")}else i("")}))}function pv(e,t){return new Promise((i=>{const n={url:`https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=${Jg}`,data:{msgtype:"text",text:{content:` ${e}\n\n${t}`}},headers:{"Content-Type":"application/json"},timeout:15e3};Jg&&gh.post(n).then((e=>{0===e.errcode?oc.info("企业微信发送通知消息成功🎉。"):oc.info(`企业微信发送通知失败：${e.errmsg}`)})).catch((e=>{oc.info("企业微信发送通知消息失败！！"),oc.info(e)})).finally((()=>{i("")})),i("")}))}function uv(e){const t=Qg.split(",");if(t[2]){const i=t[2].split("|");let n="";for(let t=0;t<i.length;t++){const s="签到号 "+(t+1);e.match(s)&&(n=i[t])}return n||(n=t[2]),n}return"@all"}function lv(e,t){return new Promise((i=>{if(Qg){const n=Qg.split(","),s={url:"https://qyapi.weixin.qq.com/cgi-bin/gettoken",data:{corpid:`${n[0]}`,corpsecret:`${n[1]}`},headers:{"Content-Type":"application/json"},timeout:15e3};gh.post(s).then((s=>{const o=t.replace(/\n/g,"<br/>"),a=JSON.parse(s).access_token;let r;switch(n[4]){case"0":r={msgtype:"textcard",textcard:{title:`${e}`,description:`${t}`,url:"https://github.com/whyour/qinglong",btntxt:"更多"}};break;case"1":r={msgtype:"text",text:{content:`${e}\n\n${t}`}};break;default:r={msgtype:"mpnews",mpnews:{articles:[{title:`${e}`,thumb_media_id:`${n[4]}`,author:"智能助手",content_source_url:"",content:`${o}`,digest:`${t}`}]}}}n[4]||(r={msgtype:"text",text:{content:`${e}\n\n${t}`}}),r={url:`https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=${a}`,data:{touser:`${uv(t)}`,agentid:`${n[3]}`,safe:"0",...r},headers:{"Content-Type":"application/json"}},gh.post(r).then((e=>{0===e.errcode?oc.info("成员ID:"+uv(t)+"企业微信应用消息发送通知消息成功🎉。"):oc.info(`企业微信应用：${e.errmsg}`)})).catch((e=>{oc.info("成员ID:"+uv(t)+"企业微信应用消息发送通知消息失败！！"),oc.info(e)})).finally((()=>{i("")}))})).catch((e=>{oc.error("企业微信应用消息发送通知消息失败！！")}))}else i("")}))}function dv(e,t,i={}){return new Promise((n=>{if(Xg){if(!new RegExp("^[a-zA-Z0-9]{24}$").test(Xg))return oc.info("您所提供的IGOT_PUSH_KEY无效"),void n("");const s={url:`https://push.hellyw.com/${Xg.toLowerCase()}`,params:`title=${e}&content=${t}&${gr(i)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};gh.post(s).then((e=>{"string"==typeof e&&(e=JSON.parse(e)),0===e.ret?oc.info("iGot发送通知消息成功🎉"):oc.info(`iGot发送通知消息失败：${e.errMsg}`)})).catch((e=>{oc.info("发送通知调用API失败！！"),oc.info(e)})).finally((()=>{n("")}))}else n("")}))}function hv(e,t){return new Promise((i=>{if(Yg){t=t.replace(/[\n\r]/g,"<br>");const n={url:"https://www.pushplus.plus/send",params:{token:`${Yg}`,title:`${e}`,content:`${t}`,topic:`${Zg}`},headers:{"Content-Type":" application/json"},timeout:15e3};gh.post(n).then((e=>{200===e.code?oc.info(`push+发送${Zg?"一对多":"一对一"}通知消息完成。`):oc.info(`push+发送${Zg?"一对多":"一对一"}通知消息失败：${e.msg}`)})).catch((e=>{oc.info(`push+发送${Zg?"一对多":"一对一"}通知消息失败！！`),oc.info(e)})).finally((()=>{i("")}))}else i("")}))}async function mv(e,t){oc.info("----【消息推送】----"),e=`Bili-${rp.nickname}-${e}`,await async function(e,t,i={},n="\n\n本通知 By：https://github.com/catlair/BiliTools"){Rg(),t+=n,await Promise.all([sv(e,t),hv(e,t)]),await Promise.all([av(e,t,i),rv(e,t),cv(e,t),pv(e,t),lv(e,t),dv(e,t,i),iv(e,t),nv(e,t),ov(e,t)])}(e,t,void 0,"")}const fv=fh({baseURL:Xa,headers:{"user-agent":ap.USER_AGENT}}),gv=fh({baseURL:Ya,headers:{Referer:Qa,"user-agent":ap.USER_AGENT}}),vv=fh({baseURL:Za,headers:{Referer:Qa,"user-agent":ap.USER_AGENT}}),xv=fh({baseURL:er,headers:{"user-agent":ap.USER_AGENT}}),yv=fh({baseURL:tr,headers:{"user-agent":ap.USER_AGENT}});function bv(e=1,t=50,i=1){return gv.get(`/xlive/app-ucenter/v1/fansMedal/panel?page=${e}&page_size=${t}&target_id=${i}`)}function wv({ruid:e,gift_num:t,bag_id:i,gift_id:n,roomid:s}){const o=ap.BILIJCT,a=o,r={gift_id:n,ruid:e,gift_num:t,bag_id:i,biz_id:s,rnd:(new Date).getTime(),send_ruid:0,storm_beat_id:0,metadata:"",price:0,visit_id:"",csrf:o,platform:"pc",biz_code:"Live",csrf_token:a,uid:ap.USERID};return gv.post("/xlive/revenue/v2/gift/sendBag",r,{headers:{Origin:Va}})}function _v(){return vv.get("/x/web-interface/nav",{headers:{Origin:Ga}})}function Dv(){return vv.get("/x/web-interface/coin/today/exp")}function Ev(e=1,t=50,i=-10){return vv.get("/x/relation/tag",{params:{tagid:i,pn:e,ps:t}})}function Cv(e,t){return vv.post("/x/relation/tags/addUsers?cross_domain=true",{fids:e,tagids:t,csrf:ap.BILIJCT},{headers:{Origin:Wa}})}function Av(e){const t=e.level_info,i=t.current_level;if(i>=ap.BILI_TARGET_LEVEL&&(rp.coinsTask=0),oc.info(`当前等级: ${t.current_level}`),i>=6){const e=ap.config.function;e.shareAndWatch=!1,e.addCoins=!1,e.taskReward=!1,oc.info("已经满级，不需要再投币了，做个白嫖怪吧")}else{const e=t.next_exp-t.current_exp;oc.info(`距离升级还需要 ${e} 经验，预计 ${function(e){if(ap.BILI_TARGET_COINS<=0)return e/15;const t=10*ap.BILI_TARGET_COINS+15,i=e/t,n=rp.money/(ap.BILI_TARGET_COINS-1);return i<n?Math.floor(i):(e-n*t)/25+n}(e).toFixed(2)} 天`)}}async function kv(e){try{var t;const{data:i}=await fv.get("/site/getCoin");oc.info(`登录成功: ${e.uname}`),oc.info(`硬币余额: ${i.money||0}`),rp.nickname=function(e){const t=e.length;return t<=3?e:`${e[0]}**${e[t-1]}`}(e.uname),rp.money=i.money||0,rp.userLevel=e.level_info.current_level,rp.bCoinCouponBalance=(null===(t=e.wallet)||void 0===t?void 0:t.coupon_balance)||0,Av(e),function(e){let t="";switch(rp.vipType=e.vipType,e.vipType){case 0:t="无大会员";break;case 1:t="月度大会员";break;case 2:t="年度大会员"}0===e.vipStatus&&(t="无大会员"===t?t:t+"[已过期]"),oc.info(`大会员状态: ${t}`)}(e)}catch(e){oc.error(`获取硬币信息异常: ${e.message}`),oc.debug(e)}}function Sv(e,t,i=1){return vv.post("/x/web-interface/coin/add",{aid:e,multiply:t,selectLike:i,csrf:ap.BILIJCT})}function Fv(e,t=1){return vh.post("https://www.bilibili.com/audio/music-service-c/web/coin/add",{sid:e,multiply:t,csrf:ap.BILIJCT})}const Tv="video",Bv="audio",Ov="article";async function Iv(e=!0){try{const t=ap.USERID,{data:i,message:n,code:s}=await(e?function(e=1,t=50){return Ev(e,t,-10)}():function(e,t=1,i=50,n="desc",s="attention"){return vv.get("/x/relation/followings",{params:{vmid:e,pn:t,ps:i,order:n,order_type:s}})}(t)),o=e?i:i.list;if(!o||0===o.length)return{msg:"-1",data:{}};if(0===s){await bh();const{mid:e}=vr(o)||{};return await Rv(e)}return{msg:e?`未获取到特别关注列表: ${s}-${n}`:`未获取到关注列表: ${s}-${n}`,data:{}}}catch(e){return{msg:e.message,data:{}}}}async function Pv(){const e=vr([1,3,4,5,160,22,119]);try{const{data:t,message:i,code:n}=await function(e=1,t=3){return vv.get("/x/web-interface/ranking/region",{params:{rid:e,day:t}})}(e,3);if(0==n){const{aid:e,title:i,author:n}=vr(t);return{msg:"0",data:{id:Number(e),title:i,author:n}}}return{msg:`未获取到排行信息: ${n}-${i}`,data:{}}}catch(e){return{msg:e.message,data:{}}}}async function jv(){const e=ap.BILI_CUSTOMIZE_UP;return 0===e.length?{msg:"-1",data:{}}:await Rv(vr(e))}async function Rv(e){try{const{code:t,data:i,message:n}=await function(e){return vv.get(`/x/space/navnum?mid=${e}`)}(e);if(t)return{msg:`通过uid获取视频失败: ${t}-${n}`,data:{}};await bh();const{video:s,audio:o,article:a}=i,{type:r,page:c,index:p}=function([e,t,i]){const n=e+t+i;if(!n)return;const s=lr(0,n-1);let o=s;if(s<e)return{type:Tv,page:ur(30,o+1),index:o%30};const a=e+t;return o=s-e,s<a?{type:Bv,page:ur(30,o+1),index:o%30}:(o=s-a,{type:Ov,page:ur(12,o+1),index:o%12})}([s,o,a]),u={[Tv]:Lv,[Bv]:Nv,[Ov]:Hv},l=await u[r](e,c,p);return l.message?{msg:l.message,data:{}}:{msg:"0",data:l}}catch(e){return oc.debug(e),{msg:e.message,data:{}}}}async function Lv(e,t,i){const{code:n,data:s,message:o}=await function(e,t=30,i=1,n=""){return vv.get("/x/space/arc/search",{params:{jsonp:"jsonp",order:"pubdate",keyword:n,pn:i,tid:0,ps:t,mid:e}})}(e,30,t);if(n)return{message:o};const{aid:a,title:r,author:c}=s.list.vlist[i];return{type:Tv,id:a,title:r,author:c}}async function Nv(e,t,i){const{code:n,data:s,msg:o}=await function(e,t=30,i=1){return vv.get("/audio/music-service/web/song/upper",{params:{jsonp:"jsonp",order:1,pn:i,ps:t,uid:e}})}(e,30,t);if(n)return{message:o};const{data:a}=s,{id:r,uname:c,title:p}=a[i];return{type:Bv,id:r,title:p,author:c}}async function Hv(e,t,i){const{code:n,data:s,message:o}=await function(e,t=12,i=1){return vv.get("/x/space/article",{params:{callback:"__test",jsonp:"jsonp",sort:"publish_time",pn:i,ps:t,mid:e},requestOptions:{isJsonp:!0}})}(e,12,t);if(n)return{message:o};const{articles:a}=s,{id:r,title:c,author:{name:p}}=a[i];return{type:Ov,id:r,title:c,author:p,mid:e}}const $v=function(){const e=[jv,Iv,()=>Iv(!1),Pv];return ap.BILI_CUSTOMIZE_UP||e.shift(),e}();async function Uv(e=0){$v.splice(0,rp.currentStartFun+e);for(let e=0;e<$v.length;e++){const t=$v[e];let i=Number(ap.BILI_COIN_RETRY_NUM??4);for(i=i<1?1:i>8?8:i;i--;){await bh();const e=await t();if("-1"===e.msg&&(i=0),"0"===e.msg)return e}i<=0&&(rp.currentStartFun=e)}return{msg:"-1",data:{id:0}}}async function qv({id:e,coin:t=1,type:i="video",mid:n}){const s={[Tv]:Sv,[Bv]:Fv,[Ov]:(e,t=1)=>function(e,t,i=1){return vv.post("/x/web-interface/coin/add",{aid:t,upid:e,avtype:2,multiply:i,csrf:ap.BILIJCT})}(n,e,t)},o=await s[i](Number(e),t);return{code:o.code,message:o.message||o.msg}}async function Mv(e){if(await async function(){try{const{data:e,code:t}=await Dv();if(0==t){const t=ap.BILI_TARGET_COINS-e/10;rp.coinsTask=t>0?t:0}}catch(e){}}(),rp.coinsTask<=0||rp.money<=0)return!0;const{data:t,msg:i}=await Uv(e.priority);return null!=t&&t.id&&"0"==i?(await bh(),await async function(e,t){const{id:i,title:n,author:s,type:o,mid:a}=e;try{const e=await qv({id:i,type:o,mid:a});if(0===e.code)rp.money--,rp.coinsTask--,t.num++,oc.info(`给[${n}--up【${s}】]投币成功`);else if(34005===e.code)t.fillCount++,oc.verbose(`当前稿件[${i}]不能再投币了`),t.fillCount>=3&&(oc.warn("自定义用户组投币似乎没有币可投了"),t.priority++);else{if(-111===e.code||-104===e.code)return oc.warn(`${i} ${e.message} 无法继续进行投币`),!0;if(t.eCount++,oc.warn(`给${i}投币失败 ${e.code} ${e.message}`),t.prevCode===e.code)return!0;t.prevCode=e.code}}catch(e){t.eCount++,oc.error(`投币异常 ${e.message}`)}finally{await bh(1500)}return!1}(t,e)):(e.eCount++,!1)}async function zv(){try{const{data:e,code:t,message:i}=await yv.get("/link_group/v1/member/my_groups");return 0===t?(null==e?void 0:e.list)||[]:(oc.warn(`获取自己的应援团异常失败: ${i}`),[])}catch(e){oc.error(`获取自己的应援团异常: ${e}`)}}const Gv=["(⌒▽⌒)","（￣▽￣）","(=・ω・=)","(｀・ω・´)","(〜￣△￣)〜","(･∀･)","(°∀°)ﾉ","(￣3￣)","╮(￣▽￣)╭","_(:3」∠)_","( ´_ゝ｀)","←_←","→_→","(<_<)","(>_>)","(;¬_¬)","(ﾟДﾟ≡ﾟдﾟ)!?","Σ(ﾟдﾟ;)","Σ( ￣□￣||)","(´；ω；`)","（/TДT)/","(^・ω・^ )","(｡･ω･｡)","(●￣(ｴ)￣●)","ε=ε=(ノ≧∇≦)ノ","(´･_･`)","(-_-#)","（￣へ￣）","(￣ε(#￣) Σ","ヽ(`Д´)ﾉ","（#-_-)┯━┯","(╯°口°)╯(┴—┴","←◡←","( ♥д♥)","Σ>―(〃°ω°〃)♡→","⁄(⁄ ⁄•⁄ω⁄•⁄ ⁄)⁄","(╬ﾟдﾟ)▄︻┻┳═一","･*･:≡(　ε:)","(汗)","(苦笑)"].concat("1","2","3","4","5","6","7","8","9","签到","哈哈"),Vv=new sc({console:"debug",file:"debug"},"live");async function Wv(){let e=99,t=0;const i=[];try{for(;t<e;){const{code:n,message:s,data:o}=await bv(t+1,50,ap.USERID);if(0!==n)return oc.verbose(`获取勋章信息失败 ${n} ${s}`),null;if(!o)return i;e=o.page_info.total_page,t=o.page_info.current_page,i.push(...o.list,...o.special_list)}return i}catch(e){return oc.error(`获取勋章异常 ${e.message}`),null}}function Kv({room_info:e,medal:t}){if(null==e||!e.room_id)return!1;if(t.level>=20)return!1;if(t.today_feed>=t.day_limit)return!1;const{whiteList:i,blackList:n}=ap.intimacy;return i&&i.length?!!i.includes(e.room_id):!n||!n.includes(e.room_id)}async function Jv(e,t){const i=Gv[lr(Gv.length-1)];try{const{code:n,message:s}=await function(e,t){const i=ap.BILIJCT,n=i;return t||(t=lr(10).toString()),gv.post("/msg/send",{color:5566168,fontsize:25,mode:1,msg:t,rnd:Date.now(),roomid:e,bubble:0,csrf:i,csrf_token:n})}(e,i);return 0===n||(11e3===n?(oc.warn(`【${t}】${e}-可能未开启评论`),!1):(oc.warn(`【${t}】${e}-发送失败 ${s}`),oc.verbose(`code: ${n}`),!1))}catch(e){oc.verbose(`发送弹幕异常 ${e.message}`)}}async function Qv(e){try{const{code:i,message:n,data:s}=await(t=e,gv.post("xlive/web-room/v1/index/TrigerInteract",{roomid:t,interact_type:3,csrf:ap.BILIJCT,csrf_token:ap.BILIJCT,visit_id:""}));if(0===i)return s;oc.info(`【${e}】直播间分享失败 ${i} ${n}`)}catch(t){oc.warn(`分享直播间 [${e}] 异常 ${t.message}`)}var t}async function Xv(e){try{const{code:i,message:n,data:s}=await(t=e,gv.post("xlive/web-ucenter/v1/interact/likeInteract",{roomid:t,csrf:ap.BILIJCT,csrf_token:ap.BILIJCT}));if(0===i)return s;oc.info(`【${e}】直播间点赞失败 ${i} ${n}`)}catch(e){oc.warn(`点赞直播间异常 ${e.message}`)}var t}async function Yv(){const e=(t=await Wv())&&0!==t.length?t.filter(Kv):[];var t;for(let t=0;t<e.length;t++){const i=e[t];await Zv(i)}}async function Zv(e){const{room_info:t,anchor_info:i}=e;if(!t||!i)return;const{liveLike:n,liveSendMessage:s,liveShare:o}=ap.intimacy,a=i.nick_name,r=t.room_id;s&&(Vv.verbose(`【${a}】开始发送直播弹幕`),await Jv(r,a)),o&&async function(){await bh(100,300);for(let e=0;e<5;e++)Vv.verbose(`分享 [${a}] 直播间`),await Qv(r),await bh(4e3)}().catch((e=>oc.error(e))),n&&async function(){await bh(100,300);for(let e=0;e<3;e++)Vv.verbose(`给 [${a}] 直播间点赞`),await Xv(r),await bh(6500)}().catch((e=>oc.error(e))),await bh(22e3)}async function ex(){try{const{data:e,message:t,code:i}=await _v();if(0!==i)return void oc.warn(`获取用户信息失败：${i} ${t}`);!function(e){var t;rp.bCoinCouponBalance=(null===(t=e.wallet)||void 0===t?void 0:t.coupon_balance)||0}(e)}catch(e){oc.error(`获取用户信息异常：${e.message}`)}}var tx;function ix(){const e=pr(),t=e.getDate(),i=function(e){const t=e||pr(),i=t.getFullYear(),n=t.getMonth()+1;return 2===n?i%4==0&&i%100!=0||i%400==0?29:28:[4,6,9,11].includes(n)?30:31}(e),n=ap.CHARGE_PRESET_TIME;return rp.bCoinCouponBalance<2?(oc.info(`剩余券为${rp.bCoinCouponBalance}，不足2跳过充电`),!1):i===t?(oc.info("今天是最后一天了"),!0):!(n>t)||(oc.info(`预设时间为${n}，不符合条件`),!1)}async function nx(){try{const{data:e,code:t,message:i}=await vv.get("/x/vip/privilege/my",{headers:{origin:Ga,referer:Qa}});if(0!==t)return void oc.info(`获取领取状态失败：${t} ${i}`);const{list:n}=e;return n.slice(0,2).filter((e=>{const t=parseInt(((new Date).getTime()/1e3).toString());return 0===e.state&&t>e.period_end_unix}))}catch(e){oc.error(`获取领取状态出现异常：${e.message}`)}}async function sx(e){try{const t=function(e){switch(e){case 1:return"B 币券";case 2:return"大会员优惠券";default:return""}}(e),{code:i,message:n}=await function(e=1){return vv.post("/x/vip/privilege/receive",{csrf:ap.BILIJCT,type:e},{headers:{origin:Ja,referer:Qa}})}(e);let s="成功";return 0===i&&(s=`失败 ${n}`),oc.info(`领取${t} ${s}`),!0}catch(e){oc.error(`领取权益出现异常：${e.message}`)}return!1}async function ox(e){let t=0,i=!1;for(;!(i||(i=await sx(e),t>2));)t++;return i}!function(e){e[e["成功"]=4]="成功",e[e["低于20电池"]=-2]="低于20电池",e[e["B币不足"]=-4]="B币不足"}(tx||(tx={}));let ax=0;async function rx(){try{const{data:{list:e}}=await function(e=3394945){const t=(new Date).getTime();return gv.get(`/xlive/web-room/v1/gift/bag_list?t=${t}&room_id=${e}`)}();return e.filter((e=>{if(e.expire_at<=0)return!1;const t=(1e3*e.expire_at-(new Date).getTime())/864e5<2,i=![1,30607].includes(e.gift_id);return i&&t&&oc.info(`${e.gift_name} 即将过期请尽快投喂`),!i&&t}))}catch(e){if(ax)return null;await rx(),ax++}}async function cx(e){try{const{data:{live_room:t,name:i}}=await function(e){return vv.get(`/x/space/acc/info?mid=${e}&jsonp=jsonp`)}(e);if(await bh(),t.roomStatus)return{roomid:t.roomid,name:i}}catch{}}function px(e,t,i,n){const s=ap.BILIJCT,o={is_fav:0,main_id:t,oid:e,detail_id:i,count:n,csrf:s,csrf_token:s};return vv.post("/x/esports/guess/add",o)}function ux(){return rp.money-ap.MATCH_COINS<ap.BILI_TARGET_COINS&&(oc.info(`需要保留${ap.BILI_TARGET_COINS}个硬币，任务结束`),!0)}async function lx(){const{data:e,code:t}=await Ev(1,1,0);if(0!==t)throw new Error(`获取最后一个关注失败: ${t}`);return e[0]}async function dx(e){const{data:t,code:i}=await vv.get("/x/relation/tags?jsonp=jsonp&callback=__jp3",{headers:{Referer:"https://space.bilibili.com/1/fans/follow?tagid=0"},requestOptions:{isJsonp:!0}});if(0===i)return t.find((t=>t.name===e));oc.warn(`获取分组列表失败: ${i}`)}async function hx(e){const t=await dx(e);if(t)return t.tagid;await bh(300);const{data:i,code:n,message:s}=await function(e){return vv.post("/x/relation/tag/create",{tag:e,jsonp:"jsonp",csrf:ap.BILIJCT})}(e);if(22106===n){await bh(300);const t=await dx(e);return t&&t.tagid}return 0!==n&&oc.warn(`创建分组失败: ${n}-${s}`),i.tagid}async function mx(e,t="天选时刻"){if(0===e.length)return;const i=await hx(t);if(i)for(const t of e){const{code:e,message:n}=await Cv(t.mid,i);0!==e&&oc.warn(`移动【${t.uname}】失败: ${e}-${n}`),await bh()}}async function fx(e,t,i,n=1){if(e.length>t.length)return;const{data:s,code:o,message:a}=await Ev(n,20,0);if(0===o){for(const{mid:n,uname:o}of s){if(e.length>=t.length)return;if(n===i)return;(t.includes(n)||t.includes(o))&&e.push({mid:n,uname:o})}if(!(s.length<20))return await fx(e,t,i,n+1)}else oc.warn(`获取关注用户失败: ${o}-${a}`)}const gx=0,vx=1,xx=5,yx=1,bx=504,wx=1096;let _x;async function Dx(){try{const{data:e,code:t,message:i}=await gv.get("/xlive/web-interface/v1/index/getWebAreaList?source_id=2");return 0!==t&&oc.info(`获取直播分区失败: ${t}-${i}`),e.data.map((e=>e.list)).map((e=>e.map((e=>({areaId:e.id,parentId:e.parent_id})))))}catch(e){throw oc.error(`获取直播分区异常: ${e.message}`),e}}async function Ex(e,t,i=1,n="lottery"){try{await bh(100);const{data:s,code:o,message:a}=await function(e,t,i=1){return gv.get(`/xlive/web-interface/v1/second/getList?platform=web&parent_area_id=${e}&area_id=${t}&page=${i}`)}(t,e,i);return 0!==o&&oc.info(`获取直播间列表失败: ${o}-${a}`),function(e){const t=[],i=[];return e.forEach((e=>{const n=e.pendant_info[2];n&&(n.pendent_id===bx?t.push(e):n.pendent_id===wx&&i.push(e))})),{lotteryTime:t,lotteryPacket:i}}(s.list)["lottery"===n?"lotteryTime":"lotteryPacket"]}catch(e){throw oc.error(`获取直播间列表异常: ${e.message}`),e}}async function Cx(e,t,i=1){const n=await Ex(e,t,i),s=[];for(const e of n){const t=await Ax(e);t&&(s.push({...t,uid:e.uid,uname:e.uname}),await bh(100))}return s}async function Ax(e){if(ap.LOTTERY_UP_BLACKLIST.includes(e.uid))return void oc.info(`跳过黑名单用户: ${e.uname}`);let t,i,n;try{({data:i,code:t,message:n}=await(s=e.roomid,gv.get(`/xlive/lottery-interface/v1/Anchor/Check?roomid=${s}`)))}catch(t){return void oc.info(`直播间${e.roomid}检测异常: ${t.message}`)}var s;if(0!==t)return void oc.debug(`直播间${e.roomid}检测失败: ${t}-${n}`);if(null===i)return;const o=ap.LOTTERY_EXCLUDE.some((e=>i.award_name.match(e)));if(!ap.LOTTERY_INCLUDE.some((e=>i.award_name.match(e)))&&o)oc.info(`跳过屏蔽奖品: ${i.award_name}`);else if(i.status!==yx);else if(i.gift_price>0);else{if(i.require_type===gx||i.require_type===vx)return i;if(i.require_type===xx&&rp.userLevel>=i.require_value)return i}}async function kx(e){try{const{id:i,gift_id:n,gift_num:s,award_name:o,uid:a,uname:r,require_type:c,require_text:p}=e;oc.info(`天选主播：【${r}】`),oc.info(`奖品：${o}`);const{code:u,message:l}=await(t={id:i,gift_id:n,gift_num:s},gv.post("/xlive/lottery-interface/v1/Anchor/Join",{...t,csrf:ap.BILIJCT,csrf_token:ap.BILIJCT,visit_id:dr(),platform:"pc"}));if(0!==u)return void oc.info(`天选失败: ${u}-${l}`);if(oc.info("天选成功 √"),c===vx){hr(_x,a);(function(e){const t=(e=e.replace("关注主播","")).split(/\s*\+\s*/);return t.shift(),t})(p).forEach((e=>hr(_x,e)))}}catch(e){oc.info(`天选异常: ${e.message}`)}var t}async function Sx(e,t,i=2){for(let n=1;n<=i;n++){const i=await Cx(e,t,n);for(const e of i)await kx(e),await bh(300)}}async function Fx(e){try{const{data:t,code:i}=await function(e){return gv.get(`/xlive/lottery-interface/v1/lottery/getLotteryInfoWeb?roomid=${e}`)}(e);if(0!==i)return;const{popularity_red_pocket:n}=t;if(!n)return;const{lot_id:s,lot_status:o}=n[0];if(2===o)return;return s}catch(e){}}async function Tx(e,t,i=1){const n=await Ex(e,t,i,"redPack"),s=[];for(const e of n){const t=await Fx(e.roomid);t&&(s.push({uid:e.uid,uname:e.uname,lot_id:t,room_id:e.roomid}),await bh(100))}return s}async function Bx(e){try{const{lot_id:i,uid:n,uname:s,room_id:o}=e;oc.info(`红包主播：【${s}】`);const{code:a,message:r}=await(t={room_id:o,lot_id:i,ruid:n},gv.post("/xlive/lottery-interface/v1/popularityRedPocket/RedPocketDraw",{...t,spm_id:"444.8.red_envelope.extract",jump_from:"",session_id:"",csrf_token:ap.BILIJCT,csrf:ap.BILIJCT,visit_id:""}));if(0!==a)return void oc.info(`红包失败: ${a}-${r}`);_x.push(n),oc.info("红包成功 √")}catch(e){oc.info(`红包异常: ${e.message}`)}var t}async function Ox(e,t,i=2){for(let n=1;n<=i;n++){const i=await Tx(e,t,n);for(const e of i)await Bx(e),await bh(200)}}async function Ix(e){try{const{code:t,message:i,data:n}=await function({session_type:e}={session_type:1}){return yv.get(`/session_svr/v1/session_svr/get_sessions?session_type=${e}&group_fold=1&unfollow_fold=1&sort_rule=2&build=0&mobi_app=web`)}();if(0!==t)return void oc.warn(`获取会话失败：${t}-${i}`);const{session_list:s}=n;if(s.length<=0)return;return s.filter((({unread_count:t,talker_id:i,is_follow:n,last_msg:s})=>{return e.find((e=>e.mid===i))&&t>0&&i===s.sender_uid&&1===n&&(o=s.timestamp,Date.now()-1e3*o<36e5);var o}))}catch(e){oc.error(`获取会话异常：${e.message}`)}}async function Px(e){const t=await Ix(e);await bh(200);try{for(let e=0;e<t.length;e++){const i=t[e];await jx(i)}}catch(e){oc.error(`更新会话异常：${e.message}`)}t.length>=19&&await Px(e)}async function jx(e){switch(ap.lottery.actFollowMsg){case"del":case"delete":await function({talker_id:e,session_type:t}){return yv.post("/session_svr/v1/session_svr/remove_session",{talker_id:e,session_type:t,build:0,mobi_app:"web",csrf_token:ap.BILIJCT,csrf:ap.BILIJCT})}(e);break;case"read":await function({talker_id:e,session_type:t,ack_seqno:i}){return yv.post("/session_svr/v1/session_svr/update_ack",{talker_id:e,session_type:t,ack_seqno:i,build:0,mobi_app:"web",csrf_token:ap.BILIJCT,csrf:ap.BILIJCT},{headers:{origin:Ka}})}(e)}await bh(50)}var Rx={taskReward:async function(){oc.info("----【每日任务完成情况】----");try{const{data:e,message:t,code:i}=await vv.get("/x/member/web/exp/reward");await bh();const{data:n}=await Dv();if(0!=i)return void oc.warn(`状态获取失败: ${i} ${t}`);const s=rp.money-ap.BILI_STAY_COINS;let o=0;0===rp.coinsTask?oc.info(`今日投币获取经验: ${n}，还需投币0颗，经验够了，不想投了`):s<=0?oc.info(`今日投币获取经验: ${n}，还需投币0颗，硬币不够了，不投币了`):s<rp.coinsTask?(o=rp.coinsTask-s,oc.info(`投币获取经验: ${n}，还需投币数量: ${o}颗;(目标${rp.coinsTask}颗，忽略部分投币)`)):(o=rp.coinsTask-n/10,oc.info(`投币获取经验: ${n}，还需投币数量: ${o}颗;(目标${rp.coinsTask}颗)`)),rp.coinsTask=o,oc.info("每日分享: "+(e.share?"已完成":"[未完成]")),oc.info("每日播放: "+(e.watch?"已完成":"[未完成]")),rp.share=e.share,rp.watch=e.watch}catch(e){oc.error(`状态获取异常 ${e.message}`)}},liveSignTask:async function(){oc.info("----【直播签到】----");try{const{data:e}=await gv.get("/xlive/web-ucenter/v1/sign/WebGetSignInfo");if(1===e.status)return oc.info("已签到，跳过签到"),void oc.info(`已经签到${e.hadSignDays}天，${e.specialText}`)}catch(e){}try{const{code:e,data:t,message:i}=await gv.get("/xlive/web-ucenter/v1/sign/DoSign");0===e?oc.info(`直播签到成功: ${t.text}，特别信息: ${t.specialText}，本月签到天数: ${t.hadSignDays}天;`):oc.warn(`直播签到失败: ${e} ${i}`)}catch(e){oc.error(`直播签到异常: ${e.message}`)}},shareAndWatch:async function(){if(oc.info("----【分享/播放视频】----"),rp.share&&rp.watch)return void oc.info("已完成，跳过分享/播放");let e=0;try{let t=await Uv();if("-1"===t.msg&&(t=await Pv()),"0"!==t.msg)return oc.warn(`获取视频失败 ${t.msg}`),!1;{const{id:i,author:n,title:s}=t.data;e=i,oc.info(`获取视频: ${s} --up【${n}】`)}}catch(e){return oc.error(`获取视频出现异常: ${e.message}`),!1}if(!rp.share){await bh();try{const{code:t,message:i}=await function(e){const t={csrf:ap.BILIJCT,aid:e};return vv.post("/x/web-interface/share/add",t)}(e);0===t?oc.info("分享视频成功!"):oc.warn(`分享视频失败: ${t} ${i}`)}catch(e){oc.error(`分享视频异常: ${e.message}`)}}if(!rp.watch){await bh();try{const{code:n,message:s}=await(t=e,i=lr(4,60),vv.post("/x/click-interface/web/heartbeat",{aid:t,played_time:i}));0===n?oc.info("播放视频成功!"):oc.warn(`播放视频失败: ${n} ${s}`)}catch(e){oc.error(`播放视频异常: ${e.message}`)}}var t,i},silver2Coin:async function(){oc.info("----【银瓜子兑换硬币】----");try{const{data:e,code:t,message:i}=await gv.get("/xlive/revenue/v1/wallet/getStatus");if(0!=t&&oc.info(`获取瓜子详情失败 ${i}`),0===e.silver_2_coin_left)oc.info("今日已兑换一次");else if(e.silver<700)oc.info("兑换失败，你瓜子不够了");else{const{message:e}=await gv.post("/xlive/revenue/v1/wallet/silver2coin",{csrf_token:ap.BILIJCT,csrf:ap.BILIJCT});oc.info(`兑换硬币： ${e}`),await gv.get("/xlive/revenue/v1/wallet/myWallet?need_bp=1&need_metal=1&platform=pc")}}catch(e){oc.error(`操作异常 ${e.message}`)}},addCoins:async function(){if(oc.info("----【视频投币】----"),!rp.coinsTask)return void oc.info("跳过投币，今日已完成");const e={eCount:0,num:0,prevCode:0,fillCount:0,priority:0};let t=!1;for(;rp.coinsTask&&!t&&e.eCount<5;)t=await Mv(e);e.eCount>=5&&oc.info("出现异常/错误5次，自动退出投币"),oc.info(`一共成功投币${e.num}颗`),oc.info(`硬币还剩${rp.money}颗`)},mangaSign:async function(){oc.info("----【漫画签到】----");try{const{code:e}=await function(e="android"){return xv.post("/twirp/activity.v1.Activity/ClockIn",{platform:e})}();0==e?oc.info("漫画签到成功"):oc.warn("漫画签到失败")}catch(t){var e;400===(null===(e=t.response)||void 0===e?void 0:e.status)?oc.info("已经签到过了，跳过任务"):oc.error(`漫画签到异常 ${t.message}`)}},supGroupSign:async function(){oc.info("----【应援团签到】----");const e=await zv();await bh();let t=0;for(let s=0;s<e.length;){const o=e[s];try{const{data:e,code:s,message:a}=await(i=o.group_id,n=o.owner_uid,yv.get("/link_setting/v1/link_setting/sign_in",{params:{group_id:i,owner_id:n}}));0===s?0===e.status?t++:oc.info(a):oc.warn(`[${o.group_name}]签到失败 ${a}`)}catch(e){oc.error(`签到异常 ${e.message}`)}finally{await bh()}}var i,n;oc.info(`签到结束，成功${t}/${e.length}`)},liveSendMessage:async function(){oc.info("----【发送直播弹幕】----"),oc.info("该函数即将废弃，请使用 liveIntimacy 替代");try{const e=await Wv(),t=e.length;let i=0,n=0;oc.info(`一共需要发送${t}个直播间`),oc.verbose("所需时间可能很长，请耐心等待");for(let s=0;s<t;s++){const{room_info:o,anchor_info:a,medal:r}=e[s];null!=o&&o.room_id?100===r.today_feed||r.level>=20?n++:(await Jv(o.room_id,a.nick_name)&&i++,s<t-1&&await bh(lr(1e4,25e3))):(oc.info(`【${a.nick_name}】没有直播间哦`),n++)}oc.info(`成功发送${i}个弹幕，跳过${n}个`)}catch(e){oc.error(`直播间发送弹幕异常: ${e.message}`)}},charging:async function(){if(oc.info("----【给目标充电】----"),await ex(),await bh(),ix())try{const e=rp.bCoinCouponBalance||0,t=ap.CHARGE_ID;let i=0;oc.info(`b 币券余额${e}`);const n=async()=>{const{code:i,message:n,data:s}=await function(e=50,t=!0,i=ap.USERID,n="up",s=i){return vv.post("/x/ugcpay/web/v2/trade/elec/pay/quick",{csrf:ap.BILIJCT,bp_num:e,is_bp_remains_prior:t,up_mid:i,otype:n,oid:s})}(e,!0,t);0===i?(oc.info(`【充值结果】${tx[s.status]}`),s.status===tx["成功"]&&(rp.chargeOrderNo=s.order_no,await bh(),await async function(){try{if(!rp.chargeOrderNo)return!1;const e=nr[lr(0,nr.length-1)],{code:t}=await function(e,t="支持大佬一波"){return vv.post("/x/ugcpay/trade/elec/message",{csrf:ap.BILIJCT,message:t,order_id:e})}(rp.chargeOrderNo,e);0===t&&oc.info("留言成功！")}catch{}}())):oc.warn(`充电失败：${i} ${n}`)};for(rp.chargeOrderNo="";!(rp.chargeOrderNo||(await n(),await bh(),i++>2)););}catch(e){oc.error(`充电出现异常：${e.message}`)}},getVipPrivilege:async function(){try{if(oc.info("----【领取大会员权益】----"),2!==rp.vipType)return oc.info("账号非年度大会员，不需要领取权益"),!1;const e=await nx();if(0===e.length)return void oc.info("已经领取过权益，不需要再领取");for(let t=0;t<e.length;t++){const i=e[t];await ox(i.type)}}catch(e){oc.error(`领取大会员权益出现异常：${e.message}`)}},giveGift:async function(){oc.info("----【投喂过期食物】----");try{const e=await rx();if(await bh(),null==e||!e.length)return void oc.info("没有2天内过期的简单礼物");const t=await async function(){const e=Object.assign([],ap.BILI_GIFT_UP),t=()=>e.splice(lr(ap.BILI_GIFT_UP.length-1),1)[0];for(;e.length;){const e=t(),i=await cx(e);if(i)return{mid:e,...i}}return await async function(){const{data:{count:e,items:t}}=await function(e=1,t=10){return e>10&&(e=10),gv.get(`/xlive/app-ucenter/v1/user/GetMyMedals?page=${e}&page_size=${t}`)}();if(await bh(),!e)return;const i=t[lr(t.length-1)];return{mid:i.target_id,roomid:i.roomid||0,name:i.uname}}()}();if(!t)return void oc.info("没有找到投喂目标");await async function({roomid:e,mid:t,name:i},n){for(const s of n){await bh();try{const{code:n,message:o,data:a}=await wv({roomid:e,ruid:t,bag_id:s.bag_id,gift_id:s.gift_id,gift_num:s.gift_num});if(0!==n){oc.warn(`向[${i}]投喂[${s.gift_name}]，${o}`);continue}a.gift_list.forEach((e=>{oc.info(`成功给 [${i}] 投喂${e.gift_name}`)}))}catch{}}}(t,e)}catch(e){oc.info(`投喂过期食物异常 ${e}`)}},matchGame:async function(){if(oc.info("----【赛事硬币竞猜】----"),ap.MATCH_COINS<=0)return void oc.info("硬币数量不能小于 0");if(ux())return;const e=await async function(){try{const{code:e,message:t,data:{list:i,page:n}}=await function(e="",t=""){return vv.get(`/x/esports/guess/collection/question?pn=1&ps=50&gid=&sids=&stime=${e}&etime=${t}`)}();return 0!==e?void oc.warn(`获取赛事错误 ${e} ${t}`):0===n.total?(oc.info("今日已经无法获取赛事"),null):i}catch(e){}}();if(await bh(),!e)return;const t=await async function(e){let t=0;try{for(const i of e){const{contest:e,questions:n}=i,s=e.id,[{id:o,title:a,details:r,is_guess:c}]=n,[p,u]=r;if(ux())return t;if(c)continue;oc.info(`${a} <=> ${p.odds}:${u.odds}`);const l=p.odds>u.odds;let d;d=ap.MATCH_SELECTION>0?l?u:p:l?p:u,oc.info(`预测[ ${d.option} ] ${ap.MATCH_COINS} 颗硬币`),await bh();const{code:h}=await px(s,o,d.detail_id,ap.MATCH_COINS);0!==h?oc.info("预测失败"):(t++,rp.money-=ap.MATCH_COINS)}}catch(e){console.warn(e.message)}return t}(function(e,t){return e.filter((e=>{const{questions:i}=e,[{details:n,is_guess:s}]=i;if(s)return!1;const[o,a]=n;return Math.abs(o.odds-a.odds)>=t}))}(e,ap.MATCH_DIFF));oc.info(`【竞猜结束】一共参与${t}次预测`)},liveLottery:async function(){oc.info("----【天选时刻】----");try{const e=await lx();oc.info(`最后一个关注的UP: ${e.uname}`);const t=await async function(){_x=[];const e=await Dx();for(const t of e)for(const e of t)await Sx(e.areaId,e.parentId,ap.LOTTERY_PAGE_NUM);return _x}();oc.info("扫描完成");const i=[];await fx(i,t,null==e?void 0:e.mid),await mx(i),oc.info("移动关注UP到分组成功")}catch(e){oc.warn(`天选时刻异常: ${e.message}`),oc.debug(e)}oc.info("结束天选时刻")},liveRedPack:async function(){oc.info("----【天选红包】----");try{const e=await lx();oc.info(`最后一个关注的UP: ${e.uname}`);const t=await async function(){_x=[];const e=await Dx();for(const t of e)for(const e of t)await Ox(e.areaId,e.parentId,ap.LOTTERY_PAGE_NUM);return _x}();oc.info("扫描完成，获取新关注的UP");const i=[];await fx(i,t,null==e?void 0:e.mid),oc.info("开始读取消息"),await Px(i),oc.info("移动关注UP到分组"),await mx(i),oc.info("移动关注UP到分组成功")}catch(e){oc.warn(`天选时刻异常: ${e.message}`),oc.debug(e)}oc.info("结束天选红包")},liveIntimacy:async function(){oc.info("----【直播亲密度】----");try{await Yv(),oc.info("直播亲密度完成")}catch(e){oc.error(`直播亲密度: ${e.message}`)}}};var Lx=Object.freeze({__proto__:null,dailyTasks:async function(e,...t){sc.pushValue="";try{await async function(){oc.info("----【登录】----");const{data:e,message:t,code:i}=await _v();if(0!==i)throw oc.error(`登录错误 ${i} ${t}`),new Error(t);if(!e.isLogin)throw new Error("接口返回为未登录");await bh(),await kv(e)}()}catch(e){return oc.error(`登录失败: ${e}`),await mv("登录失败",sc.pushValue),"未完成"}const i=yh([...Object.values(Rx)]);for(const e of i)try{await e()}catch(t){oc.error(`${e.name}失败: ${t}`)}finally{await bh()}return e&&await e(...t),await mv("每日完成",sc.pushValue),"完成"}});
