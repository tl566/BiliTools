"use strict";var t=require("crypto"),e=require("path"),n=require("zlib"),r=require("fs"),o=require("json5"),i=require("nodemailer"),a=require("tunnel"),s=require("got");function c(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function u(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var f=u(t),l=u(e),d=u(o),p=u(i),g=u(a),m=c(s),h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},y=function(t){return t&&t.Math==Math&&t},_=y("object"==typeof globalThis&&globalThis)||y("object"==typeof window&&window)||y("object"==typeof self&&self)||y("object"==typeof h&&h)||function(){return this}()||Function("return this")(),v={},w=function(t){try{return!!t()}catch(t){return!0}},b=!w((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),$=!w((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),T=$,O=Function.prototype.call,S=T?O.bind(O):function(){return O.apply(O,arguments)},I={},E={}.propertyIsEnumerable,C=Object.getOwnPropertyDescriptor,P=C&&!E.call({1:2},1);I.f=P?function(t){var e=C(this,t);return!!e&&e.enumerable}:E;var x,A,L=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},R=$,k=Function.prototype,U=k.bind,N=k.call,j=R&&U.bind(N,N),B=R?function(t){return t&&j(t)}:function(t){return t&&function(){return N.apply(t,arguments)}},G=B,D=G({}.toString),M=G("".slice),H=function(t){return M(D(t),8,-1)},K=B,q=w,Y=H,F=_.Object,J=K("".split),Q=q((function(){return!F("z").propertyIsEnumerable(0)}))?function(t){return"String"==Y(t)?J(t,""):F(t)}:F,W=_.TypeError,z=function(t){if(null==t)throw W("Can't call method on "+t);return t},X=Q,V=z,Z=function(t){return X(V(t))},tt=function(t){return"function"==typeof t},et=tt,nt=function(t){return"object"==typeof t?null!==t:et(t)},rt=_,ot=tt,it=function(t){return ot(t)?t:void 0},at=function(t,e){return arguments.length<2?it(rt[t]):rt[t]&&rt[t][e]},st=B({}.isPrototypeOf),ct=_,ut=at("navigator","userAgent")||"",ft=ct.process,lt=ct.Deno,dt=ft&&ft.versions||lt&&lt.version,pt=dt&&dt.v8;pt&&(A=(x=pt.split("."))[0]>0&&x[0]<4?1:+(x[0]+x[1])),!A&&ut&&(!(x=ut.match(/Edge\/(\d+)/))||x[1]>=74)&&(x=ut.match(/Chrome\/(\d+)/))&&(A=+x[1]);var gt=A,mt=w,ht=!!Object.getOwnPropertySymbols&&!mt((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&gt&&gt<41})),yt=ht&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,_t=at,vt=tt,wt=st,bt=yt,$t=_.Object,Tt=bt?function(t){return"symbol"==typeof t}:function(t){var e=_t("Symbol");return vt(e)&&wt(e.prototype,$t(t))},Ot=_.String,St=function(t){try{return Ot(t)}catch(t){return"Object"}},It=tt,Et=St,Ct=_.TypeError,Pt=function(t){if(It(t))return t;throw Ct(Et(t)+" is not a function")},xt=Pt,At=function(t,e){var n=t[e];return null==n?void 0:xt(n)},Lt=S,Rt=tt,kt=nt,Ut=_.TypeError,Nt={exports:{}},jt=_,Bt=Object.defineProperty,Gt=function(t,e){try{Bt(jt,t,{value:e,configurable:!0,writable:!0})}catch(n){jt[t]=e}return e},Dt=Gt,Mt=_["__core-js_shared__"]||Dt("__core-js_shared__",{}),Ht=Mt;(Nt.exports=function(t,e){return Ht[t]||(Ht[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.22.7",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.7/LICENSE",source:"https://github.com/zloirock/core-js"});var Kt=z,qt=_.Object,Yt=function(t){return qt(Kt(t))},Ft=Yt,Jt=B({}.hasOwnProperty),Qt=Object.hasOwn||function(t,e){return Jt(Ft(t),e)},Wt=B,zt=0,Xt=Math.random(),Vt=Wt(1..toString),Zt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Vt(++zt+Xt,36)},te=_,ee=Nt.exports,ne=Qt,re=Zt,oe=ht,ie=yt,ae=ee("wks"),se=te.Symbol,ce=se&&se.for,ue=ie?se:se&&se.withoutSetter||re,fe=function(t){if(!ne(ae,t)||!oe&&"string"!=typeof ae[t]){var e="Symbol."+t;oe&&ne(se,t)?ae[t]=se[t]:ae[t]=ie&&ce?ce(e):ue(e)}return ae[t]},le=S,de=nt,pe=Tt,ge=At,me=function(t,e){var n,r;if("string"===e&&Rt(n=t.toString)&&!kt(r=Lt(n,t)))return r;if(Rt(n=t.valueOf)&&!kt(r=Lt(n,t)))return r;if("string"!==e&&Rt(n=t.toString)&&!kt(r=Lt(n,t)))return r;throw Ut("Can't convert object to primitive value")},he=fe,ye=_.TypeError,_e=he("toPrimitive"),ve=function(t,e){if(!de(t)||pe(t))return t;var n,r=ge(t,_e);if(r){if(void 0===e&&(e="default"),n=le(r,t,e),!de(n)||pe(n))return n;throw ye("Can't convert object to primitive value")}return void 0===e&&(e="number"),me(t,e)},we=Tt,be=function(t){var e=ve(t,"string");return we(e)?e:e+""},$e=nt,Te=_.document,Oe=$e(Te)&&$e(Te.createElement),Se=function(t){return Oe?Te.createElement(t):{}},Ie=Se,Ee=!b&&!w((function(){return 7!=Object.defineProperty(Ie("div"),"a",{get:function(){return 7}}).a})),Ce=b,Pe=S,xe=I,Ae=L,Le=Z,Re=be,ke=Qt,Ue=Ee,Ne=Object.getOwnPropertyDescriptor;v.f=Ce?Ne:function(t,e){if(t=Le(t),e=Re(e),Ue)try{return Ne(t,e)}catch(t){}if(ke(t,e))return Ae(!Pe(xe.f,t,e),t[e])};var je={},Be=b&&w((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Ge=_,De=nt,Me=Ge.String,He=Ge.TypeError,Ke=function(t){if(De(t))return t;throw He(Me(t)+" is not an object")},qe=b,Ye=Ee,Fe=Be,Je=Ke,Qe=be,We=_.TypeError,ze=Object.defineProperty,Xe=Object.getOwnPropertyDescriptor;je.f=qe?Fe?function(t,e,n){if(Je(t),e=Qe(e),Je(n),"function"==typeof t&&"prototype"===e&&"value"in n&&"writable"in n&&!n.writable){var r=Xe(t,e);r&&r.writable&&(t[e]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return ze(t,e,n)}:ze:function(t,e,n){if(Je(t),e=Qe(e),Je(n),Ye)try{return ze(t,e,n)}catch(t){}if("get"in n||"set"in n)throw We("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Ve=je,Ze=L,tn=b?function(t,e,n){return Ve.f(t,e,Ze(1,n))}:function(t,e,n){return t[e]=n,t},en={exports:{}},nn=b,rn=Qt,on=Function.prototype,an=nn&&Object.getOwnPropertyDescriptor,sn=rn(on,"name"),cn={EXISTS:sn,PROPER:sn&&"something"===function(){}.name,CONFIGURABLE:sn&&(!nn||nn&&an(on,"name").configurable)},un=tt,fn=Mt,ln=B(Function.toString);un(fn.inspectSource)||(fn.inspectSource=function(t){return ln(t)});var dn,pn,gn,mn=fn.inspectSource,hn=tt,yn=mn,_n=_.WeakMap,vn=hn(_n)&&/native code/.test(yn(_n)),wn=Nt.exports,bn=Zt,$n=wn("keys"),Tn=function(t){return $n[t]||($n[t]=bn(t))},On={},Sn=vn,In=_,En=B,Cn=nt,Pn=tn,xn=Qt,An=Mt,Ln=Tn,Rn=On,kn=In.TypeError,Un=In.WeakMap;if(Sn||An.state){var Nn=An.state||(An.state=new Un),jn=En(Nn.get),Bn=En(Nn.has),Gn=En(Nn.set);dn=function(t,e){if(Bn(Nn,t))throw new kn("Object already initialized");return e.facade=t,Gn(Nn,t,e),e},pn=function(t){return jn(Nn,t)||{}},gn=function(t){return Bn(Nn,t)}}else{var Dn=Ln("state");Rn[Dn]=!0,dn=function(t,e){if(xn(t,Dn))throw new kn("Object already initialized");return e.facade=t,Pn(t,Dn,e),e},pn=function(t){return xn(t,Dn)?t[Dn]:{}},gn=function(t){return xn(t,Dn)}}var Mn={set:dn,get:pn,has:gn,enforce:function(t){return gn(t)?pn(t):dn(t,{})},getterFor:function(t){return function(e){var n;if(!Cn(e)||(n=pn(e)).type!==t)throw kn("Incompatible receiver, "+t+" required");return n}}},Hn=w,Kn=tt,qn=Qt,Yn=b,Fn=cn.CONFIGURABLE,Jn=mn,Qn=Mn.enforce,Wn=Mn.get,zn=Object.defineProperty,Xn=Yn&&!Hn((function(){return 8!==zn((function(){}),"length",{value:8}).length})),Vn=String(String).split("String"),Zn=en.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!qn(t,"name")||Fn&&t.name!==e)&&zn(t,"name",{value:e,configurable:!0}),Xn&&n&&qn(n,"arity")&&t.length!==n.arity&&zn(t,"length",{value:n.arity});try{n&&qn(n,"constructor")&&n.constructor?Yn&&zn(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=Qn(t);return qn(r,"source")||(r.source=Vn.join("string"==typeof e?e:"")),t};Function.prototype.toString=Zn((function(){return Kn(this)&&Wn(this).source||Jn(this)}),"toString");var tr=tt,er=tn,nr=en.exports,rr=Gt,or={},ir=Math.ceil,ar=Math.floor,sr=Math.trunc||function(t){var e=+t;return(e>0?ar:ir)(e)},cr=function(t){var e=+t;return e!=e||0===e?0:sr(e)},ur=cr,fr=Math.max,lr=Math.min,dr=cr,pr=Math.min,gr=function(t){return t>0?pr(dr(t),9007199254740991):0},mr=function(t){return gr(t.length)},hr=Z,yr=function(t,e){var n=ur(t);return n<0?fr(n+e,0):lr(n,e)},_r=mr,vr=function(t){return function(e,n,r){var o,i=hr(e),a=_r(i),s=yr(r,a);if(t&&n!=n){for(;a>s;)if((o=i[s++])!=o)return!0}else for(;a>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},wr={includes:vr(!0),indexOf:vr(!1)},br=Qt,$r=Z,Tr=wr.indexOf,Or=On,Sr=B([].push),Ir=function(t,e){var n,r=$r(t),o=0,i=[];for(n in r)!br(Or,n)&&br(r,n)&&Sr(i,n);for(;e.length>o;)br(r,n=e[o++])&&(~Tr(i,n)||Sr(i,n));return i},Er=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Cr=Ir,Pr=Er.concat("length","prototype");or.f=Object.getOwnPropertyNames||function(t){return Cr(t,Pr)};var xr={};xr.f=Object.getOwnPropertySymbols;var Ar=at,Lr=or,Rr=xr,kr=Ke,Ur=B([].concat),Nr=Ar("Reflect","ownKeys")||function(t){var e=Lr.f(kr(t)),n=Rr.f;return n?Ur(e,n(t)):e},jr=Qt,Br=Nr,Gr=v,Dr=je,Mr=function(t,e,n){for(var r=Br(e),o=Dr.f,i=Gr.f,a=0;a<r.length;a++){var s=r[a];jr(t,s)||n&&jr(n,s)||o(t,s,i(e,s))}},Hr=w,Kr=tt,qr=/#|\.prototype\./,Yr=function(t,e){var n=Jr[Fr(t)];return n==Wr||n!=Qr&&(Kr(e)?Hr(e):!!e)},Fr=Yr.normalize=function(t){return String(t).replace(qr,".").toLowerCase()},Jr=Yr.data={},Qr=Yr.NATIVE="N",Wr=Yr.POLYFILL="P",zr=Yr,Xr=_,Vr=v.f,Zr=tn,to=function(t,e,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:e;return tr(n)&&nr(n,i,r),r.global?o?t[e]=n:rr(e,n):(r.unsafe?t[e]&&(o=!0):delete t[e],o?t[e]=n:er(t,e,n)),t},eo=Gt,no=Mr,ro=zr,oo=function(t,e){var n,r,o,i,a,s=t.target,c=t.global,u=t.stat;if(n=c?Xr:u?Xr[s]||eo(s,{}):(Xr[s]||{}).prototype)for(r in e){if(i=e[r],o=t.dontCallGetSet?(a=Vr(n,r))&&a.value:n[r],!ro(c?r:s+(u?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;no(i,o)}(t.sham||o&&o.sham)&&Zr(i,"sham",!0),to(n,r,i,t)}},io=je.f,ao=Qt,so=fe("toStringTag"),co=_,uo=function(t,e,n){t&&!n&&(t=t.prototype),t&&!ao(t,so)&&io(t,so,{configurable:!0,value:e})};oo({global:!0},{Reflect:{}}),uo(co.Reflect,"Reflect",!0);const fo=["æ£’","æ£’å”‰","æ£’è€¶","åŠ æ²¹~","UPåŠ æ²¹!","æ”¯æŒ~","æ”¯æŒæ”¯æŒï¼","å‚¬æ›´å•¦","é¡¶é¡¶","ç•™ä¸‹è„šå°~","å¹²æ¯","bilibiliå¹²æ¯","o(*ï¿£â–½ï¿£*)o","(ï½¡ï½¥âˆ€ï½¥)ï¾‰ï¾å—¨","(â—Ë‡âˆ€Ë‡â—)","( â€¢Ì€ Ï‰ â€¢Ì )y","(à¸‡ â€¢_â€¢)à¸‡",">.<","^_~"],lo=["èˆ°","èˆ¹","èˆªæµ·","ä»£é‡‘åˆ¸","ä¼˜æƒ åˆ¸","è‡ªæ‹","ç…§","å†™çœŸ","å›¾","æç£","è½¦è½¦ä¸€å±€","å†æ¥ä¸€å±€","æ¸¸æˆé“å…·"],po=["è°¢"],go=[65566781,1277481241,1643654862,603676925],mo=Object.prototype.toString;function ho(t,e){return mo.call(t)===`[object ${e}]`}function yo(t){return null!==t&&ho(t,"Object")}function _o(t){return ho(t,"String")}function vo(t){const e=t||wo(),n=e.getFullYear(),r=e.getMonth()+1;return 2===r?n%4==0&&n%100!=0||n%400==0?29:28:[4,6,9,11].includes(r)?30:31}function wo(){const t=new Date,e=t.getTime(),n=t.getTimezoneOffset()/60;return new Date(e+36e5*(n+8))}function bo(t,e){return Math.ceil(e/t)}function $o(t,e,n){if(n&&"boolean"!=typeof n&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):void 0===e&&(e=t,t=0),t>e){const n=t;t=e,e=n}if(n||t%1||e%1){const n=Math.random();return Math.min(t+n*(e-t+parseFloat("1e-"+((n+"").length-1))),e)}return t+Math.floor(Math.random()*(e-t+1))}function To(){return`${$o(1,9)}${function(t,e){let n="";for(let e=0;e<t;e++)n+=Co("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");return e?n.toLowerCase():n}(10,!0)}0`}function Oo(t,e){t.includes(e)||t.push(e)}function So(t){return t||{}}function Io(t,e){return void 0===t||void 0===e?t||e:yo(t)&&yo(e)?Array.isArray(t)&&Array.isArray(e)?t.concat(e):Object.keys(e).reduce(((n,r)=>(n[r]=Io(t[r],e[r]),n)),t):e}function Eo(t){if(!yo(t)&&(!(e=t)||!Array.isArray(e)))return t;var e;const n=new URLSearchParams;return Array.isArray(t)||(t=Object.entries(t)),t.forEach((([t,e])=>{yo(e)?n.append(t,JSON.stringify(e)):n.append(t,String(e))})),n.toString()}function Co(t){return t[$o(t.length-1)]}function Po(t){return t?t.split("; ").map((t=>t.split("="))):[]}function xo(t,e){return t?e&&0!==e.length?function(t){const e=Object.keys(t).reduce(((e,n)=>e+`${n}=${t[n]}; `),"");return e.substring(0,e.length-2||0)}(function(t,e){const n=Po(null==e?void 0:e[0]).filter((t=>2===t.length)),r=Po(t).concat(n).filter((t=>2===t.length)),o={};for(const t of r)o[t[0]]?o[t[0]]=t[1]:Object.defineProperty(o,t[0],{value:t[1],enumerable:!0,writable:!0});return o}(t,e)):t:""}function Ao(t,e){if(!t)return null;const n=`(?:^|)${e}=([^;]*)(?:;|$)`,r=t.match(n);return r?r[1]:null}function Lo(t){return Ao(t,"bili_jct")||""}var Ro=$,ko=Function.prototype,Uo=ko.apply,No=ko.call,jo="object"==typeof Reflect&&Reflect.apply||(Ro?No.bind(Uo):function(){return No.apply(Uo,arguments)}),Bo=_,Go=tt,Do=Bo.String,Mo=Bo.TypeError,Ho=B,Ko=Ke,qo=function(t){if("object"==typeof t||Go(t))return t;throw Mo("Can't set "+Do(t)+" as a prototype")},Yo=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Ho(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return Ko(n),qo(r),e?t(n,r):n.__proto__=r,n}}():void 0),Fo=je.f,Jo=tt,Qo=nt,Wo=Yo,zo={};zo[fe("toStringTag")]="z";var Xo=_,Vo="[object z]"===String(zo),Zo=tt,ti=H,ei=fe("toStringTag"),ni=Xo.Object,ri="Arguments"==ti(function(){return arguments}()),oi=Vo?ti:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=ni(t),ei))?n:ri?ti(e):"Object"==(r=ti(e))&&Zo(e.callee)?"Arguments":r},ii=oi,ai=_.String,si=function(t){if("Symbol"===ii(t))throw TypeError("Cannot convert a Symbol value to a string");return ai(t)},ci=function(t,e){return void 0===t?arguments.length<2?"":e:si(t)},ui=nt,fi=tn,li=function(t,e){ui(e)&&"cause"in e&&fi(t,"cause",e.cause)},di=Error,pi=B("".replace),gi=String(di("zxcasd").stack),mi=/\n\s*at [^:]*:[^\n]*/,hi=mi.test(gi),yi=function(t,e){if(hi&&"string"==typeof t&&!di.prepareStackTrace)for(;e--;)t=pi(t,mi,"");return t},_i=L,vi=!w((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",_i(1,7)),7!==t.stack)})),wi=at,bi=Qt,$i=tn,Ti=st,Oi=Yo,Si=Mr,Ii=function(t,e,n){n in t||Fo(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})},Ei=function(t,e,n){var r,o;return Wo&&Jo(r=e.constructor)&&r!==n&&Qo(o=r.prototype)&&o!==n.prototype&&Wo(t,o),t},Ci=ci,Pi=li,xi=yi,Ai=vi,Li=b,Ri=oo,ki=jo,Ui=function(t,e,n,r){var o="stackTraceLimit",i=r?2:1,a=t.split("."),s=a[a.length-1],c=wi.apply(null,a);if(c){var u=c.prototype;if(bi(u,"cause")&&delete u.cause,!n)return c;var f=wi("Error"),l=e((function(t,e){var n=Ci(r?e:t,void 0),o=r?new c(t):new c;return void 0!==n&&$i(o,"message",n),Ai&&$i(o,"stack",xi(o.stack,2)),this&&Ti(u,this)&&Ei(o,this,l),arguments.length>i&&Pi(o,arguments[i]),o}));l.prototype=u,"Error"!==s?Oi?Oi(l,f):Si(l,f,{name:!0}):Li&&o in c&&(Ii(l,c,o),Ii(l,c,"prepareStackTrace")),Si(l,c);try{u.name!==s&&$i(u,"name",s),u.constructor=l}catch(t){}return l}},Ni=_.WebAssembly,ji=7!==Error("e",{cause:7}).cause,Bi=function(t,e){var n={};n[t]=Ui(t,e,ji),Ri({global:!0,constructor:!0,arity:1,forced:ji},n)},Gi=function(t,e){if(Ni&&Ni[t]){var n={};n[t]=Ui("WebAssembly."+t,e,ji),Ri({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:ji},n)}};Bi("Error",(function(t){return function(e){return ki(t,this,arguments)}})),Bi("EvalError",(function(t){return function(e){return ki(t,this,arguments)}})),Bi("RangeError",(function(t){return function(e){return ki(t,this,arguments)}})),Bi("ReferenceError",(function(t){return function(e){return ki(t,this,arguments)}})),Bi("SyntaxError",(function(t){return function(e){return ki(t,this,arguments)}})),Bi("TypeError",(function(t){return function(e){return ki(t,this,arguments)}})),Bi("URIError",(function(t){return function(e){return ki(t,this,arguments)}})),Gi("CompileError",(function(t){return function(e){return ki(t,this,arguments)}})),Gi("LinkError",(function(t){return function(e){return ki(t,this,arguments)}})),Gi("RuntimeError",(function(t){return function(e){return ki(t,this,arguments)}}));const Di={value:""},Mi={log:Hi,error:function(t){Hi("error",t)},warn:function(t){Hi("warn",t)},info:function(t){Hi("info",t)},verbose:function(t){Hi("verbose",t)},debug:function(t){Hi("debug",t)}};function Hi(t,e){const n=wo().toString().match(/\w{2}:\w{2}:\w{2}/)[0];if(function(t="debug"){const e=["error","warn","info","verbose","debug"],n=e.indexOf(t);return n>0?e.slice(0,n+1):e}().includes(t)){const t=`[${n}] ${e}`;Di.value+=t+"\n"}process.stdout.write(`[${t} ${n}] ${e}\n`)}function Ki(t){try{const e=n.unzipSync(Buffer.from(t,"base64")).toString();try{return decodeURIComponent(function(t){return t.replace(/\\u([\d\w]{4})/gi,((t,e)=>String.fromCodePoint(parseInt(e,16))))}(e))}catch(t){return unescape(e)}}catch(t){throw new Error("Error: å½“å‰å­—ç¬¦ä¸²ä¸èƒ½è¢«Gzipè§£å‹")}}const qi=()=>process.env.QL_BRANCH;class Yi{static configFileName=function(){const t=qi()?"cat_bili_config":"config",e=".json",{BILITOOLS_FILE_NAME:n}=process.env;return n?n.endsWith(e)?n:`${n}.json`:t+e}();static isQingLongPanel=qi()}const Fi=d.default?d.default:d;function Ji(t){try{let e;if((r.existsSync(t)||r.existsSync(t+="5"))&&(e=r.readFileSync(t,"utf-8")),!e)return;return Mi.verbose(`è¯»å–é…ç½®æ–‡ä»¶ ${t}`),Fi.parse(e)}catch(t){!function(t){if(!_o(t))return;throw new TypeError("é…ç½®æ–‡ä»¶å­˜åœ¨ï¼Œä½†æ˜¯æ— æ³•è§£æï¼å¯èƒ½ JSON5 æ ¼å¼ä¸æ­£ç¡®ï¼")}(t.message)}}const Qi=t=>l.resolve(process.cwd(),t),Wi=t=>l.resolve(__dirname,"../",t);function zi(t){throw new Error(t||"è·å–é…ç½®å¤±è´¥ï¼æœªæ‰¾åˆ°é…ç½®æ–‡ä»¶ï¼")}const Xi=Array.from(new Set([Qi("./config/config.dev.json"),Qi(`./config/${Yi.configFileName}`),Qi(`./${Yi.configFileName}`),Wi(`./config/${Yi.configFileName}`),Wi(`./${Yi.configFileName}`)])),Vi=["./config.json",Qi("./config/config.json")];function Zi(t){let e;const n=Array.isArray(t);if(e=n?t:t.account.filter((t=>t.cookie)),0===e.length)return;if(Yi.isQingLongPanel)return function(t){const e=process.argv.find((t=>t.includes("--item")||t.includes("-i")||t.includes("-I")));if(!e)return t[0];const n=Number(e.split("=")[1])-1;return!n||n>=t.length||n<0?(Mi.warn("ä¼¼ä¹æƒ³è¦æŒ‡å®šä¸€ä¸ªä¸å­˜åœ¨çš„ç”¨æˆ·ï¼Œæˆ‘ä»¬å°†æŒ‡å®šç¬¬ä¸€ä¸ªç”¨æˆ·"),t[0]):t[n]}(e);Mi.warn("åœ¨å•ç”¨æˆ·åœºæ™¯ä¸‹é…ç½®äº†å¤šç”¨æˆ·ï¼Œæˆ‘ä»¬å°†æ”¾å¼ƒå¤šä½™çš„é…ç½®");const r=e[0];return n||(r.message=Object.assign(t.message||{},r.message)),r}function ta(){if(globalThis.BILITOOLS_CONFIG)return globalThis.BILITOOLS_CONFIG;Yi.isQingLongPanel&&Xi.splice(0,1,...Vi);for(let t=0;t<Xi.length;t++){const e=Ji(Xi[t]);if(e)return e}return(()=>{const{BILITOOLS_CONFIG:t,BILI_SCF_CONFIG:e,BILI_CONFIG:n}=process.env,r=t||e||n;if(r)try{return Fi.parse(Ki(r))}catch{zi("ç¯å¢ƒä¸­çš„é…ç½®ä¸æ˜¯æœ‰æ•ˆçš„ JSON å­—ç¬¦ä¸²ï¼")}})()}function ea(t){if(t||zi(),function(t){if(Array.isArray(t))return!0;return Boolean(t.account&&t.account.length)}(t)){const e=Zi(t);if(e)return e}return t.cookie||zi("é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰ cookieï¼"),t}function na(t){return t&&t.map((t=>Number(t))).filter((t=>t>0&&t%1==0))}class ra{constructor(t){var e,n,r,o,i,a,s,c,u;this.config=t,this.COOKIE=t.cookie,this.BILIJCT=Lo(t.cookie),this.USERID=(u=t.cookie,Number(Ao(u,"DedeUserID"))||0),this.USER_AGENT=t.userAgent;const f=null!==(e=t.apiDelay)&&void 0!==e?e:[2,6];this.BILI_API_DELAY=Array.isArray(f)?na(f):[Number(f)];const l=So(t.message);this.MESSAGE_API=l.api,this.PUSHPLUS_TOKEN=l.pushplusToken||process.env.PUSHPLUS_TOKEN;const d=So(t.coin);this.BILI_CUSTOMIZE_UP=na(d.customizeUp||t.customizeUp)||[],this.BILI_UPPER_ACC_MATCH=!1!==(null!==(n=d.upperAccMatch)&&void 0!==n?n:t.upperAccMatch),this.BILI_COIN_RETRY_NUM=d.retryNum||t.coinRetryNum||4,this.BILI_TARGET_LEVEL=null!==(r=d.targetLevel||t.targetLevel)&&void 0!==r?r:6,this.BILI_STAY_COINS=null!==(o=d.stayCoins||t.stayCoins)&&void 0!==o?o:0,this.BILI_TARGET_COINS=null!==(i=d.targetCoins||t.targetCoins)&&void 0!==i?i:5;const p=So(t.gift);this.BILI_GIFT_UP=na(p.mids||t.giftUp)||this.BILI_CUSTOMIZE_UP||[];const g=So(t.charge);this.CHARGE_ID=g.mid||t.chargeUpId||this.USERID,this.CHARGE_PRESET_TIME=g.presetTime||t.chargePresetTime||31;const m=So(t.match);this.MATCH_COINS=null!==(a=m.coins||t.matchCoins)&&void 0!==a?a:5,this.MATCH_SELECTION=null!==(s=m.selection||t.matchSelection)&&void 0!==s?s:1,this.MATCH_DIFF=null!==(c=m.diff||t.matchDiff)&&void 0!==c?c:0;const h=So(t.lottery);this.LOTTERY_EXCLUDE=h.excludeAward||lo,this.LOTTERY_INCLUDE=h.includeAward||po,this.LOTTERY_UP_BLACKLIST=h.blackUid||go,this.LOTTERY_MOVE_TAG=h.moveTag,this.LOTTERY_PAGE_NUM=h.pageNum||2}}let oa;const ia=new Proxy({},{get:(t,e)=>(oa||sa(),Reflect.get(oa,e)),set:(t,e,n)=>"config"===e&&n?(sa(n),!0):Reflect.set(oa,e,n)});let aa=null;function sa(t){t||(t=ea(ta())),oa=new ra(ea(t)),aa=class extends class{static money=0;static coinsTask=5;static share=!1;static watch=!1;static currentStartFun=0;static bCoinCouponBalance=0;static vipType=0;static userLevel=0}{},aa.coinsTask=oa.BILI_TARGET_COINS}const ca={silver2Coin:!0,liveSignTask:!0,addCoins:!0,mangaSign:!1,shareAndWatch:!0,supGroupSign:!1,liveSendMessage:!1,taskReward:!0,charging:!1,getVipPrivilege:!1,giveGift:!1,matchGame:!1,liveLottery:!1,liveRedPack:!1};function ua(){return{...ca}}function fa(t){const e=function(){const t=ua();for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e];switch((ia.config.function||{})[e]){case!0:!1===n&&(t[e]=!0);break;case!1:!0===n&&(t[e]=!1)}}return t.addCoins||t.shareAndWatch||(t.taskReward=!1),t}();return t.map((t=>e[t.name]?t:null)).filter((t=>t))}function la(t){const e=ia.BILI_API_DELAY;let n;n=t||(1===e.length?1e3*e[0]:1e3*$o(e[0]||2,e[1]||6));const r=(new Date).getTime()+Number(n||0);for(;(new Date).getTime()<r;);return new Promise((t=>{t("done")}))}var da;!function(t){t[t.SUCCESS=0]="SUCCESS",t[t["åº”ç”¨ç¨‹åºä¸å­˜åœ¨æˆ–å·²è¢«å°ç¦"]=-1]="åº”ç”¨ç¨‹åºä¸å­˜åœ¨æˆ–å·²è¢«å°ç¦",t[t["Access Keyé”™è¯¯"]=-2]="Access Keyé”™è¯¯",t[t["APIæ ¡éªŒå¯†åŒ™é”™è¯¯"]=-3]="APIæ ¡éªŒå¯†åŒ™é”™è¯¯",t[t["è°ƒç”¨æ–¹å¯¹è¯¥Methodæ²¡æœ‰æƒé™"]=-4]="è°ƒç”¨æ–¹å¯¹è¯¥Methodæ²¡æœ‰æƒé™",t[t["è´¦å·æœªç™»å½•"]=-101]="è´¦å·æœªç™»å½•",t[t["è´¦å·è¢«å°åœ"]=-102]="è´¦å·è¢«å°åœ",t[t["ç§¯åˆ†ä¸è¶³"]=-103]="ç§¯åˆ†ä¸è¶³",t[t["ç¡¬å¸ä¸è¶³"]=-104]="ç¡¬å¸ä¸è¶³",t[t["éªŒè¯ç é”™è¯¯"]=-105]="éªŒè¯ç é”™è¯¯",t[t["è´¦å·éæ­£å¼ä¼šå‘˜æˆ–åœ¨é€‚åº”æœŸ"]=-106]="è´¦å·éæ­£å¼ä¼šå‘˜æˆ–åœ¨é€‚åº”æœŸ",t[t["åº”ç”¨ä¸å­˜åœ¨æˆ–è€…è¢«å°ç¦"]=-107]="åº”ç”¨ä¸å­˜åœ¨æˆ–è€…è¢«å°ç¦",t[t["æœªç»‘å®šæ‰‹æœº?"]=-108]="æœªç»‘å®šæ‰‹æœº?",t[t["æœªç»‘å®šæ‰‹æœº"]=-110]="æœªç»‘å®šæ‰‹æœº",t[t["csrf æ ¡éªŒå¤±è´¥"]=-111]="csrf æ ¡éªŒå¤±è´¥",t[t["ç³»ç»Ÿå‡çº§ä¸­"]=-112]="ç³»ç»Ÿå‡çº§ä¸­",t[t["è´¦å·å°šæœªå®åè®¤è¯"]=-113]="è´¦å·å°šæœªå®åè®¤è¯",t[t["è¯·å…ˆç»‘å®šæ‰‹æœº"]=-114]="è¯·å…ˆç»‘å®šæ‰‹æœº",t[t["è¯·å…ˆå®Œæˆå®åè®¤è¯"]=-115]="è¯·å…ˆå®Œæˆå®åè®¤è¯"}(da||(da={}));const pa="https://account.bilibili.com",ga="https://live.bilibili.com",ma="https://space.bilibili.com",ha="https://www.bilibili.com/",ya="https://account.bilibili.com",_a="https://api.live.bilibili.com",va="https://api.bilibili.com",wa="https://manga.bilibili.com",ba="https://api.vc.bilibili.com",$a={"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.41 Safari/537.36 Edg/101.0.1210.32","content-type":"application/x-www-form-urlencoded; charset=UTF-8","accept-language":"zh-CN,zh;q=0.9","accept-encoding":"gzip, deflate, br"},Ta=(t,e)=>{const{isTransformResponse:n,isReturnNativeResponse:r}=e;if(r)return t;if(!1===n)return t.body;const{body:o}=t;if(e.isJsonp&&_o(o))return function(t){const e=t.replace(/^\w+\(/,"").replace(/\)$/,"");return JSON.parse(e)}(o);try{if(_o(o)&&o.startsWith("{"))return JSON.parse(o)}catch{}return o};class Oa{name="VGot";constructor(t){t.baseURL&&(t.prefixUrl=t.baseURL),this.options=t,this.gotInstance=m.default.extend(t,{hooks:{afterResponse:[t=>{const{requestOptions:e}=t.request.options;var n;null!=e&&e.withBiliCookie&&(ia.COOKIE=xo(ia.COOKIE,(null===(n=t.headers)||void 0===n?void 0:n["set-cookie"])||[]));return t}]}})}request(t){const{requestOptions:e={},headers:n={}}=this.options;return t.requestOptions=Object.assign({},e,t.requestOptions),t.headers=Object.assign({},n,t.headers),e.withBiliCookie&&(t.headers.Cookie=ia.COOKIE),e.retry&&(t.retry=e.retry),t=function(t){var e;function n(e){t.agent||(t.agent={}),t.agent[e]=t[`${e}Agent`]}return _o(t.url)||(t.url=t.url.toString()),yo(t.params)&&!_o(t.searchParams)&&(t.searchParams={...t.searchParams,...t.params}),yo(t.data)&&(null!==(e=t.headers["content-type"])&&void 0!==e&&e.startsWith("application/x-www-form-urlencoded")?t.body=Eo(t.data):t.json=t.data),t.httpAgent&&n("http"),t.httpsAgent&&n("https"),t.url&&t.url.startsWith("/")&&(t.url=t.url.substring(1)),t}(t),new Promise(((e,n)=>{this.gotInstance(t).then((r=>{{"function"!=typeof Ta;try{const n=Ta(r,t.requestOptions);e(n)}catch(t){n(t||new Error("è¯·æ±‚é”™è¯¯!"))}}})).catch((t=>{n(t)}))}))}get(t,e){return _o(t)?this.request({...e,method:"GET",url:t}):this.request({...t,method:"GET"})}post(t,e,n){return _o(t)?this.request({...n,method:"POST",url:t,data:e}):this.request({...t,method:"POST"})}put(t,e,n){return this.request({...n,method:"PUT",url:t,data:e})}delete(t,e,n){return this.request({...n,method:"DELETE",url:t,data:e})}patch(t,e,n){return this.request({...n,method:"PATCH",url:t,data:e})}}function Sa(t){return new Oa(Io({timeout:1e4,headers:{"content-type":$a["content-type"],"user-agent":$a["user-agent"],"accept-language":$a["accept-language"],"accept-encoding":$a["accept-encoding"]},requestOptions:{isTransformResponse:!0,ignoreCancelToken:!0,withBiliCookie:!0}},t||{}))}const Ia=Sa({requestOptions:{withBiliCookie:!1}}),Ea=Sa();function Ca(){var t;const e=(null===(t=ia.config)||void 0===t?void 0:t.message)||{};["GOBOT_URL","GOBOT_TOKEN","GOBOT_QQ","SCKEY","QQ_SKEY","QQ_MODE","BARK_PUSH","BARK_SOUND","BARK_GROUP","TG_BOT_TOKEN","TG_USER_ID","TG_PROXY_AUTH","TG_PROXY_HOST","TG_PROXY_PORT","TG_API_HOST","DD_BOT_TOKEN","DD_BOT_SECRET","QYWX_KEY","QYWX_AM","IGOT_PUSH_KEY","PUSH_PLUS_TOKEN","PUSH_PLUS_USER"].forEach((t=>{const n=e[(r=t,r.toLowerCase().replace(/_(\w)/g,((t,e)=>e.toUpperCase())))]||e[t]||process.env[t];var r;n&&(process.env[t]=n)})),ia.PUSHPLUS_TOKEN&&(process.env.PUSH_PLUS_TOKEN=ia.PUSHPLUS_TOKEN),function(){process.env.PUSH_KEY&&(Pa=process.env.PUSH_KEY);process.env.QQ_SKEY&&(Fa=process.env.QQ_SKEY);process.env.QQ_MODE&&(Ja=process.env.QQ_MODE);process.env.BARK_PUSH?(xa=process.env.BARK_PUSH.indexOf("https")>-1||process.env.BARK_PUSH.indexOf("http")>-1?process.env.BARK_PUSH:`https://api.day.app/${process.env.BARK_PUSH}`,process.env.BARK_SOUND&&(Aa=process.env.BARK_SOUND),process.env.BARK_GROUP&&(La=process.env.BARK_GROUP)):xa&&-1===xa.indexOf("https")&&-1===xa.indexOf("http")&&(xa=`https://api.day.app/${xa}`);process.env.TG_BOT_TOKEN&&(Ra=process.env.TG_BOT_TOKEN);process.env.TG_USER_ID&&(ka=process.env.TG_USER_ID);process.env.TG_PROXY_AUTH&&(ja=process.env.TG_PROXY_AUTH);process.env.TG_PROXY_HOST&&(Ua=process.env.TG_PROXY_HOST);process.env.TG_PROXY_PORT&&(Na=process.env.TG_PROXY_PORT);process.env.TG_API_HOST&&(Ba=process.env.TG_API_HOST);process.env.DD_BOT_TOKEN&&(Ga=process.env.DD_BOT_TOKEN,process.env.DD_BOT_SECRET&&(Da=process.env.DD_BOT_SECRET));process.env.QYWX_KEY&&(Ma=process.env.QYWX_KEY);process.env.QYWX_AM&&(Ha=process.env.QYWX_AM);process.env.IGOT_PUSH_KEY&&(Ka=process.env.IGOT_PUSH_KEY);process.env.PUSH_PLUS_TOKEN&&(qa=process.env.PUSH_PLUS_TOKEN);process.env.PUSH_PLUS_USER&&(Ya=process.env.PUSH_PLUS_USER)}()}let Pa="",xa="",Aa="",La="QingLong",Ra="",ka="",Ua="",Na="",ja="",Ba="api.telegram.org",Ga="",Da="",Ma="",Ha="",Ka="",qa="",Ya="",Fa="",Ja="";async function Qa(t,e){var n;const r=null===(n=ia.config.message)||void 0===n?void 0:n.email;if(!(r&&r.pass&&r.from&&r.host))return;const o=Number(r.port)||465,i=p.createTransport({host:r.host,port:o,secure:465===o,auth:{user:r.from,pass:r.pass}}),a=await i.sendMail({from:`${t} <${r.from}>`,to:r.to,subject:t,headers:{"Content-Type":"text/plain; charset=utf-8"},text:e.replace(/\n/g,"\r\n")});Mi.info(`é‚®ä»¶æ¶ˆæ¯å·²å‘é€: ${a.messageId}`)}async function Wa(t,e){try{const n=ia.MESSAGE_API;if(!n)return;const r=n.replace("{title}",t).replace("{text}",e);await Ia.get(r)}catch(t){Mi.info(`è‡ªå®šä¹‰æ¥å£æ¶ˆæ¯å‘é€å¤±è´¥: ${t}`),Mi.error(t)}}function za(t,e,n=2100){return new Promise((r=>{if(Pa){e=e.replace(/[\n\r]/g,"\n\n");const o={url:Pa.includes("SCT")?`https://sctapi.ftqq.com/${Pa}.send`:`https://sc.ftqq.com/${Pa}.send`,params:`text=${t}&desp=${e}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};setTimeout((()=>{Ia.post(o).then((t=>{0===t.errno||0===t.data.errno?Mi.info("serveré…±å‘é€é€šçŸ¥æ¶ˆæ¯æˆåŠŸğŸ‰"):1024===t.errno?Mi.info(`serveré…±å‘é€é€šçŸ¥æ¶ˆæ¯å¼‚å¸¸: ${t.errmsg}`):Mi.info(`serveré…±å‘é€é€šçŸ¥æ¶ˆæ¯å¼‚å¸¸\n${JSON.stringify(t)}`)})).catch((t=>{Mi.info("å‘é€é€šçŸ¥è°ƒç”¨APIå¤±è´¥ï¼ï¼"),Mi.info(t)})).finally((()=>{r("")}))}),n)}else r("")}))}function Xa(t,e){return new Promise((n=>{if(Fa){const r={url:`https://push.xuthus.cc/${Ja}/${Fa}`,headers:{"Content-Type":"application/json"},data:{},params:{}};t=t.replace(/äº¬è±†/g,"è±†è±†"),e=(e=(e=e.replace(/äº¬è±†/g,"")).replace(/ğŸ¶/g,"")).replace(/çº¢åŒ…/g,"HåŒ…"),"email"===Ja?r.data={t:t,c:e}:r.params=`${t}\n\n${e}`;const o=function(t){switch(t){case"send":return"ä¸ªäºº";case"group":return"QQç¾¤";case"wx":return"å¾®ä¿¡";case"ww":return"ä¼ä¸šå¾®ä¿¡";case"email":return"é‚®ä»¶";default:return"æœªçŸ¥æ–¹å¼"}};Ia.post(r).then((t=>{200===t.code?Mi.info(`é…·æ¨å‘é€${o(Ja)}é€šçŸ¥æ¶ˆæ¯æˆåŠŸğŸ‰`):400===t.code?Mi.info(`QQé…·æ¨(Cool Push)å‘é€${o(Ja)}æ¨é€å¤±è´¥ï¼š${t.msg}`):503===t.code?Mi.info(`QQé…·æ¨å‡ºé”™ï¼Œ${t.message}ï¼š${t.data}`):Mi.info(`é…·æ¨æ¨é€å¼‚å¸¸: ${JSON.stringify(t)}`)})).catch((t=>{Mi.info(`å‘é€${o(Ja)}é€šçŸ¥è°ƒç”¨APIå¤±è´¥ï¼ï¼`),Mi.info(t)})).finally((()=>{n("")}))}else n("")}))}function Va(t,e,n={}){return new Promise((r=>{if(xa){const o={url:`${xa}/${encodeURIComponent(t)}/${encodeURIComponent(e)}?sound=${Aa}&group=${La}&${Eo(n)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};Ia.get(o).then((t=>{200===t.code?Mi.info("Bark APPå‘é€é€šçŸ¥æ¶ˆæ¯æˆåŠŸğŸ‰"):Mi.info(`Bark APPå‘é€é€šå¤±è´¥ï¼š${t.message}`)})).catch((t=>{Mi.info("Bark APPå‘é€é€šçŸ¥è°ƒç”¨APIå¤±è´¥ï¼ï¼"),Mi.error(t)})).finally((()=>{r("")}))}r("")}))}function Za(t,e){return new Promise((n=>{if(Ra&&ka){const r={url:`https://${Ba}/bot${Ra}/sendMessage`,params:`chat_id=${ka}&text=${t}\n\n${e}&disable_web_page_preview=true`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};if(Ua&&Na){const t=g.httpsOverHttp({proxy:{host:Ua,port:+Na,proxyAuth:ja},maxSockets:1});Object.assign(r,{httpsAgent:t})}Ia.post(r).then((t=>{t.ok?Mi.info("Telegramå‘é€é€šçŸ¥æ¶ˆæ¯æˆåŠŸğŸ‰ã€‚"):400===t.error_code?Mi.info("è¯·ä¸»åŠ¨ç»™botå‘é€ä¸€æ¡æ¶ˆæ¯å¹¶æ£€æŸ¥æ¥æ”¶ç”¨æˆ·IDæ˜¯å¦æ­£ç¡®ã€‚"):401===t.error_code&&Mi.info("Telegram bot token å¡«å†™é”™è¯¯ã€‚")})).catch((t=>{Mi.info("telegramå‘é€é€šçŸ¥æ¶ˆæ¯å¤±è´¥ï¼ï¼"),Mi.info(t)})).finally((()=>{n("")}))}else n("")}))}function ts(t,e){return new Promise((n=>{const r={url:`https://oapi.dingtalk.com/robot/send?access_token=${Ga}`,data:{msgtype:"text",text:{content:` ${t}\n\n${e}`}},headers:{"Content-Type":"application/json"},timeout:15e3};if(Ga){if(Da){const t=require("crypto"),e=Date.now(),n=t.createHmac("sha256",Da);n.update(`${e}\n${Da}`);const o=encodeURIComponent(n.digest("base64"));r.url=`${r.url}&timestamp=${e}&sign=${o}`}Ia.post(r).then((t=>{0===t.errcode?Mi.info("é’‰é’‰å‘é€é€šçŸ¥æ¶ˆæ¯æˆåŠŸğŸ‰ã€‚"):Mi.info(`é’‰é’‰å‘é€é€šçŸ¥å¤±è´¥ï¼š${t.errmsg}`)})).catch((t=>{Mi.info("é’‰é’‰å‘é€é€šçŸ¥æ¶ˆæ¯å¤±è´¥ï¼ï¼"),Mi.info(t)})),n("")}else n("")}))}function es(t,e){return new Promise((n=>{const r={url:`https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=${Ma}`,data:{msgtype:"text",text:{content:` ${t}\n\n${e}`}},headers:{"Content-Type":"application/json"},timeout:15e3};Ma&&Ia.post(r).then((t=>{0===t.errcode?Mi.info("ä¼ä¸šå¾®ä¿¡å‘é€é€šçŸ¥æ¶ˆæ¯æˆåŠŸğŸ‰ã€‚"):Mi.info(`ä¼ä¸šå¾®ä¿¡å‘é€é€šçŸ¥å¤±è´¥ï¼š${t.errmsg}`)})).catch((t=>{Mi.info("ä¼ä¸šå¾®ä¿¡å‘é€é€šçŸ¥æ¶ˆæ¯å¤±è´¥ï¼ï¼"),Mi.info(t)})).finally((()=>{n("")})),n("")}))}function ns(t){const e=Ha.split(",");if(e[2]){const n=e[2].split("|");let r="";for(let e=0;e<n.length;e++){const o="ç­¾åˆ°å· "+(e+1);t.match(o)&&(r=n[e])}return r||(r=e[2]),r}return"@all"}function rs(t,e){return new Promise((n=>{if(Ha){const r=Ha.split(","),o={url:"https://qyapi.weixin.qq.com/cgi-bin/gettoken",data:{corpid:`${r[0]}`,corpsecret:`${r[1]}`},headers:{"Content-Type":"application/json"},timeout:15e3};Ia.post(o).then((o=>{const i=e.replace(/\n/g,"<br/>"),a=JSON.parse(o).access_token;let s;switch(r[4]){case"0":s={msgtype:"textcard",textcard:{title:`${t}`,description:`${e}`,url:"https://github.com/whyour/qinglong",btntxt:"æ›´å¤š"}};break;case"1":s={msgtype:"text",text:{content:`${t}\n\n${e}`}};break;default:s={msgtype:"mpnews",mpnews:{articles:[{title:`${t}`,thumb_media_id:`${r[4]}`,author:"æ™ºèƒ½åŠ©æ‰‹",content_source_url:"",content:`${i}`,digest:`${e}`}]}}}r[4]||(s={msgtype:"text",text:{content:`${t}\n\n${e}`}}),s={url:`https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=${a}`,data:{touser:`${ns(e)}`,agentid:`${r[3]}`,safe:"0",...s},headers:{"Content-Type":"application/json"}},Ia.post(s).then((t=>{0===t.errcode?Mi.info("æˆå‘˜ID:"+ns(e)+"ä¼ä¸šå¾®ä¿¡åº”ç”¨æ¶ˆæ¯å‘é€é€šçŸ¥æ¶ˆæ¯æˆåŠŸğŸ‰ã€‚"):Mi.info(`ä¼ä¸šå¾®ä¿¡åº”ç”¨ï¼š${t.errmsg}`)})).catch((t=>{Mi.info("æˆå‘˜ID:"+ns(e)+"ä¼ä¸šå¾®ä¿¡åº”ç”¨æ¶ˆæ¯å‘é€é€šçŸ¥æ¶ˆæ¯å¤±è´¥ï¼ï¼"),Mi.info(t)})).finally((()=>{n("")}))})).catch((t=>{Mi.error("ä¼ä¸šå¾®ä¿¡åº”ç”¨æ¶ˆæ¯å‘é€é€šçŸ¥æ¶ˆæ¯å¤±è´¥ï¼ï¼")}))}else n("")}))}function os(t,e,n={}){return new Promise((r=>{if(Ka){if(!new RegExp("^[a-zA-Z0-9]{24}$").test(Ka))return Mi.info("æ‚¨æ‰€æä¾›çš„IGOT_PUSH_KEYæ— æ•ˆ"),void r("");const o={url:`https://push.hellyw.com/${Ka.toLowerCase()}`,params:`title=${t}&content=${e}&${Eo(n)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};Ia.post(o).then((t=>{"string"==typeof t&&(t=JSON.parse(t)),0===t.ret?Mi.info("iGotå‘é€é€šçŸ¥æ¶ˆæ¯æˆåŠŸğŸ‰"):Mi.info(`iGotå‘é€é€šçŸ¥æ¶ˆæ¯å¤±è´¥ï¼š${t.errMsg}`)})).catch((t=>{Mi.info("å‘é€é€šçŸ¥è°ƒç”¨APIå¤±è´¥ï¼ï¼"),Mi.info(t)})).finally((()=>{r("")}))}else r("")}))}function is(t,e){return new Promise((n=>{if(qa){e=e.replace(/[\n\r]/g,"<br>");const r={url:"https://www.pushplus.plus/send",params:{token:`${qa}`,title:`${t}`,content:`${e}`,topic:`${Ya}`},headers:{"Content-Type":" application/json"},timeout:15e3};Ia.post(r).then((t=>{200===t.code?Mi.info(`push+å‘é€${Ya?"ä¸€å¯¹å¤š":"ä¸€å¯¹ä¸€"}é€šçŸ¥æ¶ˆæ¯å®Œæˆã€‚`):Mi.info(`push+å‘é€${Ya?"ä¸€å¯¹å¤š":"ä¸€å¯¹ä¸€"}é€šçŸ¥æ¶ˆæ¯å¤±è´¥ï¼š${t.msg}`)})).catch((t=>{Mi.info(`push+å‘é€${Ya?"ä¸€å¯¹å¤š":"ä¸€å¯¹ä¸€"}é€šçŸ¥æ¶ˆæ¯å¤±è´¥ï¼ï¼`),Mi.info(t)})).finally((()=>{n("")}))}else n("")}))}async function as(t,e){Mi.info("----ã€æ¶ˆæ¯æ¨é€ã€‘----"),t=`Bili-${aa.nickname}-${t}`,await async function(t,e,n={},r){Ca(),e+=r,await Promise.all([za(t,e),is(t,e)]),await Promise.all([Va(t,e,n),Za(t,e),ts(t,e),es(t,e),rs(t,e),os(t,e,n),Qa(t,e),Wa(t,e),Xa(t,e)])}(t,e,void 0,"")}const ss=Sa({baseURL:ya,headers:{"user-agent":ia.USER_AGENT}}),cs=Sa({baseURL:_a,headers:{Referer:ha,"user-agent":ia.USER_AGENT}}),us=Sa({baseURL:va,headers:{Referer:ha,"user-agent":ia.USER_AGENT}}),fs=Sa({baseURL:wa,headers:{"user-agent":ia.USER_AGENT}}),ls=Sa({baseURL:ba,headers:{"user-agent":ia.USER_AGENT}});function ds(t=3394945){const e=(new Date).getTime();return cs.get(`/xlive/web-room/v1/gift/bag_list?t=${e}&room_id=${t}`)}function ps(t=1,e=10){return t>10&&(t=10),cs.get(`/xlive/app-ucenter/v1/user/GetMyMedals?page=${t}&page_size=${e}`)}function gs({ruid:t,gift_num:e,bag_id:n,gift_id:r,roomid:o}){const i=ia.BILIJCT,a=i,s={gift_id:r,ruid:t,gift_num:e,bag_id:n,biz_id:o,rnd:(new Date).getTime(),send_ruid:0,storm_beat_id:0,metadata:"",price:0,visit_id:"",csrf:i,platform:"pc",biz_code:"Live",csrf_token:a,uid:ia.USERID};return cs.post("/xlive/revenue/v2/gift/sendBag",s,{headers:{Origin:ga}})}function ms(){return us.get("/x/web-interface/nav",{headers:{Origin:pa}})}function hs(){return us.get("/x/web-interface/coin/today/exp")}function ys(t=1,e=50,n){return us.get("/x/relation/tag",{params:{tagid:n,pn:t,ps:e}})}function _s(t,e){return us.post("/x/relation/tags/addUsers?cross_domain=true",{fids:t,tagids:e,csrf:ia.BILIJCT},{headers:{Origin:ma}})}function vs(t){const e=t.level_info,n=e.current_level;if(n>=ia.BILI_TARGET_LEVEL&&(aa.coinsTask=0),Mi.info(`å½“å‰ç­‰çº§: ${e.current_level}`),n>=6){const t=ia.config.function;t.shareAndWatch=!1,t.addCoins=!1,t.taskReward=!1,Mi.info("å·²ç»æ»¡çº§ï¼Œä¸éœ€è¦å†æŠ•å¸äº†ï¼Œåšä¸ªç™½å«–æ€ªå§")}else{const t=e.next_exp-e.current_exp;Mi.info(`è·ç¦»å‡çº§è¿˜éœ€è¦ ${t} ç»éªŒï¼Œé¢„è®¡ ${function(t){if(ia.BILI_TARGET_COINS<=0)return t/15;const e=10*ia.BILI_TARGET_COINS+15,n=t/e,r=aa.money/(ia.BILI_TARGET_COINS-1);return n<r?Math.floor(n):(t-r*e)/25+r}(t).toFixed(2)} å¤©`)}}async function ws(t){try{var e;const{data:n}=await ss.get("/site/getCoin");Mi.info(`ç™»å½•æˆåŠŸ: ${t.uname}`),Mi.info(`ç¡¬å¸ä½™é¢: ${n.money||0}`),aa.nickname=function(t){const e=t.length;return e<=3?t:`${t[0]}**${t[e-1]}`}(t.uname),aa.money=n.money||0,aa.userLevel=t.level_info.current_level,aa.bCoinCouponBalance=(null===(e=t.wallet)||void 0===e?void 0:e.coupon_balance)||0,vs(t),function(t){let e="";switch(aa.vipType=t.vipType,t.vipType){case 0:e="æ— å¤§ä¼šå‘˜";break;case 1:e="æœˆåº¦å¤§ä¼šå‘˜";break;case 2:e="å¹´åº¦å¤§ä¼šå‘˜"}0===t.vipStatus&&(e="æ— å¤§ä¼šå‘˜"===e?e:e+"[å·²è¿‡æœŸ]"),Mi.info(`å¤§ä¼šå‘˜çŠ¶æ€: ${e}`)}(t)}catch(t){Mi.error(`è·å–ç¡¬å¸ä¿¡æ¯å¼‚å¸¸: ${t.message}`),Mi.debug(t)}}function bs(t,e,n=1){return us.post("/x/web-interface/coin/add",{aid:t,multiply:e,selectLike:n,csrf:ia.BILIJCT})}function $s(t,e=1){return Ea.post("https://www.bilibili.com/audio/music-service-c/web/coin/add",{sid:t,multiply:e,csrf:ia.BILIJCT})}const Ts="video",Os="audio",Ss="article";async function Is(t=!0){try{const r=ia.USERID,{data:o,message:i,code:a}=await(t?ys(e,n,-10):function(t,e,n,r,o){return us.get("/x/relation/followings",{params:{vmid:t,pn:e,ps:n,order:r,order_type:o}})}(r)),s=t?o:o.list;if(!s||0===s.length)return{msg:"-1",data:{}};if(0===a){await la();const{mid:t}=Co(s)||{};return await Ps(t)}return{msg:t?`æœªè·å–åˆ°ç‰¹åˆ«å…³æ³¨åˆ—è¡¨: ${a}-${i}`:`æœªè·å–åˆ°å…³æ³¨åˆ—è¡¨: ${a}-${i}`,data:{}}}catch(t){return{msg:t.message,data:{}}}var e,n}async function Es(){const t=Co([1,3,4,5,160,22,119]);try{const{data:e,message:n,code:r}=await function(t,e){return us.get("/x/web-interface/ranking/region",{params:{rid:t,day:e}})}(t,3);if(0==r){const{aid:t,title:n,author:r}=Co(e);return{msg:"0",data:{id:Number(t),title:n,author:r}}}return{msg:`æœªè·å–åˆ°æ’è¡Œä¿¡æ¯: ${r}-${n}`,data:{}}}catch(t){return{msg:t.message,data:{}}}}async function Cs(){const t=ia.BILI_CUSTOMIZE_UP;return 0===t.length?{msg:"-1",data:{}}:await Ps(Co(t))}async function Ps(t){try{const{code:e,data:n,message:r}=await function(t){return us.get(`/x/space/navnum?mid=${t}`)}(t);if(e)return{msg:`é€šè¿‡uidè·å–è§†é¢‘å¤±è´¥: ${e}-${r}`,data:{}};await la();const{video:o,audio:i,article:a}=n,{type:s,page:c,index:u}=function([t,e,n]){const r=t+e+n;if(!r)return;const o=$o(0,r-1);let i=o;if(o<t)return{type:Ts,page:bo(30,i+1),index:i%30};const a=t+e;return i=o-t,o<a?{type:Os,page:bo(30,i+1),index:i%30}:(i=o-a,{type:Ss,page:bo(12,i+1),index:i%12})}([o,i,a]),f={[Ts]:xs,[Os]:As,[Ss]:Ls},l=await f[s](t,c,u);return l.message?{msg:l.message,data:{}}:{msg:"0",data:l}}catch(t){return Mi.debug(t),{msg:t.message,data:{}}}}async function xs(t,e,n){const{code:r,data:o,message:i}=await function(t,e,n=1,r=""){return us.get("/x/space/arc/search",{params:{jsonp:"jsonp",order:"pubdate",keyword:r,pn:n,tid:0,ps:e,mid:t}})}(t,30,e);if(r)return{message:i};const{aid:a,title:s,author:c}=o.list.vlist[n];return{type:Ts,id:a,title:s,author:c}}async function As(t,e,n){const{code:r,data:o,msg:i}=await function(t,e,n=1){return us.get("/audio/music-service/web/song/upper",{params:{jsonp:"jsonp",order:1,pn:n,ps:e,uid:t}})}(t,30,e);if(r)return{message:i};const{data:a}=o,{id:s,uname:c,title:u}=a[n];return{type:Os,id:s,title:u,author:c}}async function Ls(t,e,n){const{code:r,data:o,message:i}=await function(t,e,n=1){return us.get("/x/space/article",{params:{callback:"__test",jsonp:"jsonp",sort:"publish_time",pn:n,ps:e,mid:t},requestOptions:{isJsonp:!0}})}(t,12,e);if(r)return{message:i};const{articles:a}=o,{id:s,title:c,author:{name:u}}=a[n];return{type:Ss,id:s,title:c,author:u,mid:t}}const Rs=function(){const t=[Cs,Is,()=>Is(!1),Es];return ia.BILI_CUSTOMIZE_UP||t.shift(),t}();async function ks(t=0){Rs.splice(0,aa.currentStartFun+t);for(let t=0;t<Rs.length;t++){var e;const n=Rs[t];let r=Number(null!==(e=ia.BILI_COIN_RETRY_NUM)&&void 0!==e?e:4);for(r=r<1?1:r>8?8:r;r--;){await la();const t=await n();if("-1"===t.msg&&(r=0),"0"===t.msg)return t}r<=0&&(aa.currentStartFun=t)}return{msg:"-1",data:{id:0}}}async function Us({id:t,coin:e,type:n,mid:r}){const o={[Ts]:bs,[Os]:$s,[Ss]:(t,e=1)=>function(t,e,n=1){return us.post("/x/web-interface/coin/add",{aid:e,upid:t,avtype:2,multiply:n,csrf:ia.BILIJCT})}(r,t,e)},i=await o[n](Number(t),e);return{code:i.code,message:i.message||i.msg}}async function Ns(t){if(await async function(){try{const{data:t,code:e}=await hs();if(0==e){const e=ia.BILI_TARGET_COINS-t/10;aa.coinsTask=e>0?e:0}}catch(t){}}(),aa.coinsTask<=0||aa.money<=0)return!0;const{data:e,msg:n}=await ks(t.priority);return null!=e&&e.id&&"0"==n?(await la(),await async function(t,e){const{id:n,title:r,author:o,type:i,mid:a}=t;try{const t=await Us({id:n,type:i,mid:a});if(0===t.code)aa.money--,aa.coinsTask--,e.num++,Mi.info(`ç»™[${r}--upã€${o}ã€‘]æŠ•å¸æˆåŠŸ`);else if(34005===t.code)e.fillCount++,Mi.verbose(`å½“å‰ç¨¿ä»¶[${n}]ä¸èƒ½å†æŠ•å¸äº†`),e.fillCount>=3&&(Mi.warn("è‡ªå®šä¹‰ç”¨æˆ·ç»„æŠ•å¸ä¼¼ä¹æ²¡æœ‰å¸å¯æŠ•äº†"),e.priority++);else{if(-111===t.code||-104===t.code)return Mi.warn(`${n} ${t.message} æ— æ³•ç»§ç»­è¿›è¡ŒæŠ•å¸`),!0;if(e.eCount++,Mi.warn(`ç»™${n}æŠ•å¸å¤±è´¥ ${t.code} ${t.message}`),e.prevCode===t.code)return!0;e.prevCode=t.code}}catch(t){e.eCount++,Mi.error(`æŠ•å¸å¼‚å¸¸ ${t.message}`)}finally{await la(1500)}return!1}(e,t)):(t.eCount++,!1)}async function js(){try{const{data:t,code:e,message:n}=await ls.get("/link_group/v1/member/my_groups");return 0===e?(null==t?void 0:t.list)||[]:(Mi.warn(`è·å–è‡ªå·±çš„åº”æ´å›¢å¼‚å¸¸å¤±è´¥: ${n}`),[])}catch(t){Mi.error(`è·å–è‡ªå·±çš„åº”æ´å›¢å¼‚å¸¸: ${t}`)}}const Bs=["(âŒ’â–½âŒ’)","ï¼ˆï¿£â–½ï¿£ï¼‰","(=ãƒ»Ï‰ãƒ»=)","(ï½€ãƒ»Ï‰ãƒ»Â´)","(ã€œï¿£â–³ï¿£)ã€œ","(ï½¥âˆ€ï½¥)","(Â°âˆ€Â°)ï¾‰","(ï¿£3ï¿£)","â•®(ï¿£â–½ï¿£)â•­","_(:3ã€âˆ )_","( Â´_ã‚ï½€)","â†_â†","â†’_â†’","(<_<)","(>_>)","(;Â¬_Â¬)","(ï¾ŸĞ”ï¾Ÿâ‰¡ï¾ŸĞ´ï¾Ÿ)!?","Î£(ï¾ŸĞ´ï¾Ÿ;)","Î£( ï¿£â–¡ï¿£||)","(Â´ï¼›Ï‰ï¼›`)","ï¼ˆ/TĞ”T)/","(^ãƒ»Ï‰ãƒ»^ )","(ï½¡ï½¥Ï‰ï½¥ï½¡)","(â—ï¿£(ï½´)ï¿£â—)","Îµ=Îµ=(ãƒâ‰§âˆ‡â‰¦)ãƒ","(Â´ï½¥_ï½¥`)","(-_-#)","ï¼ˆï¿£ã¸ï¿£ï¼‰","(ï¿£Îµ(#ï¿£) Î£","ãƒ½(`Ğ”Â´)ï¾‰","ï¼ˆ#-_-)â”¯â”â”¯","(â•¯Â°å£Â°)â•¯(â”´â€”â”´","â†â—¡â†","( â™¥Ğ´â™¥)","Î£>â€•(ã€ƒÂ°Ï‰Â°ã€ƒ)â™¡â†’","â„(â„ â„â€¢â„Ï‰â„â€¢â„ â„)â„","(â•¬ï¾ŸĞ´ï¾Ÿ)â–„ï¸»â”»â”³â•ä¸€","ï½¥*ï½¥:â‰¡(ã€€Îµ:)","(æ±—)","(è‹¦ç¬‘)"].concat("1","2","3","4","5","6","7","8","9","ç­¾åˆ°","å“ˆå“ˆ");async function Gs(){try{const{code:r,message:o,data:i}=await(t=1,e=256,n=ia.USERID,cs.get(`/xlive/app-ucenter/v1/fansMedal/panel?page=${t}&page_size=${e}&target_id=${n}`));return 0!==r?(Mi.verbose(`è·å–å‹‹ç« ä¿¡æ¯å¤±è´¥ ${r} ${o}`),null):i}catch(t){return Mi.error(`è·å–å‹‹ç« å¼‚å¸¸ ${t.message}`),null}var t,e,n}async function Ds(t,e){const n=Bs[$o(Bs.length-1)];try{const{code:r,message:o}=await function(t,e){const n=ia.BILIJCT,r=n;return e||(e=$o(10).toString()),cs.post("/msg/send",{color:5566168,fontsize:25,mode:1,msg:e,rnd:Date.now(),roomid:t,bubble:0,csrf:n,csrf_token:r})}(t,n);return 0===r||(11e3===r?(Mi.warn(`ã€${e}ã€‘${t}-å¯èƒ½æœªå¼€å¯è¯„è®º`),!1):(Mi.warn(`ã€${e}ã€‘${t}-å‘é€å¤±è´¥ ${o}`),Mi.verbose(`code: ${r}`),!1))}catch(t){Mi.verbose(`å‘é€å¼¹å¹•å¼‚å¸¸ ${t.message}`)}}async function Ms(){try{const{data:t,message:e,code:n}=await ms();if(0!==n)return void Mi.warn(`è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼š${n} ${e}`);!function(t){var e;aa.bCoinCouponBalance=(null===(e=t.wallet)||void 0===e?void 0:e.coupon_balance)||0}(t)}catch(t){Mi.error(`è·å–ç”¨æˆ·ä¿¡æ¯å¼‚å¸¸ï¼š${t.message}`)}}var Hs;async function Ks(t){try{const e=function(t){switch(t){case 1:return"B å¸åˆ¸";case 2:return"å¤§ä¼šå‘˜ä¼˜æƒ åˆ¸";default:return""}}(t),{code:n,message:r}=await function(t){return us.post("/x/vip/privilege/receive",{csrf:ia.BILIJCT,type:t})}(t);let o="æˆåŠŸ";return 0===n&&(o=`å¤±è´¥ ${r}`),Mi.info(`é¢†å–${e} ${o}`),!0}catch(t){Mi.error(`é¢†å–æƒç›Šå‡ºç°å¼‚å¸¸ï¼š${t.message}`)}return!1}async function qs(t){let e=0,n=!1;for(;!(n||(n=await Ks(t),e>2));)e++;return n}!function(t){t[t["æˆåŠŸ"]=4]="æˆåŠŸ",t[t["ä½äº20ç”µæ± "]=-2]="ä½äº20ç”µæ± ",t[t["Bå¸ä¸è¶³"]=-4]="Bå¸ä¸è¶³"}(Hs||(Hs={}));let Ys=0;async function Fs(){try{const{data:{list:t}}=await ds();return t.filter((t=>{if(t.expire_at<=0)return!1;const e=(1e3*t.expire_at-(new Date).getTime())/864e5<2,n=![1,30607].includes(t.gift_id);return n&&e&&Mi.info(`${t.gift_name} å³å°†è¿‡æœŸè¯·å°½å¿«æŠ•å–‚`),!n&&e}))}catch(t){if(Ys)return null;await Fs(),Ys++}}async function Js(t){try{const{data:{live_room:e,name:n}}=await function(t){return us.get(`/x/space/acc/info?mid=${t}&jsonp=jsonp`)}(t);if(await la(),e.roomStatus)return{roomid:e.roomid,name:n}}catch{}}function Qs(t,e,n,r){const o=ia.BILIJCT,i={is_fav:0,main_id:e,oid:t,detail_id:n,count:r,csrf:o,csrf_token:o};return us.post("/x/esports/guess/add",i)}function Ws(){return aa.money-ia.MATCH_COINS<ia.BILI_TARGET_COINS&&(Mi.info(`éœ€è¦ä¿ç•™${ia.BILI_TARGET_COINS}ä¸ªç¡¬å¸ï¼Œä»»åŠ¡ç»“æŸ`),!0)}function zs(t,e,n,r,o){const i=Lo(ia.COOKIE),a=i,s=[(c=ia.COOKIE,Ao(c,"LIVE_BUVID")||""),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))];var c;return{ua:ia.USER_AGENT,id:[n,e,o,t],csrf_token:i,csrf:a,device:s,uname:r}}async function Xs(){try{await Ea.get("https://api.live.bilibili.com/relation/v1/Feed/heartBeat")}catch{}}async function Vs(t){const{data:{area_id:e,parent_area_id:n,room_id:r}}=await function(t){return cs.get(`/room/v1/Room/get_info?room_id=${t}&from=room`)}(t);return{room_id:r,area_id:e,parent_area_id:n}}async function Zs(t,e){const n={id:JSON.stringify(t.id),device:JSON.stringify(t.device),ts:(new Date).getTime(),is_patch:0,heart_beat:"[]",ua:t.ua,visit_id:"",csrf:t.csrf,csrf_token:t.csrf_token};try{const{data:r,code:o}=await function(t){return Ea.post("https://live-trace.bilibili.com/xlive/data-interface/v1/x25Kn/E",t)}(n);if(0===o)return Mi.info(`è¿›å…¥ã€${t.uname}ã€‘çš„ç›´æ’­é—´`),e.v++,r}catch(t){Mi.verbose(t)}}async function tc(t,e,n){if(n.v>6)return;const r={id:JSON.stringify(e.id),device:JSON.stringify(e.device),ets:t.timestamp,benchmark:t.secret_key,time:60,ts:(new Date).getTime(),ua:e.ua},o=function(t,e){const[n,r,o,i]=JSON.parse(t.id),[a,s]=JSON.parse(t.device),{ets:c,time:u,ts:l}=t,d={platform:"web",parent_id:n,area_id:r,seq_id:o,room_id:i,buvid:a,uuid:s,ets:c,time:u,ts:l},p=t.benchmark,g=["MD5","SHA1","SHA256","SHA224","SHA512","SHA384"];let m=JSON.stringify(d);for(const t of e)m=f.createHmac(g[t],p).update(m).digest("hex");return m}(r,t.secret_rule);try{const{data:t,code:i,message:a}=await function(t){return Ea.post("https://live-trace.bilibili.com/xlive/data-interface/v1/x25Kn/X",t)}(Object.assign({visit_id:"",csrf:e.csrf,csrf_token:e.csrf_token,s:o},r));return 0===i?(Mi.info(`å‘ã€${e.uname}ã€‘å‘é€ç¬¬${n.v}æ¬¡å¿ƒè·³`),n.v++):Mi.warn(`å‘ã€${e.uname}ã€‘å‘é€ç¬¬${n.v}æ¬¡å¿ƒè·³å¤±è´¥ ${i} ${a}`),t}catch(t){Mi.verbose(t)}}async function ec(t=1,e=10){try{const{code:n,message:r,data:o}=await ps(t,e);return 0!==n?(Mi.verbose(`è·å–ç›´æ’­é—´å¤±è´¥ ${n} ${r}`),null):o}catch(t){return Mi.verbose(`è·å–ç›´æ’­é—´å¼‚å¸¸ ${t.message}`),null}}async function nc(t=!0){const e=await async function(){let t=0;try{var e,n;const{data:r,code:o}=await ds();return 0!==o||(null===(e=r.list)||void 0===e?void 0:e.length)<=0?24:(null===(n=r.list)||void 0===n||n.forEach((e=>{if(30607===e.gift_id){const n=(1e3*e.expire_at-(new Date).getTime())/864e5;n>6&&n<=7&&(t+=e.gift_num)}})),t>=24?0:24-t)}catch(t){}return 24}();let n;return t?n=await async function(){const{items:t,page_info:e}=await ec();let{total_page:n}=e;if(n&&n>1){n=n>3?3:n;for(let e=2;e<=n;e++){const n=await ec(e,10);t.push(...n.items)}}return t}():({items:n}=await ec()),{fansMedalList:n,heartNum:e}}async function rc(t,e,n,r){if(!r.v||e[n])return await Xs(),await la(500),0===r.v?e[n]=await Zs(t,r):e[n]=await tc(e[n],t,r),"done"}async function oc(t,e){const n=[];let r=0;for(let o=0;o<6;o++){let i=0;if(i>=e)break;const a=t.length;r=0;for(let s=0;s<a&&!(i>=e);s++){const e=(new Date).getTime(),a=t[s],{roomid:c,uname:u}=a,{room_id:f,area_id:l,parent_area_id:d}=await Vs(c),p=zs(f,l,d,u,o);await rc(p,n,s,{v:o}),await la(2e3),r+=(new Date).getTime()-e,i++}o<5&&await la(6e4-r)}return"done"}async function ic(){const{data:t,code:e}=await ys(1,1,0);if(0!==e)throw new Error(`è·å–æœ€åä¸€ä¸ªå…³æ³¨å¤±è´¥: ${e}`);return t[0]}async function ac(t){const{data:e,code:n}=await us.get("/x/relation/tags?jsonp=jsonp&callback=__jp3",{headers:{Referer:"https://space.bilibili.com/1/fans/follow?tagid=0"},requestOptions:{isJsonp:!0}});if(0===n)return e.find((e=>e.name===t));Mi.warn(`è·å–åˆ†ç»„åˆ—è¡¨å¤±è´¥: ${n}`)}async function sc(t){const e=await ac(t);if(e)return e.tagid;await la(300);const{data:n,code:r,message:o}=await(i=t,us.post("/x/relation/tag/create",{tag:i,jsonp:"jsonp",csrf:ia.BILIJCT}));var i;if(22106===r){await la(300);const e=await ac(t);return e&&e.tagid}return 0!==r&&Mi.warn(`åˆ›å»ºåˆ†ç»„å¤±è´¥: ${r}-${o}`),n.tagid}async function cc(t,e){if(0===t.length)return;const n=await sc(e);if(n)for(const e of t){const{code:t,message:r}=await _s(e.mid,n);0!==t&&Mi.warn(`ç§»åŠ¨ã€${e.uname}ã€‘å¤±è´¥: ${t}-${r}`),await la()}}async function uc(t,e,n,r=1){if(t.length>e.length)return;const{data:o,code:i,message:a}=await ys(r,20,0);if(0===i){for(const{mid:r,uname:i}of o){if(t.length>=e.length)return;if(r===n)return;(e.includes(r)||e.includes(i))&&t.push({mid:r,uname:i})}if(!(o.length<20))return await uc(t,e,n,r+1)}else Mi.warn(`è·å–å…³æ³¨ç”¨æˆ·å¤±è´¥: ${i}-${a}`)}const fc=0,lc=1,dc=5,pc=1,gc=504,mc=1096;let hc;async function yc(){try{const{data:t,code:e,message:n}=await cs.get("/xlive/web-interface/v1/index/getWebAreaList?source_id=2");return 0!==e&&Mi.info(`è·å–ç›´æ’­åˆ†åŒºå¤±è´¥: ${e}-${n}`),t.data.map((t=>t.list)).map((t=>t.map((t=>({areaId:t.id,parentId:t.parent_id})))))}catch(t){throw Mi.error(`è·å–ç›´æ’­åˆ†åŒºå¼‚å¸¸: ${t.message}`),t}}async function _c(t,e,n=1,r="lottery"){try{await la(100);const{data:o,code:i,message:a}=await function(t,e,n){return cs.get(`/xlive/web-interface/v1/second/getList?platform=web&parent_area_id=${t}&area_id=${e}&page=${n}`)}(e,t,n);return 0!==i&&Mi.info(`è·å–ç›´æ’­é—´åˆ—è¡¨å¤±è´¥: ${i}-${a}`),function(t){const e=[],n=[];return t.forEach((t=>{const r=t.pendant_info[2];r&&(r.pendent_id===gc?e.push(t):r.pendent_id===mc&&n.push(t))})),{lotteryTime:e,lotteryPacket:n}}(o.list)["lottery"===r?"lotteryTime":"lotteryPacket"]}catch(t){throw Mi.error(`è·å–ç›´æ’­é—´åˆ—è¡¨å¼‚å¸¸: ${t.message}`),t}}async function vc(t,e,n=1){const r=await _c(t,e,n),o=[];for(const t of r){const e=await wc(t);e&&(o.push({...e,uid:t.uid,uname:t.uname}),await la(100))}return o}async function wc(t){if(ia.LOTTERY_UP_BLACKLIST.includes(t.uid))return void Mi.info(`è·³è¿‡é»‘åå•ç”¨æˆ·: ${t.uname}`);let e,n,r;try{({data:n,code:e,message:r}=await(o=t.roomid,cs.get(`/xlive/lottery-interface/v1/Anchor/Check?roomid=${o}`)))}catch(e){return void Mi.info(`ç›´æ’­é—´${t.roomid}æ£€æµ‹å¼‚å¸¸: ${e.message}`)}var o;if(0!==e)return void Mi.debug(`ç›´æ’­é—´${t.roomid}æ£€æµ‹å¤±è´¥: ${e}-${r}`);if(null===n)return;const i=ia.LOTTERY_EXCLUDE.some((t=>n.award_name.match(t)));if(!ia.LOTTERY_INCLUDE.some((t=>n.award_name.match(t)))&&i)Mi.info(`è·³è¿‡å±è”½å¥–å“: ${n.award_name}`);else if(n.status!==pc);else if(n.gift_price>0);else{if(n.require_type===fc||n.require_type===lc)return n;if(n.require_type===dc&&aa.userLevel>=n.require_value)return n}}async function bc(t){try{const{id:n,gift_id:r,gift_num:o,award_name:i,uid:a,uname:s,require_type:c,require_text:u}=t;Mi.info(`å¤©é€‰ä¸»æ’­ï¼šã€${s}ã€‘`),Mi.info(`å¥–å“ï¼š${i}`);const{code:f,message:l}=await(e={id:n,gift_id:r,gift_num:o},cs.post("/xlive/lottery-interface/v1/Anchor/Join",{...e,csrf:ia.BILIJCT,csrf_token:ia.BILIJCT,visit_id:To(),platform:"pc"}));if(0!==f)return void Mi.info(`å¤©é€‰å¤±è´¥: ${f}-${l}`);if(Mi.info("å¤©é€‰æˆåŠŸ âˆš"),c===lc){Oo(hc,a);(function(t){const e=(t=t.replace("å…³æ³¨ä¸»æ’­","")).split(/\s*\+\s*/);return e.shift(),e})(u).forEach((t=>Oo(hc,t)))}}catch(t){Mi.info(`å¤©é€‰å¼‚å¸¸: ${t.message}`)}var e}async function $c(t,e,n=2){for(let r=1;r<=n;r++){const n=await vc(t,e,r);for(const t of n)await bc(t),await la(300)}}async function Tc(t){try{const{data:e,code:n}=await function(t){return cs.get(`/xlive/lottery-interface/v1/lottery/getLotteryInfoWeb?roomid=${t}`)}(t);if(0!==n)return;const{popularity_red_pocket:r}=e;if(!r)return;const{lot_id:o,lot_status:i}=r[0];if(2===i)return;return o}catch(t){}}async function Oc(t,e,n=1){const r=await _c(t,e,n,"redPack"),o=[];for(const t of r){const e=await Tc(t.roomid);e&&(o.push({uid:t.uid,uname:t.uname,lot_id:e,room_id:t.roomid}),await la(100))}return o}async function Sc(t){try{const{lot_id:n,uid:r,uname:o,room_id:i}=t;Mi.info(`çº¢åŒ…ä¸»æ’­ï¼šã€${o}ã€‘`);const{code:a,message:s}=await(e={room_id:i,lot_id:n,ruid:r},cs.post("/xlive/lottery-interface/v1/popularityRedPocket/RedPocketDraw",{...e,spm_id:"444.8.red_envelope.extract",jump_from:"",session_id:"",csrf_token:ia.BILIJCT,csrf:ia.BILIJCT,visit_id:""}));if(0!==a)return void Mi.info(`çº¢åŒ…å¤±è´¥: ${a}-${s}`);hc.push(r),Mi.info("çº¢åŒ…æˆåŠŸ âˆš")}catch(t){Mi.info(`çº¢åŒ…å¼‚å¸¸: ${t.message}`)}var e}async function Ic(t,e,n=2){for(let r=1;r<=n;r++){const n=await Oc(t,e,r);for(const t of n)await Sc(t),await la(200)}}function Ec({talker_id:t,session_type:e}){return ls.post("/session_svr/v1/session_svr/remove_session",{talker_id:t,session_type:e,build:0,mobi_app:"web",csrf_token:ia.BILIJCT,csrf:ia.BILIJCT})}async function Cc(t){try{const{code:e,message:n,data:r}=await function({session_type:t}){return ls.get(`/session_svr/v1/session_svr/get_sessions?session_type=${t}&group_fold=1&unfollow_fold=1&sort_rule=2&build=0&mobi_app=web`)}();if(0!==e)return void Mi.warn(`è·å–ä¼šè¯å¤±è´¥ï¼š${e}-${n}`);const{session_list:o}=r;if(o.length<=0)return;return o.filter((({unread_count:e,talker_id:n,is_follow:r,last_msg:o})=>{return t.find((t=>t.mid===n))&&e>0&&n===o.sender_uid&&1===r&&(i=o.timestamp,Date.now()-1e3*i<36e5);var i}))}catch(t){Mi.error(`è·å–ä¼šè¯å¼‚å¸¸ï¼š${t.message}`)}}async function Pc(t){const e=await Cc(t);await la(200);try{for(let t=0;t<e.length;t++){const n=e[t];await Ec(n),await la(50)}}catch(t){Mi.error(`æ›´æ–°ä¼šè¯å¼‚å¸¸ï¼š${t.message}`)}e.length>=19&&await Pc(t)}var xc={taskReward:async function(){Mi.info("----ã€æ¯æ—¥ä»»åŠ¡å®Œæˆæƒ…å†µã€‘----");try{const{data:t,message:e,code:n}=await us.get("/x/member/web/exp/reward");await la();const{data:r}=await hs();if(0!=n)return void Mi.warn(`çŠ¶æ€è·å–å¤±è´¥: ${n} ${e}`);const o=aa.money-ia.BILI_STAY_COINS;let i=0;0===aa.coinsTask?Mi.info(`ä»Šæ—¥æŠ•å¸è·å–ç»éªŒ: ${r}ï¼Œè¿˜éœ€æŠ•å¸0é¢—ï¼Œç»éªŒå¤Ÿäº†ï¼Œä¸æƒ³æŠ•äº†`):o<=0?Mi.info(`ä»Šæ—¥æŠ•å¸è·å–ç»éªŒ: ${r}ï¼Œè¿˜éœ€æŠ•å¸0é¢—ï¼Œç¡¬å¸ä¸å¤Ÿäº†ï¼Œä¸æŠ•å¸äº†`):o<aa.coinsTask?(i=aa.coinsTask-o,Mi.info(`æŠ•å¸è·å–ç»éªŒ: ${r}ï¼Œè¿˜éœ€æŠ•å¸æ•°é‡: ${i}é¢—;(ç›®æ ‡${aa.coinsTask}é¢—ï¼Œå¿½ç•¥éƒ¨åˆ†æŠ•å¸)`)):(i=aa.coinsTask-r/10,Mi.info(`æŠ•å¸è·å–ç»éªŒ: ${r}ï¼Œè¿˜éœ€æŠ•å¸æ•°é‡: ${i}é¢—;(ç›®æ ‡${aa.coinsTask}é¢—)`)),aa.coinsTask=i,Mi.info("æ¯æ—¥åˆ†äº«: "+(t.share?"å·²å®Œæˆ":"[æœªå®Œæˆ]")),Mi.info("æ¯æ—¥æ’­æ”¾: "+(t.watch?"å·²å®Œæˆ":"[æœªå®Œæˆ]")),aa.share=t.share,aa.watch=t.watch}catch(t){Mi.error(`çŠ¶æ€è·å–å¼‚å¸¸ ${t.message}`)}},liveSignTask:async function(){Mi.info("----ã€ç›´æ’­ç­¾åˆ°ã€‘----");try{const{data:t}=await cs.get("/xlive/web-ucenter/v1/sign/WebGetSignInfo");if(1===t.status)return Mi.info("å·²ç­¾åˆ°ï¼Œè·³è¿‡ç­¾åˆ°"),void Mi.info(`å·²ç»ç­¾åˆ°${t.hadSignDays}å¤©ï¼Œ${t.specialText}`)}catch(t){}try{const{code:t,data:e,message:n}=await cs.get("/xlive/web-ucenter/v1/sign/DoSign");0===t?Mi.info(`ç›´æ’­ç­¾åˆ°æˆåŠŸ: ${e.text}ï¼Œç‰¹åˆ«ä¿¡æ¯: ${e.specialText}ï¼Œæœ¬æœˆç­¾åˆ°å¤©æ•°: ${e.hadSignDays}å¤©;`):Mi.warn(`ç›´æ’­ç­¾åˆ°å¤±è´¥: ${t} ${n}`)}catch(t){Mi.error(`ç›´æ’­ç­¾åˆ°å¼‚å¸¸: ${t.message}`)}},shareAndWatch:async function(){if(Mi.info("----ã€åˆ†äº«/æ’­æ”¾è§†é¢‘ã€‘----"),aa.share&&aa.watch)return void Mi.info("å·²å®Œæˆï¼Œè·³è¿‡åˆ†äº«/æ’­æ”¾");let t=0;try{let e=await ks();if("-1"===e.msg&&(e=await Es()),"0"!==e.msg)return Mi.warn(`è·å–è§†é¢‘å¤±è´¥ ${e.msg}`),!1;{const{id:n,author:r,title:o}=e.data;t=n,Mi.info(`è·å–è§†é¢‘: ${o} --upã€${r}ã€‘`)}}catch(t){return Mi.error(`è·å–è§†é¢‘å‡ºç°å¼‚å¸¸: ${t.message}`),!1}if(!aa.share){await la();try{const{code:e,message:n}=await function(t){const e={csrf:ia.BILIJCT,aid:t};return us.post("/x/web-interface/share/add",e)}(t);0===e?Mi.info("åˆ†äº«è§†é¢‘æˆåŠŸ!"):Mi.warn(`åˆ†äº«è§†é¢‘å¤±è´¥: ${e} ${n}`)}catch(t){Mi.error(`åˆ†äº«è§†é¢‘å¼‚å¸¸: ${t.message}`)}}if(!aa.watch){await la();try{const{code:r,message:o}=await(e=t,n=$o(4,60),us.post("/x/click-interface/web/heartbeat",{aid:e,played_time:n}));0===r?Mi.info("æ’­æ”¾è§†é¢‘æˆåŠŸ!"):Mi.warn(`æ’­æ”¾è§†é¢‘å¤±è´¥: ${r} ${o}`)}catch(t){Mi.error(`æ’­æ”¾è§†é¢‘å¼‚å¸¸: ${t.message}`)}}var e,n},silver2Coin:async function(){Mi.info("----ã€é“¶ç“œå­å…‘æ¢ç¡¬å¸ã€‘----");try{const{data:t,code:e,message:n}=await cs.get("/xlive/revenue/v1/wallet/getStatus");if(0!=e&&Mi.info(`è·å–ç“œå­è¯¦æƒ…å¤±è´¥ ${n}`),0===t.silver_2_coin_left)Mi.info("ä»Šæ—¥å·²å…‘æ¢ä¸€æ¬¡");else if(t.silver<700)Mi.info("å…‘æ¢å¤±è´¥ï¼Œä½ ç“œå­ä¸å¤Ÿäº†");else{const{message:t}=await cs.post("/xlive/revenue/v1/wallet/silver2coin",{csrf_token:ia.BILIJCT,csrf:ia.BILIJCT});Mi.info(`å…‘æ¢ç¡¬å¸ï¼š ${t}`),await cs.get("/xlive/revenue/v1/wallet/myWallet?need_bp=1&need_metal=1&platform=pc")}}catch(t){Mi.error(`æ“ä½œå¼‚å¸¸ ${t.message}`)}},addCoins:async function(){if(Mi.info("----ã€è§†é¢‘æŠ•å¸ã€‘----"),!aa.coinsTask)return void Mi.info("è·³è¿‡æŠ•å¸ï¼Œä»Šæ—¥å·²å®Œæˆ");const t={eCount:0,num:0,prevCode:0,fillCount:0,priority:0};let e=!1;for(;aa.coinsTask&&!e&&t.eCount<5;)e=await Ns(t);t.eCount>=5&&Mi.info("å‡ºç°å¼‚å¸¸/é”™è¯¯5æ¬¡ï¼Œè‡ªåŠ¨é€€å‡ºæŠ•å¸"),Mi.info(`ä¸€å…±æˆåŠŸæŠ•å¸${t.num}é¢—`),Mi.info(`ç¡¬å¸è¿˜å‰©${aa.money}é¢—`)},mangaSign:async function(){Mi.info("----ã€æ¼«ç”»ç­¾åˆ°ã€‘----");try{const{code:t}=await fs.post("/twirp/activity.v1.Activity/ClockIn",{platform:e});0==t?Mi.info("æ¼«ç”»ç­¾åˆ°æˆåŠŸ"):Mi.warn("æ¼«ç”»ç­¾åˆ°å¤±è´¥")}catch(e){var t;400===(null===(t=e.response)||void 0===t?void 0:t.status)?Mi.info("å·²ç»ç­¾åˆ°è¿‡äº†ï¼Œè·³è¿‡ä»»åŠ¡"):Mi.error(`æ¼«ç”»ç­¾åˆ°å¼‚å¸¸ ${e.message}`)}var e},supGroupSign:async function(){Mi.info("----ã€åº”æ´å›¢ç­¾åˆ°ã€‘----");const t=await js();await la();let e=0;for(let o=0;o<t.length;){const i=t[o];try{const{data:t,code:o,message:a}=await(n=i.group_id,r=i.owner_uid,ls.get("/link_setting/v1/link_setting/sign_in",{params:{group_id:n,owner_id:r}}));0===o?0===t.status?e++:Mi.info(a):Mi.warn(`[${i.group_name}]ç­¾åˆ°å¤±è´¥ ${a}`)}catch(t){Mi.error(`ç­¾åˆ°å¼‚å¸¸ ${t.message}`)}finally{await la()}}var n,r;Mi.info(`ç­¾åˆ°ç»“æŸï¼ŒæˆåŠŸ${e}/${t.length}`)},liveSendMessage:async function(){Mi.info("----ã€å‘é€ç›´æ’­å¼¹å¹•ã€‘----");const t=await async function(){const{list:t,special_list:e}=await Gs();return t.push(...e),t}(),e=t.length;let n=0,r=0;Mi.info(`ä¸€å…±éœ€è¦å‘é€${e}ä¸ªç›´æ’­é—´`),Mi.verbose("æ‰€éœ€æ—¶é—´å¯èƒ½å¾ˆé•¿ï¼Œè¯·è€å¿ƒç­‰å¾…");for(let o=0;o<e;o++){const{room_info:i,anchor_info:a,medal:s}=t[o];null!=i&&i.room_id?100===s.today_feed||s.guard_level>0?r++:(await Ds(i.room_id,a.nick_name)&&n++,o<e-1&&await la($o(1e4,25e3))):(Mi.info(`ã€${a.nick_name}ã€‘æ²¡æœ‰ç›´æ’­é—´å“¦`),r++)}Mi.info(`æˆåŠŸå‘é€${n}ä¸ªå¼¹å¹•ï¼Œè·³è¿‡${r}ä¸ª`)},charging:async function(){if(Mi.info("----ã€ç»™ç›®æ ‡å……ç”µã€‘----"),await Ms(),await la(),function(){const t=wo(),e=t.getDate(),n=vo(t),r=ia.CHARGE_PRESET_TIME;return aa.bCoinCouponBalance<2?(Mi.info(`å‰©ä½™åˆ¸ä¸º${aa.bCoinCouponBalance}ï¼Œä¸è¶³2è·³è¿‡å……ç”µ`),!1):n===e?(Mi.info("ä»Šå¤©æ˜¯æœ€åä¸€å¤©äº†"),!0):!(r>e&&(Mi.info(`é¢„è®¾æ—¶é—´ä¸º${r}ï¼Œä¸ç¬¦åˆæ¡ä»¶`),1))}())try{const t=aa.bCoinCouponBalance||0,e=ia.CHARGE_ID;let n=0;Mi.info(`b å¸åˆ¸ä½™é¢${t}`);const r=async()=>{const{code:n,message:r,data:o}=await function(t,e,n=ia.USERID,r,o){return us.post("/x/ugcpay/web/v2/trade/elec/pay/quick",{csrf:ia.BILIJCT,bp_num:t,is_bp_remains_prior:e,up_mid:n,otype:r,oid:o})}(t,!0,e);0===n?(Mi.info(`ã€å……å€¼ç»“æœã€‘${Hs[o.status]}`),o.status===Hs["æˆåŠŸ"]&&(aa.chargeOrderNo=o.order_no,await la(),await async function(){try{if(!aa.chargeOrderNo)return!1;const t=fo[$o(0,fo.length-1)],{code:e}=await function(t,e){return us.post("/x/ugcpay/trade/elec/message",{csrf:ia.BILIJCT,message:e,order_id:t})}(aa.chargeOrderNo,t);0===e&&Mi.info("ç•™è¨€æˆåŠŸï¼")}catch{}}())):Mi.warn(`å……ç”µå¤±è´¥ï¼š${n} ${r}`)};for(aa.chargeOrderNo="";!(aa.chargeOrderNo||(await r(),await la(),n++>2)););}catch(t){Mi.error(`å……ç”µå‡ºç°å¼‚å¸¸ï¼š${t.message}`)}},getVipPrivilege:async function(){Mi.info("----ã€é¢†å–å¤§ä¼šå‘˜æƒç›Šã€‘----"),function(){if(2!==aa.vipType)return Mi.info("è´¦å·éå¹´åº¦å¤§ä¼šå‘˜ï¼Œä¸éœ€è¦é¢†å–æƒç›Š"),!1;const t=wo(),e=t.getDate(),n=vo(t);return 1===e||n===e||(Mi.info("ä»Šå¤©éé¢„è®¢é¢†å–æ—¶é—´ï¼Œè·³è¿‡é¢†å–"),!1)}()&&(await qs(1),await qs(2))},giveGift:async function(){Mi.info("----ã€æŠ•å–‚è¿‡æœŸé£Ÿç‰©ã€‘----");try{const t=await Fs();if(await la(),null==t||!t.length)return void Mi.info("æ²¡æœ‰2å¤©å†…è¿‡æœŸçš„ç®€å•ç¤¼ç‰©");const e=await async function(){const t=Object.assign([],ia.BILI_GIFT_UP),e=()=>t.splice($o(ia.BILI_GIFT_UP.length-1),1)[0];for(;t.length;){const t=e(),n=await Js(t);if(n)return{mid:t,...n}}return await async function(){const{data:{count:t,items:e}}=await ps();if(await la(),!t)return;const n=e[$o(e.length-1)];return{mid:n.target_id,roomid:n.roomid||0,name:n.uname}}()}();if(!e)return void Mi.info("æ²¡æœ‰æ‰¾åˆ°æŠ•å–‚ç›®æ ‡");await async function({roomid:t,mid:e,name:n},r){for(const o of r){await la();try{const{code:r,message:i,data:a}=await gs({roomid:t,ruid:e,bag_id:o.bag_id,gift_id:o.gift_id,gift_num:o.gift_num});if(0!==r){Mi.warn(`å‘[${n}]æŠ•å–‚[${o.gift_name}]ï¼Œ${i}`);continue}a.gift_list.forEach((t=>{Mi.info(`æˆåŠŸç»™ [${n}] æŠ•å–‚${t.gift_name}`)}))}catch{}}}(e,t)}catch(t){Mi.info(`æŠ•å–‚è¿‡æœŸé£Ÿç‰©å¼‚å¸¸ ${t}`)}},matchGame:async function(){if(Mi.info("----ã€èµ›äº‹ç¡¬å¸ç«çŒœã€‘----"),ia.MATCH_COINS<=0)return void Mi.info("ç¡¬å¸æ•°é‡ä¸èƒ½å°äº 0");if(Ws())return;const t=await async function(){try{const{code:n,message:r,data:{list:o,page:i}}=await us.get(`/x/esports/guess/collection/question?pn=1&ps=50&gid=&sids=&stime=${t}&etime=${e}`);return 0!==n?void Mi.warn(`è·å–èµ›äº‹é”™è¯¯ ${n} ${r}`):0===i.total?(Mi.info("ä»Šæ—¥å·²ç»æ— æ³•è·å–èµ›äº‹"),null):o}catch(t){}var t,e}();if(await la(),!t)return;const e=await async function(t){let e=0;try{for(const n of t){const{contest:t,questions:r}=n,o=t.id,[{id:i,title:a,details:s,is_guess:c}]=r,[u,f]=s;if(Ws())return e;if(c)continue;Mi.info(`${a} <=> ${u.odds}:${f.odds}`);const l=u.odds>f.odds;let d;d=ia.MATCH_SELECTION>0?l?f:u:l?u:f,Mi.info(`é¢„æµ‹[ ${d.option} ] ${ia.MATCH_COINS} é¢—ç¡¬å¸`),await la();const{code:p}=await Qs(o,i,d.detail_id,ia.MATCH_COINS);0!==p?Mi.info("é¢„æµ‹å¤±è´¥"):(e++,aa.money-=ia.MATCH_COINS)}}catch(t){console.warn(t.message)}return e}(function(t,e){return t.filter((t=>{const{questions:n}=t,[{details:r,is_guess:o}]=n;if(o)return!1;const[i,a]=r;return Math.abs(i.odds-a.odds)>=e}))}(t,ia.MATCH_DIFF));Mi.info(`ã€ç«çŒœç»“æŸã€‘ä¸€å…±å‚ä¸${e}æ¬¡é¢„æµ‹`)},liveHeart:async function(){Mi.info("----ã€ç›´æ’­å¿ƒè·³ã€‘----");const{heartNum:t,fansMedalList:e}=await nc(),n=e&&e.length;if(!n)return void Mi.info("æ²¡æœ‰å‹‹ç« åˆ—è¡¨");const r=Math.ceil(t/n);for(let n=0;n<r;n++)await oc(e,t);Mi.info("å®Œæˆ")},liveLottery:async function(){Mi.info("----ã€å¤©é€‰æ—¶åˆ»ã€‘----");try{const t=await ic();Mi.info(`æœ€åä¸€ä¸ªå…³æ³¨çš„UP: ${t.uname}`);const e=await async function(){hc=[];const t=await yc();for(const e of t)for(const t of e)await $c(t.areaId,t.parentId,ia.LOTTERY_PAGE_NUM);return hc}();Mi.info("æ‰«æå®Œæˆ");const n=[];await uc(n,e,null==t?void 0:t.mid),await cc(n),Mi.info("ç§»åŠ¨å…³æ³¨UPåˆ°åˆ†ç»„æˆåŠŸ")}catch(t){Mi.warn(`å¤©é€‰æ—¶åˆ»å¼‚å¸¸: ${t.message}`),Mi.debug(t)}Mi.info("ç»“æŸå¤©é€‰æ—¶åˆ»")},liveRedPack:async function(){Mi.info("----ã€å¤©é€‰çº¢åŒ…ã€‘----");try{const t=await ic();Mi.info(`æœ€åä¸€ä¸ªå…³æ³¨çš„UP: ${t.uname}`);const e=await async function(){hc=[];const t=await yc();for(const e of t)for(const t of e)await Ic(t.areaId,t.parentId,ia.LOTTERY_PAGE_NUM);return hc}();Mi.info("æ‰«æå®Œæˆï¼Œè·å–æ–°å…³æ³¨çš„UP");const n=[];await uc(n,e,null==t?void 0:t.mid),Mi.info("å¼€å§‹è¯»å–æ¶ˆæ¯"),await Pc(n),Mi.info("ç§»åŠ¨å…³æ³¨UPåˆ°åˆ†ç»„"),await cc(n),Mi.info("ç§»åŠ¨å…³æ³¨UPåˆ°åˆ†ç»„æˆåŠŸ")}catch(t){Mi.warn(`å¤©é€‰æ—¶åˆ»å¼‚å¸¸: ${t.message}`),Mi.debug(t)}Mi.info("ç»“æŸå¤©é€‰çº¢åŒ…")}};var Ac=!w((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),Lc=_,Rc=Qt,kc=tt,Uc=Yt,Nc=Ac,jc=Tn("IE_PROTO"),Bc=Lc.Object,Gc=Bc.prototype,Dc=Nc?Bc.getPrototypeOf:function(t){var e=Uc(t);if(Rc(e,jc))return e[jc];var n=e.constructor;return kc(n)&&e instanceof n?n.prototype:e instanceof Bc?Gc:null},Mc={},Hc=Ir,Kc=Er,qc=Object.keys||function(t){return Hc(t,Kc)},Yc=b,Fc=Be,Jc=je,Qc=Ke,Wc=Z,zc=qc;Mc.f=Yc&&!Fc?Object.defineProperties:function(t,e){Qc(t);for(var n,r=Wc(e),o=zc(e),i=o.length,a=0;i>a;)Jc.f(t,n=o[a++],r[n]);return t};var Xc,Vc=at("document","documentElement"),Zc=Ke,tu=Mc,eu=Er,nu=On,ru=Vc,ou=Se,iu=Tn("IE_PROTO"),au=function(){},su=function(t){return"<script>"+t+"<\/script>"},cu=function(t){t.write(su("")),t.close();var e=t.parentWindow.Object;return t=null,e},uu=function(){try{Xc=new ActiveXObject("htmlfile")}catch(t){}var t,e;uu="undefined"!=typeof document?document.domain&&Xc?cu(Xc):((e=ou("iframe")).style.display="none",ru.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(su("document.F=Object")),t.close(),t.F):cu(Xc);for(var n=eu.length;n--;)delete uu.prototype[eu[n]];return uu()};nu[iu]=!0;var fu=Object.create||function(t,e){var n;return null!==t?(au.prototype=Zc(t),n=new au,au.prototype=null,n[iu]=t):n=uu(),void 0===e?n:tu.f(n,e)},lu=Pt,du=$,pu=B(B.bind),gu={},mu=gu,hu=fe("iterator"),yu=Array.prototype,_u=oi,vu=At,wu=gu,bu=fe("iterator"),$u=function(t){if(null!=t)return vu(t,bu)||vu(t,"@@iterator")||wu[_u(t)]},Tu=S,Ou=Pt,Su=Ke,Iu=St,Eu=$u,Cu=_.TypeError,Pu=S,xu=Ke,Au=At,Lu=function(t,e){return lu(t),void 0===e?t:du?pu(t,e):function(){return t.apply(e,arguments)}},Ru=S,ku=Ke,Uu=St,Nu=function(t){return void 0!==t&&(mu.Array===t||yu[hu]===t)},ju=mr,Bu=st,Gu=function(t,e){var n=arguments.length<2?Eu(t):e;if(Ou(n))return Su(Tu(n,t));throw Cu(Iu(t)+" is not iterable")},Du=$u,Mu=function(t,e,n){var r,o;xu(t);try{if(!(r=Au(t,"return"))){if("throw"===e)throw n;return n}r=Pu(r,t)}catch(t){o=!0,r=t}if("throw"===e)throw n;if(o)throw r;return xu(r),n},Hu=_.TypeError,Ku=function(t,e){this.stopped=t,this.result=e},qu=Ku.prototype,Yu=function(t,e,n){var r,o,i,a,s,c,u,f=n&&n.that,l=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_ITERATOR),p=!(!n||!n.INTERRUPTED),g=Lu(e,f),m=function(t){return r&&Mu(r,"normal",t),new Ku(!0,t)},h=function(t){return l?(ku(t),p?g(t[0],t[1],m):g(t[0],t[1])):p?g(t,m):g(t)};if(d)r=t;else{if(!(o=Du(t)))throw Hu(Uu(t)+" is not iterable");if(Nu(o)){for(i=0,a=ju(t);a>i;i++)if((s=h(t[i]))&&Bu(qu,s))return s;return new Ku(!1)}r=Gu(t,o)}for(c=r.next;!(u=Ru(c,r)).done;){try{s=h(u.value)}catch(t){Mu(r,"throw",t)}if("object"==typeof s&&s&&Bu(qu,s))return s}return new Ku(!1)},Fu=oo,Ju=_,Qu=st,Wu=Dc,zu=Yo,Xu=Mr,Vu=fu,Zu=tn,tf=L,ef=yi,nf=li,rf=Yu,of=ci,af=vi,sf=fe("toStringTag"),cf=Ju.Error,uf=[].push,ff=function(t,e){var n,r=arguments.length>2?arguments[2]:void 0,o=Qu(lf,this);zu?n=zu(new cf,o?Wu(this):lf):(n=o?this:Vu(lf),Zu(n,sf,"Error")),void 0!==e&&Zu(n,"message",of(e)),af&&Zu(n,"stack",ef(n.stack,1)),nf(n,r);var i=[];return rf(t,uf,{that:i}),Zu(n,"errors",i),n};zu?zu(ff,cf):Xu(ff,cf,{name:!0});var lf=ff.prototype=Vu(cf.prototype,{constructor:tf(1,ff),message:tf(1,""),name:tf(1,"AggregateError")});Fu({global:!0,constructor:!0,arity:2},{AggregateError:ff});var df={},pf=Pt,gf=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=pf(e),this.reject=pf(n)};df.f=function(t){return new gf(t)};var mf=S,hf=Pt,yf=at,_f=df,vf=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},wf=Yu;oo({target:"Promise",stat:!0},{any:function(t){var e=this,n=yf("AggregateError"),r=_f.f(e),o=r.resolve,i=r.reject,a=vf((function(){var r=hf(e.resolve),a=[],s=0,c=1,u=!1;wf(t,(function(t){var f=s++,l=!1;c++,mf(r,e,t).then((function(t){l||u||(u=!0,o(t))}),(function(t){l||u||(l=!0,a[f]=t,--c||i(new n(a,"No one promise resolved")))}))})),--c||i(new n(a,"No one promise resolved"))}));return a.error&&i(a.value),r.promise}}),Mi.info("å¼€å§‹æ‰§è¡Œç½‘ç»œä»£ç "),Mi.info("å½“å‰ç‰ˆæœ¬ã€v0.5.0-rc0ã€‘"),async function(t,...e){Di.value="";try{await async function(){Mi.info("----ã€ç™»å½•ã€‘----");const{data:t,message:e,code:n}=await ms();if(0!==n)throw Mi.error(`ç™»å½•é”™è¯¯ ${n} ${e}`),new Error(e);if(!t.isLogin)throw new Error("æ¥å£è¿”å›ä¸ºæœªç™»å½•");await la(),await ws(t)}()}catch(t){return Mi.error(`ç™»å½•å¤±è´¥: ${t}`),await as("ç™»å½•å¤±è´¥",Di.value),"æœªå®Œæˆ"}const n=fa([...Object.values(xc)]);for(const t of n)await t(),await la();return t&&await t(...e),await as("æ¯æ—¥å®Œæˆ",Di.value),"å®Œæˆ"}().then((t=>{VMThis.message=t,VMThis.resolve(t)})).catch((t=>{VMThis.error=t,VMThis.reject(t)}));
